!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=124)}([function(t,e,r){var n=r(2),i=r(8),o=r(14),a=r(11),s=r(21),l=function(t,e,r){var u,c,h,p,d=t&l.F,f=t&l.G,m=t&l.S,_=t&l.P,y=t&l.B,g=f?n:m?n[e]||(n[e]={}):(n[e]||{}).prototype,v=f?i:i[e]||(i[e]={}),b=v.prototype||(v.prototype={});for(u in f&&(r=e),r)h=((c=!d&&g&&void 0!==g[u])?g:r)[u],p=y&&c?s(h,n):_&&"function"==typeof h?s(Function.call,h):h,g&&a(g,u,h,t&l.U),v[u]!=h&&o(v,u,p),_&&b[u]!=h&&(b[u]=h)};n.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(3);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,r){var n=r(62)("wks"),i=r(31),o=r(2).Symbol,a="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=n},function(t,e,r){var n=r(4),i=r(88),o=r(27),a=Object.defineProperty;e.f=r(7)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){t.exports=!r(1)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var r=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(25),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,a,s,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(o(r=this._events[t]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),a=(u=r.slice()).length,l=0;l<a;l++)u[l].apply(this,s);return!0},r.prototype.addListener=function(t,e){var a;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},r.prototype.removeListener=function(t,e){var r,o,a,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(r=this._events[t]).length,o=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(r)){for(s=a;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){o=s;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[t]))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,r){var n=r(2),i=r(14),o=r(13),a=r(31)("src"),s=Function.toString,l=(""+s).split("toString");r(8).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,r,s){var u="function"==typeof r;u&&(o(r,"name")||i(r,"name",e)),t[e]!==r&&(u&&(o(r,a)||i(r,a,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=r:s?t[e]?t[e]=r:i(t,e,r):(delete t[e],i(t,e,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,r){var n=r(0),i=r(1),o=r(24),a=/"/g,s=function(t,e,r,n){var i=String(o(t)),s="<"+e;return""!==r&&(s+=" "+r+'="'+String(n).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var r={};r[t]=e(s),n(n.P+n.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",r)}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(6),i=r(30);t.exports=r(7)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var n=r(46),i=r(24);t.exports=function(t){return n(i(t))}},function(t,e,r){var n=r(24);t.exports=function(t){return Object(n(t))}},function(t,e,r){"use strict";var n=r(1);t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,r){var n=r(47),i=r(30),o=r(15),a=r(27),s=r(13),l=r(88),u=Object.getOwnPropertyDescriptor;e.f=r(7)?u:function(t,e){if(t=o(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,r){var n=r(0),i=r(8),o=r(1);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],a={};a[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",a)}},function(t,e,r){var n=r(21),i=r(46),o=r(16),a=r(9),s=r(218);t.exports=function(t,e){var r=1==t,l=2==t,u=3==t,c=4==t,h=6==t,p=5==t||h,d=e||s;return function(e,s,f){for(var m,_,y=o(e),g=i(y),v=n(s,f,3),b=a(g.length),x=0,w=r?d(e,b):l?d(e,0):void 0;b>x;x++)if((p||x in g)&&(_=v(m=g[x],x,y),t))if(r)w[x]=_;else if(_)switch(t){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(c)return!1;return h?-1:u||c?c:w}}},function(t,e,r){var n=r(22);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){"use strict";if(r(7)){var n=r(32),i=r(2),o=r(1),a=r(0),s=r(59),l=r(85),u=r(21),c=r(43),h=r(30),p=r(14),d=r(44),f=r(25),m=r(9),_=r(113),y=r(34),g=r(27),v=r(13),b=r(51),x=r(3),w=r(16),k=r(78),E=r(35),I=r(37),S=r(36).f,M=r(80),T=r(31),A=r(5),P=r(20),C=r(49),D=r(56),z=r(82),B=r(40),L=r(53),R=r(42),O=r(81),F=r(105),N=r(6),V=r(18),j=N.f,U=V.f,q=i.RangeError,G=i.TypeError,Z=i.Uint8Array,X=Array.prototype,W=l.ArrayBuffer,H=l.DataView,Y=P(0),K=P(2),J=P(3),Q=P(4),$=P(5),tt=P(6),et=C(!0),rt=C(!1),nt=z.values,it=z.keys,ot=z.entries,at=X.lastIndexOf,st=X.reduce,lt=X.reduceRight,ut=X.join,ct=X.sort,ht=X.slice,pt=X.toString,dt=X.toLocaleString,ft=A("iterator"),mt=A("toStringTag"),_t=T("typed_constructor"),yt=T("def_constructor"),gt=s.CONSTR,vt=s.TYPED,bt=s.VIEW,xt=P(1,function(t,e){return St(D(t,t[yt]),e)}),wt=o(function(){return 1===new Z(new Uint16Array([1]).buffer)[0]}),kt=!!Z&&!!Z.prototype.set&&o(function(){new Z(1).set({})}),Et=function(t,e){var r=f(t);if(r<0||r%e)throw q("Wrong offset!");return r},It=function(t){if(x(t)&&vt in t)return t;throw G(t+" is not a typed array!")},St=function(t,e){if(!(x(t)&&_t in t))throw G("It is not a typed array constructor!");return new t(e)},Mt=function(t,e){return Tt(D(t,t[yt]),e)},Tt=function(t,e){for(var r=0,n=e.length,i=St(t,n);n>r;)i[r]=e[r++];return i},At=function(t,e,r){j(t,e,{get:function(){return this._d[r]}})},Pt=function(t){var e,r,n,i,o,a,s=w(t),l=arguments.length,c=l>1?arguments[1]:void 0,h=void 0!==c,p=M(s);if(void 0!=p&&!k(p)){for(a=p.call(s),n=[],e=0;!(o=a.next()).done;e++)n.push(o.value);s=n}for(h&&l>2&&(c=u(c,arguments[2],2)),e=0,r=m(s.length),i=St(this,r);r>e;e++)i[e]=h?c(s[e],e):s[e];return i},Ct=function(){for(var t=0,e=arguments.length,r=St(this,e);e>t;)r[t]=arguments[t++];return r},Dt=!!Z&&o(function(){dt.call(new Z(1))}),zt=function(){return dt.apply(Dt?ht.call(It(this)):It(this),arguments)},Bt={copyWithin:function(t,e){return F.call(It(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(It(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return O.apply(It(this),arguments)},filter:function(t){return Mt(this,K(It(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(It(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(It(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Y(It(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(It(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(It(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ut.apply(It(this),arguments)},lastIndexOf:function(t){return at.apply(It(this),arguments)},map:function(t){return xt(It(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(It(this),arguments)},reduceRight:function(t){return lt.apply(It(this),arguments)},reverse:function(){for(var t,e=It(this).length,r=Math.floor(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this},some:function(t){return J(It(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(It(this),t)},subarray:function(t,e){var r=It(this),n=r.length,i=y(t,n);return new(D(r,r[yt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,m((void 0===e?n:y(e,n))-i))}},Lt=function(t,e){return Mt(this,ht.call(It(this),t,e))},Rt=function(t){It(this);var e=Et(arguments[1],1),r=this.length,n=w(t),i=m(n.length),o=0;if(i+e>r)throw q("Wrong length!");for(;o<i;)this[e+o]=n[o++]},Ot={entries:function(){return ot.call(It(this))},keys:function(){return it.call(It(this))},values:function(){return nt.call(It(this))}},Ft=function(t,e){return x(t)&&t[vt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Nt=function(t,e){return Ft(t,e=g(e,!0))?h(2,t[e]):U(t,e)},Vt=function(t,e,r){return!(Ft(t,e=g(e,!0))&&x(r)&&v(r,"value"))||v(r,"get")||v(r,"set")||r.configurable||v(r,"writable")&&!r.writable||v(r,"enumerable")&&!r.enumerable?j(t,e,r):(t[e]=r.value,t)};gt||(V.f=Nt,N.f=Vt),a(a.S+a.F*!gt,"Object",{getOwnPropertyDescriptor:Nt,defineProperty:Vt}),o(function(){pt.call({})})&&(pt=dt=function(){return ut.call(this)});var jt=d({},Bt);d(jt,Ot),p(jt,ft,Ot.values),d(jt,{slice:Lt,set:Rt,constructor:function(){},toString:pt,toLocaleString:zt}),At(jt,"buffer","b"),At(jt,"byteOffset","o"),At(jt,"byteLength","l"),At(jt,"length","e"),j(jt,mt,{get:function(){return this[vt]}}),t.exports=function(t,e,r,l){var u=t+((l=!!l)?"Clamped":"")+"Array",h="get"+t,d="set"+t,f=i[u],y=f||{},g=f&&I(f),v=!f||!s.ABV,w={},k=f&&f.prototype,M=function(t,r){j(t,r,{get:function(){return function(t,r){var n=t._d;return n.v[h](r*e+n.o,wt)}(this,r)},set:function(t){return function(t,r,n){var i=t._d;l&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[d](r*e+i.o,n,wt)}(this,r,t)},enumerable:!0})};v?(f=r(function(t,r,n,i){c(t,f,u,"_d");var o,a,s,l,h=0,d=0;if(x(r)){if(!(r instanceof W||"ArrayBuffer"==(l=b(r))||"SharedArrayBuffer"==l))return vt in r?Tt(f,r):Pt.call(f,r);o=r,d=Et(n,e);var y=r.byteLength;if(void 0===i){if(y%e)throw q("Wrong length!");if((a=y-d)<0)throw q("Wrong length!")}else if((a=m(i)*e)+d>y)throw q("Wrong length!");s=a/e}else s=_(r),o=new W(a=s*e);for(p(t,"_d",{b:o,o:d,l:a,e:s,v:new H(o)});h<s;)M(t,h++)}),k=f.prototype=E(jt),p(k,"constructor",f)):o(function(){f(1)})&&o(function(){new f(-1)})&&L(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=r(function(t,r,n,i){var o;return c(t,f,u),x(r)?r instanceof W||"ArrayBuffer"==(o=b(r))||"SharedArrayBuffer"==o?void 0!==i?new y(r,Et(n,e),i):void 0!==n?new y(r,Et(n,e)):new y(r):vt in r?Tt(f,r):Pt.call(f,r):new y(_(r))}),Y(g!==Function.prototype?S(y).concat(S(g)):S(y),function(t){t in f||p(f,t,y[t])}),f.prototype=k,n||(k.constructor=f));var T=k[ft],A=!!T&&("values"==T.name||void 0==T.name),P=Ot.values;p(f,_t,!0),p(k,vt,u),p(k,bt,!0),p(k,yt,f),(l?new f(1)[mt]==u:mt in k)||j(k,mt,{get:function(){return u}}),w[u]=f,a(a.G+a.W+a.F*(f!=y),w),a(a.S,u,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){y.of.call(f,1)}),u,{from:Pt,of:Ct}),"BYTES_PER_ELEMENT"in k||p(k,"BYTES_PER_ELEMENT",e),a(a.P,u,Bt),R(u),a(a.P+a.F*kt,u,{set:Rt}),a(a.P+a.F*!A,u,Ot),n||k.toString==pt||(k.toString=pt),a(a.P+a.F*o(function(){new f(1).slice()}),u,{slice:Lt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!o(function(){k.toLocaleString.call([1,2])})),u,{toLocaleString:zt}),B[u]=A?T:P,n||A||p(k,ft,P)}}else t.exports=function(){}},function(t,e,r){var n=r(3);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(31)("meta"),i=r(3),o=r(13),a=r(6).f,s=0,l=Object.isExtensible||function(){return!0},u=!r(1)(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[n].i},getWeak:function(t,e){if(!o(t,n)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[n].w},onFreeze:function(t){return u&&h.NEED&&l(t)&&!o(t,n)&&c(t),t}}},function(t,e,r){t.exports=function(){"use strict";var t,e,r;function n(n,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(r=i(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=i;else t=i}return n(0,function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=n;function n(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){var r,n,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=function(t,e,r){this.column=t,this.row=e,this.zoom=r};i.prototype.clone=function(){return new i(this.column,this.row,this.zoom)},i.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},i.prototype.sub=function(t){return this.clone()._sub(t)},i.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},i.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var o=a;function a(t,e){this.x=t,this.y=e}function s(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!s(t[r],e[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(!s(t[n],e[n]))return!1;return!0}return t===e}function l(t,e,n,i){var o=new r(t,e,n,i);return function(t){return o.solve(t)}}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t};var u=l(.25,.1,.25,1);function c(t,e,r){return Math.min(r,Math.max(e,t))}function h(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}var p=1;function d(){return p++}function f(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function m(t,e){return-1!==t.indexOf(e,t.length-e.length)}function _(t,e,r){var n={};for(var i in t)n[i]=e.call(r||this,t[i],i,t);return n}function y(t,e,r){var n={};for(var i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function g(t){return Array.isArray(t)?t.map(g):"object"==typeof t&&t?_(t,g):t}var v={};function b(t){v[t]||("undefined"!=typeof console&&console.warn(t),v[t]=!0)}function x(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function w(t){for(var e=0,r=0,n=t.length,i=n-1,o=void 0,a=void 0;r<n;i=r++)o=t[r],e+=((a=t[i]).x-o.x)*(o.y+a.y);return e}var k=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),E=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,I=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,S={now:k,frame:function(t){var e=E(t);return{cancel:function(){return I(e)}}},getImageData:function(t){var e=self.document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(0,0,t.width,t.height)},resolveURL:function(t){var e=self.document.createElement("a");return e.href=t,e.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:!1};if(self.document){var M=self.document.createElement("img");M.onload=function(){S.supportsWebp=!0},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var T={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(T);var A=function(t){function e(e,r,n){t.call(this,e),this.status=r,this.url=n,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error);function P(t){var e=new self.XMLHttpRequest;for(var r in e.open(t.method||"GET",t.url,!0),t.headers)e.setRequestHeader(r,t.headers[r]);return e.withCredentials="include"===t.credentials,e}var C=function(t,e){var r=P(t);return r.responseType="arraybuffer",r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){var n=r.response;if(0===n.byteLength&&200===r.status)return e(new Error("http status 200 returned without content."));r.status>=200&&r.status<300&&r.response?e(null,{data:n,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")}):e(new A(r.statusText,r.status,t.url))},r.send(),{cancel:function(){return r.abort()}}};function D(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function z(t,e,r){if(r&&r[t]){var n=r[t].indexOf(e);-1!==n&&r[t].splice(n,1)}}var B=function(t,e){void 0===e&&(e={}),h(this,e),this.type=t},L=function(t){function e(e,r){void 0===r&&(r={}),t.call(this,"error",h({error:e},r))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(B),R=function(){};R.prototype.on=function(t,e){return this._listeners=this._listeners||{},D(t,e,this._listeners),this},R.prototype.off=function(t,e){return z(t,e,this._listeners),z(t,e,this._oneTimeListeners),this},R.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},D(t,e,this._oneTimeListeners),this},R.prototype.fire=function(t){"string"==typeof t&&(t=new B(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var r=0,n=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];r<n.length;r+=1)n[r].call(this,t);for(var i=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];i<o.length;i+=1){var a=o[i];z(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(h(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof L&&console.error(t.error);return this},R.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},R.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var O={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},F=function(t,e,r,n){this.message=(t?t+": ":"")+r,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__)};function N(t){var e=t.key,r=t.value;return r?[new F(e,r,"constants have been deprecated as of v8")]:[]}function V(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}function j(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function U(t){return Array.isArray(t)?t.map(U):j(t)}var q=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),G=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var i=n[r],o=i[0],a=i[1];this.bindings[o]=a}};G.prototype.concat=function(t){return new G(this,t)},G.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},G.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Z={kind:"null"},X={kind:"number"},W={kind:"string"},H={kind:"boolean"},Y={kind:"color"},K={kind:"object"},J={kind:"value"},Q={kind:"collator"},$={kind:"formatted"};function tt(t,e){return{kind:"array",itemType:t,N:e}}function et(t){if("array"===t.kind){var e=et(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var rt=[Z,X,W,H,Y,$,K,tt(J)];function nt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&!nt(t.itemType,e.itemType)&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,n=rt;r<n.length;r+=1)if(!nt(n[r],e))return null}return"Expected "+et(t)+" but found "+et(e)+" instead."}var it=e(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=i.indexOf("("),u=i.indexOf(")");if(-1!==l&&u+1===i.length){var c=i.substr(0,l),h=i.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=a(h[1]),m=a(h[2]),_=m<=.5?m*(f+1):m+f-m*f,y=2*m-_;return[n(255*s(y,_,d+1/3)),n(255*s(y,_,d)),n(255*s(y,_,d-1/3)),p];default:return null}}return null}}catch(t){}}).parseCSSColor,ot=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};ot.parse=function(t){if(t){if(t instanceof ot)return t;if("string"==typeof t){var e=it(t);if(e)return new ot(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},ot.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+i+")"},ot.prototype.toArray=function(){var t=this.r,e=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]},ot.black=new ot(0,0,0,1),ot.white=new ot(1,1,1,1),ot.transparent=new ot(0,0,0,0);var at=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};at.prototype.compare=function(t,e){return this.collator.compare(t,e)},at.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var st=function(t,e,r){this.type=Q,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function lt(t,e,r,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ut(t){if(null===t)return Z;if("string"==typeof t)return W;if("boolean"==typeof t)return H;if("number"==typeof t)return X;if(t instanceof ot)return Y;if(t instanceof at)return Q;if(Array.isArray(t)){for(var e,r=t.length,n=0,i=t;n<i.length;n+=1){var o=ut(i[n]);if(e){if(e===o)continue;e=J;break}e=o}return tt(e||J,r)}return K}st.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,H);if(!n)return null;var i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,H);if(!i)return null;var o=null;return r.locale&&!(o=e.parse(r.locale,1,W))?null:new st(n,i,o)},st.prototype.evaluate=function(t){return new at(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},st.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},st.prototype.possibleOutputs=function(){return[void 0]},st.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ct=function(t,e,r){this.text=t,this.scale=e,this.fontStack=r},ht=function(t){this.sections=t};ht.prototype.toString=function(){return this.sections.map(function(t){return t.text}).join("")},ht.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.text);var i=n.fontStack?["literal",n.fontStack.split(",")]:null;t.push({"text-font":i,"font-scale":n.scale})}return t};var pt=function(t){this.type=$,this.sections=t};pt.parse=function(t,e){if(t.length<3)return e.error("Expected at least two arguments.");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");for(var r=[],n=1;n<t.length-1;n+=2){var i=e.parse(t[n],1,J);if(!i)return null;var o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o)return e.error("Formatted text type must be 'string', 'value', or 'null'.");var a=t[n+1];if("object"!=typeof a||Array.isArray(a))return e.error("Format options argument must be an object.");var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,X)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,tt(W))))return null;r.push({text:i,scale:s,font:l})}return new pt(r)},pt.prototype.evaluate=function(t){return new ht(this.sections.map(function(e){return new ct(e.text.evaluate(t)||"",e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null)}))},pt.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t(n.text),n.scale&&t(n.scale),n.font&&t(n.font)}},pt.prototype.possibleOutputs=function(){return[void 0]},pt.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.text.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),t.push(i)}return t};var dt=function(t,e){this.type=t,this.value=e};dt.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof ot)return!0;if(e instanceof at)return!0;if(Array.isArray(e)){for(var r=0,n=e;r<n.length;r+=1)if(!t(n[r]))return!1;return!0}if("object"==typeof e){for(var i in e)if(!t(e[i]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var r=t[1],n=ut(r),i=e.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new dt(n,r)},dt.prototype.evaluate=function(){return this.value},dt.prototype.eachChild=function(){},dt.prototype.possibleOutputs=function(){return[this.value]},dt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ot?["rgba"].concat(this.value.toArray()):this.value instanceof ht?this.value.serialize():this.value};var ft=function(t){this.name="ExpressionEvaluationError",this.message=t};ft.prototype.toJSON=function(){return this.message};var mt={string:W,number:X,boolean:H,object:K},_t=function(t,e){this.type=t,this.args=e};_t.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var r=t[0],n=mt[r],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,J);if(!a)return null;i.push(a)}return new _t(n,i)},_t.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!nt(this.type,ut(r)))return r;if(e===this.args.length-1)throw new ft("Expected value to be of type "+et(this.type)+", but found "+et(ut(r))+" instead.")}return null},_t.prototype.eachChild=function(t){this.args.forEach(t)},_t.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},_t.prototype.serialize=function(){return[this.type.kind].concat(this.args.map(function(t){return t.serialize()}))};var yt={string:W,number:X,boolean:H},gt=function(t,e){this.type=t,this.input=e};gt.parse=function(t,e){if(t.length<2||t.length>4)return e.error("Expected 1, 2, or 3 arguments, but found "+(t.length-1)+" instead.");var r,n;if(t.length>2){var i=t[1];if("string"!=typeof i||!(i in yt))return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=yt[i]}else r=J;if(t.length>3){if("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2]))return e.error('The length argument to "array" must be a positive integer literal',2);n=t[2]}var o=tt(r,n),a=e.parse(t[t.length-1],t.length-1,J);return a?new gt(o,a):null},gt.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(nt(this.type,ut(e)))throw new ft("Expected value to be of type "+et(this.type)+", but found "+et(ut(e))+" instead.");return e},gt.prototype.eachChild=function(t){t(this.input)},gt.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},gt.prototype.serialize=function(){var t=["array"],e=this.type.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var r=this.type.N;"number"==typeof r&&t.push(r)}return t.push(this.input.serialize()),t};var vt={"to-number":X,"to-color":Y},bt=function(t,e){this.type=t,this.args=e};bt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var r=t[0],n=vt[r],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,J);if(!a)return null;i.push(a)}return new bt(n,i)},bt.prototype.evaluate=function(t){if("color"===this.type.kind){for(var e,r,n=0,i=this.args;n<i.length;n+=1)if(r=null,"string"==typeof(e=i[n].evaluate(t))){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":lt(e[0],e[1],e[2],e[3])))return new ot(e[0]/255,e[1]/255,e[2]/255,e[3]);throw new ft(r||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}if("formatted"===this.type.kind){for(var a,s=0,l=this.args;s<l.length;s+=1)if("string"==typeof(a=l[s].evaluate(t)))return new ht([new ct(a,null,null)]);throw new ft("Could not parse formatted text from value '"+("string"==typeof a?a:JSON.stringify(a))+"'")}for(var u=null,c=0,h=this.args;c<h.length;c+=1)if(null!==(u=h[c].evaluate(t))){var p=Number(u);if(!isNaN(p))return p}throw new ft("Could not convert "+JSON.stringify(u)+" to number.")},bt.prototype.eachChild=function(t){this.args.forEach(t)},bt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},bt.prototype.serialize=function(){var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var xt=["Unknown","Point","LineString","Polygon"],wt=function(){this._parseColorCache={}};wt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},wt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?xt[this.feature.type]:this.feature.type:null},wt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},wt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ot.parse(t)),e};var kt=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};function Et(t){if(t instanceof kt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!Et(t)&&(e=!1)}),e}function It(t){if(t instanceof kt&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!It(t)&&(e=!1)}),e}function St(t,e){if(t instanceof kt&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild(function(t){r&&!St(t,e)&&(r=!1)}),r}kt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},kt.prototype.eachChild=function(t){this.args.forEach(t)},kt.prototype.possibleOutputs=function(){return[void 0]},kt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},kt.parse=function(t,e){var r=t[0],n=kt.definitions[r];if(!n)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter(function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1}),s=null,l=0,u=a;l<u.length;l+=1){var c=u[l],h=c[0],p=c[1];s=new Tt(e.registry,e.path,null,e.scope);for(var d=[],f=!1,m=1;m<t.length;m++){var _=t[m],y=Array.isArray(h)?h[m-1]:h.type,g=s.parse(_,1+d.length,y);if(!g){f=!0;break}d.push(g)}if(!f)if(Array.isArray(h)&&h.length!==d.length)s.error("Expected "+h.length+" arguments, but found "+d.length+" instead.");else{for(var v=0;v<d.length;v++){var b=Array.isArray(h)?h[v]:h.type,x=d[v];s.concat(v+1).checkSubtype(b,x.type)}if(0===s.errors.length)return new kt(r,i,p,d)}}if(1===a.length)e.errors.push.apply(e.errors,s.errors);else{for(var w=(a.length?a:o).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(et).join(", ")+")":"("+et(e.type)+"...)"}).join(" | "),k=[],E=1;E<t.length;E++){var I=e.parse(t[E],1+k.length);if(!I)return null;k.push(et(I.type))}e.error("Expected arguments of type "+w+", but found ("+k.join(", ")+") instead.")}return null},kt.register=function(t,e){for(var r in kt.definitions=e,e)t[r]=kt};var Mt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Mt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new Mt(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Mt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Mt.prototype.eachChild=function(){},Mt.prototype.possibleOutputs=function(){return[void 0]},Mt.prototype.serialize=function(){return["var",this.name]};var Tt=function(t,e,r,n,i){void 0===e&&(e=[]),void 0===n&&(n=new G),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=r};function At(t,e){for(var r,n,i=0,o=t.length-1,a=0;i<=o;){if(r=t[a=Math.floor((i+o)/2)],n=t[a+1],e===r||e>r&&e<n)return a;if(r<e)i=a+1;else{if(!(r>e))throw new ft("Input is not a number.");o=a-1}}return Math.max(a-1,0)}Tt.prototype.parse=function(t,e,r,n,i){return void 0===i&&(i={}),e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)},Tt.prototype._parse=function(t,e){if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[r];if(n){var i=n.parse(t,this);if(!i)return null;if(this.expectedType){var o=this.expectedType,a=i.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind||"value"!==a.kind)if("array"===o.kind&&"value"===a.kind)e.omitTypeAnnotations||(i=new gt(o,i));else if("color"!==o.kind||"value"!==a.kind&&"string"!==a.kind)if("formatted"!==o.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(this.expectedType,i.type))return null}else e.omitTypeAnnotations||(i=new bt(o,[i]));else e.omitTypeAnnotations||(i=new bt(o,[i]));else e.omitTypeAnnotations||(i=new _t(o,[i]))}if(!(i instanceof dt)&&function t(e){if(e instanceof Mt)return t(e.boundExpression);if(e instanceof kt&&"error"===e.name)return!1;if(e instanceof st)return!1;var r=e instanceof bt||e instanceof _t||e instanceof gt,n=!0;return e.eachChild(function(e){n=r?n&&t(e):n&&e instanceof dt}),!!n&&Et(e)&&St(e,["zoom","heatmap-density","line-progress","is-supported-script"])}(i)){var s=new wt;try{i=new dt(i.type,i.evaluate(s))}catch(t){return this.error(t.message),null}}return i}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},Tt.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Tt(this.registry,n,e||null,i,this.errors)},Tt.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var n=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new q(n,t))},Tt.prototype.checkSubtype=function(t,e){var r=nt(t,e);return r&&this.error(r),r};var Pt=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};Pt.parse=function(t,e){var r=t[1],n=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,1,X)))return null;var i=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),n.unshift(-1/0);for(var a=0;a<n.length;a+=2){var s=n[a],l=n[a+1],u=a+1,c=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=e.parse(l,c,o);if(!h)return null;o=o||h.type,i.push([s,h])}return new Pt(o,r,i)},Pt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;return n>=e[i-1]?r[i-1].evaluate(t):r[At(e,n)].evaluate(t)},Pt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Pt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Pt.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Ct=Dt;function Dt(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}function zt(t,e,r){return t*(1-r)+e*r}Dt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Dt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Dt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Dt.prototype.solveCurveX=function(t,e){var r,n,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},Dt.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Bt=Object.freeze({number:zt,color:function(t,e,r){return new ot(zt(t.r,e.r,r),zt(t.g,e.g,r),zt(t.b,e.b,r),zt(t.a,e.a,r))},array:function(t,e,r){return t.map(function(t,n){return zt(t,e[n],r)})}}),Lt=function(t,e,r,n){this.type=t,this.interpolation=e,this.input=r,this.labels=[],this.outputs=[];for(var i=0,o=n;i<o.length;i+=1){var a=o[i],s=a[0],l=a[1];this.labels.push(s),this.outputs.push(l)}};function Rt(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}Lt.interpolationFactor=function(t,e,r,n){var i=0;if("exponential"===t.name)i=Rt(e,t.base,r,n);else if("linear"===t.name)i=Rt(e,1,r,n);else if("cubic-bezier"===t.name){var o=t.controlPoints;i=new Ct(o[0],o[1],o[2],o[3]).solve(Rt(e,1,r,n))}return i},Lt.parse=function(t,e){var r=t[1],n=t[2],i=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var o=r[1];if("number"!=typeof o)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:o}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var a=r.slice(1);if(4!==a.length||a.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:a}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,2,X)))return null;var s=[],l=null;e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var u=0;u<i.length;u+=2){var c=i[u],h=i[u+1],p=u+3,d=u+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(s.length&&s[s.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var f=e.parse(h,d,l);if(!f)return null;l=l||f.type,s.push([c,f])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Lt(l,r,n,s):e.error("Type "+et(l)+" is not interpolatable.")},Lt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);var o=At(e,n),a=e[o],s=e[o+1],l=Lt.interpolationFactor(this.interpolation,n,a,s),u=r[o].evaluate(t),c=r[o+1].evaluate(t);return Bt[this.type.kind.toLowerCase()](u,c,l)},Lt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Lt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Lt.prototype.serialize=function(){for(var t=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var Ot=function(t,e){this.type=t,this.args=e};Ot.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,n=e.expectedType;n&&"value"!==n.kind&&(r=n);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],l=e.parse(s,1+i.length,r,void 0,{omitTypeAnnotations:!0});if(!l)return null;r=r||l.type,i.push(l)}var u=n&&i.some(function(t){return nt(n,t.type)});return new Ot(u?J:r,i)},Ot.prototype.evaluate=function(t){for(var e=null,r=0,n=this.args;r<n.length&&null===(e=n[r].evaluate(t));r+=1);return e},Ot.prototype.eachChild=function(t){this.args.forEach(t)},Ot.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Ot.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ft=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Ft.prototype.evaluate=function(t){return this.result.evaluate(t)},Ft.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},Ft.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var i=t[n];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var o=e.parse(t[n+1],n+1);if(!o)return null;r.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,void 0,r);return a?new Ft(r,a):null},Ft.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Ft.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var Nt=function(t,e,r){this.type=t,this.index=e,this.input=r};Nt.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,X),n=e.parse(t[2],2,tt(e.expectedType||J));if(!r||!n)return null;var i=n.type;return new Nt(i.itemType,r,n)},Nt.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new ft("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new ft("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new ft("Array index must be an integer, but found "+e+" instead.");return r[e]},Nt.prototype.eachChild=function(t){t(this.index),t(this.input)},Nt.prototype.possibleOutputs=function(){return[void 0]},Nt.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Vt=function(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o};Vt.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,h=s;c<h.length;c+=1){var p=h[c];if("number"!=typeof p&&"string"!=typeof p)return u.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ut(p)))return null}else r=ut(p);if(void 0!==i[String(p)])return u.error("Branch labels must be unique.");i[String(p)]=o.length}var d=e.parse(l,a,n);if(!d)return null;n=n||d.type,o.push(d)}var f=e.parse(t[1],1,J);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,n);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new Vt(r,n,f,i,o,m):null},Vt.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ut(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Vt.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Vt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},Vt.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i],s=n[t.cases[a]];void 0===s?(n[t.cases[a]]=r.length,r.push([t.cases[a],[a]])):r[s][1].push(a)}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=r;u<c.length;u+=1){var h=c[u],p=h[0],d=h[1];1===d.length?e.push(l(d[0])):e.push(d.map(l)),e.push(t.outputs[p].serialize())}return e.push(this.otherwise.serialize()),e};var jt=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};function Ut(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function qt(t,e,r,n){return 0===n.compare(e,r)}function Gt(t,e,r){var n="=="!==t&&"!="!==t;return function(){function i(t,e,r){this.type=H,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],o=e.parse(t[1],1,J);if(!o)return null;if(!Ut(r,o.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+et(o.type)+"'.");var a=e.parse(t[2],2,J);if(!a)return null;if(!Ut(r,a.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+et(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+et(o.type)+"' and '"+et(a.type)+"'.");n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new _t(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new _t(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Q)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=ut(o),l=ut(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new ft('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var u=ut(o),c=ut(a);if("string"!==u.kind||"string"!==c.kind)return e(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},i}()}jt.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,H);if(!o)return null;var a=e.parse(t[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new jt(r,n,s):null},jt.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},jt.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t(i),t(o)}t(this.otherwise)},jt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},jt.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Zt=Gt("==",function(t,e,r){return e===r},qt),Xt=Gt("!=",function(t,e,r){return e!==r},function(t,e,r,n){return!qt(0,e,r,n)}),Wt=Gt("<",function(t,e,r){return e<r},function(t,e,r,n){return n.compare(e,r)<0}),Ht=Gt(">",function(t,e,r){return e>r},function(t,e,r,n){return n.compare(e,r)>0}),Yt=Gt("<=",function(t,e,r){return e<=r},function(t,e,r,n){return n.compare(e,r)<=0}),Kt=Gt(">=",function(t,e,r){return e>=r},function(t,e,r,n){return n.compare(e,r)>=0}),Jt=function(t){this.type=X,this.input=t};Jt.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+et(r.type)+" instead."):new Jt(r):null},Jt.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ft("Expected value to be of type string or array, but found "+et(ut(e))+" instead.")},Jt.prototype.eachChild=function(t){t(this.input)},Jt.prototype.possibleOutputs=function(){return[void 0]},Jt.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Qt={"==":Zt,"!=":Xt,">":Ht,"<":Wt,">=":Kt,"<=":Yt,array:gt,at:Nt,boolean:_t,case:jt,coalesce:Ot,collator:st,format:pt,interpolate:Lt,length:Jt,let:Ft,literal:dt,match:Vt,number:_t,object:_t,step:Pt,string:_t,"to-color":bt,"to-number":bt,var:Mt};function $t(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];r=r.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=lt(r,n,i,a);if(s)throw new ft(s);return new ot(r/255*a,n/255*a,i/255*a,a)}function te(t,e){return t in e}function ee(t,e){var r=e[t];return void 0===r?null:r}function re(t){return{type:t}}function ne(t){return{result:"success",value:t}}function ie(t){return{result:"error",value:t}}function oe(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function ae(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function se(t){return!!t.expression&&t.expression.interpolated}kt.register(Qt,{error:[{kind:"error"},[W],function(t,e){var r=e[0];throw new ft(r.evaluate(t))}],typeof:[W,[J],function(t,e){return et(ut(e[0].evaluate(t)))}],"to-string":[W,[J],function(t,e){var r=e[0],n=typeof(r=r.evaluate(t));return null===r?"":"string"===n||"number"===n||"boolean"===n?String(r):r instanceof ot||r instanceof ht?r.toString():JSON.stringify(r)}],"to-boolean":[H,[J],function(t,e){var r=e[0];return Boolean(r.evaluate(t))}],"to-rgba":[tt(X,4),[Y],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Y,[X,X,X],$t],rgba:[Y,[X,X,X,X],$t],has:{type:H,overloads:[[[W],function(t,e){return te(e[0].evaluate(t),t.properties())}],[[W,K],function(t,e){var r=e[0],n=e[1];return te(r.evaluate(t),n.evaluate(t))}]]},get:{type:J,overloads:[[[W],function(t,e){return ee(e[0].evaluate(t),t.properties())}],[[W,K],function(t,e){var r=e[0],n=e[1];return ee(r.evaluate(t),n.evaluate(t))}]]},"feature-state":[J,[W],function(t,e){return ee(e[0].evaluate(t),t.featureState||{})}],properties:[K,[],function(t){return t.properties()}],"geometry-type":[W,[],function(t){return t.geometryType()}],id:[J,[],function(t){return t.id()}],zoom:[X,[],function(t){return t.globals.zoom}],"heatmap-density":[X,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[X,[],function(t){return t.globals.lineProgress||0}],"+":[X,re(X),function(t,e){for(var r=0,n=0,i=e;n<i.length;n+=1)r+=i[n].evaluate(t);return r}],"*":[X,re(X),function(t,e){for(var r=1,n=0,i=e;n<i.length;n+=1)r*=i[n].evaluate(t);return r}],"-":{type:X,overloads:[[[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[X],function(t,e){return-e[0].evaluate(t)}]]},"/":[X,[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[X,[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],ln2:[X,[],function(){return Math.LN2}],pi:[X,[],function(){return Math.PI}],e:[X,[],function(){return Math.E}],"^":[X,[X,X],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[X,[X],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[X,[X],function(t,e){var r=e[0];return Math.log10(r.evaluate(t))}],ln:[X,[X],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[X,[X],function(t,e){var r=e[0];return Math.log2(r.evaluate(t))}],sin:[X,[X],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[X,[X],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[X,[X],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[X,[X],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[X,[X],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[X,[X],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[X,re(X),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[X,re(X),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[X,[X],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[X,[X],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[X,[X],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[X,[X],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[H,[W,J],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[H,[J],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[H,[W],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<o}],"filter-id-<":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>o}],"filter-id->":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[H,[J],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[H,[],function(t){return null!==t.id()}],"filter-type-in":[H,[tt(W)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[H,[tt(J)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[H,[W,tt(J)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[H,[W,tt(J)],function(t,e){var r=e[0],n=e[1];return function(t,e,r,n){for(;r<=n;){var i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}(t.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[re(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1)if(!n[r].evaluate(t))return!1;return!0}]]},any:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[re(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1)if(n[r].evaluate(t))return!0;return!1}]]},"!":[H,[H],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[H,[W],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[W,[W],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[W,[W],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[W,re(W),function(t,e){return e.map(function(e){return e.evaluate(t)}).join("")}],"resolved-locale":[W,[Q],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var le=.95047,ue=1,ce=1.08883,he=4/29,pe=6/29,de=3*pe*pe,fe=pe*pe*pe,me=Math.PI/180,_e=180/Math.PI;function ye(t){return t>fe?Math.pow(t,1/3):t/de+he}function ge(t){return t>pe?t*t*t:de*(t-he)}function ve(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function be(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function xe(t){var e=be(t.r),r=be(t.g),n=be(t.b),i=ye((.4124564*e+.3575761*r+.1804375*n)/le),o=ye((.2126729*e+.7151522*r+.072175*n)/ue);return{l:116*o-16,a:500*(i-o),b:200*(o-ye((.0193339*e+.119192*r+.9503041*n)/ce)),alpha:t.a}}function we(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=ue*ge(e),r=le*ge(r),n=ce*ge(n),new ot(ve(3.2404542*r-1.5371385*e-.4985314*n),ve(-.969266*r+1.8760108*e+.041556*n),ve(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}var ke={forward:xe,reverse:we,interpolate:function(t,e,r){return{l:zt(t.l,e.l,r),a:zt(t.a,e.a,r),b:zt(t.b,e.b,r),alpha:zt(t.alpha,e.alpha,r)}}},Ee={forward:function(t){var e=xe(t),r=e.l,n=e.a,i=e.b,o=Math.atan2(i,n)*_e;return{h:o<0?o+360:o,c:Math.sqrt(n*n+i*i),l:r,alpha:t.a}},reverse:function(t){var e=t.h*me,r=t.c;return we({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:function(t,e,r){var n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}(t.h,e.h,r),c:zt(t.c,e.c,r),l:zt(t.l,e.l,r),alpha:zt(t.alpha,e.alpha,r)}}},Ie=Object.freeze({lab:ke,hcl:Ee});function Se(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Me(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Te(t){return t}function Ae(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Pe(t,e,r,n,i){return Ae(typeof r===i?n[r]:void 0,t.default,e.default)}function Ce(t,e,r){if("number"!==Se(r))return Ae(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var i=Be(t.stops,r);return t.stops[i][1]}function De(t,e,r){var n=void 0!==t.base?t.base:1;if("number"!==Se(r))return Ae(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var o=Be(t.stops,r),a=function(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Bt[e.type]||Te;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=Ie[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return u(r,n,a)}}:u(s,l,a)}function ze(t,e,r){return"color"===e.type?r=ot.parse(r):Se(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Ae(r,t.default,e.default)}function Be(t,e){for(var r,n,i=0,o=t.length-1,a=0;i<=o;){if(r=t[a=Math.floor((i+o)/2)][0],n=t[a+1][0],e===r||e>r&&e<n)return a;r<e?i=a+1:r>e&&(o=a-1)}return Math.max(a-1,0)}var Le=function(t,e){var r;this.expression=t,this._warningHistory={},this._defaultValue="color"===(r=e).type&&Me(r.default)?new ot(0,0,0,0):"color"===r.type?ot.parse(r.default)||null:void 0===r.default?null:r.default,"enum"===e.type&&(this._enumValues=e.values)};function Re(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Qt}function Oe(t,e){var r=new Tt(Qt,[],function(t){var e={color:Y,string:W,number:X,enum:W,boolean:H};return"array"===t.type?tt(e[t.value]||J,t.length):e[t.type]||null}(e)),n=r.parse(t);return n?ne(new Le(n,e)):ie(r.errors)}Le.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._evaluator||(this._evaluator=new wt),this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this.expression.evaluate(this._evaluator)},Le.prototype.evaluate=function(t,e,r){this._evaluator||(this._evaluator=new wt),this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r;try{var n=this.expression.evaluate(this._evaluator);if(null==n)return this._defaultValue;if(this._enumValues&&!(n in this._enumValues))throw new ft("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(n)+" instead.");return n}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Fe=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!It(e.expression)};Fe.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r)},Fe.prototype.evaluate=function(t,e,r){return this._styleExpression.evaluate(t,e,r)};var Ne=function(t,e,r){this.kind=t,this.zoomStops=r.labels,this._styleExpression=e,this.isStateDependent="camera"!==t&&!It(e.expression),r instanceof Lt&&(this._interpolationType=r.interpolation)};function Ve(t,e){if("error"===(t=Oe(t,e)).result)return t;var r=t.value.expression,n=Et(r);if(!n&&!oe(e))return ie([new q("","data expressions not supported")]);var i=St(r,["zoom"]);if(!i&&!ae(e))return ie([new q("","zoom expressions not supported")]);var o=function t(e){var r=null;if(e instanceof Ft)r=t(e.result);else if(e instanceof Ot)for(var n=0,i=e.args;n<i.length;n+=1){var o=i[n];if(r=t(o))break}else(e instanceof Pt||e instanceof Lt)&&e.input instanceof kt&&"zoom"===e.input.name&&(r=e);return r instanceof q?r:(e.eachChild(function(e){var n=t(e);n instanceof q?r=n:!r&&n?r=new q("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new q("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r)}(r);return o||i?o instanceof q?ie([o]):o instanceof Lt&&!se(e)?ie([new q("",'"interpolate" expressions cannot be used with this property')]):ne(o?new Ne(n?"camera":"composite",t.value,o):new Fe(n?"constant":"source",t.value)):ie([new q("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ne.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r)},Ne.prototype.evaluate=function(t,e,r){return this._styleExpression.evaluate(t,e,r)},Ne.prototype.interpolationFactor=function(t,e,r){return this._interpolationType?Lt.interpolationFactor(this._interpolationType,t,e,r):0};var je=function(t,e){this._parameters=t,this._specification=e,V(this,function t(e,r){var n,i,o,a="color"===r.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||void 0!==e.property,u=s||!l,c=e.type||(se(r)?"exponential":"interval");if(a&&((e=V({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],ot.parse(t[1])]})),e.default?e.default=ot.parse(e.default):e.default=ot.parse(r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Ie[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)n=De;else if("interval"===c)n=Ce;else if("categorical"===c){n=Pe,i=Object.create(null);for(var h=0,p=e.stops;h<p.length;h+=1){var d=p[h];i[d[0]]=d[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');n=ze}if(s){for(var f={},m=[],_=0;_<e.stops.length;_++){var y=e.stops[_],g=y[0].zoom;void 0===f[g]&&(f[g]={zoom:g,type:e.type,property:e.property,default:e.default,stops:[]},m.push(g)),f[g].stops.push([y[0].value,y[1]])}for(var v=[],b=0,x=m;b<x.length;b+=1){var w=x[b];v.push([f[w].zoom,t(f[w],r)])}return{kind:"composite",interpolationFactor:Lt.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:v.map(function(t){return t[0]}),evaluate:function(t,n){var i=t.zoom;return De({stops:v,base:e.base},r,i).evaluate(i,n)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Lt.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var a=t.zoom;return n(e,r,a,i,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Ae(e.default,r.default):n(e,r,s,i,o)}}}(this._parameters,this._specification))};function Ue(t,e){if(Me(t))return new je(t,e);if(Re(t)){var r=Ve(t,e);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return r.value}var n=t;return"string"==typeof t&&"color"===e.type&&(n=ot.parse(t)),{kind:"constant",evaluate:function(){return n}}}function qe(t){var e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=Se(r);if("object"!==l)return[new F(e,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],h=n[c]||n["*"],p=void 0;if(i[c])p=i[c];else if(n[c])p=dr;else if(i["*"])p=i["*"];else{if(!n["*"]){s.push(new F(e,r[u],'unknown property "'+u+'"'));continue}p=dr}s=s.concat(p({key:(e?e+".":e)+u,value:r[u],valueSpec:h,style:o,styleSpec:a,object:r,objectKey:u},r))}for(var d in n)i[d]||n[d].required&&void 0===n[d].default&&void 0===r[d]&&s.push(new F(e,r,'missing required property "'+d+'"'));return s}function Ge(t){var e=t.value,r=t.valueSpec,n=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||dr;if("array"!==Se(e))return[new F(o,e,"array expected, "+Se(e)+" found")];if(r.length&&e.length!==r.length)return[new F(o,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new F(o,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value};i.$version<7&&(s.function=r.function),"object"===Se(r.value)&&(s=r.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:n,styleSpec:i,key:o+"["+u+"]"}));return l}function Ze(t){var e=t.key,r=t.value,n=t.valueSpec,i=Se(r);return"number"!==i?[new F(e,r,"number expected, "+i+" found")]:"minimum"in n&&r<n.minimum?[new F(e,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new F(e,r,r+" is greater than the maximum value "+n.maximum)]:[]}function Xe(t){var e,r,n,i=t.valueSpec,o=j(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,u="array"===Se(t.value.stops)&&"array"===Se(t.value.stops[0])&&"object"===Se(t.value.stops[0][0]),c=qe({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new F(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;return e=e.concat(Ge({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Se(r)&&0===r.length&&e.push(new F(t.key,r,"array must have at least one stop")),e},default:function(t){return dr({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&c.push(new F(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||c.push(new F(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!se(t.valueSpec)&&c.push(new F(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!oe(t.valueSpec)?c.push(new F(t.key,t.value,"property functions not supported")):s&&!ae(t.valueSpec)&&c.push(new F(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==t.value.property||c.push(new F(t.key,t.value,'"property" property is required')),c;function h(t){var e=[],o=t.value,s=t.key;if("array"!==Se(o))return[new F(s,o,"array expected, "+Se(o)+" found")];if(2!==o.length)return[new F(s,o,"array length 2 expected, length "+o.length+" found")];if(u){if("object"!==Se(o[0]))return[new F(s,o,"object expected, "+Se(o[0])+" found")];if(void 0===o[0].zoom)return[new F(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new F(s,o,"object stop key must have value")];if(n&&n>j(o[0].zoom))return[new F(s,o[0].zoom,"stop zoom values must appear in ascending order")];j(o[0].zoom)!==n&&(n=j(o[0].zoom),r=void 0,a={}),e=e.concat(qe({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Ze,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return e.concat(dr({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function p(t,n){var s=Se(t.value),l=j(t.value),u=null!==t.value?t.value:n;if(e){if(s!==e)return[new F(t.key,u,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new F(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var c="number expected, "+s+" found";return oe(i)&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new F(t.key,u,c)]}return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==r&&l<r?[new F(t.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===o&&l in a?[new F(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new F(t.key,u,"integer expected, found "+l)]}}function We(t){var e=("property"===t.expressionContext?Ve:Oe)(U(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new F(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new F(t.key,t.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:"property"!==t.expressionContext||"layout"!==t.propertyType||It(e.value._styleExpression.expression)?[]:[new F(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')]}function He(t){var e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(j(r))&&i.push(new F(e,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(j(r))&&i.push(new F(e,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),i}function Ye(t){if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var n=r[e];if(!Ye(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}je.deserialize=function(t){return new je(t._parameters,t._specification)},je.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Ke={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Je(t){if(!t)return function(){return!0};Ye(t)||(t=$e(t));var e=Oe(t,Ke);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,r){return e.value.evaluate(t,r)}}function Qe(t,e){return t<e?-1:t>e?1:0}function $e(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?tr(t[1],t[2],"=="):"!="===r?nr(tr(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?tr(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map($e))):"all"===r?["all"].concat(t.slice(1).map($e)):"none"===r?["all"].concat(t.slice(1).map($e).map(nr)):"in"===r?er(t[1],t.slice(2)):"!in"===r?nr(er(t[1],t.slice(2))):"has"===r?rr(t[1]):"!has"!==r||nr(rr(t[1]))}function tr(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function er(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Qe)]]:["filter-in-small",t,["literal",e]]}}function rr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function nr(t){return["!",t]}function ir(t){return Ye(U(t.value))?We(V({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value,n=e.key;if("array"!==Se(r))return[new F(n,r,"array expected, "+Se(r)+" found")];var i,o=e.styleSpec,a=[];if(r.length<1)return[new F(n,r,"filter array must have at least 1 element")];switch(a=a.concat(He({key:n+"[0]",value:r[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),j(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===j(r[1])&&a.push(new F(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new F(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(i=Se(r[1]))&&a.push(new F(n+"[1]",r[1],"string expected, "+i+" found"));for(var s=2;s<r.length;s++)i=Se(r[s]),"$type"===j(r[1])?a=a.concat(He({key:n+"["+s+"]",value:r[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new F(n+"["+s+"]",r[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(t({key:n+"["+l+"]",value:r[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Se(r[1]),2!==r.length?a.push(new F(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new F(n+"[1]",r[1],"string expected, "+i+" found"))}return a}(t)}function or(t,e){var r=t.key,n=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return dr({key:r,value:o,valueSpec:i.transition,style:n,styleSpec:i});var u,c=t.valueSpec||s[a];if(!c)return[new F(r,o,'unknown property "'+a+'"')];if("string"===Se(o)&&oe(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new F(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&n&&!n.glyphs&&h.push(new F(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Me(U(o))&&"identity"===j(o.type)&&h.push(new F(r,o,'"text-font" does not support identity functions'))),h.concat(dr({key:t.key,value:o,valueSpec:c,style:n,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function ar(t){return or(t,"paint")}function sr(t){return or(t,"layout")}function lr(t){var e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;r.type||r.ref||e.push(new F(n,r,'either "type" or "ref" is required'));var a,s=j(r.type),l=j(r.ref);if(r.id)for(var u=j(r.id),c=0;c<t.arrayIndex;c++){var h=i.layers[c];j(h.id)===u&&e.push(new F(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+h.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(t){t in r&&e.push(new F(n,r[t],'"'+t+'" is prohibited for ref layers'))}),i.layers.forEach(function(t){j(t.id)===l&&(a=t)}),a?a.ref?e.push(new F(n,r.ref,"ref cannot reference another ref layer")):s=j(a.type):e.push(new F(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var p=i.sources&&i.sources[r.source],d=p&&j(p.type);p?"vector"===d&&"raster"===s?e.push(new F(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new F(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new F(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&p.lineMetrics||e.push(new F(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new F(n,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new F(n,r.source,'source "'+r.source+'" not found'))}else e.push(new F(n,r,'missing required property "source"'));return e=e.concat(qe({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return dr({key:n+".type",value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:ir,layout:function(t){return qe({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return sr(V({layerType:s},t))}}})},paint:function(t){return qe({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return ar(V({layerType:s},t))}}})}}}))}function ur(t){var e=t.value,r=t.key,n=t.styleSpec,i=t.style;if(!e.type)return[new F(r,e,'"type" is required')];var o=j(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(qe({key:r,value:e,valueSpec:n["source_"+o.replace("-","_")],style:t.style,styleSpec:n})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new F(r+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return qe({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n});case"video":return qe({key:r,value:e,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return qe({key:r,value:e,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return a.push(new F(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return He({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function cr(t){var e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=Se(e);if(void 0===e)return o;if("object"!==a)return o.concat([new F("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=l&&n[l[1]]&&n[l[1]].transition?o.concat(dr({key:s,value:e[s],valueSpec:r.transition,style:i,styleSpec:r})):n[s]?o.concat(dr({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):o.concat([new F(s,e[s],'unknown property "'+s+'"')])}return o}function hr(t){var e=t.value,r=t.key,n=Se(e);return"string"!==n?[new F(r,e,"string expected, "+n+" found")]:[]}var pr={"*":function(){return[]},array:Ge,boolean:function(t){var e=t.value,r=t.key,n=Se(e);return"boolean"!==n?[new F(r,e,"boolean expected, "+n+" found")]:[]},number:Ze,color:function(t){var e=t.key,r=t.value,n=Se(r);return"string"!==n?[new F(e,r,"color expected, "+n+" found")]:null===it(r)?[new F(e,r,'color expected, "'+r+'" found')]:[]},constants:N,enum:He,filter:ir,function:Xe,layer:lr,object:qe,source:ur,light:cr,string:hr,formatted:function(t){return 0===hr(t).length?[]:We(t)}};function dr(t){var e=t.value,r=t.valueSpec,n=t.styleSpec;return r.expression&&Me(j(e))?Xe(t):r.expression&&Re(U(e))?We(t):r.type&&pr[r.type]?pr[r.type](t):qe(V({},t,{valueSpec:r.type?n[r.type]:r}))}function fr(t){var e=t.value,r=t.key,n=hr(t);return n.length?n:(-1===e.indexOf("{fontstack}")&&n.push(new F(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new F(r,e,'"glyphs" url must include a "{range}" token')),n)}function mr(t,e){e=e||O;var r=[];return r=r.concat(dr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:fr,"*":function(){return[]}}})),t.constants&&(r=r.concat(N({key:"constants",value:t.constants,style:t,styleSpec:e}))),_r(r)}function _r(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function yr(t){return function(){return _r(t.apply(this,arguments))}}mr.source=yr(ur),mr.light=yr(cr),mr.layer=yr(lr),mr.filter=yr(ir),mr.paintProperty=yr(ar),mr.layoutProperty=yr(sr);var gr=mr,vr=mr.light,br=mr.paintProperty,xr=mr.layoutProperty;function wr(t,e){var r=!1;if(e&&e.length)for(var n=0,i=e;n<i.length;n+=1){var o=i[n];t.fire(new L(new Error(o.message))),r=!0}return r}var kr=Ir,Er=3;function Ir(t,e,r){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],e=i[1],r=i[2],this.d=e+2*r;for(var o=0;o<this.d*this.d;o++){var a=i[Er+o],s=i[Er+o+1];n.push(a===s?null:i.subarray(a,s))}var l=i[Er+n.length],u=i[Er+n.length+1];this.keys=i.subarray(l,u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var h=r/e*t;this.min=-h,this.max=t+h}Ir.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},Ir.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ir.prototype._insertCell=function(t,e,r,n,i,o){this.cells[i].push(o)},Ir.prototype.query=function(t,e,r,n){var i=this.min,o=this.max;if(t<=i&&e<=i&&o<=r&&o<=n)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,r,n,this._queryCell,a,{}),a},Ir.prototype._queryCell=function(t,e,r,n,i,o,a){var s=this.cells[i];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var h=s[c];if(void 0===a[h]){var p=4*h;t<=u[p+2]&&e<=u[p+3]&&r>=u[p+0]&&n>=u[p+1]?(a[h]=!0,o.push(l[h])):a[h]=!1}}},Ir.prototype._forEachCell=function(t,e,r,n,i,o,a){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(r),c=this._convertToCellCoord(n),h=s;h<=u;h++)for(var p=l;p<=c;p++){var d=this.d*p+h;if(i.call(this,t,e,r,n,d,o,a))return}},Ir.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ir.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Er+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(e+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[Er+a]=o,i.set(s,o),o+=s.length}return i[Er+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[Er+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var Sr=self.ImageData,Mr={};function Tr(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Mr[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var Ar in Tr("Object",Object),kr.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),r},kr.deserialize=function(t){return new kr(t)},Tr("Grid",kr),Tr("Color",ot),Tr("Error",Error),Tr("StylePropertyFunction",je),Tr("StyleExpression",Le,{omit:["_evaluator"]}),Tr("ZoomDependentExpression",Ne),Tr("ZoomConstantExpression",Fe),Tr("CompoundExpression",kt,{omit:["_evaluate"]}),Qt)Qt[Ar]._classRegistryKey||Tr("Expression_"+Ar,Qt[Ar]);function Pr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof Sr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var n=[],i=0,o=t;i<o.length;i+=1){var a=o[i];n.push(Pr(a,e))}return n}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u={};if(s.serialize)u._serialized=s.serialize(t,e);else{for(var c in t)if(t.hasOwnProperty(c)&&!(Mr[l].omit.indexOf(c)>=0)){var h=t[c];u[c]=Mr[l].shallow.indexOf(c)>=0?h:Pr(h,e)}t instanceof Error&&(u.message=t.message)}return{name:l,properties:u}}throw new Error("can't serialize object of type "+typeof t)}function Cr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof Sr)return t;if(Array.isArray(t))return t.map(function(t){return Cr(t)});if("object"==typeof t){var e=t,r=e.name,n=e.properties;if(!r)throw new Error("can't deserialize object of anonymous class");var i=Mr[r].klass;if(!i)throw new Error("can't deserialize unregistered class "+r);if(i.deserialize)return i.deserialize(n._serialized);for(var o=Object.create(i.prototype),a=0,s=Object.keys(n);a<s.length;a+=1){var l=s[a];o[l]=Mr[r].shallow.indexOf(l)>=0?n[l]:Cr(n[l])}return o}throw new Error("can't deserialize object of type "+typeof t)}var Dr=function(){this.first=!0};Dr.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var zr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Br(t){for(var e=0,r=t;e<r.length;e+=1)if(Rr(r[e].charCodeAt(0)))return!0;return!1}function Lr(t){return!(zr.Arabic(t)||zr["Arabic Supplement"](t)||zr["Arabic Extended-A"](t)||zr["Arabic Presentation Forms-A"](t)||zr["Arabic Presentation Forms-B"](t))}function Rr(t){return!(746!==t&&747!==t&&(t<4352||!(zr["Bopomofo Extended"](t)||zr.Bopomofo(t)||zr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||zr["CJK Compatibility Ideographs"](t)||zr["CJK Compatibility"](t)||zr["CJK Radicals Supplement"](t)||zr["CJK Strokes"](t)||!(!zr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||zr["CJK Unified Ideographs Extension A"](t)||zr["CJK Unified Ideographs"](t)||zr["Enclosed CJK Letters and Months"](t)||zr["Hangul Compatibility Jamo"](t)||zr["Hangul Jamo Extended-A"](t)||zr["Hangul Jamo Extended-B"](t)||zr["Hangul Jamo"](t)||zr["Hangul Syllables"](t)||zr.Hiragana(t)||zr["Ideographic Description Characters"](t)||zr.Kanbun(t)||zr["Kangxi Radicals"](t)||zr["Katakana Phonetic Extensions"](t)||zr.Katakana(t)&&12540!==t||!(!zr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!zr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||zr["Unified Canadian Aboriginal Syllabics"](t)||zr["Unified Canadian Aboriginal Syllabics Extended"](t)||zr["Vertical Forms"](t)||zr["Yijing Hexagram Symbols"](t)||zr["Yi Syllables"](t)||zr["Yi Radicals"](t))))}function Or(t){return!(Rr(t)||function(t){return!!(zr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||zr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||zr["Letterlike Symbols"](t)||zr["Number Forms"](t)||zr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||zr["Control Pictures"](t)&&9251!==t||zr["Optical Character Recognition"](t)||zr["Enclosed Alphanumerics"](t)||zr["Geometric Shapes"](t)||zr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||zr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||zr["CJK Symbols and Punctuation"](t)||zr.Katakana(t)||zr["Private Use Area"](t)||zr["CJK Compatibility Forms"](t)||zr["Small Form Variants"](t)||zr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Fr(t,e){return!(!e&&(t>=1424&&t<=2303||zr["Arabic Presentation Forms-A"](t)||zr["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||zr.Khmer(t))}var Nr,Vr=!1,jr=null,Ur=!1,qr=new R,Gr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ur||null!=Gr.applyArabicShaping}},Zr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dr,this.transition={})};Zr.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,n=t;r<n.length;r+=1)if(!Fr(n[r].charCodeAt(0),e))return!1;return!0}(t,Gr.isLoaded())},Zr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var Xr=function(t,e){this.property=t,this.value=e,this.expression=Ue(void 0===e?t.specification.default:e,t.specification)};Xr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Xr.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var Wr=function(t){this.property=t,this.value=new Xr(t,void 0)};Wr.prototype.transitioned=function(t,e){return new Yr(this.property,this.value,e,h({},t.transition,this.transition),t.now)},Wr.prototype.untransitioned=function(){return new Yr(this.property,this.value,null,{},0)};var Hr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Hr.prototype.getValue=function(t){return g(this._values[t].value.value)},Hr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Wr(this._values[t].property)),this._values[t].value=new Xr(this._values[t].property,null===e?void 0:g(e))},Hr.prototype.getTransition=function(t){return g(this._values[t].transition)},Hr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Wr(this._values[t].property)),this._values[t].transition=g(e)||void 0},Hr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i);var o=this.getTransition(n);void 0!==o&&(t[n+"-transition"]=o)}return t},Hr.prototype.transitioned=function(t,e){for(var r=new Kr(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n];r._values[o]=this._values[o].transitioned(t,e._values[o])}return r},Hr.prototype.untransitioned=function(){for(var t=new Kr(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e];t._values[n]=this._values[n].untransitioned()}return t};var Yr=function(t,e,r,n,i){this.property=t,this.value=e,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};Yr.prototype.possiblyEvaluate=function(t){var e=t.now||0,r=this.value.possiblyEvaluate(t),n=this.prior;if(n){if(e>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(e<this.begin)return n.possiblyEvaluate(t);var i=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(t),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}(i))}return r};var Kr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Kr.prototype.possiblyEvaluate=function(t){for(var e=new $r(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];e._values[i]=this._values[i].possiblyEvaluate(t)}return e},Kr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var r=e[t];if(this._values[r].prior)return!0}return!1};var Jr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Jr.prototype.getValue=function(t){return g(this._values[t].value)},Jr.prototype.setValue=function(t,e){this._values[t]=new Xr(this._values[t].property,null===e?void 0:g(e))},Jr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i)}return t},Jr.prototype.possiblyEvaluate=function(t){for(var e=new $r(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];e._values[i]=this._values[i].possiblyEvaluate(t)}return e};var Qr=function(t,e,r){this.property=t,this.value=e,this.globals=r};Qr.prototype.isConstant=function(){return"constant"===this.value.kind},Qr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Qr.prototype.evaluate=function(t,e){return this.property.evaluate(this.value,this.globals,t,e)};var $r=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};$r.prototype.get=function(t){return this._values[t]};var tn=function(t){this.specification=t};tn.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},tn.prototype.interpolate=function(t,e,r){var n=Bt[this.specification.type];return n?n(t,e,r):t};var en=function(t){this.specification=t};en.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Qr(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Qr(this,t.expression,e)},en.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Qr(this,{kind:"constant",value:void 0},t.globals);var n=Bt[this.specification.type];return n?new Qr(this,{kind:"constant",value:n(t.value.value,e.value.value,r)},t.globals):t},en.prototype.evaluate=function(t,e,r,n){return"constant"===t.kind?t.value:t.evaluate(e,r,n)};var rn=function(t){this.specification=t};rn.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Zr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Zr(Math.floor(e.zoom),e)),t.expression.evaluate(new Zr(Math.floor(e.zoom+1),e)),e)}},rn.prototype._calculate=function(t,e,r,n){var i=n.zoom,o=i-Math.floor(i),a=n.crossFadingFactor();return i>n.zoomHistory.lastIntegerZoom?{from:t,to:e,fromScale:2,toScale:1,t:o+(1-o)*a}:{from:r,to:e,fromScale:.5,toScale:1,t:1-(1-a)*o}},rn.prototype.interpolate=function(t){return t};var nn=function(t){this.specification=t};nn.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},nn.prototype.interpolate=function(){return!1};var on=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var r=t[e],n=this.defaultPropertyValues[e]=new Xr(r,void 0),i=this.defaultTransitionablePropertyValues[e]=new Wr(r);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({})}};Tr("DataDrivenProperty",en),Tr("DataConstantProperty",tn),Tr("CrossFadedProperty",rn),Tr("ColorRampProperty",nn);var an=function(t){function e(e,r){for(var n in t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.visibility="visible","background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this._featureFilter=function(){return!0},r.layout&&(this._unevaluatedLayout=new Jr(r.layout)),this._transitionablePaint=new Hr(r.paint),e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,r){if(null!=e){var n="layers."+this.id+".layout."+t;if(this._validate(xr,n,t,e,r))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return m(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,r){if(null!=e){var n="layers."+this.id+".paint."+t;if(this._validate(br,n,t,e,r))return!1}if(m(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,e);var o=this._transitionablePaint._values[t].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(t),o||i},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),y(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,r,n,i){return(!i||!1!==i.validate)&&wr(this,t.call(gr,{key:e,layerType:this.type,objectKey:r,value:n,styleSpec:O,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof Qr&&oe(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(R),sn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ln=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},un=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function cn(t,e){void 0===e&&(e=1);var r=0,n=0;return{members:t.map(function(t){var i,o=(i=t.type,sn[i].BYTES_PER_ELEMENT),a=r=hn(r,Math.max(e,o)),s=t.components||1;return n=Math.max(n,o),r+=o*s,{name:t.name,type:t.type,components:s,offset:a}}),size:hn(r,Math.max(n,e)),alignment:e}}function hn(t,e){return Math.ceil(t/e)*e}un.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},un.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},un.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},un.prototype.clear=function(){this.length=0},un.prototype.resize=function(t){this.reserve(t),this.length=t},un.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},un.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var pn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.int16[n+0]=t,this.int16[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.int16[n+0]=e,this.int16[n+1]=r,t},e}(un);pn.prototype.bytesPerElement=4,Tr("StructArrayLayout2i4",pn);var dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var i=this.length;this.resize(i+1);var o=4*i;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,i},e.prototype.emplace=function(t,e,r,n,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=i,t},e}(un);dn.prototype.bytesPerElement=8,Tr("StructArrayLayout4i8",dn);var fn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,r,n,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(un);fn.prototype.bytesPerElement=12,Tr("StructArrayLayout2i4i12",fn);var mn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint8[c+8]=i,this.uint8[c+9]=o,this.uint8[c+10]=a,this.uint8[c+11]=s,l},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l){var u=6*t,c=12*t;return this.int16[u+0]=e,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.uint8[c+8]=o,this.uint8[c+9]=a,this.uint8[c+10]=s,this.uint8[c+11]=l,t},e}(un);mn.prototype.bytesPerElement=12,Tr("StructArrayLayout4i4ub12",mn);var _n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint16[u+4]=i,this.uint16[u+5]=o,this.uint16[u+6]=a,this.uint16[u+7]=s,l},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l){var u=8*t;return this.int16[u+0]=e,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.uint16[u+4]=o,this.uint16[u+5]=a,this.uint16[u+6]=s,this.uint16[u+7]=l,t},e}(un);_n.prototype.bytesPerElement=16,Tr("StructArrayLayout4i4ui16",_n);var yn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=r,this.float32[i+2]=n,t},e}(un);yn.prototype.bytesPerElement=12,Tr("StructArrayLayout3f12",yn);var gn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.uint32[r+0]=t,e},e.prototype.emplace=function(t,e){var r=1*t;return this.uint32[r+0]=e,t},e}(un);gn.prototype.bytesPerElement=4,Tr("StructArrayLayout1ul4",gn);var vn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s,l,u,c){var h=this.length;this.resize(h+1);var p=12*h,d=6*h;return this.int16[p+0]=t,this.int16[p+1]=e,this.int16[p+2]=r,this.int16[p+3]=n,this.int16[p+4]=i,this.int16[p+5]=o,this.uint32[d+3]=a,this.uint16[p+8]=s,this.uint16[p+9]=l,this.int16[p+10]=u,this.int16[p+11]=c,h},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l,u,c,h){var p=12*t,d=6*t;return this.int16[p+0]=e,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=i,this.int16[p+4]=o,this.int16[p+5]=a,this.uint32[d+3]=s,this.uint16[p+8]=l,this.uint16[p+9]=u,this.int16[p+10]=c,this.int16[p+11]=h,t},e}(un);vn.prototype.bytesPerElement=24,Tr("StructArrayLayout6i1ul2ui2i24",vn);var bn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,r,n,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(un);bn.prototype.bytesPerElement=12,Tr("StructArrayLayout2i2i2i12",bn);var xn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=4*r;return this.uint8[n+0]=t,this.uint8[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=4*t;return this.uint8[n+0]=e,this.uint8[n+1]=r,t},e}(un);xn.prototype.bytesPerElement=4,Tr("StructArrayLayout2ub4",xn);var wn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d){var f=this.length;this.resize(f+1);var m=20*f,_=10*f,y=40*f;return this.int16[m+0]=t,this.int16[m+1]=e,this.uint16[m+2]=r,this.uint16[m+3]=n,this.uint32[_+2]=i,this.uint32[_+3]=o,this.uint32[_+4]=a,this.uint16[m+10]=s,this.uint16[m+11]=l,this.uint16[m+12]=u,this.float32[_+7]=c,this.float32[_+8]=h,this.uint8[y+36]=p,this.uint8[y+37]=d,f},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m=20*t,_=10*t,y=40*t;return this.int16[m+0]=e,this.int16[m+1]=r,this.uint16[m+2]=n,this.uint16[m+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[m+10]=l,this.uint16[m+11]=u,this.uint16[m+12]=c,this.float32[_+7]=h,this.float32[_+8]=p,this.uint8[y+36]=d,this.uint8[y+37]=f,t},e}(un);wn.prototype.bytesPerElement=40,Tr("StructArrayLayout2i2ui3ul3ui2f2ub40",wn);var kn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.float32[r+0]=t,e},e.prototype.emplace=function(t,e){var r=1*t;return this.float32[r+0]=e,t},e}(un);kn.prototype.bytesPerElement=4,Tr("StructArrayLayout1f4",kn);var En=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=r,this.int16[i+2]=n,t},e}(un);En.prototype.bytesPerElement=6,Tr("StructArrayLayout3i6",En);var In=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=2*n,o=4*n;return this.uint32[i+0]=t,this.uint16[o+2]=e,this.uint16[o+3]=r,n},e.prototype.emplace=function(t,e,r,n){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=r,this.uint16[o+3]=n,t},e}(un);In.prototype.bytesPerElement=8,Tr("StructArrayLayout1ul2ui8",In);var Sn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.uint16[i+0]=t,this.uint16[i+1]=e,this.uint16[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,this.uint16[i+2]=n,t},e}(un);Sn.prototype.bytesPerElement=6,Tr("StructArrayLayout3ui6",Sn);var Mn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.uint16[n+0]=t,this.uint16[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=r,t},e}(un);Mn.prototype.bytesPerElement=4,Tr("StructArrayLayout2ui4",Mn);var Tn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.float32[n+0]=t,this.float32[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.float32[n+0]=e,this.float32[n+1]=r,t},e}(un);Tn.prototype.bytesPerElement=8,Tr("StructArrayLayout2f8",Tn);var An=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var i=this.length;this.resize(i+1);var o=4*i;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=r,this.float32[o+3]=n,i},e.prototype.emplace=function(t,e,r,n,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,t},e}(un);An.prototype.bytesPerElement=16,Tr("StructArrayLayout4f16",An);var Pn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.radius.get=function(){return this._structArray.int16[this._pos2+10]},r.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},r.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},r.anchorPoint.get=function(){return new o(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(ln);Pn.prototype.size=24;var Cn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Pn(this,t)},e}(vn);Tr("CollisionBoxArray",Cn);var Dn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,r),e}(ln);Dn.prototype.size=40;var zn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Dn(this,t)},e}(wn);Tr("PlacedSymbolArray",zn);var Bn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={offsetX:{configurable:!0}};return r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},r.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,r),e}(ln);Bn.prototype.size=4;var Ln=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new Bn(this,t)},e}(kn);Tr("GlyphOffsetArray",Ln);var Rn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return r.x.get=function(){return this._structArray.int16[this._pos2+0]},r.x.set=function(t){this._structArray.int16[this._pos2+0]=t},r.y.get=function(){return this._structArray.int16[this._pos2+1]},r.y.set=function(t){this._structArray.int16[this._pos2+1]=t},r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},r.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,r),e}(ln);Rn.prototype.size=6;var On=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new Rn(this,t)},e}(En);Tr("SymbolLineVertexArray",On);var Fn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,r),e}(ln);Fn.prototype.size=8;var Nn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Fn(this,t)},e}(In);Tr("FeatureIndexArray",Nn);var Vn=cn([{name:"a_pos",components:2,type:"Int16"}],4),jn=Vn.members,Un=(Vn.size,Vn.alignment,function(t){void 0===t&&(t=[]),this.segments=t});Un.prototype.prepareSegment=function(t,e,r){var n=this.segments[this.segments.length-1];return t>Un.MAX_VERTEX_ARRAY_LENGTH&&b("Max vertices per segment is "+Un.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>Un.MAX_VERTEX_ARRAY_LENGTH)&&(n={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},this.segments.push(n)),n},Un.prototype.get=function(){return this.segments},Un.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var n in r.vaos)r.vaos[n].destroy()}},Un.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Tr("SegmentVector",Un);var qn=function(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)};function Gn(t){return[qn(255*t.r,255*t.g),qn(255*t.b,255*t.a)]}var Zn=function(t,e,r){this.value=t,this.name=e,this.type=r,this.statistics={max:-1/0}};Zn.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},Zn.prototype.populatePaintArray=function(){},Zn.prototype.updatePaintArray=function(){},Zn.prototype.upload=function(){},Zn.prototype.destroy=function(){},Zn.prototype.setUniforms=function(t,e,r,n){var i=n.constantOr(this.value),o=t.gl;"color"===this.type?o.uniform4f(e.uniforms["u_"+this.name],i.r,i.g,i.b,i.a):o.uniform1f(e.uniforms["u_"+this.name],i)};var Xn=function(t,e,r){this.expression=t,this.name=e,this.type=r,this.statistics={max:-1/0};var n="color"===r?Tn:kn;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}],this.paintVertexArray=new n};Xn.prototype.defines=function(){return[]},Xn.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var i=this.expression.evaluate(new Zr(0),e,{});if("color"===this.type)for(var o=Gn(i),a=n;a<t;a++)r.emplaceBack(o[0],o[1]);else{for(var s=n;s<t;s++)r.emplaceBack(i);this.statistics.max=Math.max(this.statistics.max,i)}},Xn.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},r,n);if("color"===this.type)for(var a=Gn(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var l=t;l<e;l++)i.emplace(l,o);this.statistics.max=Math.max(this.statistics.max,o)}},Xn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Xn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Xn.prototype.setUniforms=function(t,e){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],0)};var Wn=function(t,e,r,n,i){this.expression=t,this.name=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.statistics={max:-1/0};var o="color"===r?An:Tn;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}],this.paintVertexArray=new o};Wn.prototype.defines=function(){return[]},Wn.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var i=this.expression.evaluate(new Zr(this.zoom),e,{}),o=this.expression.evaluate(new Zr(this.zoom+1),e,{});if("color"===this.type)for(var a=Gn(i),s=Gn(o),l=n;l<t;l++)r.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var u=n;u<t;u++)r.emplaceBack(i,o);this.statistics.max=Math.max(this.statistics.max,i,o)}},Wn.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);if("color"===this.type)for(var s=Gn(o),l=Gn(a),u=t;u<e;u++)i.emplace(u,s[0],s[1],l[0],l[1]);else{for(var c=t;c<e;c++)i.emplace(c,o,a);this.statistics.max=Math.max(this.statistics.max,o,a)}},Wn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Wn.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},Wn.prototype.setUniforms=function(t,e,r){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],this.interpolationFactor(r.zoom))};var Hn=function(){this.binders={},this.cacheKey="",this._buffers=[],this._idMap={},this._bufferOffset=0};Hn.createDynamic=function(t,e,r){var n=new Hn,i=[];for(var o in t.paint._values)if(r(o)){var a=t.paint.get(o);if(a instanceof Qr&&oe(a.property.specification)){var s=Kn(o,t.type),l=a.property.specification.type,u=a.property.useIntegerZoom;"constant"===a.value.kind?(n.binders[o]=new Zn(a.value,s,l),i.push("/u_"+s)):"source"===a.value.kind?(n.binders[o]=new Xn(a.value,s,l),i.push("/a_"+s)):(n.binders[o]=new Wn(a.value,s,l,u,e),i.push("/z_"+s))}}return n.cacheKey=i.sort().join(""),n},Hn.prototype.populatePaintArrays=function(t,e,r){for(var n in this.binders)this.binders[n].populatePaintArray(t,e);if(e.id){var i=String(e.id);this._idMap[i]=this._idMap[i]||[],this._idMap[i].push({index:r,start:this._bufferOffset,end:t})}this._bufferOffset=t},Hn.prototype.updatePaintArrays=function(t,e,r){var n=!1;for(var i in t){var o=this._idMap[i];if(o)for(var a=t[i],s=0,l=o;s<l.length;s+=1){var u=l[s],c=e.feature(u.index);for(var h in this.binders){var p=this.binders[h];if(!(p instanceof Zn)&&!0===p.expression.isStateDependent){var d=r.paint.get(h);p.expression=d.value,p.updatePaintArray(u.start,u.end,c,a),n=!0}}}}return n},Hn.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},Hn.prototype.setUniforms=function(t,e,r,n){for(var i in this.binders)this.binders[i].setUniforms(t,e,n,r.get(i))},Hn.prototype.getPaintVertexBuffers=function(){return this._buffers},Hn.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof Xn||i instanceof Wn)&&i.paintVertexBuffer&&r.push(i.paintVertexBuffer)}this._buffers=r},Hn.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var Yn=function(t,e,r,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,o=e;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=Hn.createDynamic(a,r,n),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1};function Kn(t,e){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[t]||t.replace(e+"-","").replace(/-/g,"_")}Yn.prototype.populatePaintArrays=function(t,e,r){for(var n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e,r);this.needsUpload=!0},Yn.prototype.updatePaintArrays=function(t,e,r){for(var n=0,i=r;n<i.length;n+=1){var o=i[n];this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(t,e,o)||this.needsUpload}},Yn.prototype.get=function(t){return this.programConfigurations[t]},Yn.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Yn.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Tr("ConstantBinder",Zn),Tr("SourceExpressionBinder",Xn),Tr("CompositeExpressionBinder",Wn),Tr("ProgramConfiguration",Hn,{omit:["_buffers"]}),Tr("ProgramConfigurationSet",Yn);var Jn=8192,Qn={min:-1*Math.pow(2,15),max:Math.pow(2,15)-1};function $n(t){for(var e=Jn/t.extent,r=t.loadGeometry(),n=0;n<r.length;n++)for(var i=r[n],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<Qn.min||a.x>Qn.max||a.y<Qn.min||a.y>Qn.max)&&b("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function ti(t,e,r,n,i){t.emplaceBack(2*e+(n+1)/2,2*r+(i+1)/2)}var ei=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new pn,this.indexArray=new Sn,this.segments=new Un,this.programConfigurations=new Yn(jn,t.layers,t.zoom)};function ri(t,e,r){for(var n=0;n<t.length;n++){var i=t[n];if(hi(i,e))return!0;if(li(e,i,r))return!0}return!1}function ni(t,e){if(1===t.length&&1===t[0].length)return ci(e,t[0][0]);for(var r=0;r<e.length;r++)for(var n=e[r],i=0;i<n.length;i++)if(ci(t,n[i]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if(ci(e,a[s]))return!0;for(var l=0;l<e.length;l++)if(ai(a,e[l]))return!0}return!1}function ii(t,e,r){for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<i.length;s++)if(hi(a,i[s]))return!0;if(oi(a,i,r))return!0}return!1}function oi(t,e,r){if(t.length>1){if(ai(t,e))return!0;for(var n=0;n<e.length;n++)if(li(e[n],t,r))return!0}for(var i=0;i<t.length;i++)if(li(t[i],e,r))return!0;return!1}function ai(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var n=t[r],i=t[r+1],o=0;o<e.length-1;o++)if(si(n,i,e[o],e[o+1]))return!0;return!1}function si(t,e,r,n){return x(t,r,n)!==x(e,r,n)&&x(t,e,r)!==x(t,e,n)}function li(t,e,r){var n=r*r;if(1===e.length)return t.distSqr(e[0])<n;for(var i=1;i<e.length;i++)if(ui(t,e[i-1],e[i])<n)return!0;return!1}function ui(t,e,r){var n=e.distSqr(r);if(0===n)return t.distSqr(e);var i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function ci(t,e){for(var r,n,i,o=!1,a=0;a<t.length;a++)for(var s=0,l=(r=t[a]).length-1;s<r.length;l=s++)n=r[s],i=r[l],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(o=!o);return o}function hi(t,e){for(var r=!1,n=0,i=t.length-1;n<t.length;i=n++){var o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function pi(t,e,r){var n=e.paint.get(t).value;return"constant"===n.kind?n.value:r.programConfigurations.get(e.id).binders[t].statistics.max}function di(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function fi(t,e,r,n,i){if(!e[0]&&!e[1])return t;var a=o.convert(e);"viewport"===r&&a._rotate(-n);for(var s=[],l=0;l<t.length;l++){for(var u=t[l],c=[],h=0;h<u.length;h++)c.push(u[h].sub(a._mult(i)));s.push(c)}return s}ei.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Zr(this.zoom),o)){var l=$n(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},ei.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},ei.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ei.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ei.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ei.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ei.prototype.addFeature=function(t,e,r){for(var n=0,i=e;n<i.length;n+=1)for(var o=0,a=i[n];o<a.length;o+=1){var s=a[o],l=s.x,u=s.y;if(!(l<0||l>=Jn||u<0||u>=Jn)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=c.vertexLength;ti(this.layoutVertexArray,l,u,-1,-1),ti(this.layoutVertexArray,l,u,1,-1),ti(this.layoutVertexArray,l,u,1,1),ti(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r)},Tr("CircleBucket",ei,{omit:["layers"]});var mi={paint:new on({"circle-radius":new en(O.paint_circle["circle-radius"]),"circle-color":new en(O.paint_circle["circle-color"]),"circle-blur":new en(O.paint_circle["circle-blur"]),"circle-opacity":new en(O.paint_circle["circle-opacity"]),"circle-translate":new tn(O.paint_circle["circle-translate"]),"circle-translate-anchor":new tn(O.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tn(O.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tn(O.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new en(O.paint_circle["circle-stroke-width"]),"circle-stroke-color":new en(O.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new en(O.paint_circle["circle-stroke-opacity"])})},_i="undefined"!=typeof Float32Array?Float32Array:Array;function yi(){var t=new _i(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function gi(){var t=new _i(3);return t[0]=0,t[1]=0,t[2]=0,t}function vi(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function bi(t,e,r){var n=new _i(3);return n[0]=t,n[1]=e,n[2]=r,n}Math.PI;var xi,wi=vi,ki=(xi=gi(),function(t,e,r,n,i,o){var a,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,a=r;a<s;a+=e)xi[0]=t[a],xi[1]=t[a+1],xi[2]=t[a+2],i(xi,xi,o),t[a]=xi[0],t[a+1]=xi[1],t[a+2]=xi[2];return t});function Ei(){var t=new _i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ii(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t}function Si(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}var Mi=function(){var t=Ei();return function(e,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),l=i?Math.min(i*r+n,e.length):e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Ti(){var t=new _i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}gi(),bi(1,0,0),bi(0,1,0),Ti(),Ti(),yi(),function(){var t;(t=new _i(2))[0]=0,t[1]=0}();var Ai=function(t){function e(e){t.call(this,e,mi)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new ei(t)},e.prototype.queryRadius=function(t){var e=t;return pi("circle-radius",this,e)+pi("circle-stroke-width",this,e)+di(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a,s){for(var l=fi(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(t,e,r){return l.map(function(t){return t.map(function(t){return Pi(t,e,r)})})}(0,s,o),p=c?u*a:u,d=0,f=n;d<f.length;d+=1)for(var m=0,_=f[d];m<_.length;m+=1){var y=_[m],g=c?y:Pi(y,s,o),v=p,b=Si([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?v*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(v*=o.cameraToCenterDistance/b[3]),ri(h,g,v))return!0}return!1},e}(an);function Pi(t,e,r){var n=Si([],[t.x,t.y,0,1],e);return new o((n[0]/n[3]+1)*r.width*.5,(n[1]/n[3]+1)*r.height*.5)}var Ci=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ei);function Di(t,e,r,n){var i=e.width,o=e.height;if(n){if(n.length!==i*o*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*o*r);return t.width=i,t.height=o,t.data=n,t}function zi(t,e,r){var n=e.width,i=e.height;if(n!==t.width||i!==t.height){var o=Di({},{width:n,height:i},r);Bi(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,n),height:Math.min(t.height,i)},r),t.width=n,t.height=i,t.data=o.data}}function Bi(t,e,r,n,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<i.height;l++)for(var u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o,h=0;h<i.width*o;h++)s[c+h]=a[u+h];return e}Tr("HeatmapBucket",Ci,{omit:["layers"]});var Li=function(t,e){Di(this,t,1,e)};Li.prototype.resize=function(t){zi(this,t,1)},Li.prototype.clone=function(){return new Li({width:this.width,height:this.height},new Uint8Array(this.data))},Li.copy=function(t,e,r,n,i){Bi(t,e,r,n,i,1)};var Ri=function(t,e){Di(this,t,4,e)};Ri.prototype.resize=function(t){zi(this,t,4)},Ri.prototype.clone=function(){return new Ri({width:this.width,height:this.height},new Uint8Array(this.data))},Ri.copy=function(t,e,r,n,i){Bi(t,e,r,n,i,4)},Tr("AlphaImage",Li),Tr("RGBAImage",Ri);var Oi={paint:new on({"heatmap-radius":new en(O.paint_heatmap["heatmap-radius"]),"heatmap-weight":new en(O.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tn(O.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nn(O.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tn(O.paint_heatmap["heatmap-opacity"])})};function Fi(t,e){for(var r=new Uint8Array(1024),n={},i=0,o=0;i<256;i++,o+=4){n[e]=i/255;var a=t.evaluate(n);r[o+0]=Math.floor(255*a.r/a.a),r[o+1]=Math.floor(255*a.g/a.a),r[o+2]=Math.floor(255*a.b/a.a),r[o+3]=Math.floor(255*a.a)}return new Ri({width:256,height:1},r)}var Ni=function(t){function e(e){t.call(this,e,Oi),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Ci(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Fi(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(an),Vi={paint:new on({"hillshade-illumination-direction":new tn(O.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tn(O.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tn(O.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tn(O.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tn(O.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tn(O.paint_hillshade["hillshade-accent-color"])})},ji=function(t){function e(e){t.call(this,e,Vi)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(an),Ui=cn([{name:"a_pos",components:2,type:"Int16"}],4),qi=Ui.members,Gi=(Ui.size,Ui.alignment,Xi),Zi=Xi;function Xi(t,e,r){r=r||2;var n,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*r:t.length,p=Wi(t,0,h,r,!0),d=[];if(!p)return d;if(c&&(p=function(t,e,r,n){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Wi(t,e[i]*n,i<o-1?e[i+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),s.push(no(a));for(s.sort(to),i=0;i<s.length;i++)eo(s[i],r),r=Hi(r,r.next);return r}(t,e,p,r)),t.length>80*r){n=o=t[0],i=a=t[1];for(var f=r;f<h;f+=r)(s=t[f])<n&&(n=s),(l=t[f+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return Yi(p,d,r,n,i,u),d}function Wi(t,e,r,n,i){var o,a;if(i===mo(t,e,r,n)>0)for(o=e;o<r;o+=n)a=ho(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=ho(o,t[o],t[o+1],a);return a&&so(a,a.next)&&(po(a),a=a.next),a}function Hi(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!so(n,n.next)&&0!==ao(n.prev,n,n.next))n=n.next;else{if(po(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function Yi(t,e,r,n,i,o,a){if(t){!a&&o&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=ro(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,a,s,l,u=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(t,n,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Ji(t,n,i,o):Ki(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),po(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?Yi(t=Qi(t,e,r),e,r,n,i,o,2):2===a&&$i(t,e,r,n,i,o):Yi(Hi(t),e,r,n,i,o,1);break}}}function Ki(t){var e=t.prev,r=t,n=t.next;if(ao(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(io(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&ao(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ji(t,e,r,n){var i=t.prev,o=t,a=t.next;if(ao(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=ro(s,l,e,r,n),p=ro(u,c,e,r,n),d=t.prevZ,f=t.nextZ;d&&d.z>=h&&f&&f.z<=p;){if(d!==t.prev&&d!==t.next&&io(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&ao(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&io(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ao(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&io(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&ao(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&io(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ao(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Qi(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!so(i,o)&&lo(i,n,n.next,o)&&uo(i,o)&&uo(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),po(n),po(n.next),n=t=o),n=n.next}while(n!==t);return n}function $i(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&oo(a,s)){var l=co(a,s);return a=Hi(a,a.next),l=Hi(l,l.next),Yi(a,e,r,n,i,o),void Yi(l,e,r,n,i,o)}s=s.next}a=a.next}while(a!==t)}function to(t,e){return t.x-e.x}function eo(t,e){if(e=function(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var l,u=r,c=r.x,h=r.y,p=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=c&&i!==n.x&&io(o<h?i:a,o,c,h,o<h?a:i,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(i-n.x))<p||l===p&&n.x>r.x)&&uo(n,t)&&(r=n,p=l),n=n.next;return r}(t,e)){var r=co(e,t);Hi(r,r.next)}}function ro(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function no(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function io(t,e,r,n,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function oo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&lo(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&uo(t,e)&&uo(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function ao(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function so(t,e){return t.x===e.x&&t.y===e.y}function lo(t,e,r,n){return!!(so(t,e)&&so(r,n)||so(t,n)&&so(r,e))||ao(t,e,r)>0!=ao(t,e,n)>0&&ao(r,n,t)>0!=ao(r,n,e)>0}function uo(t,e){return ao(t.prev,t,t.next)<0?ao(t,e,t.next)>=0&&ao(t,t.prev,e)>=0:ao(t,e,t.prev)<0||ao(t,t.next,e)<0}function co(t,e){var r=new fo(t.i,t.x,t.y),n=new fo(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function ho(t,e,r,n){var i=new fo(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function po(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function fo(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mo(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}Xi.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(mo(t,0,o,r));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(mo(t,u,c,r))}var h=0;for(s=0;s<n.length;s+=3){var p=n[s]*r,d=n[s+1]*r,f=n[s+2]*r;h+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},Xi.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r},Gi.default=Zi;var _o=go,yo=go;function go(t,e,r,n,i){!function t(e,r,n,i,o){for(;i>n;){if(i-n>600){var a=i-n+1,s=r-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,r,Math.max(n,Math.floor(r-s*u/a+c)),Math.min(i,Math.floor(r+(a-s)*u/a+c)),o)}var h=e[r],p=n,d=i;for(vo(e,n,r),o(e[i],h)>0&&vo(e,n,i);p<d;){for(vo(e,p,d),p++,d--;o(e[p],h)<0;)p++;for(;o(e[d],h)>0;)d--}0===o(e[n],h)?vo(e,n,d):vo(e,++d,i),d<=r&&(n=d+1),r<=d&&(i=d-1)}}(t,e,r||0,n||t.length-1,i||bo)}function vo(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function bo(t,e){return t<e?-1:t>e?1:0}function xo(t,e){var r=t.length;if(r<=1)return[t];for(var n,i,o=[],a=0;a<r;a++){var s=w(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(n&&o.push(n),n=[t[a]]):n.push(t[a]))}if(n&&o.push(n),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(_o(o[l],e,1,o[l].length-1,wo),o[l]=o[l].slice(0,e));return o}function wo(t,e){return e.area-t.area}_o.default=yo;var ko=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new pn,this.indexArray=new Sn,this.indexArray2=new Mn,this.programConfigurations=new Yn(qi,t.layers,t.zoom),this.segments=new Un,this.segments2=new Un};ko.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Zr(this.zoom),o)){var l=$n(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},ko.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},ko.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ko.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ko.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qi),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ko.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ko.prototype.addFeature=function(t,e,r){for(var n=0,i=xo(e,500);n<i.length;n+=1){for(var o=i[n],a=0,s=0,l=o;s<l.length;s+=1)a+=l[s].length;for(var u=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray),c=u.vertexLength,h=[],p=[],d=0,f=o;d<f.length;d+=1){var m=f[d];if(0!==m.length){m!==o[0]&&p.push(h.length/2);var _=this.segments2.prepareSegment(m.length,this.layoutVertexArray,this.indexArray2),y=_.vertexLength;this.layoutVertexArray.emplaceBack(m[0].x,m[0].y),this.indexArray2.emplaceBack(y+m.length-1,y),h.push(m[0].x),h.push(m[0].y);for(var g=1;g<m.length;g++)this.layoutVertexArray.emplaceBack(m[g].x,m[g].y),this.indexArray2.emplaceBack(y+g-1,y+g),h.push(m[g].x),h.push(m[g].y);_.vertexLength+=m.length,_.primitiveLength+=m.length}}for(var v=Gi(h,p),b=0;b<v.length;b+=3)this.indexArray.emplaceBack(c+v[b],c+v[b+1],c+v[b+2]);u.vertexLength+=a,u.primitiveLength+=v.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r)},Tr("FillBucket",ko,{omit:["layers"]});var Eo={paint:new on({"fill-antialias":new tn(O.paint_fill["fill-antialias"]),"fill-opacity":new en(O.paint_fill["fill-opacity"]),"fill-color":new en(O.paint_fill["fill-color"]),"fill-outline-color":new en(O.paint_fill["fill-outline-color"]),"fill-translate":new tn(O.paint_fill["fill-translate"]),"fill-translate-anchor":new tn(O.paint_fill["fill-translate-anchor"]),"fill-pattern":new rn(O.paint_fill["fill-pattern"])})},Io=function(t){function e(e){t.call(this,e,Eo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(t){this.paint=this._transitioningPaint.possiblyEvaluate(t);var e=this.paint._values["fill-outline-color"];"constant"===e.value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new ko(t)},e.prototype.queryRadius=function(){return di(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a){return ni(fi(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),n)},e}(an),So=cn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Mo=So.members,To=(So.size,So.alignment,Math.pow(2,13));function Ao(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,2*Math.floor(n*To)+a,i*To*2,o*To*2,Math.round(s))}var Po=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new fn,this.indexArray=new Sn,this.programConfigurations=new Yn(Mo,t.layers,t.zoom),this.segments=new Un};function Co(t,e){return t.x===e.x&&(t.x<0||t.x>Jn)||t.y===e.y&&(t.y<0||t.y>Jn)}function Do(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>Jn})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>Jn})}Po.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Zr(this.zoom),o)){var l=$n(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},Po.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},Po.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Po.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Po.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Po.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Po.prototype.addFeature=function(t,e,r){for(var n=0,i=xo(e,500);n<i.length;n+=1){for(var o=i[n],a=0,s=0,l=o;s<l.length;s+=1)a+=l[s].length;for(var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),c=0,h=o;c<h.length;c+=1){var p=h[c];if(0!==p.length&&!Do(p))for(var d=0,f=0;f<p.length;f++){var m=p[f];if(f>=1){var _=p[f-1];if(!Co(m,_)){u.vertexLength+4>Un.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var y=m.sub(_)._perp()._unit(),g=_.dist(m);d+g>32768&&(d=0),Ao(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,0,d),Ao(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,1,d),d+=g,Ao(this.layoutVertexArray,_.x,_.y,y.x,y.y,0,0,d),Ao(this.layoutVertexArray,_.x,_.y,y.x,y.y,0,1,d);var v=u.vertexLength;this.indexArray.emplaceBack(v,v+1,v+2),this.indexArray.emplaceBack(v+1,v+2,v+3),u.vertexLength+=4,u.primitiveLength+=2}}}}u.vertexLength+a>Un.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray));for(var b=[],x=[],w=u.vertexLength,k=0,E=o;k<E.length;k+=1){var I=E[k];if(0!==I.length){I!==o[0]&&x.push(b.length/2);for(var S=0;S<I.length;S++){var M=I[S];Ao(this.layoutVertexArray,M.x,M.y,0,0,1,1,0),b.push(M.x),b.push(M.y)}}}for(var T=Gi(b,x),A=0;A<T.length;A+=3)this.indexArray.emplaceBack(w+T[A],w+T[A+1],w+T[A+2]);u.primitiveLength+=T.length/3,u.vertexLength+=a}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r)},Tr("FillExtrusionBucket",Po,{omit:["layers"]});var zo={paint:new on({"fill-extrusion-opacity":new tn(O["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new en(O["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tn(O["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tn(O["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new rn(O["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new en(O["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new en(O["paint_fill-extrusion"]["fill-extrusion-base"])})},Bo=function(t){function e(e){t.call(this,e,zo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Po(t)},e.prototype.queryRadius=function(){return di(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a){return ni(fi(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),n)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(an),Lo=cn([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Ro=Lo.members,Oo=(Lo.size,Lo.alignment,Fo);function Fo(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(No,this,e)}function No(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function Vo(t){for(var e,r,n=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],n+=((r=t[a]).x-e.x)*(e.y+r.y);return n}Fo.types=["Unknown","Point","LineString","Polygon"],Fo.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,i=0,a=0,s=0,l=[];t.pos<r;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)a+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new o(a,s));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&l.push(e),l},Fo.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,u]},Fo.prototype.toGeoJSON=function(t,e,r){var n,i,o=this.extent*Math.pow(2,r),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=Fo.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+s)/o;t[e]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];c(l=h);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var a=Vo(t[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}(l),n=0;n<l.length;n++)for(i=0;i<l[n].length;i++)c(l[n][i])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var jo=Uo;function Uo(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(qo,this,e),this.length=this._features.length}function qo(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}function Go(t,e,r){if(3===t){var n=new jo(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}Uo.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Oo(this._pbf,e,this.extent,this._keys,this._values)};var Zo={VectorTile:function(t,e){this.layers=t.readFields(Go,{},e)},VectorTileFeature:Oo,VectorTileLayer:jo},Xo=Zo.VectorTileFeature.types,Wo=63,Ho=Math.cos(Math.PI/180*37.5),Yo=.5,Ko=Math.pow(2,14)/Yo;function Jo(t,e,r,n,i,o,a){t.emplaceBack(e.x,e.y,n?1:0,i?1:-1,Math.round(Wo*r.x)+128,Math.round(Wo*r.y)+128,1+(0===o?0:o<0?-1:1)|(a*Yo&63)<<2,a*Yo>>6)}var Qo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new mn,this.indexArray=new Sn,this.programConfigurations=new Yn(Ro,t.layers,t.zoom),this.segments=new Un};function $o(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(Ko-1)}Qo.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Zr(this.zoom),o)){var l=$n(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},Qo.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},Qo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ro),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qo.prototype.addFeature=function(t,e,r){for(var n=this.layers[0].layout,i=n.get("line-join").evaluate(t,{}),o=n.get("line-cap"),a=n.get("line-miter-limit"),s=n.get("line-round-limit"),l=0,u=e;l<u.length;l+=1){var c=u[l];this.addLine(c,t,i,o,a,s,r)}},Qo.prototype.addLine=function(t,e,r,n,i,o,a){var s=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(s={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var l="Polygon"===Xo[e.type],u=t.length;u>=2&&t[u-1].equals(t[u-2]);)u--;for(var c=0;c<u-1&&t[c].equals(t[c+1]);)c++;if(!(u<(l?3:2))){s&&(s.tileTotal=function(t,e,r){for(var n,i,o=0,a=c;a<r-1;a++)n=t[a],i=t[a+1],o+=n.dist(i);return o}(t,0,u)),"bevel"===r&&(i=1.05);var h=Jn/(512*this.overscaling)*15,p=t[c],d=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray);this.distance=0;var f,m,_,y=n,g=l?"butt":n,v=!0,b=void 0,x=void 0,w=void 0,k=void 0;this.e1=this.e2=this.e3=-1,l&&(f=t[u-2],k=p.sub(f)._unit()._perp());for(var E=c;E<u;E++)if(!(x=l&&E===u-1?t[c+1]:t[E+1])||!t[E].equals(x)){k&&(w=k),f&&(b=f),f=t[E],k=x?x.sub(f)._unit()._perp():w;var I=(w=w||k).add(k);0===I.x&&0===I.y||I._unit();var S=I.x*k.x+I.y*k.y,M=0!==S?1/S:1/0,T=S<Ho&&b&&x;if(T&&E>c){var A=f.dist(b);if(A>2*h){var P=f.sub(f.sub(b)._mult(h/A)._round());this.distance+=P.dist(b),this.addCurrentVertex(P,this.distance,w.mult(1),0,0,!1,d,s),b=P}}var C=b&&x,D=C?r:x?y:g;if(C&&"round"===D&&(M<o?D="miter":M<=2&&(D="fakeround")),"miter"===D&&M>i&&(D="bevel"),"bevel"===D&&(M>2&&(D="flipbevel"),M<i&&(D="miter")),b&&(this.distance+=f.dist(b)),"miter"===D)I._mult(M),this.addCurrentVertex(f,this.distance,I,0,0,!1,d,s);else if("flipbevel"===D){if(M>100)I=k.clone().mult(-1);else{var z=w.x*k.y-w.y*k.x>0?-1:1,B=M*w.add(k).mag()/w.sub(k).mag();I._perp()._mult(B*z)}this.addCurrentVertex(f,this.distance,I,0,0,!1,d,s),this.addCurrentVertex(f,this.distance,I.mult(-1),0,0,!1,d,s)}else if("bevel"===D||"fakeround"===D){var L=w.x*k.y-w.y*k.x>0,R=-Math.sqrt(M*M-1);if(L?(_=0,m=R):(m=0,_=R),v||this.addCurrentVertex(f,this.distance,w,m,_,!1,d,s),"fakeround"===D){for(var O=Math.floor(8*(.5-(S-.5))),F=void 0,N=0;N<O;N++)F=k.mult((N+1)/(O+1))._add(w)._unit(),this.addPieSliceVertex(f,this.distance,F,L,d,s);this.addPieSliceVertex(f,this.distance,I,L,d,s);for(var V=O-1;V>=0;V--)F=w.mult((V+1)/(O+1))._add(k)._unit(),this.addPieSliceVertex(f,this.distance,F,L,d,s)}x&&this.addCurrentVertex(f,this.distance,k,-m,-_,!1,d,s)}else"butt"===D?(v||this.addCurrentVertex(f,this.distance,w,0,0,!1,d,s),x&&this.addCurrentVertex(f,this.distance,k,0,0,!1,d,s)):"square"===D?(v||(this.addCurrentVertex(f,this.distance,w,1,1,!1,d,s),this.e1=this.e2=-1),x&&this.addCurrentVertex(f,this.distance,k,-1,-1,!1,d,s)):"round"===D&&(v||(this.addCurrentVertex(f,this.distance,w,0,0,!1,d,s),this.addCurrentVertex(f,this.distance,w,1,1,!0,d,s),this.e1=this.e2=-1),x&&(this.addCurrentVertex(f,this.distance,k,-1,-1,!0,d,s),this.addCurrentVertex(f,this.distance,k,0,0,!1,d,s)));if(T&&E<u-1){var j=f.dist(x);if(j>2*h){var U=f.add(x.sub(f)._mult(h/j)._round());this.distance+=U.dist(f),this.addCurrentVertex(U,this.distance,k.mult(1),0,0,!1,d,s),f=U}}v=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a)}},Qo.prototype.addCurrentVertex=function(t,e,r,n,i,o,a,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(e=$o(e,s)),l=r.clone(),n&&l._sub(r.perp()._mult(n)),Jo(u,t,l,o,!1,n,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=r.mult(-1),i&&l._sub(r.perp()._mult(i)),Jo(u,t,l,o,!0,-i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>Ko/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,r,n,i,o,a))},Qo.prototype.addPieSliceVertex=function(t,e,r,n,i,o){r=r.mult(n?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=$o(e,o)),Jo(a,t,r,!1,n,0,e),this.e3=i.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),i.primitiveLength++),n?this.e2=this.e3:this.e1=this.e3},Tr("LineBucket",Qo,{omit:["layers"]});var ta=new on({"line-cap":new tn(O.layout_line["line-cap"]),"line-join":new en(O.layout_line["line-join"]),"line-miter-limit":new tn(O.layout_line["line-miter-limit"]),"line-round-limit":new tn(O.layout_line["line-round-limit"])}),ea={paint:new on({"line-opacity":new en(O.paint_line["line-opacity"]),"line-color":new en(O.paint_line["line-color"]),"line-translate":new tn(O.paint_line["line-translate"]),"line-translate-anchor":new tn(O.paint_line["line-translate-anchor"]),"line-width":new en(O.paint_line["line-width"]),"line-gap-width":new en(O.paint_line["line-gap-width"]),"line-offset":new en(O.paint_line["line-offset"]),"line-blur":new en(O.paint_line["line-blur"]),"line-dasharray":new rn(O.paint_line["line-dasharray"]),"line-pattern":new rn(O.paint_line["line-pattern"]),"line-gradient":new nn(O.paint_line["line-gradient"])}),layout:ta},ra=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new Zr(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,n,i){return r=h({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,n,i)},e}(en))(ea.paint.properties["line-width"].specification);ra.useIntegerZoom=!0;var na=function(t){function e(e){t.call(this,e,ea)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Fi(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=ra.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Qo(t)},e.prototype.queryRadius=function(t){var e=t,r=ia(pi("line-width",this,e),pi("line-gap-width",this,e)),n=pi("line-offset",this,e);return r/2+Math.abs(n)+di(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,a,s){var l=fi(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*ia(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),c=this.paint.get("line-offset").evaluate(e,r);return c&&(n=function(t,e){for(var r=[],n=new o(0,0),i=0;i<t.length;i++){for(var a=t[i],s=[],l=0;l<a.length;l++){var u=a[l-1],c=a[l],h=a[l+1],p=0===l?n:c.sub(u)._unit()._perp(),d=l===a.length-1?n:h.sub(c)._unit()._perp(),f=p._add(d)._unit(),m=f.x*d.x+f.y*d.y;f._mult(1/m),s.push(f._mult(e)._add(c))}r.push(s)}return r}(n,c*s)),ii(l,n,u)},e}(an);function ia(t,e){return e>0?e+2*t:t}var oa=cn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),aa=cn([{name:"a_projected_pos",components:3,type:"Float32"}],4),sa=(cn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),cn([{name:"a_placed",components:2,type:"Uint8"}],4)),la=(cn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),cn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ua=cn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function ca(t,e,r){var n=e.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),Gr.applyArabicShaping&&(t=Gr.applyArabicShaping(t)),t}function ha(t,e,r){return t instanceof ht?(t.sections.forEach(function(t){t.text=ca(t.text,e,r)}),t):ca(t,e,r)}cn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),cn([{type:"Float32",name:"offsetX"}]),cn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var pa={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},da=function(t){function e(e,r,n,i){t.call(this,e,r),this.angle=n,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(o);function fa(t,e){var r=e.expression;if("constant"===r.kind)return{functionType:"constant",layoutSize:r.evaluate(new Zr(t+1))};if("source"===r.kind)return{functionType:"source"};for(var n=r.zoomStops,i=0;i<n.length&&n[i]<=t;)i++;for(var o=i=Math.max(0,i-1);o<n.length&&n[o]<t+1;)o++;o=Math.min(n.length-1,o);var a={min:n[i],max:n[o]};return"composite"===r.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:r.evaluate(new Zr(t+1)),zoomRange:a,sizeRange:{min:r.evaluate(new Zr(a.min)),max:r.evaluate(new Zr(a.max))},propertyValue:e.value}}Tr("Anchor",da);var ma=Zo.VectorTileFeature.types,_a=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ya(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.round(32*n),Math.round(32*i),o,a,s?s[0]:0,s?s[1]:0)}function ga(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}var va=function(t){this.layoutVertexArray=new _n,this.indexArray=new Sn,this.programConfigurations=t,this.segments=new Un,this.dynamicLayoutVertexArray=new yn,this.opacityVertexArray=new gn,this.placedSymbolArray=new zn};va.prototype.upload=function(t,e,r,n){r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,oa.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,aa.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,_a,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(t)},va.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Tr("SymbolBuffers",va);var ba=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Un,this.collisionVertexArray=new xn};ba.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,sa.members,!0)},ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Tr("CollisionBuffers",ba);var xa=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=fa(this.zoom,e["text-size"]),this.iconSizeData=fa(this.zoom,e["icon-size"]);var r=this.layers[0].layout;this.sortFeaturesByY=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sourceID=t.sourceID};xa.prototype.createArrays=function(){this.text=new va(new Yn(oa.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new va(new Yn(oa.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new ba(bn,la.members,Mn),this.collisionCircle=new ba(bn,ua.members,Sn),this.glyphOffsetArray=new Ln,this.lineVertexArray=new On},xa.prototype.calculateGlyphDependencies=function(t,e,r,n){for(var i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,r&&n){var o=pa[t.charAt(i)];o&&(e[o.charCodeAt(0)]=!0)}},xa.prototype.populate=function(t,e){var r=this.layers[0],n=r.layout,i=n.get("text-font"),o=n.get("text-field"),a=n.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),l="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||l){for(var u=e.iconDependencies,c=e.glyphDependencies,h=new Zr(this.zoom),p=0,d=t;p<d.length;p+=1){var f=d[p],m=f.feature,_=f.index,y=f.sourceLayerIndex;if(r._featureFilter(h,m)){var g=void 0;s&&(g=ha(g=r.getValueAndResolveTokens("text-field",m),r,m));var v=void 0;if(l&&(v=r.getValueAndResolveTokens("icon-image",m)),g||v){var b={text:g,icon:v,index:_,sourceLayerIndex:y,geometry:$n(m),properties:m.properties,type:ma[m.type]};if(void 0!==m.id&&(b.id=m.id),this.features.push(b),v&&(u[v]=!0),g){var x=i.evaluate(m,{}).join(","),w=c[x]=c[x]||{},k="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");if(g instanceof ht)for(var E=0,I=g.sections;E<I.length;E+=1){var S=I[E],M=Br(g.toString()),T=S.fontStack||x,A=c[T]=c[T]||{};this.calculateGlyphDependencies(S.text,A,k,M)}else{var P=Br(g);this.calculateGlyphDependencies(g,w,k,P)}}}}}"line"===n.get("symbol-placement")&&(this.features=function(t){var e={},r={},n=[],i=0;function o(e){n.push(t[e]),i++}function a(t,e,i){var o=r[t];return delete r[t],r[e]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function s(t,r,i){var o=e[r];return delete e[r],e[t]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function l(t,e,r){var n=r?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}for(var u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.text instanceof ht?c.text.toString():c.text;if(p){var d=l(p,h),f=l(p,h,!0);if(d in r&&f in e&&r[d]!==e[f]){var m=s(d,f,h),_=a(d,f,n[m].geometry);delete e[d],delete r[f],r[l(p,n[_].geometry,!0)]=_,n[m].geometry=null}else d in r?a(d,f,h):f in e?s(d,f,h):(o(u),e[d]=i-1,r[f]=i-1)}else o(u)}return n.filter(function(t){return t.geometry})}(this.features))}},xa.prototype.update=function(t,e){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers))},xa.prototype.isEmpty=function(){return 0===this.symbolInstances.length},xa.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},xa.prototype.upload=function(t){this.uploaded||(this.collisionBox.upload(t),this.collisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},xa.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},xa.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:n},a<e.length-1&&(n+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},xa.prototype.addSymbols=function(t,e,r,n,i,o,a,s,l,u){for(var c=t.indexArray,h=t.layoutVertexArray,p=t.dynamicLayoutVertexArray,d=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),f=this.glyphOffsetArray.length,m=d.vertexLength,_=0,y=e;_<y.length;_+=1){var g=y[_],v=g.tl,b=g.tr,x=g.bl,w=g.br,k=g.tex,E=d.vertexLength,I=g.glyphOffset[1];ya(h,s.x,s.y,v.x,I+v.y,k.x,k.y,r),ya(h,s.x,s.y,b.x,I+b.y,k.x+k.w,k.y,r),ya(h,s.x,s.y,x.x,I+x.y,k.x,k.y+k.h,r),ya(h,s.x,s.y,w.x,I+w.y,k.x+k.w,k.y+k.h,r),ga(p,s,0),c.emplaceBack(E,E+1,E+2),c.emplaceBack(E+1,E+2,E+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(g.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,f,this.glyphOffsetArray.length-f,m,l,u,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index)},xa.prototype._addCollisionDebugVertex=function(t,e,r,n,i){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,n.x,n.y,Math.round(i.x),Math.round(i.y))},xa.prototype.addCollisionDebugVertices=function(t,e,r,n,i,a,s,l){var u=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),c=u.vertexLength,h=i.layoutVertexArray,p=i.collisionVertexArray;if(this._addCollisionDebugVertex(h,p,a,s.anchor,new o(t,e)),this._addCollisionDebugVertex(h,p,a,s.anchor,new o(r,e)),this._addCollisionDebugVertex(h,p,a,s.anchor,new o(r,n)),this._addCollisionDebugVertex(h,p,a,s.anchor,new o(t,n)),u.vertexLength+=4,l){var d=i.indexArray;d.emplaceBack(c,c+1,c+2),d.emplaceBack(c,c+2,c+3),u.primitiveLength+=2}else{var f=i.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),u.primitiveLength+=4}},xa.prototype.generateCollisionDebugBuffers=function(){for(var t=0,e=this.symbolInstances;t<e.length;t+=1){var r=e[t];r.textCollisionFeature={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex},r.iconCollisionFeature={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex};for(var n=0;n<2;n++){var i=r[0===n?"textCollisionFeature":"iconCollisionFeature"];if(i)for(var o=i.boxStartIndex;o<i.boxEndIndex;o++){var a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=a.radius>0;this.addCollisionDebugVertices(s,l,u,c,h?this.collisionCircle:this.collisionBox,a.anchorPoint,r,h)}}}},xa.prototype.deserializeCollisionBoxes=function(t,e,r,n,i){for(var o={},a=e;a<r;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=n;l<i;l++){var u=t.get(l);if(0===u.radius){o.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},o.iconFeatureIndex=u.featureIndex;break}}return o},xa.prototype.hasTextData=function(){return this.text.segments.get().length>0},xa.prototype.hasIconData=function(){return this.icon.segments.get().length>0},xa.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},xa.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},xa.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var r=[],n=0;n<this.symbolInstances.length;n++)r.push(n);var i=Math.sin(t),o=Math.cos(t);r.sort(function(t,r){var n=e.symbolInstances[t],a=e.symbolInstances[r];return(0|Math.round(i*n.anchor.x+o*n.anchor.y))-(0|Math.round(i*a.anchor.x+o*a.anchor.y))||a.featureIndex-n.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var a=0,s=r;a<s.length;a+=1){var l=s[a],u=e.symbolInstances[l];e.featureSortOrder.push(u.featureIndex);for(var c=0,h=u.placedTextSymbolIndices;c<h.length;c+=1)for(var p=h[c],d=e.text.placedSymbolArray.get(p),f=d.vertexStartIndex+4*d.numGlyphs,m=d.vertexStartIndex;m<f;m+=4)e.text.indexArray.emplaceBack(m,m+1,m+2),e.text.indexArray.emplaceBack(m+1,m+2,m+3);var _=e.icon.placedSymbolArray.get(l);if(_.numGlyphs){var y=_.vertexStartIndex;e.icon.indexArray.emplaceBack(y,y+1,y+2),e.icon.indexArray.emplaceBack(y+1,y+2,y+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Tr("SymbolBucket",xa,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),xa.MAX_GLYPHS=65535,xa.addDynamicAttributes=ga;var wa=new on({"symbol-placement":new tn(O.layout_symbol["symbol-placement"]),"symbol-spacing":new tn(O.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tn(O.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new tn(O.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new tn(O.layout_symbol["icon-ignore-placement"]),"icon-optional":new tn(O.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tn(O.layout_symbol["icon-rotation-alignment"]),"icon-size":new en(O.layout_symbol["icon-size"]),"icon-text-fit":new tn(O.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tn(O.layout_symbol["icon-text-fit-padding"]),"icon-image":new en(O.layout_symbol["icon-image"]),"icon-rotate":new en(O.layout_symbol["icon-rotate"]),"icon-padding":new tn(O.layout_symbol["icon-padding"]),"icon-keep-upright":new tn(O.layout_symbol["icon-keep-upright"]),"icon-offset":new en(O.layout_symbol["icon-offset"]),"icon-anchor":new en(O.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tn(O.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tn(O.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tn(O.layout_symbol["text-rotation-alignment"]),"text-field":new en(O.layout_symbol["text-field"]),"text-font":new en(O.layout_symbol["text-font"]),"text-size":new en(O.layout_symbol["text-size"]),"text-max-width":new en(O.layout_symbol["text-max-width"]),"text-line-height":new tn(O.layout_symbol["text-line-height"]),"text-letter-spacing":new en(O.layout_symbol["text-letter-spacing"]),"text-justify":new en(O.layout_symbol["text-justify"]),"text-anchor":new en(O.layout_symbol["text-anchor"]),"text-max-angle":new tn(O.layout_symbol["text-max-angle"]),"text-rotate":new en(O.layout_symbol["text-rotate"]),"text-padding":new tn(O.layout_symbol["text-padding"]),"text-keep-upright":new tn(O.layout_symbol["text-keep-upright"]),"text-transform":new en(O.layout_symbol["text-transform"]),"text-offset":new en(O.layout_symbol["text-offset"]),"text-allow-overlap":new tn(O.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new tn(O.layout_symbol["text-ignore-placement"]),"text-optional":new tn(O.layout_symbol["text-optional"])}),ka={paint:new on({"icon-opacity":new en(O.paint_symbol["icon-opacity"]),"icon-color":new en(O.paint_symbol["icon-color"]),"icon-halo-color":new en(O.paint_symbol["icon-halo-color"]),"icon-halo-width":new en(O.paint_symbol["icon-halo-width"]),"icon-halo-blur":new en(O.paint_symbol["icon-halo-blur"]),"icon-translate":new tn(O.paint_symbol["icon-translate"]),"icon-translate-anchor":new tn(O.paint_symbol["icon-translate-anchor"]),"text-opacity":new en(O.paint_symbol["text-opacity"]),"text-color":new en(O.paint_symbol["text-color"]),"text-halo-color":new en(O.paint_symbol["text-halo-color"]),"text-halo-width":new en(O.paint_symbol["text-halo-width"]),"text-halo-blur":new en(O.paint_symbol["text-halo-blur"]),"text-translate":new tn(O.paint_symbol["text-translate"]),"text-translate-anchor":new tn(O.paint_symbol["text-translate-anchor"])}),layout:wa},Ea=function(t){function e(e){t.call(this,e,ka)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var r,n=this.layout.get(t).evaluate(e,{}),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||Re(i.value)?n:(r=e.properties,n.replace(/{([^{}]+)}/g,function(t,e){return e in r?String(r[e]):""}))},e.prototype.createBucket=function(t){return new xa(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(an),Ia={paint:new on({"background-color":new tn(O.paint_background["background-color"]),"background-pattern":new rn(O.paint_background["background-pattern"]),"background-opacity":new tn(O.paint_background["background-opacity"])})},Sa=function(t){function e(e){t.call(this,e,Ia)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(an),Ma={paint:new on({"raster-opacity":new tn(O.paint_raster["raster-opacity"]),"raster-hue-rotate":new tn(O.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tn(O.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tn(O.paint_raster["raster-brightness-max"]),"raster-saturation":new tn(O.paint_raster["raster-saturation"]),"raster-contrast":new tn(O.paint_raster["raster-contrast"]),"raster-resampling":new tn(O.paint_raster["raster-resampling"]),"raster-fade-duration":new tn(O.paint_raster["raster-fade-duration"])})},Ta={circle:Ai,heatmap:Ni,hillshade:ji,fill:Io,"fill-extrusion":Bo,line:na,symbol:Ea,background:Sa,raster:function(t){function e(e){t.call(this,e,Ma)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(an)};function Aa(t,e,r){r=r||{},this.w=t||64,this.h=e||64,this.autoResize=!!r.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function Pa(t,e,r){this.x=0,this.y=t,this.w=this.free=e,this.h=r}Aa.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var r,n,i,o,a=[],s=0;s<t.length;s++)if(r=t[s].w||t[s].width,n=t[s].h||t[s].height,i=t[s].id,r&&n){if(!(o=this.packOne(r,n,i)))continue;e.inPlace&&(t[s].x=o.x,t[s].y=o.y,t[s].id=o.id),a.push(o)}return this.shrink(),a},Aa.prototype.packOne=function(t,e,r){var n,i,o,a,s,l,u,c,h={freebin:-1,shelf:-1,waste:1/0},p=0;if("string"==typeof r||"number"==typeof r){if(n=this.getBin(r))return this.ref(n),n;"number"==typeof r&&(this.maxId=Math.max(r,this.maxId))}else r=++this.maxId;for(a=0;a<this.freebins.length;a++){if(e===(n=this.freebins[a]).maxh&&t===n.maxw)return this.allocFreebin(a,t,e,r);e>n.maxh||t>n.maxw||e<=n.maxh&&t<=n.maxw&&(o=n.maxw*n.maxh-t*e)<h.waste&&(h.waste=o,h.freebin=a)}for(a=0;a<this.shelves.length;a++)if(p+=(i=this.shelves[a]).h,!(t>i.free)){if(e===i.h)return this.allocShelf(a,t,e,r);e>i.h||e<i.h&&(o=(i.h-e)*t)<h.waste&&(h.freebin=-1,h.waste=o,h.shelf=a)}return-1!==h.freebin?this.allocFreebin(h.freebin,t,e,r):-1!==h.shelf?this.allocShelf(h.shelf,t,e,r):e<=this.h-p&&t<=this.w?(i=new Pa(p,this.w,e),this.allocShelf(this.shelves.push(i)-1,t,e,r)):this.autoResize?(s=l=this.h,((u=c=this.w)<=s||t>u)&&(c=2*Math.max(t,u)),(s<u||e>s)&&(l=2*Math.max(e,s)),this.resize(c,l),this.packOne(t,e,r)):null},Aa.prototype.allocFreebin=function(t,e,r,n){var i=this.freebins.splice(t,1)[0];return i.id=n,i.w=e,i.h=r,i.refcount=0,this.bins[n]=i,this.ref(i),i},Aa.prototype.allocShelf=function(t,e,r,n){var i=this.shelves[t].alloc(e,r,n);return this.bins[n]=i,this.ref(i),i},Aa.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,r=0;r<this.shelves.length;r++){var n=this.shelves[r];e+=n.h,t=Math.max(n.w-n.free,t)}this.resize(t,e)}},Aa.prototype.getBin=function(t){return this.bins[t]},Aa.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},Aa.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},Aa.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},Aa.prototype.resize=function(t,e){this.w=t,this.h=e;for(var r=0;r<this.shelves.length;r++)this.shelves[r].resize(t);return!0},Pa.prototype.alloc=function(t,e,r){if(t>this.free||e>this.h)return null;var n=this.x;return this.x+=t,this.free-=t,new function(t,e,r,n,i,o,a){this.id=t,this.x=e,this.y=r,this.w=n,this.h=i,this.maxw=o||n,this.maxh=a||i,this.refcount=0}(r,n,this.y,t,e,t,this.h)},Pa.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0};var Ca=function(t,e){var r=e.pixelRatio;this.paddedRect=t,this.pixelRatio=r},Da={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};Da.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Da.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Da.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ca.prototype,Da);var za=function(t){var e={},r=new Aa(0,0,{autoResize:!0}),n=[];for(var i in t){var o=t[i],a={x:0,y:0,w:o.data.width+2,h:o.data.height+2};n.push(a),e[i]=new Ca(a,o)}r.pack(n,{inPlace:!0});var s=new Ri({width:r.w,height:r.h});for(var l in t){var u=t[l],c=e[l].paddedRect;Ri.copy(u.data,s,{x:0,y:0},{x:c.x+1,y:c.y+1},u.data)}this.image=s,this.positions=e};Tr("ImagePosition",Ca),Tr("ImageAtlas",za);var Ba=self.HTMLImageElement,La=self.HTMLCanvasElement,Ra=self.HTMLVideoElement,Oa=self.ImageData,Fa=function(t,e,r,n){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,n)};Fa.prototype.update=function(t,e){var r=t.width,n=t.height,i=!this.size||this.size[0]!==r||this.size[1]!==n,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),i?(this.size=[r,n],o.pixelStoreUnpack.set(1),this.format!==a.RGBA||e&&!1===e.premultiply||o.pixelStoreUnpackPremultiplyAlpha.set(!0),t instanceof Ba||t instanceof La||t instanceof Ra||t instanceof Oa?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,r,n,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof Ba||t instanceof La||t instanceof Ra||t instanceof Oa?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,r,n,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},Fa.prototype.bind=function(t,e,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)},Fa.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Fa.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Na=function(t,e,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,p=r?-1:1,d=t[e+h];for(h+=p,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},Va=function(t,e,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&s,d+=f,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+d]=255&a,d+=f,a/=256,u-=8);t[r+d-f]|=128*m},ja=Ua;function Ua(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function qa(t){return t.type===Ua.Bytes?t.readVarint()+t.pos:t.pos+1}function Ga(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Za(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function Xa(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Wa(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Ha(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Ya(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Ka(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function Ja(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Qa(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function $a(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function ts(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function es(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function rs(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function ns(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Ua.Varint=0,Ua.Fixed64=1,Ua.Bytes=2,Ua.Fixed32=5,Ua.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=es(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ns(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=es(this.buf,this.pos)+4294967296*es(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=es(this.buf,this.pos)+4294967296*ns(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Na(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Na(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(n=(112&(i=o[r.pos++]))>>4,i<128)return Ga(t,n,e);if(n|=(127&(i=o[r.pos++]))<<3,i<128)return Ga(t,n,e);if(n|=(127&(i=o[r.pos++]))<<10,i<128)return Ga(t,n,e);if(n|=(127&(i=o[r.pos++]))<<17,i<128)return Ga(t,n,e);if(n|=(127&(i=o[r.pos++]))<<24,i<128)return Ga(t,n,e);if(n|=(1&(i=o[r.pos++]))<<31,i<128)return Ga(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){for(var n="",i=e;i<r;){var o,a,s,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=qa(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=qa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ua.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ua.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ua.Fixed32)this.pos+=4;else{if(e!==Ua.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),rs(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),rs(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),rs(this.buf,-1&t,this.pos),rs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),rs(this.buf,-1&t,this.pos),rs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&Za(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Va(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Va(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&Za(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,Ua.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,Xa,e)},writePackedSVarint:function(t,e){this.writeMessage(t,Wa,e)},writePackedBoolean:function(t,e){this.writeMessage(t,Ka,e)},writePackedFloat:function(t,e){this.writeMessage(t,Ha,e)},writePackedDouble:function(t,e){this.writeMessage(t,Ya,e)},writePackedFixed32:function(t,e){this.writeMessage(t,Ja,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,Qa,e)},writePackedFixed64:function(t,e){this.writeMessage(t,$a,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,ts,e)},writeBytesField:function(t,e){this.writeTag(t,Ua.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ua.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ua.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ua.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ua.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ua.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ua.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ua.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ua.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ua.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var is=3;function os(t,e,r){1===t&&r.readMessage(as,e)}function as(t,e,r){if(3===t){var n=r.readMessage(ss,{}),i=n.id,o=n.bitmap,a=n.width,s=n.height,l=n.left,u=n.top,c=n.advance;e.push({id:i,bitmap:new Li({width:a+2*is,height:s+2*is},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function ss(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}var ls=is,us=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.callbackID=0,f(["receive"],this),this.target.addEventListener("message",this.receive,!1)};function cs(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[t*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}us.prototype.send=function(t,e,r,n){var i=r?this.mapId+":"+this.callbackID++:null;r&&(this.callbacks[i]=r);var o=[];this.target.postMessage({targetMapId:n,sourceMapId:this.mapId,type:t,id:String(i),data:Pr(e,o)},o)},us.prototype.receive=function(t){var e,r=this,n=t.data,i=n.id;if(!n.targetMapId||this.mapId===n.targetMapId){var o=function(t,e){var n=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(i),error:t?Pr(t):null,data:Pr(e,n)},n)};if("<response>"===n.type)e=this.callbacks[n.id],delete this.callbacks[n.id],e&&n.error?e(Cr(n.error)):e&&e(null,Cr(n.data));else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,Cr(n.data),o);else if(void 0!==n.id&&this.parent.getWorkerSource){var a=n.type.split("."),s=Cr(n.data);this.parent.getWorkerSource(n.sourceMapId,a[0],s.source)[a[1]](s,o)}else this.parent[n.type](Cr(n.data))}},us.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var hs=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=fs(0,t,e,r)};hs.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},hs.prototype.url=function(t,e){var r,n,i,o,a,s=(r=this.x,n=this.y,i=this.z,o=cs(256*r,256*(n=Math.pow(2,i)-n-1),i),a=cs(256*(r+1),256*(n+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,r){for(var n,i="",o=t;o>0;o--)i+=(e&(n=1<<o-1)?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)};var ps=function(t,e){this.wrap=t,this.canonical=e,this.key=fs(t,e.z,e.x,e.y)},ds=function(t,e,r,n,i){this.overscaledZ=t,this.wrap=e,this.canonical=new hs(r,+n,+i),this.key=fs(e,t,n,i)};function fs(t,e,r,n){(t*=2)<0&&(t=-1*t-1);var i=1<<e;return 32*(i*i*t+i*n+r)+e}ds.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},ds.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new ds(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ds(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},ds.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},ds.prototype.children=function(t){if(this.overscaledZ>=t)return[new ds(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new ds(e,this.wrap,e,r,n),new ds(e,this.wrap,e,r+1,n),new ds(e,this.wrap,e,r,n+1),new ds(e,this.wrap,e,r+1,n+1)]},ds.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},ds.prototype.wrapped=function(){return new ds(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ds.prototype.unwrapTo=function(t){return new ds(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},ds.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ds.prototype.toUnwrapped=function(){return new ps(this.wrap,this.canonical)},ds.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ds.prototype.toCoordinate=function(){return new i(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},Tr("CanonicalTileID",hs),Tr("OverscaledTileID",ds,{omit:["posMatrix"]});var ms=function(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return b('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var n=this.dim=e.height;this.border=Math.max(Math.ceil(e.height/2),1),this.stride=this.dim+2*this.border,this.data=new Int32Array(this.stride*this.stride);for(var i=e.data,o="terrarium"===r?this._unpackTerrarium:this._unpackMapbox,a=0;a<n;a++)for(var s=0;s<n;s++){var l=4*(a*n+s);this.set(s,a,o(i[l],i[l+1],i[l+2]))}for(var u=0;u<n;u++)this.set(-1,u,this.get(0,u)),this.set(n,u,this.get(n-1,u)),this.set(u,-1,this.get(u,0)),this.set(u,n,this.get(u,n-1));this.set(-1,-1,this.get(0,0)),this.set(n,-1,this.get(n-1,0)),this.set(-1,n,this.get(0,n-1)),this.set(n,n,this.get(n-1,n-1))};ms.prototype.set=function(t,e,r){this.data[this._idx(t,e)]=r+65536},ms.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},ms.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},ms.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},ms.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},ms.prototype.getPixels=function(){return new Ri({width:this.dim+2*this.border,height:this.dim+2*this.border},new Uint8Array(this.data.buffer))},ms.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var n=e*this.dim,i=e*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(e){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}for(var s=c(n,-this.border,this.dim+this.border),l=c(i,-this.border,this.dim+this.border),u=c(o,-this.border,this.dim+this.border),h=c(a,-this.border,this.dim+this.border),p=-e*this.dim,d=-r*this.dim,f=u;f<h;f++)for(var m=s;m<l;m++)this.set(m,f,t.get(m+p,f+d))},Tr("DEMData",ms);var _s=cn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ys=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};ys.prototype.encode=function(t){return this._stringToNumber[t]},ys.prototype.decode=function(t){return this._numberToString[t]};var gs=function(t,e,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=n,this.properties=t.properties,null!=t.id&&(this.id=t.id)},vs={geometry:{configurable:!0}};vs.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},vs.geometry.set=function(t){this._geometry=t},gs.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(gs.prototype,vs);var bs=function(){this.state={},this.stateChanges={}};bs.prototype.updateState=function(t,e,r){e=String(e),this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][e]=this.stateChanges[t][e]||{},h(this.stateChanges[t][e],r)},bs.prototype.getState=function(t,e){e=String(e);var r=this.state[t]||{},n=this.stateChanges[t]||{};return h({},r[e],n[e])},bs.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},bs.prototype.coalesceChanges=function(t,e){var r={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var i={};for(var o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),h(this.state[n][o],this.stateChanges[n][o]),i[o]=this.state[n][o];r[n]=i}if(this.stateChanges={},0!==Object.keys(r).length)for(var a in t)t[a].setFeatureState(r,e)};var xs=function(t,e,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new kr(Jn,16,0),this.featureIndexArray=r||new Nn};function ws(t,e){return e-t}xs.prototype.insert=function(t,e,r,n,i){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);for(var a=0;a<e.length;a++){for(var s=e[a],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<Jn&&l[1]<Jn&&l[2]>=0&&l[3]>=0&&this.grid.insert(o,l[0],l[1],l[2],l[3])}},xs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Zo.VectorTile(new ja(this.rawTileData)).layers,this.sourceLayerCoder=new ys(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},xs.prototype.query=function(t,e,r){var n=this;this.loadVTLayers();for(var i=t.params||{},o=Jn/t.tileSize/t.scale,a=Je(i.filter),s=t.queryGeometry,l=t.queryPadding*o,u=1/0,c=1/0,h=-1/0,p=-1/0,d=0;d<s.length;d++)for(var f=s[d],m=0;m<f.length;m++){var _=f[m];u=Math.min(u,_.x),c=Math.min(c,_.y),h=Math.max(h,_.x),p=Math.max(p,_.y)}var y=this.grid.query(u-l,c-l,h+l,p+l);y.sort(ws);for(var g,v={},b=function(l){var u=y[l];if(u!==g){g=u;var c=n.featureIndexArray.get(u),h=null;n.loadMatchingFeature(v,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,a,i.layers,e,function(e,i){h||(h=$n(e));var a={};return e.id&&(a=r.getState(i.sourceLayer||"_geojsonTileLayer",String(e.id))),i.queryIntersectsFeature(s,e,a,h,n.z,t.transform,o,t.posMatrix)})}},x=0;x<y.length;x++)b(x);return v},xs.prototype.loadMatchingFeature=function(t,e,r,n,i,o,a,s){var l=this.bucketLayerIDs[e];if(!o||function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}(o,l)){var u=this.sourceLayerCoder.decode(r),c=this.vtLayers[u].feature(n);if(i(new Zr(this.tileID.overscaledZ),c))for(var h=0;h<l.length;h++){var p=l[h];if(!(o&&o.indexOf(p)<0)){var d=a[p];if(d&&(!s||s(c,d))){var f=new gs(c,this.z,this.x,this.y);f.layer=d.serialize();var m=t[p];void 0===m&&(m=t[p]=[]),m.push({featureIndex:n,feature:f})}}}}},xs.prototype.lookupSymbolFeatures=function(t,e,r,n,i,o){var a={};this.loadVTLayers();for(var s=Je(n),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(a,e,r,c,s,i,o)}return a},xs.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var n=0,i=r[e];n<i.length;n+=1)if(t===i[n])return!0;return!1},Tr("FeatureIndex",xs,{omit:["rawTileData","sourceLayerCoder"]});var ks=function(t,e){this.tileID=t,this.uid=d(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};ks.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<S.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},ks.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ks.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var n in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var r={};if(!e)return r;for(var n=0,i=t;n<i.length;n+=1){var o=i[n],a=o.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length){o.layers=a,o.stateDependentLayers=a.filter(function(t){return t.isStateDependent()});for(var s=0,l=a;s<l.length;s+=1)r[l[s].id]=o}}return r}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[n];if(i instanceof xa){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(a))}t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Cn},ks.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ks.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},ks.prototype.getBucket=function(t){return this.buckets[t.id]},ks.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var n=t.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new Fa(t,this.iconAtlasImage,n.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Fa(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},ks.prototype.queryRenderedFeatures=function(t,e,r,n,i,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,scale:n,tileSize:this.tileSize,posMatrix:s,transform:o,params:i,queryPadding:this.queryPadding*a},t,e):{}},ks.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var r=this.latestFeatureIndex.loadVTLayers(),n=e?e.sourceLayer:"",i=r._geojsonTileLayer||r[n];if(i)for(var o=Je(e&&e.filter),a=this.tileID.canonical,s=a.z,l=a.x,u=a.y,c={z:s,x:l,y:u},h=0;h<i.length;h++){var p=i.feature(h);if(o(new Zr(this.tileID.overscaledZ),p)){var d=new gs(p,s,l,u);d.tile=c,t.push(d)}}}},ks.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},ks.prototype.setMask=function(t,e){if(!s(this.mask,t)&&(this.mask=t,this.clearMask(),!s(t,{0:!0}))){var r=new dn,n=new Sn;this.segments=new Un,this.segments.prepareSegment(0,r,n);for(var i=Object.keys(t),a=0;a<i.length;a++){var l=t[i[a]],u=Jn>>l.z,c=new o(l.x*u,l.y*u),h=new o(c.x+u,c.y+u),p=this.segments.prepareSegment(4,r,n);r.emplaceBack(c.x,c.y,c.x,c.y),r.emplaceBack(h.x,c.y,h.x,c.y),r.emplaceBack(c.x,h.y,c.x,h.y),r.emplaceBack(h.x,h.y,h.x,h.y);var d=p.vertexLength;n.emplaceBack(d,d+1,d+2),n.emplaceBack(d+1,d+2,d+3),p.vertexLength+=4,p.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(r,_s.members),this.maskedIndexBuffer=e.createIndexBuffer(n)}},ks.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ks.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,r,n,i){var o=n||i;return e[r]=!o||o.toLowerCase(),""}),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var n=Date.now(),i=!1;if(this.expirationTime>n)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=n+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ks.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ks.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var r=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets){var i=this.buckets[n],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=r[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(n).queryRadius(i))))}}},ks.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ks.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<S.now()},ks.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ks.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=S.now()+t};var Es={horizontal:1,vertical:2,horizontalOnly:3},Is=function(){this.text="",this.sectionIndex=[],this.sections=[]};Is.fromFeature=function(t,e){var r=new Is;if(t instanceof ht)for(var n=0;n<t.sections.length;n++){var i=t.sections[n];r.sections.push({scale:i.scale||1,fontStack:i.fontStack||e}),r.text+=i.text;for(var o=0;o<i.text.length;o++)r.sectionIndex.push(n)}else{r.text=t,r.sections.push({scale:1,fontStack:e});for(var a=0;a<t.length;a++)r.sectionIndex.push(0)}return r},Is.prototype.length=function(){return this.text.length},Is.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Is.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Is.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;n&&Or(n)&&!pa[t[r+1]]||i&&Or(i)&&!pa[t[r-1]]||!pa[t[r]]?e+=t[r]:e+=pa[t[r]]}return e}(this.text)},Is.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Ss[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=t&&Ss[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},Is.prototype.substring=function(t,e){var r=new Is;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},Is.prototype.toString=function(){return this.text},Is.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)};var Ss={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ms={};function Ts(t,e,r,n){var i=Math.pow(t-e,2);return n?t<e?i/2:2*i:i+Math.abs(r)*r}function As(t,e){var r=0;return 10===t&&(r-=1e4),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Ps(t,e,r,n,i,o){for(var a=null,s=Ts(e,r,i,o),l=0,u=n;l<u.length;l+=1){var c=u[l],h=Ts(e-c.x,r,i,o)+c.badness;h<=s&&(a=c,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function Cs(t,e,r,n){if(!r)return[];if(!t)return[];for(var i,o=[],a=function(t,e,r,n){for(var i=0,o=0;o<t.length();o++){var a=t.getSection(o),s=n[a.fontStack],l=s&&s[t.getCharCode(o)];l&&(i+=l.metrics.advance*a.scale+e)}return i/Math.max(1,Math.ceil(i/r))}(t,e,r,n),s=0,l=0;l<t.length();l++){var u=t.getSection(l),c=t.getCharCode(l),h=n[u.fontStack],p=h&&h[c];p&&!Ss[c]&&(s+=p.metrics.advance*u.scale+e),l<t.length()-1&&(Ms[c]||!((i=c)<11904)&&(zr["Bopomofo Extended"](i)||zr.Bopomofo(i)||zr["CJK Compatibility Forms"](i)||zr["CJK Compatibility Ideographs"](i)||zr["CJK Compatibility"](i)||zr["CJK Radicals Supplement"](i)||zr["CJK Strokes"](i)||zr["CJK Symbols and Punctuation"](i)||zr["CJK Unified Ideographs Extension A"](i)||zr["CJK Unified Ideographs"](i)||zr["Enclosed CJK Letters and Months"](i)||zr["Halfwidth and Fullwidth Forms"](i)||zr.Hiragana(i)||zr["Ideographic Description Characters"](i)||zr["Kangxi Radicals"](i)||zr["Katakana Phonetic Extensions"](i)||zr.Katakana(i)||zr["Vertical Forms"](i)||zr["Yi Radicals"](i)||zr["Yi Syllables"](i)))&&o.push(Ps(l+1,s,a,o,As(c,t.getCharCode(l+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Ps(t.length(),s,a,o,0,!0))}function Ds(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function zs(t,e,r,n,i){if(i){var o=t[n],a=e[o.fontStack],s=a&&a[o.glyph];if(s)for(var l=s.metrics.advance*o.scale,u=(t[n].x+l)*i,c=r;c<=n;c++)t[c].x-=u}}Ms[10]=!0,Ms[32]=!0,Ms[38]=!0,Ms[40]=!0,Ms[41]=!0,Ms[43]=!0,Ms[45]=!0,Ms[47]=!0,Ms[173]=!0,Ms[183]=!0,Ms[8203]=!0,Ms[8208]=!0,Ms[8211]=!0,Ms[8231]=!0,t.createCommonjsModule=e,t.Point=o,t.window=self,t.browser=S,t.uuid=function(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()},t.validateUuid=function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},t.storageAvailable=function(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}},t.warnOnce=b,t.postData=function(t,e,r){var n=P(h(t,{method:"POST"}));return n.onerror=function(){r(new Error(n.statusText))},n.onload=function(){n.status>=200&&n.status<300?r(null,n.response):r(new A(n.statusText,n.status,t.url))},n.send(e),{cancel:function(){return n.abort()}}},t.getJSON=function(t,e){var r=P(t);return r.setRequestHeader("Accept","application/json"),r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){if(r.status>=200&&r.status<300&&r.response){var n;try{n=JSON.parse(r.response)}catch(t){return e(t)}e(null,n)}else 401===r.status&&t.url.match(/mapbox.com/)?e(new A(r.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",r.status,t.url)):e(new A(r.statusText,r.status,t.url))},r.send(),{cancel:function(){return r.abort()}}},t.getImage=function(t,e){return C(t,function(t,r){if(t)e(t);else if(r){var n=new self.Image,i=self.URL||self.webkitURL;n.onload=function(){e(null,n),i.revokeObjectURL(n.src)};var o=new self.Blob([new Uint8Array(r.data)],{type:"image/png"});n.cacheControl=r.cacheControl,n.expires=r.expires,n.src=r.data.byteLength?i.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},t.ResourceType=T,t.RGBAImage=Ri,t.ShelfPack=Aa,t.ImagePosition=Ca,t.Texture=Fa,t.getArrayBuffer=C,t.parseGlyphPBF=function(t){return new ja(t).readFields(os,[])},t.isChar=zr,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--n&&r(o,i)})})},t.AlphaImage=Li,t.styleSpec=O,t.endsWith=m,t.extend=h,t.sphericalToCartesian=function(t){var e=t[0],r=t[1],n=t[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(n),y:e*Math.sin(r)*Math.sin(n),z:e*Math.cos(n)}},t.Evented=R,t.validateStyle=gr,t.validateLight=vr,t.emitValidationErrors=wr,t.Color=ot,t.number=zt,t.Properties=on,t.Transitionable=Hr,t.Transitioning=Kr,t.PossiblyEvaluated=$r,t.DataConstantProperty=tn,t.uniqueId=d,t.Actor=us,t.pick=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n];i in t&&(r[i]=t[i])}return r},t.wrap=function(t,e,r){var n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i},t.clamp=c,t.Event=B,t.ErrorEvent=L,t.OverscaledTileID=ds,t.EXTENT=Jn,t.getCoordinatesCenter=function(t){for(var e=1/0,r=1/0,n=-1/0,o=-1/0,a=0;a<t.length;a++)e=Math.min(e,t[a].column),r=Math.min(r,t[a].row),n=Math.max(n,t[a].column),o=Math.max(o,t[a].row);var s=n-e,l=o-r,u=Math.max(s,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new i((e+n)/2,(r+o)/2,0).zoomTo(c)},t.CanonicalTileID=hs,t.StructArrayLayout4i8=dn,t.rasterBoundsAttributes=_s,t.getVideo=function(t,e){var r,n,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");r=t[o],n=void 0,(n=self.document.createElement("a")).href=r,(n.protocol!==self.document.location.protocol||n.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=t[o],i.appendChild(a)}return{cancel:function(){}}},t.ValidationError=F,t.bindAll=f,t.deepEqual=s,t.Tile=ks,t.Coordinate=i,t.keysDifference=function(t,e){var r=[];for(var n in t)n in e||r.push(n);return r},t.SourceFeatureState=bs,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.create=function(){var t=new _i(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],_=e[14],y=e[15],g=r*s-n*a,v=r*l-i*a,b=r*u-o*a,x=n*l-i*s,w=n*u-o*s,k=i*u-o*l,E=c*m-h*f,I=c*_-p*f,S=c*y-d*f,M=h*_-p*m,T=h*y-d*m,A=p*y-d*_,P=g*A-v*T+b*M+x*S-w*I+k*E;return P?(P=1/P,t[0]=(s*A-l*T+u*M)*P,t[1]=(i*T-n*A-o*M)*P,t[2]=(m*k-_*w+y*x)*P,t[3]=(p*w-h*k-d*x)*P,t[4]=(l*S-a*A-u*I)*P,t[5]=(r*A-i*S+o*I)*P,t[6]=(_*b-f*k-y*v)*P,t[7]=(c*k-p*b+d*v)*P,t[8]=(a*T-s*S+u*E)*P,t[9]=(n*S-r*T-o*E)*P,t[10]=(f*w-m*b+y*g)*P,t[11]=(h*b-c*w-d*g)*P,t[12]=(s*I-a*M-l*E)*P,t[13]=(r*M-n*I+i*E)*P,t[14]=(m*v-f*x-_*g)*P,t[15]=(c*x-h*v+p*g)*P,t):null},t.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],m=e[12],_=e[13],y=e[14],g=e[15],v=r[0],b=r[1],x=r[2],w=r[3];return t[0]=v*n+b*s+x*h+w*m,t[1]=v*i+b*l+x*p+w*_,t[2]=v*o+b*u+x*d+w*y,t[3]=v*a+b*c+x*f+w*g,v=r[4],b=r[5],x=r[6],w=r[7],t[4]=v*n+b*s+x*h+w*m,t[5]=v*i+b*l+x*p+w*_,t[6]=v*o+b*u+x*d+w*y,t[7]=v*a+b*c+x*f+w*g,v=r[8],b=r[9],x=r[10],w=r[11],t[8]=v*n+b*s+x*h+w*m,t[9]=v*i+b*l+x*p+w*_,t[10]=v*o+b*u+x*d+w*y,t[11]=v*a+b*c+x*f+w*g,v=r[12],b=r[13],x=r[14],w=r[15],t[12]=v*n+b*s+x*h+w*m,t[13]=v*i+b*l+x*p+w*_,t[14]=v*o+b*u+x*d+w*y,t[15]=v*a+b*c+x*f+w*g,t},t.translate=function(t,e,r){var n,i,o,a,s,l,u,c,h,p,d,f,m=r[0],_=r[1],y=r[2];return e===t?(t[12]=e[0]*m+e[4]*_+e[8]*y+e[12],t[13]=e[1]*m+e[5]*_+e[9]*y+e[13],t[14]=e[2]*m+e[6]*_+e[10]*y+e[14],t[15]=e[3]*m+e[7]*_+e[11]*y+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=n*m+s*_+h*y+e[12],t[13]=i*m+l*_+p*y+e[13],t[14]=o*m+u*_+d*y+e[14],t[15]=a*m+c*_+f*y+e[15]),t},t.scale=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*n,t[5]=a*i+c*n,t[6]=s*i+h*n,t[7]=l*i+p*n,t[8]=u*i-o*n,t[9]=c*i-a*n,t[10]=h*i-s*n,t[11]=p*i-l*n,t},t.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*n,t[1]=a*i+c*n,t[2]=s*i+h*n,t[3]=l*i+p*n,t[4]=u*i-o*n,t[5]=c*i-a*n,t[6]=h*i-s*n,t[7]=p*i-l*n,t},t.perspective=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*a,t[15]=0,t},t.ortho=function(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*u,t[15]=1,t},t.create$1=Ei,t.normalize=Ii,t.transformMat4=Si,t.forEach=Mi,t.getSizeData=fa,t.evaluateSizeForFeature=function(t,e,r){var n=e;return"source"===t.functionType?r.lowerSize/10:"composite"===t.functionType?zt(r.lowerSize/10,r.upperSize/10,n.uSizeT):n.uSize},t.evaluateSizeForZoom=function(t,e,r){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var n=t.propertyValue,i=t.zoomRange,o=t.sizeRange,a=c(Ue(n,r.specification).interpolationFactor(e,i.min,i.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var s=t.propertyValue,l=t.zoomRange;return{uSizeT:c(Ue(s,r.specification).interpolationFactor(e,l.min,l.max),0,1),uSize:0}},t.addDynamicAttributes=ga,t.properties=ka,t.WritingMode=Es,t.multiPolygonIntersectsBufferedPoint=ri,t.multiPolygonIntersectsMultiPolygon=ni,t.multiPolygonIntersectsBufferedMultiLine=ii,t.polygonIntersectsPolygon=function(t,e){for(var r=0;r<t.length;r++)if(hi(e,t[r]))return!0;for(var n=0;n<e.length;n++)if(hi(t,e[n]))return!0;return!!ai(t,e)},t.distToSegmentSquared=ui,t.StyleLayer=an,t.createStyleLayer=function(t){return new Ta[t.type](t)},t.clone=g,t.filterObject=y,t.mapObject=_,t.registerForPluginAvailability=function(t){return jr?t({pluginURL:jr,completionCallback:Nr}):qr.once("pluginAvailable",t),t},t.evented=qr,t.ZoomHistory=Dr,t.createLayout=cn,t.ProgramConfiguration=Hn,t.create$2=yi,t.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.create$3=gi,t.length=vi,t.fromValues=bi,t.normalize$1=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2];return t[0]=i*l-o*s,t[1]=o*a-n*l,t[2]=n*s-i*a,t},t.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},t.len=wi,t.forEach$1=ki,t.StructArrayLayout2i4=pn,t.UnwrappedTileID=ps,t.create$4=function(){var t=new _i(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},t.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*s,t[1]=i*l+a*s,t[2]=n*-s+o*l,t[3]=i*-s+a*l,t},t.ease=u,t.bezier=l,t.EvaluationParameters=Zr,t.setRTLTextPlugin=function(t,e){if(Vr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Vr=!0,jr=S.resolveURL(t),Nr=function(t){t?(Vr=!1,jr=null,e&&e(t)):Ur=!0},qr.fire(new B("pluginAvailable",{pluginURL:jr,completionCallback:Nr}))},t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.featureFilter=Je,t.Anchor=da,t.register=Tr,t.GLYPH_PBF_BORDER=ls,t.shapeText=function(t,e,r,n,i,o,a,s,l,u,c){var h=Is.fromFeature(t,r);c===Es.vertical&&h.verticalizePunctuation();var p,d=[],f={positionedGlyphs:d,text:h,top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:c},m=Gr.processBidirectionalText,_=Gr.processStyledBidirectionalText;if(m&&1===h.sections.length){p=[];for(var y=0,g=m(h.toString(),Cs(h,s,n,e));y<g.length;y+=1){var v=g[y],b=new Is;b.text=v,b.sections=h.sections;for(var x=0;x<v.length;x++)b.sectionIndex.push(0);p.push(b)}}else if(_){p=[];for(var w=0,k=_(h.text,h.sectionIndex,Cs(h,s,n,e));w<k.length;w+=1){var E=k[w],I=new Is;I.text=E[0],I.sectionIndex=E[1],I.sections=h.sections,p.push(I)}}else p=function(t,e){for(var r=[],n=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];r.push(t.substring(i,s)),i=s}return i<n.length&&r.push(t.substring(i,n.length)),r}(h,Cs(h,s,n,e));return function(t,e,r,n,i,o,a,s,l){for(var u=0,c=-17,h=0,p=t.positionedGlyphs,d="right"===o?1:"left"===o?0:.5,f=0,m=r;f<m.length;f+=1){var _=m[f];_.trim();var y=_.getMaxScale();if(_.length()){for(var g=p.length,v=0;v<_.length();v++){var b=_.getSection(v),x=_.getCharCode(v),w=24*(y-b.scale),k=e[b.fontStack],E=k&&k[x];E&&(Rr(x)&&a!==Es.horizontal?(p.push({glyph:x,x:u,y:w,vertical:!0,scale:b.scale,fontStack:b.fontStack}),u+=l*b.scale+s):(p.push({glyph:x,x:u,y:c+w,vertical:!1,scale:b.scale,fontStack:b.fontStack}),u+=E.metrics.advance*b.scale+s))}if(p.length!==g){var I=u-s;h=Math.max(I,h),zs(p,e,g,p.length-1,d)}u=0,c+=n*y}else c+=n}var S=Ds(i),M=S.horizontalAlign,T=S.verticalAlign;!function(t,e,r,n,i,o,a){for(var s=(e-r)*i,l=(-n*a+.5)*o,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l}(p,d,M,T,h,n,r.length);var A=c- -17;t.top+=-T*A,t.bottom=t.top+A,t.left+=-M*h,t.right=t.left+h}(f,e,p,i,o,a,c,s,u),!!d.length&&(f.text=f.text.toString(),f)},t.shapeIcon=function(t,e,r){var n=Ds(r),i=n.horizontalAlign,o=n.verticalAlign,a=e[0],s=e[1],l=a-t.displaySize[0]*i,u=l+t.displaySize[0],c=s-t.displaySize[1]*o;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:u}},t.allowsVerticalWritingMode=Br,t.allowsLetterSpacing=function(t){for(var e=0,r=t;e<r.length;e+=1)if(!Lr(r[e].charCodeAt(0)))return!1;return!0},t.classifyRings=xo,t.SymbolBucket=xa,t.Formatted=ht,t.FeatureIndex=xs,t.CollisionBoxArray=Cn,t.DictionaryCoder=ys,t.ImageAtlas=za,t.mvt=Zo,t.Protobuf=ja,t.DEMData=ms,t.vectorTile=Zo,t.Point$1=o,t.pbf=ja,t.plugin=Gr}),n(0,function(t){function e(t){var r=typeof t;if("number"===r||"boolean"===r||"string"===r||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var n="[",i=0,o=t;i<o.length;i+=1)n+=e(o[i])+",";return n+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function r(r){for(var n="",i=0,o=t.refProperties;i<o.length;i+=1)n+="/"+e(r[o[i]]);return n}var n=function(t){t&&this.replace(t)};function i(t,e,r,n,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-r/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<r/2;){var c=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var d=c.angleTo(h)-h.angleTo(p);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:d}),u+=d;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=h.dist(p)}return!0}function o(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function a(t,e,r){return t?.6*e*r:0}function s(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function l(e,r,n,l,u,c){for(var h=a(n,u,c),p=s(n,l)*c,d=0,f=o(e)/2,m=0;m<e.length-1;m++){var _=e[m],y=e[m+1],g=_.dist(y);if(d+g>f){var v=(f-d)/g,b=t.number(_.x,y.x,v),x=t.number(_.y,y.y,v),w=new t.Anchor(b,x,y.angleTo(_),m);return w._round(),!h||i(e,w,p,h,r)?w:void 0}d+=g}}function u(e,r,n,l,u,c,h,p,d){var f=a(l,c,h),m=s(l,u),_=m*h,y=0===e[0].x||e[0].x===d||0===e[0].y||e[0].y===d;return r-_<r/4&&(r=_+r/4),function e(r,n,a,s,l,u,c,h,p){for(var d=u/2,f=o(r),m=0,_=n-a,y=[],g=0;g<r.length-1;g++){for(var v=r[g],b=r[g+1],x=v.dist(b),w=b.angleTo(v);_+a<m+x;){var k=((_+=a)-m)/x,E=t.number(v.x,b.x,k),I=t.number(v.y,b.y,k);if(E>=0&&E<p&&I>=0&&I<p&&_-d>=0&&_+d<=f){var S=new t.Anchor(E,I,w,g);S._round(),s&&!i(r,S,u,s,l)||y.push(S)}}m+=x}return h||y.length||c||(y=e(r,m/2,a,s,l,u,c,!0,p)),y}(e,y?r/2*p%r:(m/2+2*c)*h*p%r,r,f,n,_,y,!1,d)}n.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},n.prototype.update=function(e,n){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];i._layerConfigs[s.id]=s;var l=i._layers[s.id]=t.createStyleLayer(s);l._featureFilter=t.featureFilter(l.filter)}for(var u=0,c=n;u<c.length;u+=1){var h=c[u];delete i._layerConfigs[h],delete i._layers[h]}this.familiesBySource={};for(var p=0,d=function(t){for(var e={},n=0;n<t.length;n++){var i=r(t[n]),o=e[i];o||(o=e[i]=[]),o.push(t[n])}var a=[];for(var s in e)a.push(e[s]);return a}(t.values(this._layerConfigs));p<d.length;p+=1){var f=d[p].map(function(t){return i._layers[t.id]}),m=f[0];if("none"!==m.visibility){var _=m.source||"",y=i.familiesBySource[_];y||(y=i.familiesBySource[_]={});var g=m.sourceLayer||"_geojsonTileLayer",v=y[g];v||(v=y[g]=[]),v.push(f)}}};var c=function(){this.opacity=0,this.targetOpacity=0,this.time=0};c.prototype.clone=function(){var t=new c;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},t.register("OpacityState",c);var h=function(e,r,n,i,o,a,s,l,u,c,h,p){var d=s.top*l-u,f=s.bottom*l+u,m=s.left*l-u,_=s.right*l+u;if(this.boxStartIndex=e.length,c){var y=f-d,g=_-m;y>0&&(y=Math.max(10*l,y),this._addLineCollisionCircles(e,r,n,n.segment,g,y,i,o,a,h))}else{if(p){var v=new t.Point(m,d),b=new t.Point(_,d),x=new t.Point(m,f),w=new t.Point(_,f),k=p*Math.PI/180;v._rotate(k),b._rotate(k),x._rotate(k),w._rotate(k),m=Math.min(v.x,b.x,x.x,w.x),_=Math.max(v.x,b.x,x.x,w.x),d=Math.min(v.y,b.y,x.y,w.y),f=Math.max(v.y,b.y,x.y,w.y)}e.emplaceBack(n.x,n.y,m,d,_,f,i,o,a,0,0)}this.boxEndIndex=e.length};h.prototype._addLineCollisionCircles=function(t,e,r,n,i,o,a,s,l,u){var c=o/2,h=Math.floor(i/c)||1,p=1+.4*Math.log(u)/Math.LN2,d=Math.floor(h*p/2),f=-o/2,m=r,_=n+1,y=f,g=-i/2,v=g-i/4;do{if(--_<0){if(y>g)return;_=0;break}y-=e[_].dist(m),m=e[_]}while(y>v);for(var b=e[_].dist(e[_+1]),x=-d;x<h+d;x++){var w=x*c,k=g+w;if(w<0&&(k+=w),w>i&&(k+=w-i),!(k<y)){for(;y+b<k;){if(y+=b,++_+1>=e.length)return;b=e[_].dist(e[_+1])}var E=k-y,I=e[_],S=e[_+1].sub(I)._unit()._mult(E)._add(I)._round(),M=Math.abs(k-f)<c?0:.8*(k-f);t.emplaceBack(S.x,S.y,-o/2,-o/2,o/2,o/2,a,s,l,o/2,M)}}};var p=f,d=f;function f(t,e){if(!(this instanceof f))return new f(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||m,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function m(t,e){return t<e?-1:t>e?1:0}function _(e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,l=e[0],u=0;u<l.length;u++){var c=l[u];(!u||c.x<i)&&(i=c.x),(!u||c.y<o)&&(o=c.y),(!u||c.x>a)&&(a=c.x),(!u||c.y>s)&&(s=c.y)}var h=a-i,d=s-o,f=Math.min(h,d),m=f/2,_=new p(null,y);if(0===f)return new t.Point(i,o);for(var v=i;v<a;v+=f)for(var b=o;b<s;b+=f)_.push(new g(v+m,b+m,m,e));for(var x=function(t){for(var e=0,r=0,n=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=3*c}return new g(r/e,n/e,0,t)}(e),w=_.length;_.length;){var k=_.pop();(k.d>x.d||!x.d)&&(x=k,n&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,w)),k.max-x.d<=r||(m=k.h/2,_.push(new g(k.p.x-m,k.p.y-m,m,e)),_.push(new g(k.p.x+m,k.p.y-m,m,e)),_.push(new g(k.p.x-m,k.p.y+m,m,e)),_.push(new g(k.p.x+m,k.p.y+m,m,e)),w+=4)}return n&&(console.log("num probes: "+w),console.log("best distance: "+x.d)),x.p}function y(t,e){return e.max-t.max}function g(e,r,n,i){this.p=new t.Point(e,r),this.h=n,this.d=function(e,r){for(var n=!1,i=1/0,o=0;o<r.length;o++)for(var a=r[o],s=0,l=a.length,u=l-1;s<l;u=s++){var c=a[s],h=a[u];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(n=!n),i=Math.min(i,t.distToSegmentSquared(e,c,h))}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}function v(e,r,n,i,o,a){e.createArrays(),e.symbolInstances=[];var s=512*e.overscaling;e.tilePixelRatio=t.EXTENT/s,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var h=e.textSizeData.zoomRange,p=h.min,d=h.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new t.EvaluationParameters(p)),u["text-size"].possiblyEvaluate(new t.EvaluationParameters(d))]}if("composite"===e.iconSizeData.functionType){var f=e.iconSizeData.zoomRange,m=f.min,_=f.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(m)),u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(_))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new t.EvaluationParameters(18));for(var y=24*l.get("text-line-height"),g="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),v=l.get("text-keep-upright"),x=0,w=e.features;x<w.length;x+=1){var k=w[x],E=l.get("text-font").evaluate(k,{}).join(","),I=n,S={},M=k.text;if(M){var T=M instanceof t.Formatted?M.toString():M,A=l.get("text-offset").evaluate(k,{}).map(function(t){return 24*t}),P=24*l.get("text-letter-spacing").evaluate(k,{}),C=t.allowsLetterSpacing(T)?P:0,D=l.get("text-anchor").evaluate(k,{}),z=l.get("text-justify").evaluate(k,{}),B="point"===l.get("symbol-placement")?24*l.get("text-max-width").evaluate(k,{}):0;S.horizontal=t.shapeText(M,r,E,B,y,D,z,C,A,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(T)&&g&&v&&(S.vertical=t.shapeText(M,r,E,B,y,D,z,C,A,24,t.WritingMode.vertical))}var L=void 0;if(k.icon){var R=i[k.icon];R&&(L=t.shapeIcon(o[k.icon],l.get("icon-offset").evaluate(k,{}),l.get("icon-anchor").evaluate(k,{})),void 0===e.sdfIcons?e.sdfIcons=R.sdf:e.sdfIcons!==R.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),R.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(S.horizontal||L)&&b(e,k,S,L,I,c)}a&&e.generateCollisionDebugBuffers()}function b(e,r,n,i,o,a){var s=a.layoutTextSize.evaluate(r,{}),p=a.layoutIconSize.evaluate(r,{}),d=a.textMaxSize.evaluate(r,{});void 0===d&&(d=s);var f=e.layers[0].layout,m=f.get("text-offset").evaluate(r,{}),y=f.get("icon-offset").evaluate(r,{}),g=s/24,v=e.tilePixelRatio*g,b=e.tilePixelRatio*d/24,k=e.tilePixelRatio*p,E=e.tilePixelRatio*f.get("symbol-spacing"),I=f.get("text-padding")*e.tilePixelRatio,S=f.get("icon-padding")*e.tilePixelRatio,M=f.get("text-max-angle")/180*Math.PI,T="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),A="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),P=f.get("symbol-placement"),C=E/2,D=function(s,l){l.x<0||l.x>=t.EXTENT||l.y<0||l.y>=t.EXTENT||e.symbolInstances.push(function(e,r,n,i,o,a,s,l,u,p,d,f,m,_,y,g,v,b,w,k,E){var I,S,M=e.addToLineVertexArray(r,n),T=0,A=0,P=0,C=i.horizontal?i.horizontal.text:"",D=[];if(i.horizontal){var z=a.layout.get("text-rotate").evaluate(w,{});I=new h(s,n,r,l,u,p,i.horizontal,d,f,m,e.overscaling,z),A+=x(e,r,i.horizontal,a,m,w,_,M,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,D,k,E),i.vertical&&(P+=x(e,r,i.vertical,a,m,w,_,M,t.WritingMode.vertical,D,k,E))}var B=I?I.boxStartIndex:e.collisionBoxArray.length,L=I?I.boxEndIndex:e.collisionBoxArray.length;if(o){var R=function(e,r,n,i,o,a){var s,l,u,c,h=r.image,p=n.layout,d=r.top-1/h.pixelRatio,f=r.left-1/h.pixelRatio,m=r.bottom+1/h.pixelRatio,_=r.right+1/h.pixelRatio;if("none"!==p.get("icon-text-fit")&&o){var y=_-f,g=m-d,v=p.get("text-size").evaluate(a,{})/24,b=o.left*v,x=o.right*v,w=o.top*v,k=x-b,E=o.bottom*v-w,I=p.get("icon-text-fit-padding")[0],S=p.get("icon-text-fit-padding")[1],M=p.get("icon-text-fit-padding")[2],T=p.get("icon-text-fit-padding")[3],A="width"===p.get("icon-text-fit")?.5*(E-g):0,P="height"===p.get("icon-text-fit")?.5*(k-y):0,C="width"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?k:y,D="height"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?E:g;s=new t.Point(b+P-T,w+A-I),l=new t.Point(b+P+S+C,w+A-I),u=new t.Point(b+P+S+C,w+A+M+D),c=new t.Point(b+P-T,w+A+M+D)}else s=new t.Point(f,d),l=new t.Point(_,d),u=new t.Point(_,m),c=new t.Point(f,m);var z=n.layout.get("icon-rotate").evaluate(a,{})*Math.PI/180;if(z){var B=Math.sin(z),L=Math.cos(z),R=[L,-B,B,L];s._matMult(R),l._matMult(R),c._matMult(R),u._matMult(R)}return[{tl:s,tr:l,bl:c,br:u,tex:h.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,o,a,0,i.horizontal,w),O=a.layout.get("icon-rotate").evaluate(w,{});S=new h(s,n,r,l,u,p,o,y,g,!1,e.overscaling,O),T=4*R.length;var F=e.iconSizeData,N=null;"source"===F.functionType?N=[10*a.layout.get("icon-size").evaluate(w,{})]:"composite"===F.functionType&&(N=[10*E.compositeIconSizes[0].evaluate(w,{}),10*E.compositeIconSizes[1].evaluate(w,{})]),e.addSymbols(e.icon,R,N,b,v,w,!1,r,M.lineStartIndex,M.lineLength)}var V=S?S.boxStartIndex:e.collisionBoxArray.length,j=S?S.boxEndIndex:e.collisionBoxArray.length;return e.glyphOffsetArray.length>=t.SymbolBucket.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),{key:C,textBoxStartIndex:B,textBoxEndIndex:L,iconBoxStartIndex:V,iconBoxEndIndex:j,textOffset:_,iconOffset:b,anchor:r,line:n,featureIndex:l,numGlyphVertices:A,numVerticalGlyphVertices:P,numIconVertices:T,textOpacityState:new c,iconOpacityState:new c,isDuplicate:!1,placedTextSymbolIndices:D,crossTileID:0}}(e,l,s,n,i,e.layers[0],e.collisionBoxArray,r.index,r.sourceLayerIndex,e.index,v,I,T,m,k,S,A,y,r,o,a))};if("line"===P)for(var z=0,B=function(e,r,n,i,o){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var h=l[c],p=l[c+1];h.x<0&&p.x<0||(h.x<0?h=new t.Point(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round():p.x<0&&(p=new t.Point(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round()),h.y<0&&p.y<0||(h.y<0?h=new t.Point(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round():p.y<0&&(p=new t.Point(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round()),h.x>=i&&p.x>=i||(h.x>=i?h=new t.Point(i,h.y+(p.y-h.y)*((i-h.x)/(p.x-h.x)))._round():p.x>=i&&(p=new t.Point(i,h.y+(p.y-h.y)*((i-h.x)/(p.x-h.x)))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new t.Point(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round():p.y>=o&&(p=new t.Point(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(p)))))}return a}(r.geometry,0,0,t.EXTENT,t.EXTENT);z<B.length;z+=1)for(var L=B[z],R=0,O=u(L,E,M,n.vertical||n.horizontal,i,24,b,e.overscaling,t.EXTENT);R<O.length;R+=1){var F=O[R],N=n.horizontal;N&&w(e,N.text,C,F)||D(L,F)}else if("line-center"===P)for(var V=0,j=r.geometry;V<j.length;V+=1){var U=j[V];if(U.length>1){var q=l(U,M,n.vertical||n.horizontal,i,24,b);q&&D(U,q)}}else if("Polygon"===r.type)for(var G=0,Z=t.classifyRings(r.geometry,0);G<Z.length;G+=1){var X=Z[G],W=_(X,16);D(X[0],new t.Anchor(W.x,W.y,0))}else if("LineString"===r.type)for(var H=0,Y=r.geometry;H<Y.length;H+=1){var K=Y[H];D(K,new t.Anchor(K[0].x,K[0].y,0))}else if("Point"===r.type)for(var J=0,Q=r.geometry;J<Q.length;J+=1)for(var $=0,tt=Q[J];$<tt.length;$+=1){var et=tt[$];D([et],new t.Anchor(et.x,et.y,0))}}function x(e,r,n,i,o,a,s,l,u,c,h,p){var d=function(e,r,n,i,o,a){for(var s=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,l=n.layout.get("text-offset").evaluate(o,{}).map(function(t){return 24*t}),u=r.positionedGlyphs,c=[],h=0;h<u.length;h++){var p=u[h],d=a[p.fontStack],f=d&&d[p.glyph];if(f){var m=f.rect;if(m){var _=t.GLYPH_PBF_BORDER+1,y=f.metrics.advance*p.scale/2,g=i?[p.x+y,p.y]:[0,0],v=i?[0,0]:[p.x+y+l[0],p.y+l[1]],b=(f.metrics.left-_)*p.scale-y+v[0],x=(-f.metrics.top-_)*p.scale+v[1],w=b+m.w*p.scale,k=x+m.h*p.scale,E=new t.Point(b,x),I=new t.Point(w,x),S=new t.Point(b,k),M=new t.Point(w,k);if(i&&p.vertical){var T=new t.Point(-y,y),A=-Math.PI/2,P=new t.Point(5,0);E._rotateAround(A,T)._add(P),I._rotateAround(A,T)._add(P),S._rotateAround(A,T)._add(P),M._rotateAround(A,T)._add(P)}if(s){var C=Math.sin(s),D=Math.cos(s),z=[D,-C,C,D];E._matMult(z),I._matMult(z),S._matMult(z),M._matMult(z)}c.push({tl:E,tr:I,bl:S,br:M,tex:m,writingMode:r.writingMode,glyphOffset:g})}}}return c}(0,n,i,o,a,h),f=e.textSizeData,m=null;return"source"===f.functionType?m=[10*i.layout.get("text-size").evaluate(a,{})]:"composite"===f.functionType&&(m=[10*p.compositeTextSizes[0].evaluate(a,{}),10*p.compositeTextSizes[1].evaluate(a,{})]),e.addSymbols(e.text,d,m,s,o,a,u,r,l.lineStartIndex,l.lineLength),c.push(e.text.placedSymbolArray.length-1),4*d.length}function w(t,e,r,n){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}else i[e]=[];return i[e].push(n),!1}f.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var i=t-1>>1,o=e[i];if(r(n,o)>=0)break;e[t]=o,t=i}e[t]=n},_down:function(t){for(var e=this.data,r=this.compare,n=this.length>>1,i=e[t];t<n;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&r(e[a],s)<0&&(o=a,s=e[a]),r(s,i)>=0)break;e[t]=s,t=o}e[t]=i}},p.default=d;var k=function(e){var r={},n=new t.ShelfPack(0,0,{autoResize:!0}),i=[];for(var o in e){var a=e[o],s=r[o]={};for(var l in a){var u=a[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};i.push(c),s[l]={rect:c,metrics:u.metrics}}}}n.pack(i,{inPlace:!0});var h=new t.AlphaImage({width:n.w,height:n.h});for(var p in e){var d=e[p];for(var f in d){var m=d[+f];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var _=r[p][f].rect;t.AlphaImage.copy(m.bitmap,h,{x:0,y:0},{x:_.x+1,y:_.y+1},m.bitmap)}}}this.image=h,this.positions=r};t.register("GlyphAtlas",k);var E=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};function I(e,r){for(var n=new t.EvaluationParameters(r),i=0,o=e;i<o.length;i+=1)o[i].recalculate(n)}E.prototype.parse=function(e,r,n,i){var o=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var a=new t.DictionaryCoder(Object.keys(e.layers).sort()),s=new t.FeatureIndex(this.tileID);s.bucketLayerIDs=[];var l,u,c,h={},p={featureIndex:s,iconDependencies:{},glyphDependencies:{}},d=r.familiesBySource[this.source];for(var f in d){var m=e.layers[f];if(m){1===m.version&&t.warnOnce('Vector tile source "'+o.source+'" layer "'+f+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var _=a.encode(f),y=[],g=0;g<m.length;g++){var b=m.feature(g);y.push({feature:b,index:g,sourceLayerIndex:_})}for(var x=0,w=d[f];x<w.length;x+=1){var E=w[x],S=E[0];S.minzoom&&o.zoom<Math.floor(S.minzoom)||S.maxzoom&&o.zoom>=S.maxzoom||"none"!==S.visibility&&(I(E,o.zoom),(h[S.id]=S.createBucket({index:s.bucketLayerIDs.length,layers:E,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:_,sourceID:o.source})).populate(y,p),s.bucketLayerIDs.push(E.map(function(t){return t.id})))}}}var M=t.mapObject(p.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(M).length?n.send("getGlyphs",{uid:this.uid,stacks:M},function(t,e){l||(l=t,u=e,A.call(o))}):u={};var T=Object.keys(p.iconDependencies);function A(){if(l)return i(l);if(u&&c){var e=new k(u),r=new t.ImageAtlas(c);for(var n in h){var o=h[n];o instanceof t.SymbolBucket&&(I(o.layers,this.zoom),v(o,u,e.positions,c,r.positions,this.showCollisionBoxes))}this.status="done",i(null,{buckets:t.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,iconAtlasImage:r.image})}}T.length?n.send("getImages",{icons:T},function(t,e){l||(l=t,c=e,A.call(o))}):c={},A.call(this)};var S="undefined"!=typeof performance,M={getEntriesByName:function(t){return!!(S&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(S&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,r){return!!(S&&performance&&performance.measure)&&performance.measure(t,e,r)},clearMarks:function(t){return!!(S&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(S&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},T=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},M.mark(this._marks.start)};function A(e,r){var n=t.getArrayBuffer(e.request,function(e,n){e?r(e):n&&r(null,{vectorTile:new t.mvt.VectorTile(new t.Protobuf(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires})});return function(){n.cancel(),r()}}T.prototype.finish=function(){M.mark(this._marks.end);var t=M.getEntriesByName(this._marks.measure);return 0===t.length&&(M.measure(this._marks.measure,this._marks.start,this._marks.end),t=M.getEntriesByName(this._marks.measure),M.clearMarks(this._marks.start),M.clearMarks(this._marks.end),M.clearMeasures(this._marks.measure)),t},M.Performance=T;var P=function(t,e,r){this.actor=t,this.layerIndex=e,this.loadVectorData=r||A,this.loading={},this.loaded={}};P.prototype.loadTile=function(e,r){var n=this,i=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new M.Performance(e.request),a=this.loading[i]=new E(e);a.abort=this.loadVectorData(e,function(e,s){if(delete n.loading[i],e||!s)return r(e);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(o){var h=o.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,n.layerIndex,n.actor,function(e,n){if(e||!n)return r(e);r(null,t.extend({rawTileData:l.slice(0)},n,u,c))}),n.loaded=n.loaded||{},n.loaded[i]=a})},P.prototype.reloadTile=function(t,e){var r=this.loaded,n=t.uid,i=this;if(r&&r[n]){var o=r[n];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,r){var n=o.reloadCallback;n&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,i.actor,n)),e(t,r)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&o.parse(o.vectorTile,this.layerIndex,this.actor,a)}},P.prototype.abortTile=function(t,e){var r=this.loading,n=t.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),e()},P.prototype.removeTile=function(t,e){var r=this.loaded,n=t.uid;r&&r[n]&&delete r[n],e()};var C=function(){this.loaded={}};C.prototype.loadTile=function(e,r){var n=e.uid,i=e.encoding,o=e.rawImageData,a=new t.DEMData(n,o,i);this.loaded=this.loaded||{},this.loaded[n]=a,r(null,a)},C.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var D={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function z(t){var e=0;if(t&&t.length>0){e+=Math.abs(B(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(B(t[r]))}return e}function B(t){var e,r,n,i,o,a,s=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(n=l-2,i=l-1,o=0):a===l-1?(n=l-1,i=0,o=1):(n=a,i=a+1,o=a+2),e=t[n],r=t[i],s+=(L(t[o][0])-L(e[0]))*Math.sin(L(r[1]));s=s*D.RADIUS*D.RADIUS/2}return s}function L(t){return t*Math.PI/180}var R={geometry:function t(e){var r,n=0;switch(e.type){case"Polygon":return z(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)n+=z(e.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)n+=t(e.geometries[r]);return n}},ring:B};function O(t,e){return function(r){return t(r,e)}}function F(t,e){e=!!e,t[0]=N(t[0],e);for(var r=1;r<t.length;r++)t[r]=N(t[r],!e);return t}function N(t,e){return function(t){return R.ring(t)>=0}(t)===e?t:t.reverse()}var V=t.mvt.VectorTileFeature.prototype.toGeoJSON,j=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};j.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var i=n[r];e.push([new t.Point(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],u=0,c=s[a];u<c.length;u+=1){var h=c[u];l.push(new t.Point(h[0],h[1]))}o.push(l)}return o},j.prototype.toGeoJSON=function(t,e,r){return V.call(this,t,e,r)};var U=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};U.prototype.feature=function(t){return new j(this._features[t])};var q=t.vectorTile.VectorTileFeature,G=Z;function Z(t,e){this.options=e||{},this.features=t,this.length=t.length}function X(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Z.prototype.feature=function(t){return new X(this.features[t],this.options.extent)},X.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var n=e[r],i=[],o=0;o<n.length;o++)i.push(new t.Point$1(n[o][0],n[o][1]));this.geometry.push(i)}return this.geometry},X.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]},X.prototype.toGeoJSON=q.prototype.toGeoJSON;var W=K,H=K,Y=G;function K(e){var r=new t.pbf;return function(t,e){for(var r in t.layers)e.writeMessage(3,J,t.layers[r])}(e,r),r.finish()}function J(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,Q,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,nt,o[r])}function Q(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,$,t),e.writeVarintField(3,r.type),e.writeMessage(4,rt,r)}function $(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=o[s];void 0===l&&(n.push(s),l=n.length-1,o[s]=l),e.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=a[h];void 0===p&&(i.push(u),p=i.length-1,a[h]=p),e.writeVarint(p)}}function tt(t,e){return(e<<3)+(7&t)}function et(t){return t<<1^t>>31}function rt(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;1===n&&(u=l.length),e.writeVarint(tt(1,u));for(var c=3===n?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==n&&e.writeVarint(tt(2,c-1));var p=l[h].x-i,d=l[h].y-o;e.writeVarint(et(p)),e.writeVarint(et(d)),i+=p,o+=d}3===n&&e.writeVarint(tt(7,0))}}function nt(t,e){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(7,t):"number"===r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function it(t,e,r,n){ot(t,r,n),ot(e,2*r,2*n),ot(e,2*r+1,2*n+1)}function ot(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function at(t,e,r,n){var i=t-r,o=e-n;return i*i+o*o}function st(t,e,r,n,i){return new lt(t,e,r,n,i)}function lt(t,e,r,n,i){e=e||ut,r=r||ct,i=i||Array,this.nodeSize=n||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=r(t[o]);!function t(e,r,n,i,o,a){if(!(o-i<=n)){var s=Math.floor((i+o)/2);!function t(e,r,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=n-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,r,n,Math.max(i,Math.floor(n-l*c/s+h)),Math.min(o,Math.floor(n+(s-l)*c/s+h)),a)}var p=r[2*n+a],d=i,f=o;for(it(e,r,i,n),r[2*o+a]>p&&it(e,r,i,o);d<f;){for(it(e,r,d,f),d++,f--;r[2*d+a]<p;)d++;for(;r[2*f+a]>p;)f--}r[2*i+a]===p?it(e,r,i,f):it(e,r,++f,o),f<=n&&(i=f+1),n<=f&&(o=f-1)}}(e,r,s,i,o,a%2),t(e,r,n,i,s-1,a+1),t(e,r,n,s+1,o,a+1)}}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function ut(t){return t[0]}function ct(t){return t[1]}function ht(t){this.options=yt(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function pt(t,e,r,n,i){return{x:t,y:e,zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function dt(t){return{type:"Feature",id:t.id,properties:ft(t),geometry:{type:"Point",coordinates:[(n=t.x,360*(n-.5)),(e=t.y,r=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var e,r,n}function ft(t){var e=t.numPoints,r=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return yt(yt({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function mt(t){return t/360+.5}function _t(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function yt(t,e){for(var r in e)t[r]=e[r];return t}function gt(t){return t.x}function vt(t){return t.y}function bt(t,e,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return(a=t-r)*a+(s=e-n)*s}function xt(t,e,r,n){var i={id:void 0===t?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)wt(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<e.length;n++)wt(t,e[n]);else if("MultiPolygon"===r)for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)wt(t,e[n][i])}(i),i}function wt(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function kt(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===o)Et(i,s);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)Et(i[u],s);else if("LineString"===o)It(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],It(i[u],s,a,!1),t.push(xt(l,"LineString",s,e.properties));return}St(i,s,a,!1)}else if("Polygon"===o)St(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)kt(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];St(i[u],c,a,!0),s.push(c)}}t.push(xt(l,o,s,e.properties))}}function Et(t,e){e.push(Mt(t[0])),e.push(Tt(t[1])),e.push(0)}function It(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var l=Mt(t[s][0]),u=Tt(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=n?(i*u-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,function t(e,r,n,i){for(var o,a=i,s=n-r>>1,l=n-r,u=e[r],c=e[r+1],h=e[n],p=e[n+1],d=r+3;d<n;d+=3){var f=bt(e[d],e[d+1],u,c,h,p);if(f>a)o=d,a=f;else if(f===a){var m=Math.abs(d-s);m<l&&(o=d,l=m)}}a>i&&(o-r>3&&t(e,r,o,i),e[o+2]=a,n-o>3&&t(e,o,n,i))}(e,0,c,r),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function St(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];It(t[i],o,r,n),e.push(o)}}function Mt(t){return t/360+.5}function Tt(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function At(t,e,r,n,i,o,a,s){if(n/=e,o>=(r/=e)&&a<n)return t;if(a<r||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,d=0===i?c.minX:c.minY,f=0===i?c.maxX:c.maxY;if(d>=r&&f<n)l.push(c);else if(!(f<r||d>=n)){var m=[];if("Point"===p||"MultiPoint"===p)Pt(h,m,r,n,i);else if("LineString"===p)Ct(h,m,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===p)zt(h,m,r,n,i,!1);else if("Polygon"===p)zt(h,m,r,n,i,!0);else if("MultiPolygon"===p)for(var _=0;_<h.length;_++){var y=[];zt(h[_],y,r,n,i,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(_=0;_<m.length;_++)l.push(xt(c.id,p,m[_],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(xt(c.id,p,m,c.tags))}}}return l.length?l:null}function Pt(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=r&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function Ct(t,e,r,n,i,o,a){for(var s,l,u=Dt(t),c=0===i?Lt:Rt,h=t.start,p=0;p<t.length-3;p+=3){var d=t[p],f=t[p+1],m=t[p+2],_=t[p+3],y=t[p+4],g=0===i?d:f,v=0===i?_:y,b=!1;a&&(s=Math.sqrt(Math.pow(d-_,2)+Math.pow(f-y,2))),g<r?v>=r&&(l=c(u,d,f,_,y,r),a&&(u.start=h+s*l)):g>=n?v<n&&(l=c(u,d,f,_,y,n),a&&(u.start=h+s*l)):Bt(u,d,f,m),v<r&&g>=r&&(l=c(u,d,f,_,y,r),b=!0),v>n&&g<=n&&(l=c(u,d,f,_,y,n),b=!0),!o&&b&&(a&&(u.end=h+s*l),e.push(u),u=Dt(t)),a&&(h+=s)}var x=t.length-3;d=t[x],f=t[x+1],m=t[x+2],(g=0===i?d:f)>=r&&g<=n&&Bt(u,d,f,m),x=u.length-3,o&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&Bt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function Dt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function zt(t,e,r,n,i,o){for(var a=0;a<t.length;a++)Ct(t[a],e,r,n,i,o,!1)}function Bt(t,e,r,n){t.push(e),t.push(r),t.push(n)}function Lt(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function Rt(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function Ot(t,e){for(var r=[],n=0;n<t.length;n++){var i,o=t[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=Ft(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(Ft(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(Ft(o.geometry[s][u],e));i.push(l)}r.push(xt(o.id,a,i,o.tags))}return r}function Ft(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function Nt(t,e){if(t.transformed)return t;var r,n,i,o=1<<t.z,a=t.x,s=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(Vt(u[n],u[n+1],e,o,a,s));else for(n=0;n<u.length;n++){var h=[];for(i=0;i<u[n].length;i+=2)h.push(Vt(u[n][i],u[n][i+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function Vt(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function jt(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Ut(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Ut(t,e,r,n){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)qt(a,i,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)qt(a,i[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)qt(a,u[s],t,r,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function qt(t,e,r,n,i,o){var a=n*n;if(n>0&&e.size<(i?a:n))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===n||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;i&&function(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}(s,o),t.push(s)}}function Gt(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)kt(r,t.features[n],e,n);else"Feature"===t.type?kt(r,t,e):kt(r,{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var r=e.buffer/e.extent,n=t,i=At(t,1,-1-r,r,0,-1,2,e),o=At(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=At(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=Ot(i,1).concat(n)),o&&(n=n.concat(Ot(o,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zt(t,e,r){return 32*((1<<t)*r+e)+t}function Xt(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return e(null,null);var i=new U(n.features),o=W(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}W.fromVectorTileJs=H,W.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var n in t)r[n]=new G(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return K({layers:r})},W.GeoJSONWrapper=Y,lt.prototype={range:function(t,e,r,n){return function(t,e,r,n,i,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),d=u.pop();if(p-d<=a)for(var f=d;f<=p;f++)s=e[2*f],l=e[2*f+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(t[f]);else{var m=Math.floor((d+p)/2);s=e[2*m],l=e[2*m+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(t[m]);var _=(h+1)%2;(0===h?r<=s:n<=l)&&(u.push(d),u.push(m-1),u.push(_)),(0===h?i>=s:o>=l)&&(u.push(m+1),u.push(p),u.push(_))}}return c}(this.ids,this.coords,t,e,r,n,this.nodeSize)},within:function(t,e,r){return function(t,e,r,n,i,o){for(var a=[0,t.length-1,0],s=[],l=i*i;a.length;){var u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var p=h;p<=c;p++)at(e[2*p],e[2*p+1],r,n)<=l&&s.push(t[p]);else{var d=Math.floor((h+c)/2),f=e[2*d],m=e[2*d+1];at(f,m,r,n)<=l&&s.push(t[d]);var _=(u+1)%2;(0===u?r-i<=f:n-i<=m)&&(a.push(h),a.push(d-1),a.push(_)),(0===u?r+i>=f:n+i>=m)&&(a.push(d+1),a.push(c),a.push(_))}}return s}(this.ids,this.coords,t,e,r,this.nodeSize)}},ht.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var r="prepare "+t.length+" points";e&&console.time(r),this.points=t;for(var n,i,o=[],a=0;a<t.length;a++)t[a].geometry&&o.push((n=a,{x:mt((i=t[a].geometry.coordinates)[0]),y:_t(i[1]),zoom:1/0,index:n,parentId:-1}));this.trees[this.options.maxZoom+1]=st(o,gt,vt,this.options.nodeSize,Float32Array),e&&console.timeEnd(r);for(var s=this.options.maxZoom;s>=this.options.minZoom;s--){var l=+Date.now();o=this._cluster(o,s),this.trees[s]=st(o,gt,vt,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",s,o.length,+Date.now()-l)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var r=((t[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,i=180;else if(r>i){var a=this.getClusters([r,n,180,o],e),s=this.getClusters([-180,n,i,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],u=l.range(mt(r),_t(o),mt(i),_t(n)),c=[],h=0;h<u.length;h++){var p=l.points[u[h]];c.push(p.numPoints?dt(p):this.points[p.index])}return c},getChildren:function(t){var e=t>>5,r=t%32,n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);var o=i.points[e];if(!o)throw new Error(n);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(o.x,o.y,a),l=[],u=0;u<s.length;u++){var c=i.points[s[u]];c.parentId===t&&l.push(c.numPoints?dt(c):this.points[c.index])}if(0===l.length)throw new Error(n);return l},getLeaves:function(t,e,r){e=e||10,r=r||0;var n=[];return this._appendLeaves(n,t,e,r,0),n},getTile:function(t,e,r){var n=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(r-a)/i,l=(r+1+a)/i,u={features:[]};return this._addTileFeatures(n.range((e-a)/i,s,(e+1+a)/i,l),n.points,e,r,i,u),0===e&&this._addTileFeatures(n.range(1-a/i,s,1,l),n.points,i,r,i,u),e===i-1&&this._addTileFeatures(n.range(0,s,a/i,l),n.points,-1,r,i,u),u.features.length?u:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},_appendLeaves:function(t,e,r,n,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=n?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,r,n,i):i<n?i++:t.push(o[a]),t.length===r)break}return i},_addTileFeatures:function(t,e,r,n,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]],l={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-r)),Math.round(this.options.extent*(s.y*i-n))]],tags:s.numPoints?ft(s):this.points[s.index].properties},u=s.numPoints?s.id:this.points[s.index].id;void 0!==u&&(l.id=u),o.features.push(l)}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var r=[],n=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,n),l=o.numPoints||1,u=o.x*l,c=o.y*l,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var p=(i<<5)+(e+1),d=0;d<s.length;d++){var f=a.points[s[d]];if(!(f.zoom<=e)){f.zoom=e;var m=f.numPoints||1;u+=f.x*m,c+=f.y*m,l+=m,f.parentId=p,this.options.reduce&&this._accumulate(h,f)}}1===l?r.push(o):(o.parentId=p,r.push(pt(u/l,c/l,p,l,h)))}}return r},_accumulate:function(t,e){var r=e.numPoints?e.properties:this.options.map(this.points[e.index].properties);this.options.reduce(t,r)}},Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gt.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=Zt(e,r,n),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=jt(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,i){if(e===l.maxZoom||e===i)continue;var f=1<<i-e;if(r!==Math.floor(o/f)||n!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,_,y,g,v,b,x=.5*l.buffer/l.extent,w=.5-x,k=.5+x,E=1+x;m=_=y=g=null,v=At(t,c,r-x,r+k,0,p.minX,p.maxX,l),b=At(t,c,r+w,r+E,0,p.minX,p.maxX,l),t=null,v&&(m=At(v,c,n-x,n+k,1,p.minY,p.maxY,l),_=At(v,c,n+w,n+E,1,p.minY,p.maxY,l),v=null),b&&(y=At(b,c,n-x,n+k,1,p.minY,p.maxY,l),g=At(b,c,n+w,n+E,1,p.minY,p.maxY,l),b=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*n),s.push(_||[],e+1,2*r,2*n+1),s.push(y||[],e+1,2*r+1,2*n),s.push(g||[],e+1,2*r+1,2*n+1)}}},Gt.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t,s=Zt(t,e=(e%a+a)%a,r);if(this.tiles[s])return Nt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,u=t,c=e,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[Zt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Nt(this.tiles[s],i):null):null};var Wt=function(e){function r(t,r,n){e.call(this,t,r,Xt),n&&(this.loadGeoJSON=n)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var n=!!(r&&r.request&&r.request.collectResourceTiming)&&new M.Performance(r.request);this.loadGeoJSON(r,function(i,o){if(i||!o)return e(i);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));!function t(e,r){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(O(t,r)),e;case"Feature":return e.geometry=t(e.geometry,r),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=F(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(O(F,e))),t}(e,r);default:return e}}(o,!0);try{t._geoJSONIndex=r.cluster?(a=r.superclusterOptions,new ht(a)).load(o.features):new Gt(o,r.geojsonVtOptions)}catch(i){return e(i)}t.loaded={};var a,s={};if(n){var l=n.finish();l&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(l)))}e(null,s)})}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(t,r){var n=this.loaded,i=t.uid;return n&&n[i]?e.prototype.reloadTile.call(this,t,r):this.loadTile(t,r)},r.prototype.loadGeoJSON=function(e,r){if(e.request)t.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error("Input data is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},r.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},r.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},r.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},r}(P),Ht=function(e){var r=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:P,geojson:Wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Ht.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},Ht.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},Ht.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},Ht.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},Ht.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},Ht.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},Ht.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},Ht.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Ht.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var n=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==n.removeSource?n.removeSource(e,r):r()}},Ht.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},Ht.prototype.loadRTLTextPlugin=function(e,r,n){try{t.plugin.isLoaded()||(this.self.importScripts(r),n(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+r)))}catch(t){n(t.toString())}},Ht.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new n),e},Ht.prototype.getWorkerSource=function(t,e,r){var n=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][r]){var i={send:function(e,r,i){n.actor.send(e,r,i,t)}};this.workerSources[t][e][r]=new this.workerSourceTypes[e](i,this.getLayerIndex(t))}return this.workerSources[t][e][r]},Ht.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new C),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Ht(self),Ht}),n(0,function(t){var e=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{e=new Worker(n),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(n),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===r[t]&&(r[t]=function(t){var r=document.createElement("canvas"),n=Object.create(e.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(t)),r[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r={create:function(e,r,n){var i=t.window.document.createElement(e);return r&&(i.className=r),n&&n.appendChild(i),i},createNS:function(e,r){return t.window.document.createElementNS(e,r)}},n=t.window.document?t.window.document.documentElement.style:null;function i(t){if(!n)return null;for(var e=0;e<t.length;e++)if(t[e]in n)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){n&&a&&(o=n[a],n[a]="none")},r.enableDrag=function(){n&&a&&(n[a]=o)};var s=i(["transform","WebkitTransform"]);r.setTransform=function(t,e){t.style[s]=e};var l=!1;try{var u=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",u,u),t.window.removeEventListener("test",u,u)}catch(t){l=!1}r.addEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&l?t.addEventListener(e,r,n):t.addEventListener(e,r,n.capture)},r.removeEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&l?t.removeEventListener(e,r,n):t.removeEventListener(e,r,n.capture)};var c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};r.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout(function(){t.window.removeEventListener("click",c,!0)},0)},r.mousePos=function(e,r){var n=e.getBoundingClientRect();return r=r.touches?r.touches[0]:r,new t.Point(r.clientX-n.left-e.clientLeft,r.clientY-n.top-e.clientTop)},r.touchPos=function(e,r){for(var n=e.getBoundingClientRect(),i=[],o="touchend"===r.type?r.changedTouches:r.touches,a=0;a<o.length;a++)i.push(new t.Point(o[a].clientX-n.left-e.clientLeft,o[a].clientY-n.top-e.clientTop));return i},r.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},r.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var h={API_URL:"https://api.mapbox.com",EVENTS_URL:"https://events.mapbox.com/events/v2",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},p="See https://www.mapbox.com/api-documentation/#access-tokens";function d(t,e){var r=b(h.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!h.REQUIRE_ACCESS_TOKEN)return x(t);if(!(e=e||h.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+p);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+p);return t.params.push("access_token="+e),x(t)}function f(t){return 0===t.indexOf("mapbox:")}var m=function(t,e){if(!f(t))return t;var r=b(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),d(r,e)},_=function(t,e,r,n){var i=b(t);return f(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+r,d(i,n)):(i.path+=""+e+r,x(i))},y=/(\.(png|jpg)\d*)(?=$)/,g=function(e,r,n){if(!r||!f(r))return e;var i=b(e),o=t.browser.devicePixelRatio>=2||512===n?"@2x":"",a=t.browser.supportsWebp?".webp":"$1";return i.path=i.path.replace(y,""+o+a),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(h.ACCESS_TOKEN||""))}(i.params),x(i)},v=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function b(t){var e=t.match(v);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function x(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var w=function(){this.eventData={anonId:null,lastSuccess:null,accessToken:h.ACCESS_TOKEN},this.queue=[],this.pending=!1,this.pendingRequest=null};w.prototype.postTurnstileEvent=function(e){h.ACCESS_TOKEN&&Array.isArray(e)&&e.some(function(t){return/(mapbox\.c)(n|om)/i.test(t)})&&this.queueRequest(t.browser.now())},w.prototype.queueRequest=function(t){this.queue.push(t),this.processRequests()},w.prototype.processRequests=function(){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var r="mapbox.turnstileEventData:"+(h.ACCESS_TOKEN||""),n=t.storageAvailable("localStorage"),i=!!this.eventData.accessToken&&this.eventData.accessToken!==h.ACCESS_TOKEN;if(i&&(this.eventData.anonId=this.eventData.lastSuccess=null),(!this.eventData.anonId||!this.eventData.lastSuccess)&&n)try{var o=t.window.localStorage.getItem(r);o&&(this.eventData=JSON.parse(o))}catch(e){t.warnOnce("Unable to read from LocalStorage")}t.validateUuid(this.eventData.anonId)||(this.eventData.anonId=t.uuid(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var s=new Date(this.eventData.lastSuccess),l=new Date(a),u=(a-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||s.getDate()!==l.getDate()}if(!i)return this.processRequests();var c=b(h.EVENTS_URL);c.params.push("access_token="+(h.ACCESS_TOKEN||""));var p={url:x(c),headers:{"Content-Type":"text/plain"}},d=JSON.stringify([{event:"appUserTurnstile",created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"0.48.0","enabled.telemetry":!1,userId:this.eventData.anonId}]);this.pendingRequest=t.postData(p,d,function(i){if(e.pendingRequest=null,!i){if(e.eventData.lastSuccess=a,e.eventData.accessToken=h.ACCESS_TOKEN,n)try{t.window.localStorage.setItem(r,JSON.stringify(e.eventData))}catch(e){t.warnOnce("Unable to write to LocalStorage")}e.processRequests()}})}};var k=new w,E=k.postTurnstileEvent.bind(k),I=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new t.ShelfPack(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new t.RGBAImage({width:64,height:64}),this.dirty=!0};I.prototype.isLoaded=function(){return this.loaded},I.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,r=this.requestors;e<r.length;e+=1){var n=r[e],i=n.ids,o=n.callback;this._notify(i,o)}this.requestors=[]}},I.prototype.getImage=function(t){return this.images[t]},I.prototype.addImage=function(t,e){this.images[t]=e},I.prototype.removeImage=function(t){delete this.images[t];var e=this.patterns[t];e&&(this.shelfPack.unref(e.bin),delete this.patterns[t])},I.prototype.listImages=function(){return Object.keys(this.images)},I.prototype.getImages=function(t,e){var r=!0;if(!this.isLoaded())for(var n=0,i=t;n<i.length;n+=1){var o=i[n];this.images[o]||(r=!1)}this.isLoaded()||r?this._notify(t,e):this.requestors.push({ids:t,callback:e})},I.prototype._notify=function(t,e){for(var r={},n=0,i=t;n<i.length;n+=1){var o=i[n],a=this.images[o];a&&(r[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,r)},I.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},I.prototype.getPattern=function(e){var r=this.patterns[e];if(r)return r.position;var n=this.getImage(e);if(!n)return null;var i=n.data.width+2,o=n.data.height+2,a=this.shelfPack.packOne(i,o);if(!a)return null;this.atlasImage.resize(this.getPixelSize());var s=n.data,l=this.atlasImage,u=a.x+1,c=a.y+1,h=s.width,p=s.height;t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c},{width:h,height:p}),t.RGBAImage.copy(s,l,{x:0,y:p-1},{x:u,y:c-1},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c+p},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:p}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u+h,y:c},{width:1,height:p}),this.dirty=!0;var d=new t.ImagePosition(a,n);return this.patterns[e]={bin:a,position:d},d},I.prototype.bind=function(e){var r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)};var S=T,M=1e20;function T(t,e,r,n,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function A(t,e,r,n,i,o,a){for(var s=0;s<e;s++){for(var l=0;l<r;l++)n[l]=t[l*e+s];for(P(n,i,o,a,r),l=0;l<r;l++)t[l*e+s]=i[l]}for(l=0;l<r;l++){for(s=0;s<e;s++)n[s]=t[l*e+s];for(P(n,i,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(i[s])}}function P(t,e,r,n,i){r[0]=0,n[0]=-M,n[1]=+M;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=n[a];)a--,s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,n[a]=s,n[a+1]=+M}for(o=0,a=0;o<i;o++){for(;n[a+1]<o;)a++;e[o]=(o-r[a])*(o-r[a])+t[r[a]]}}T.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var i=e.data[4*n+3]/255;this.gridOuter[n]=1===i?0:0===i?M:Math.pow(Math.max(0,.5-i),2),this.gridInner[n]=1===i?M:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(A(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),A(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++){var o=this.gridOuter[n]-this.gridInner[n];r[n]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return r};var C=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};C.prototype.setURL=function(t){this.url=t},C.prototype.getGlyphs=function(e,r){var n=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var l=s[a];i.push({stack:o,id:l})}t.asyncAll(i,function(t,e){var r=t.stack,i=t.id,o=n.entries[r];o||(o=n.entries[r]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a)if(a=n._tinySDF(o,r,i))e(null,{stack:r,id:i,glyph:a});else{var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var l=o.requests[s];l||(l=o.requests[s]=[],C.loadGlyphRange(r,s,n.url,n.requestTransform,function(t,e){if(e)for(var r in e)o.glyphs[+r]=e[+r];for(var n=0,i=l;n<i.length;n+=1)(0,i[n])(t,e);delete o.requests[s]})),l.push(function(t,n){t?e(t):n&&e(null,{stack:r,id:i,glyph:n[i]||null})})}}else e(null,{stack:r,id:i,glyph:a})},function(t,e){if(t)r(t);else if(e){for(var n={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,l=a.id,u=a.glyph;(n[s]||(n[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,n)}})},C.prototype._tinySDF=function(e,r,n){var i=this.localIdeographFontFamily;if(i&&(t.isChar["CJK Unified Ideographs"](n)||t.isChar["Hangul Syllables"](n))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(r)?a="900":/medium/i.test(r)?a="500":/light/i.test(r)&&(a="200"),o=e.tinySDF=new C.TinySDF(24,3,8,.25,i,a)}return{id:n,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},C.loadGlyphRange=function(e,r,n,i,o){var a=256*r,s=a+255,l=i(function(t,e){if(!f(t))return t;var r=b(t);return r.path="/fonts/v1"+r.path,d(r,e)}(n).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,function(e,r){if(e)o(e);else if(r){for(var n={},i=0,a=t.parseGlyphPBF(r.data);i<a.length;i+=1){var s=a[i];n[s.id]=s}o(null,n)}})},C.TinySDF=S;var D=function(){this.specification=t.styleSpec.light.position};D.prototype.possiblyEvaluate=function(e,r){return t.sphericalToCartesian(e.expression.evaluate(r))},D.prototype.interpolate=function(e,r,n){return{x:t.number(e.x,r.x,n),y:t.number(e.y,r.y,n),z:t.number(e.z,r.z,n)}};var z=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new D,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),B=function(e){function r(r){e.call(this),this._transitionable=new t.Transitionable(z),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var r in e){var n=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),n):this._transitionable.setValue(r,n)}},r.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},r.prototype._validate=function(e,r){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},r}(t.Evented),L=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};L.prototype.getDash=function(t,e){var r=t.join(",")+String(e);return this.positions[r]||(this.positions[r]=this.addDash(t,e)),this.positions[r]},L.prototype.addDash=function(e,r){var n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,l=s/2,u=e.length%2==1,c=-n;c<=n;c++)for(var h=this.nextRow+n+c,p=this.width*h,d=u?-e[e.length-1]:0,f=e[0],m=1,_=0;_<this.width;_++){for(;f<_/s;)d=f,f+=e[m],u&&m===e.length-1&&(f+=e[0]),m++;var y=Math.abs(_-d*s),g=Math.abs(_-f*s),v=Math.min(y,g),b=m%2==1,x=void 0;if(r){var w=n?c/n*(l+1):0;if(b){var k=l-Math.abs(w);x=Math.sqrt(v*v+k*k)}else x=l-Math.sqrt(v*v+w*w)}else x=(b?1:-1)*v;this.data[3+4*(p+_)]=Math.max(0,Math.min(255,x+128))}var E={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:o};return this.nextRow+=i,this.dirty=!0,E},L.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var R=function e(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=i[o],s=new e.Actor(a,n,this.id);s.name="Worker "+o,this.actors.push(s)}};function O(e,r,n){var i=function(e,r){if(e)return n(e);if(r){var i=t.pick(r,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);r.vector_layers&&(i.vectorLayers=r.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(t){return t.id})),n(null,i)}};return e.url?t.getJSON(r(m(e.url),t.ResourceType.Source),i):t.browser.frame(function(){return i(null,e)})}R.prototype.broadcast=function(e,r,n){n=n||function(){},t.asyncAll(this.actors,function(t,n){t.send(e,r,n)},n)},R.prototype.send=function(t,e,r,n){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,r),n},R.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=t.Actor;var F=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};F.prototype.wrap=function(){return new F(t.wrap(this.lng,-180,180),this.lat)},F.prototype.toArray=function(){return[this.lng,this.lat]},F.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},F.prototype.toBounds=function(t){var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new N(new F(this.lng-r,this.lat-e),new F(this.lng+r,this.lat+e))},F.convert=function(t){if(t instanceof F)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new F(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new F(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var N=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};N.prototype.setNorthEast=function(t){return this._ne=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.setSouthWest=function(t){return this._sw=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.extend=function(t){var e,r,n=this._sw,i=this._ne;if(t instanceof F)e=t,r=t;else{if(!(t instanceof N))return Array.isArray(t)?t.every(Array.isArray)?this.extend(N.convert(t)):this.extend(F.convert(t)):this;if(e=t._sw,r=t._ne,!e||!r)return this}return n||i?(n.lng=Math.min(e.lng,n.lng),n.lat=Math.min(e.lat,n.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new F(e.lng,e.lat),this._ne=new F(r.lng,r.lat)),this},N.prototype.getCenter=function(){return new F((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},N.prototype.getSouthWest=function(){return this._sw},N.prototype.getNorthEast=function(){return this._ne},N.prototype.getNorthWest=function(){return new F(this.getWest(),this.getNorth())},N.prototype.getSouthEast=function(){return new F(this.getEast(),this.getSouth())},N.prototype.getWest=function(){return this._sw.lng},N.prototype.getSouth=function(){return this._sw.lat},N.prototype.getEast=function(){return this._ne.lng},N.prototype.getNorth=function(){return this._ne.lat},N.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},N.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},N.prototype.isEmpty=function(){return!(this._sw&&this._ne)},N.convert=function(t){return!t||t instanceof N?t:new N(t)};var V=function(t,e,r){this.bounds=N.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=r||24};V.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},V.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),r=Math.floor(this.latY(this.bounds.getNorth(),t.z)),n=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),i=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<n&&t.y>=r&&t.y<i},V.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},V.prototype.latY=function(e,r){var n=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),i=Math.pow(2,r)/(2*Math.PI);return Math.pow(2,r-1)+.5*Math.log((1+n)/(1-n))*-i};var j=function(e){function r(r,n,i,o){if(e.call(this),this.id=r,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(n,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._transformRequest,function(r,n){e._tileJSONRequest=null,r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new V(n.bounds,e.minzoom,e.maxzoom)),E(n.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.loadTile=function(e,r){var n=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(n,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(t,n){return e.aborted?r(null):t&&404!==t.status?r(t):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",i,o.bind(this)):"loading"===e.state?e.reloadCallback=r:this.dispatcher.send("reloadTile",i,o.bind(this),e.workerID)},r.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.hasTransition=function(){return!1},r}(t.Evented),U=function(e){function r(r,n,i,o){e.call(this),this.id=r,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._transformRequest,function(r,n){e._tileJSONRequest=null,r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new V(n.bounds,e.minzoom,e.maxzoom)),E(n.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.loadTile=function(e,r){var n=this,i=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(i,o){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(i)e.state="errored",r(i);else if(o){n.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=n.map.painter.context,s=a.gl;e.texture=n.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",r(null)}})},r.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},r.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},r.prototype.hasTransition=function(){return!1},r}(t.Evented),q=function(e){function r(r,n,i,o){e.call(this,r,n,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},n),this.encoding=n.encoding||"mapbox"}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(e,r){var n=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(n,t.ResourceType.Tile),function(n,i){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(n)e.state="errored",r(n);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=t.browser.getImageData(i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,n){t&&(e.state="errored",r(t)),n&&(e.dem=n,e.needsHillshadePrepare=!0,e.state="loaded",r(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},r.prototype._getNeighboringTiles=function(e){var r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,o=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},r}(U),G=function(e){function r(r,n,i,o){e.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=i,this.setEventedParent(o),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution);var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(n.clusterRadius||50)*a,log:!1}},n.workerOptions)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(r){if(r)e.fire(new t.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(n.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",n))}})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setData=function(e){var r=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)r.fire(new t.ErrorEvent(e));else{var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new t.Event("data",n))}}),this},r.prototype.getClusterExpansionZoom=function(t,e){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e,this.workerID),this},r.prototype.getClusterChildren=function(t,e){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e,this.workerID),this},r.prototype.getClusterLeaves=function(t,e,r,n){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:r},n,this.workerID),this},r.prototype._updateWorkerData=function(e){var r=this,n=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(n.request=this.map._transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(i),this.workerID=this.dispatcher.send(this.type+".loadData",n,function(t,i){r._removed||i&&i.abandoned||(r._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[r.id]&&(r._resourceTiming=i.resourceTiming[r.id].slice(0)),r.dispatcher.send(r.type+".coalesce",{source:n.source},null,r.workerID),e(t))},this.workerID)},r.prototype.loadTile=function(e,r){var n=this,i=void 0===e.workerID?"loadTile":"reloadTile",o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(i,o,function(t,o){return e.unloadVectorData(),e.aborted?r(null):t?r(t):(e.loadVectorData(o,n.map.painter,"reloadTile"===i),r(null))},this.workerID)},r.prototype.abortTile=function(t){t.aborted=!0},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},r.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},r.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(t.Evented),Z=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Z.prototype.bind=function(t,e,r,n,i,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==n.length,u=0;!l&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||l||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,r,n,i,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},Z.prototype.freshBind=function(t,e,r,n,i,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var h=l;h<s;h++)c.disableVertexAttribArray(h)}e.enableAttributes(c,t);for(var p=0,d=r;p<d.length;p+=1)d[p].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,i);for(var f=0,m=r;f<m.length;f+=1){var _=m[f];_.bind(),_.setVertexAttribPointers(c,t,i)}o&&(o.bind(),o.setVertexAttribPointers(c,t,i)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,i)),u.currentNumAttributes=l},Z.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var X=function(e){function r(t,r,n,i){e.call(this),this.id=t,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(e.image=t.browser.getImageData(n),e._finishLoading())})},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setCoordinates=function(e){this.coordinates=e;var r=this.map,n=e.map(function(t){return r.transform.locationCoordinate(F.convert(t)).zoomTo(0)}),i=this.centerCoord=t.getCoordinatesCenter(n);i.column=Math.floor(i.column),i.row=Math.floor(i.row),this.tileID=new t.CanonicalTileID(i.zoom,i.column,i.row),this.minzoom=this.maxzoom=i.zoom;var o=n.map(function(e){var r=e.zoomTo(i.zoom);return new t.Point(Math.round((r.column-i.column)*t.EXTENT),Math.round((r.row-i.row)*t.EXTENT))});return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,r=e.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new Z),this.texture||(this.texture=new t.Texture(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(t.Evented),W=function(e){function r(t,r,n,i){e.call(this,t,r,n,i),this.roundZoom=!0,this.type="video",this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this,r=this.options;this.urls=[];for(var n=0,i=r.urls;n<i.length;n+=1){var o=i[n];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(e.video=n,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map._rerender()}),e.map&&e.video.play(),e._finishLoading())})},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,r=e.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new Z),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(X),H=function(e){function r(r,n,i,o){e.call(this,r,n,i,o),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new Z),this.texture?e?this.texture.update(this.canvas):this._playing&&(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.canvas)):(this.texture=new t.Texture(r,this.canvas,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var r=e[t];if(isNaN(r)||r<=0)return!0}return!1},r}(X),Y={vector:j,raster:U,"raster-dem":q,geojson:G,video:W,image:X,canvas:H},K=function(e,r,n,i){var o=new Y[r.type](e,r,n,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function J(t,e,r,n,i){var o=i.maxPitchScaleFactor(),a=t.tilesIn(r,o);a.sort(Q);for(var s=[],l=0,u=a;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(e,t._state,c.queryGeometry,c.scale,n,i,o,t.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}var h=function(t){for(var e={},r={},n=0,i=t;n<i.length;n+=1){var o=i[n],a=o.queryResults,s=o.wrappedTileID,l=r[s]=r[s]||{};for(var u in a)for(var c=a[u],h=l[u]=l[u]||{},p=e[u]=e[u]||[],d=0,f=c;d<f.length;d+=1){var m=f[d];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m.feature))}}return e}(s);for(var p in h)h[p].forEach(function(e){var r=t.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=r});return h}function Q(t,e){var r=t.tileID,n=e.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var $=function(t,e){this.max=t,this.onRemove=e,this.reset()};$.prototype.reset=function(){for(var t in this.data)for(var e=0,r=this.data[t];e<r.length;e+=1){var n=r[e];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},$.prototype.add=function(t,e,r){var n=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==r&&(o.timeout=setTimeout(function(){n.remove(t,o)},r)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},$.prototype.has=function(t){return t.wrapped().key in this.data},$.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},$.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},$.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},$.prototype.remove=function(t,e){if(!this.has(t))return this;var r=t.wrapped().key,n=void 0===e?0:this.data[r].indexOf(e),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this},$.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var tt=function(t,e,r){this.context=t;var n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};tt.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},tt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},tt.prototype.updateData=function(t){var e=this.context.gl;this.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},tt.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var et={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},rt=function(t,e,r,n){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};rt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},rt.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},rt.prototype.enableAttributes=function(t,e){for(var r=0;r<this.attributes.length;r++){var n=this.attributes[r],i=e.attributes[n.name];void 0!==i&&t.enableVertexAttribArray(i)}},rt.prototype.setVertexAttribPointers=function(t,e,r){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[et[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}},rt.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var nt=function(e){this.context=e,this.current=t.Color.transparent};nt.prototype.get=function(){return this.current},nt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t)};var it=function(t){this.context=t,this.current=1};it.prototype.get=function(){return this.current},it.prototype.set=function(t){this.current!==t&&(this.context.gl.clearDepth(t),this.current=t)};var ot=function(t){this.context=t,this.current=0};ot.prototype.get=function(){return this.current},ot.prototype.set=function(t){this.current!==t&&(this.context.gl.clearStencil(t),this.current=t)};var at=function(t){this.context=t,this.current=[!0,!0,!0,!0]};at.prototype.get=function(){return this.current},at.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t)};var st=function(t){this.context=t,this.current=!0};st.prototype.get=function(){return this.current},st.prototype.set=function(t){this.current!==t&&(this.context.gl.depthMask(t),this.current=t)};var lt=function(t){this.context=t,this.current=255};lt.prototype.get=function(){return this.current},lt.prototype.set=function(t){this.current!==t&&(this.context.gl.stencilMask(t),this.current=t)};var ut=function(t){this.context=t,this.current={func:t.gl.ALWAYS,ref:0,mask:255}};ut.prototype.get=function(){return this.current},ut.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t)};var ct=function(t){this.context=t;var e=this.context.gl;this.current=[e.KEEP,e.KEEP,e.KEEP]};ct.prototype.get=function(){return this.current},ct.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t)};var ht=function(t){this.context=t,this.current=!1};ht.prototype.get=function(){return this.current},ht.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t}};var pt=function(t){this.context=t,this.current=[0,1]};pt.prototype.get=function(){return this.current},pt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.depthRange(t[0],t[1]),this.current=t)};var dt=function(t){this.context=t,this.current=!1};dt.prototype.get=function(){return this.current},dt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t}};var ft=function(t){this.context=t,this.current=t.gl.LESS};ft.prototype.get=function(){return this.current},ft.prototype.set=function(t){this.current!==t&&(this.context.gl.depthFunc(t),this.current=t)};var mt=function(t){this.context=t,this.current=!1};mt.prototype.get=function(){return this.current},mt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t}};var _t=function(t){this.context=t;var e=this.context.gl;this.current=[e.ONE,e.ZERO]};_t.prototype.get=function(){return this.current},_t.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.blendFunc(t[0],t[1]),this.current=t)};var yt=function(e){this.context=e,this.current=t.Color.transparent};yt.prototype.get=function(){return this.current},yt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t)};var gt=function(t){this.context=t,this.current=null};gt.prototype.get=function(){return this.current},gt.prototype.set=function(t){this.current!==t&&(this.context.gl.useProgram(t),this.current=t)};var vt=function(t){this.context=t,this.current=t.gl.TEXTURE0};vt.prototype.get=function(){return this.current},vt.prototype.set=function(t){this.current!==t&&(this.context.gl.activeTexture(t),this.current=t)};var bt=function(t){this.context=t;var e=this.context.gl;this.current=[0,0,e.drawingBufferWidth,e.drawingBufferHeight]};bt.prototype.get=function(){return this.current},bt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t)};var xt=function(t){this.context=t,this.current=null};xt.prototype.get=function(){return this.current},xt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t}};var wt=function(t){this.context=t,this.current=null};wt.prototype.get=function(){return this.current},wt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t}};var kt=function(t){this.context=t,this.current=null};kt.prototype.get=function(){return this.current},kt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t}};var Et=function(t){this.context=t,this.current=null};Et.prototype.get=function(){return this.current},Et.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t}};var It=function(t){this.context=t,this.current=null};It.prototype.get=function(){return this.current},It.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t};var St=function(t){this.context=t,this.current=null};St.prototype.get=function(){return this.current},St.prototype.set=function(t){this.current!==t&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t)};var Mt=function(t){this.context=t,this.current=4};Mt.prototype.get=function(){return this.current},Mt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t}};var Tt=function(t){this.context=t,this.current=!1};Tt.prototype.get=function(){return this.current},Tt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t}};var At=function(t,e){this.context=t,this.current=null,this.parent=e};At.prototype.get=function(){return this.current};var Pt=function(t){function e(e,r){t.call(this,e,r),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(At),Ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t}},e}(At),Dt=function(t,e,r){this.context=t,this.width=e,this.height=r;var n=t.gl,i=this.framebuffer=n.createFramebuffer();this.colorAttachment=new Pt(t,i),this.depthAttachment=new Ct(t,i)};Dt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r),t.deleteFramebuffer(this.framebuffer)};var zt=function(t,e,r){this.func=t,this.mask=e,this.range=r};zt.ReadOnly=!1,zt.ReadWrite=!0,zt.disabled=new zt(519,zt.ReadOnly,[0,1]);var Bt=function(t,e,r,n,i,o){this.test=t,this.ref=e,this.mask=r,this.fail=n,this.depthFail=i,this.pass=o};Bt.disabled=new Bt({func:519,mask:0},0,0,7680,7680,7680);var Lt=function(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r};Lt.disabled=new Lt(Lt.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),Lt.unblended=new Lt(Lt.Replace,t.Color.transparent,[!0,!0,!0,!0]),Lt.alphaBlended=new Lt([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Rt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new nt(this),this.clearDepth=new it(this),this.clearStencil=new ot(this),this.colorMask=new at(this),this.depthMask=new st(this),this.stencilMask=new lt(this),this.stencilFunc=new ut(this),this.stencilOp=new ct(this),this.stencilTest=new ht(this),this.depthRange=new pt(this),this.depthTest=new dt(this),this.depthFunc=new ft(this),this.blend=new mt(this),this.blendFunc=new _t(this),this.blendColor=new yt(this),this.program=new gt(this),this.activeTexture=new vt(this),this.viewport=new bt(this),this.bindFramebuffer=new xt(this),this.bindRenderbuffer=new wt(this),this.bindTexture=new kt(this),this.bindVertexBuffer=new Et(this),this.bindElementBuffer=new It(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new St(this),this.pixelStoreUnpack=new Mt(this),this.pixelStoreUnpackPremultiplyAlpha=new Tt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};Rt.prototype.createIndexBuffer=function(t,e){return new tt(this,t,e)},Rt.prototype.createVertexBuffer=function(t,e,r){return new rt(this,t,e,r)},Rt.prototype.createRenderbuffer=function(t,e,r){var n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),i},Rt.prototype.createFramebuffer=function(t,e){return new Dt(this,t,e)},Rt.prototype.clear=function(t){var e=t.color,r=t.depth,n=this.gl,i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(i|=n.DEPTH_BUFFER_BIT,this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(i)},Rt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Rt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Rt.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,Lt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)};var Ot=function(e){function r(r,n,i){var o=this;e.call(this),this.id=r,this.dispatcher=i,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=K(r,n,i,this),this._tiles={},this._cache=new $(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},r.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},r.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},r.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[e].upload(t)},r.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(Nt)},r.prototype.getRenderableIds=function(e){var r=this,n=[];for(var i in r._tiles)r._isIdRenderable(+i,e)&&n.push(+i);return e?n.sort(function(e,n){var i=r._tiles[e].tileID,o=r._tiles[n].tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(r.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(r.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x}):n.sort(Nt)},r.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},r.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},r.prototype._reloadTile=function(t,e){var r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))},r.prototype._tileLoaded=function(e,r,n,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null)},r.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),r=0;r<e.length;r++){var n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){var i=this.getTileByID(n);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var r=e.tileID.canonical.x-t.tileID.canonical.x,n=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,n),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},r.prototype.getTile=function(t){return this.getTileByID(t.key)},r.prototype.getTileByID=function(t){return this._tiles[t]},r.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},r.prototype._retainLoadedChildren=function(t,e,r,n){for(var i in this._tiles){var o=this._tiles[i];if(!(n[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>r)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){n[a.key]=a;break}}}},r.prototype.findLoadedParent=function(t,e){for(var r=t.overscaledZ-1;r>=e;r--){var n=t.scaledTo(r);if(!n)return;var i=String(n.key),o=this._tiles[i];if(o&&o.hasData())return o;if(this._cache.has(n))return this._cache.get(n)}},r.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),r=Math.floor(5*e),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)},r.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,r=Math.round(e);if(this._prevLng=t,r){var n={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+r),n[o.tileID.key]=o}for(var a in this._tiles=n,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},r.prototype.update=function(e){var n=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return n._source.hasTile(t)}))):i=[];var o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),a=Math.max(o-r.maxOverzooming,this._source.minzoom),s=Math.max(o+r.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(i,o);if(Vt(this._source.type)){for(var u={},c={},h=0,p=Object.keys(l);h<p.length;h+=1){var d=p[h],f=l[d],m=n._tiles[d];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var _=n.findLoadedParent(f,a);_&&(n._addTile(_.tileID),u[_.tileID.key]=_.tileID),c[d]=f}}for(var y in this._retainLoadedChildren(c,o,s,l),u)l[y]||(n._coveredTiles[y]=!0,l[y]=u[y])}for(var g in l)n._tiles[g].clearFadeHold();for(var v=0,b=t.keysDifference(this._tiles,l);v<b.length;v+=1){var x=b[v],w=n._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(n.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||n._removeTile(x)}}},r.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},r.prototype._updateRetainedTiles=function(t,e){for(var n={},i={},o=Math.max(e-r.maxOverzooming,this._source.minzoom),a=Math.max(e+r.maxUnderzooming,this._source.minzoom),s={},l=0,u=t;l<u.length;l+=1){var c=u[l],h=this._addTile(c);n[c.key]=c,h.hasData()||e<this._source.maxzoom&&(s[c.key]=c)}this._retainLoadedChildren(s,e,a,n);for(var p=0,d=t;p<d.length;p+=1){var f=d[p],m=this._tiles[f.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var _=f.children(this._source.maxzoom)[0],y=this.getTile(_);if(y&&y.hasData()){n[_.key]=_;continue}}else{var g=f.children(this._source.maxzoom);if(n[g[0].key]&&n[g[1].key]&&n[g[2].key]&&n[g[3].key])continue}for(var v=m.wasRequested(),b=f.overscaledZ-1;b>=o;--b){var x=f.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(m=this.getTile(x))&&v&&(m=this._addTile(x)),m&&(n[x.key]=x,v=m.wasRequested(),m.hasData()))break}}}return n},r.prototype._addTile=function(e){var r=this._tiles[e.key];if(r)return r;(r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));var n=Boolean(r);return n||(r=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))),r?(r.uses++,this._tiles[e.key]=r,n||this._source.fire(new t.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(t,e){var r=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(function(){r._reloadTile(t,"expired"),delete r._timers[t]},n))},r.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},r.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},r.prototype.tilesIn=function(e,r){for(var n=[],i=this.getIds(),o=1/0,a=1/0,s=-1/0,l=-1/0,u=e[0].zoom,c=0;c<e.length;c++){var h=e[c];o=Math.min(o,h.column),a=Math.min(a,h.row),s=Math.max(s,h.column),l=Math.max(l,h.row)}for(var p=0;p<i.length;p++){var d=this._tiles[i[p]];if(!d.holdingForFade()){var f=d.tileID,m=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),_=r*d.queryPadding*t.EXTENT/d.tileSize/m,y=[Ft(f,new t.Coordinate(o,a,u)),Ft(f,new t.Coordinate(s,l,u))];if(y[0].x-_<t.EXTENT&&y[0].y-_<t.EXTENT&&y[1].x+_>=0&&y[1].y+_>=0){for(var g=[],v=0;v<e.length;v++)g.push(Ft(f,e[v]));n.push({tile:d,tileID:f,queryGeometry:[g],scale:m})}}}return n},r.prototype.getVisibleCoordinates=function(t){for(var e=this,r=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),n=0,i=r;n<i.length;n+=1){var o=i[n];o.posMatrix=e.transform.calculatePosMatrix(o.toUnwrapped())}return r},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Vt(this._source.type))for(var e in this._tiles){var r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=t.browser.now())return!0}return!1},r.prototype.setFeatureState=function(t,e,r){t=t||"_geojsonTileLayer",this._state.updateState(t,e,r)},r.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},r}(t.Evented);function Ft(e,r){var n=r.zoomTo(e.canonical.z);return new t.Point((n.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.EXTENT,(n.row-e.canonical.y)*t.EXTENT)}function Nt(t,e){return t%32-e%32||e-t}function Vt(t){return"raster"===t||"image"===t||"video"===t}function jt(){return new t.window.Worker(fn.workerUrl)}Ot.maxOverzooming=10,Ot.maxUnderzooming=3;var Ut,qt=function(){this.active={}};function Gt(e,r){var n={};for(var i in e)"ref"!==i&&(n[i]=e[i]);return t.refProperties.forEach(function(t){t in r&&(n[t]=r[t])}),n}function Zt(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Gt(t[n],e[t[n].ref]));return t}qt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<qt.workerCount;)this.workers.push(new jt);return this.active[t]=!0,this.workers.slice()},qt.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},qt.workerCount=Math.max(Math.floor(t.browser.hardwareConcurrency/2),1);var Xt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Wt(t,e,r){r.push({command:Xt.addSource,args:[t,e[t]]})}function Ht(t,e,r){e.push({command:Xt.removeSource,args:[t]}),r[t]=!0}function Yt(t,e,r,n){Ht(t,r,n),Wt(t,e,r)}function Kt(e,r,n){var i;for(i in e[n])if(e[n].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[n][i],r[n][i]))return!1;for(i in r[n])if(r[n].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[n][i],r[n][i]))return!1;return!0}function Jt(e,r,n,i,o,a){var s;for(s in r=r||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}));for(s in r)r.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}))}function Qt(t){return t.id}function $t(t,e){return t[e.id]=e,t}var te=function(t,e,r){var n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};te.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},te.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},te.prototype.insertCircle=function(t,e,r,n){this._forEachCell(e-n,r-n,e+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(n)},te.prototype._insertBoxCell=function(t,e,r,n,i,o){this.boxCells[i].push(o)},te.prototype._insertCircleCell=function(t,e,r,n,i,o){this.circleCells[i].push(o)},te.prototype._query=function(t,e,r,n,i,o){if(r<0||t>this.width||n<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return o?a.filter(o):a}var p={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,r,n,this._queryCell,a,p,o),i?a.length>0:a},te.prototype._queryCircle=function(t,e,r,n,i){var o=t-r,a=t+r,s=e-r,l=e+r;if(a<0||o>this.width||l<0||s>this.height)return!n&&[];var u=[],c={hitTest:n,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,i),n?u.length>0:u},te.prototype.query=function(t,e,r,n,i){return this._query(t,e,r,n,!1,i)},te.prototype.hitTest=function(t,e,r,n,i){return this._query(t,e,r,n,!0,i)},te.prototype.hitTestCircle=function(t,e,r,n){return this._queryCircle(t,e,r,!0,n)},te.prototype._queryCell=function(t,e,r,n,i,o,a,s){var l=a.seenUids,u=this.boxCells[i];if(null!==u)for(var c=this.bboxes,h=0,p=u;h<p.length;h+=1){var d=p[h];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=c[f+2]&&e<=c[f+3]&&r>=c[f+0]&&n>=c[f+1]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[f],y1:c[f+1],x2:c[f+2],y2:c[f+3]})}}}var m=this.circleCells[i];if(null!==m)for(var _=this.circles,y=0,g=m;y<g.length;y+=1){var v=g[y];if(!l.circle[v]){l.circle[v]=!0;var b=3*v;if(this._circleAndRectCollide(_[b],_[b+1],_[b+2],t,e,r,n)&&(!s||s(this.circleKeys[v]))){if(a.hitTest)return o.push(!0),!0;var x=_[b],w=_[b+1],k=_[b+2];o.push({key:this.circleKeys[v],x1:x-k,y1:w-k,x2:x+k,y2:w+k})}}}},te.prototype._queryCellCircle=function(t,e,r,n,i,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var h=this.bboxes,p=0,d=c;p<d.length;p+=1){var f=d[p];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var _=this.circleCells[i];if(null!==_)for(var y=this.circles,g=0,v=_;g<v.length;g+=1){var b=v[g];if(!u.circle[b]){u.circle[b]=!0;var x=3*b;if(this._circlesCollide(y[x],y[x+1],y[x+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},te.prototype._forEachCell=function(t,e,r,n,i,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++){var f=this.xCellCount*d+p;if(i.call(this,t,e,r,n,f,o,a,s))return}},te.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},te.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},te.prototype._circlesCollide=function(t,e,r,n,i,o){var a=n-t,s=i-e,l=r+o;return l*l>a*a+s*s},te.prototype._circleAndRectCollide=function(t,e,r,n,i,o,a){var s=(o-n)/2,l=Math.abs(t-(n+s));if(l>s+r)return!1;var u=(a-i)/2,c=Math.abs(e-(i+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=r*r};var ee=t.properties.layout;function re(e,r,n,i,o){var a=t.identity(new Float32Array(16));return r?(t.identity(a),t.scale(a,a,[1/o,1/o,1]),n||t.rotateZ(a,a,i.angle)):(t.scale(a,a,[i.width/2,-i.height/2,1]),t.translate(a,a,[1,-1,0]),t.multiply(a,a,e)),a}function ne(e,r,n,i,o){var a=t.identity(new Float32Array(16));return r?(t.multiply(a,a,e),t.scale(a,a,[o,o,1]),n||t.rotateZ(a,a,-i.angle)):(t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/i.width,2/i.height,1])),a}function ie(e,r){var n=[e.x,e.y,0,1];fe(n,n,r);var i=n[3];return{point:new t.Point(n[0]/i,n[1]/i),signedDistanceFromCamera:i}}function oe(t,e){var r=t[0]/t[3],n=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&n>=-e[1]&&n<=e[1]}function ae(e,r,n,i,o,a,s,l){var u=i?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,n.transform.zoom,ee.properties[i?"text-size":"icon-size"]),h=[256/n.width*2+1,256/n.height*2+1],p=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var d=e.lineVertexArray,f=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=n.transform.width/n.transform.height,_=!1,y=0;y<f.length;y++){var g=f.get(y);if(g.hidden||g.writingMode===t.WritingMode.vertical&&!_)de(g.numGlyphs,p);else{_=!1;var v=[g.anchorX,g.anchorY,0,1];if(t.transformMat4(v,v,r),oe(v,h)){var b=.5+v[3]/n.transform.cameraToCenterDistance*.5,x=t.evaluateSizeForFeature(u,c,g),w=s?x*b:x/b,k=new t.Point(g.anchorX,g.anchorY),E=ie(k,o).point,I={},S=ue(g,w,!1,l,r,o,a,e.glyphOffsetArray,d,p,E,k,I,m);_=S.useVertical,(S.notEnoughRoom||_||S.needsFlipping&&ue(g,w,!0,l,r,o,a,e.glyphOffsetArray,d,p,E,k,I,m).notEnoughRoom)&&de(g.numGlyphs,p)}else de(g.numGlyphs,p)}}i?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function se(t,e,r,n,i,o,a,s,l,u,c,h){var p=s.glyphStartIndex+s.numGlyphs,d=s.lineStartIndex,f=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),_=e.getoffsetX(p-1),y=he(t*m,r,n,i,o,a,s.segment,d,f,l,u,c,h);if(!y)return null;var g=he(t*_,r,n,i,o,a,s.segment,d,f,l,u,c,h);return g?{first:y,last:g}:null}function le(e,r,n,i){return e===t.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function ue(e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m,_=r/24,y=e.lineOffsetX*r,g=e.lineOffsetY*r;if(e.numGlyphs>1){var v=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=se(_,l,y,g,n,h,p,e,u,a,d,!1);if(!w)return{notEnoughRoom:!0};var k=ie(w.first.point,s).point,E=ie(w.last.point,s).point;if(i&&!n){var I=le(e.writingMode,k,E,f);if(I)return I}m=[w.first];for(var S=e.glyphStartIndex+1;S<v-1;S++)m.push(he(_*l.getoffsetX(S),y,g,n,h,p,e.segment,b,x,u,a,d,!1));m.push(w.last)}else{if(i&&!n){var M=ie(p,o).point,T=e.lineStartIndex+e.segment+1,A=new t.Point(u.getx(T),u.gety(T)),P=ie(A,o),C=P.signedDistanceFromCamera>0?P.point:ce(p,A,M,1,o),D=le(e.writingMode,M,C,f);if(D)return D}var z=he(_*l.getoffsetX(e.glyphStartIndex),y,g,n,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,d,!1);if(!z)return{notEnoughRoom:!0};m=[z]}for(var B=0,L=m;B<L.length;B+=1){var R=L[B];t.addDynamicAttributes(c,R.point,R.angle)}return{}}function ce(t,e,r,n,i){var o=ie(t.add(t.sub(e)._unit()),i).point,a=r.sub(o);return r.add(a._mult(n/a.mag()))}function he(e,r,n,i,o,a,s,l,u,c,h,p,d){var f=i?e-r:e+r,m=f>0?1:-1,_=0;i&&(m*=-1,_=Math.PI),m<0&&(_+=Math.PI);for(var y=m>0?l+s:l+s+1,g=y,v=o,b=o,x=0,w=0,k=Math.abs(f);x+w<=k;){if((y+=m)<l||y>=u)return null;if(b=v,void 0===(v=p[y])){var E=new t.Point(c.getx(y),c.gety(y)),I=ie(E,h);if(I.signedDistanceFromCamera>0)v=p[y]=I.point;else{var S=y-m;v=ce(0===x?a:new t.Point(c.getx(S),c.gety(S)),E,b,k-x+1,h)}}x+=w,w=b.dist(v)}var M=(k-x)/w,T=v.sub(b),A=T.mult(M)._add(b);return A._add(T._unit()._perp()._mult(n*m)),{point:A,angle:_+Math.atan2(v.y-b.y,v.x-b.x),tileDistance:d?{prevTileDistance:y-m===g?0:c.gettileUnitDistanceFromAnchor(y-m),lastSegmentViewportDistance:k-x}:null}}var pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(t,e){for(var r=0;r<t;r++){var n=e.length;e.resize(n+4),e.float32.set(pe,3*n)}}function fe(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t[3]=r[3]*n+r[7]*i+r[15],t}var me=function(t,e,r){void 0===e&&(e=new te(t.width+200,t.height+200,25)),void 0===r&&(r=new te(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function _e(t,e,r){t[e+4]=r?1:0}function ye(e,r,n){return r*(t.EXTENT/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}me.prototype.placeCollisionBox=function(t,e,r,n,i){var o=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY),a=r*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!e&&this.grid.hitTest(s,l,u,c,i)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},me.prototype.approximateTileDistance=function(t,e,r,n,i){var o=i?1:n/this.pitchfactor,a=t.lastSegmentViewportDistance*r;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},me.prototype.placeCollisionCircles=function(e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m=[],_=this.projectAnchor(c,a.anchorX,a.anchorY),y=u/24,g=a.lineOffsetX*u,v=a.lineOffsetY*u,b=new t.Point(a.anchorX,a.anchorY),x=se(y,l,g,v,!1,ie(b,h).point,b,a,s,h,{},!0),w=!1,k=!1,E=!0,I=_.perspectiveRatio*i,S=1/(i*n),M=0,T=0;x&&(M=this.approximateTileDistance(x.first.tileDistance,x.first.angle,S,_.cameraDistance,d),T=this.approximateTileDistance(x.last.tileDistance,x.last.angle,S,_.cameraDistance,d));for(var A=0;A<e.length;A+=5){var P=e[A],C=e[A+1],D=e[A+2],z=e[A+3];if(!x||z<-M||z>T)_e(e,A,!1);else{var B=this.projectPoint(c,P,C),L=D*I;if(m.length>0){var R=B.x-m[m.length-4],O=B.y-m[m.length-3];if(L*L*2>R*R+O*O&&A+8<e.length){var F=e[A+8];if(F>-M&&F<T){_e(e,A,!1);continue}}}var N=A/5;m.push(B.x,B.y,L,N),_e(e,A,!0);var V=B.x-L,j=B.y-L,U=B.x+L,q=B.y+L;if(E=E&&this.isOffscreen(V,j,U,q),k=k||this.isInsideGrid(V,j,U,q),!r&&this.grid.hitTestCircle(B.x,B.y,L,f)){if(!p)return{circles:[],offscreen:!1};w=!0}}}return{circles:w||!k?[]:m,offscreen:E}},me.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,i=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var u=l[s],c=new t.Point(u.x+100,u.y+100);n=Math.min(n,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),r.push(c)}for(var h={},p={},d=0,f=this.grid.query(n,i,o,a).concat(this.ignoredGrid.query(n,i,o,a));d<f.length;d+=1){var m=f[d],_=m.key;if(void 0===h[_.bucketInstanceId]&&(h[_.bucketInstanceId]={}),!h[_.bucketInstanceId][_.featureIndex]){var y=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(r,y)&&(h[_.bucketInstanceId][_.featureIndex]=!0,void 0===p[_.bucketInstanceId]&&(p[_.bucketInstanceId]=[]),p[_.bucketInstanceId].push(_.featureIndex))}}return p},me.prototype.insertCollisionBox=function(t,e,r,n,i){var o={bucketInstanceId:r,featureIndex:n,collisionGroupID:i};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},me.prototype.insertCollisionCircles=function(t,e,r,n,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:n,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},me.prototype.projectAnchor=function(t,e,r){var n=[e,r,0,1];return fe(n,n,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5,cameraDistance:n[3]}},me.prototype.projectPoint=function(e,r,n){var i=[r,n,0,1];return fe(i,i,e),new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},me.prototype.projectAndGetPerspectiveRatio=function(e,r,n){var i=[r,n,0,1];return fe(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},me.prototype.isOffscreen=function(t,e,r,n){return r<100||t>=this.screenRightBoundary||n<100||e>this.screenBottomBoundary},me.prototype.isInsideGrid=function(t,e,r,n){return r>=0&&t<this.gridRightBoundary&&n>=0&&e<this.gridBottomBoundary};var ge=function(t,e,r,n){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):n&&r?1:0,this.placed=r};ge.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ve=function(t,e,r,n,i){this.text=new ge(t?t.text:null,e,r,i),this.icon=new ge(t?t.icon:null,e,n,i)};ve.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var be=function(t,e,r){this.text=t,this.icon=e,this.skipFade=r},xe=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};xe.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var we=function(t,e,r){this.transform=t.clone(),this.collisionIndex=new me(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new xe(r)};function ke(t,e,r){t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0)}we.prototype.placeLayerTile=function(e,r,n,i){var o=r.getBucket(e),a=r.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=r.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),p=re(h,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,ye(r,1,this.transform.zoom)),d=re(h,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,ye(r,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,r,n,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID),this.placeLayerBucket(o,h,p,d,u,c,n,r.holdingForFade(),i,s)}},we.prototype.placeLayerBucket=function(e,r,n,i,o,a,s,l,u,c){for(var h=e.layers[0].layout,p=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,t.properties.layout.properties["text-size"]),d=h.get("text-optional"),f=h.get("icon-optional"),m=this.collisionGroups.get(e.sourceID),_=0,y=e.symbolInstances;_<y.length;_+=1){var g=y[_];if(!u[g.crossTileID]){if(l){this.placements[g.crossTileID]=new be(!1,!1,!1);continue}var v=!1,b=!1,x=!0,w=null,k=null,E=null,I=0,S=0;g.collisionArrays||(g.collisionArrays=e.deserializeCollisionBoxes(c,g.textBoxStartIndex,g.textBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex)),g.collisionArrays.textFeatureIndex&&(I=g.collisionArrays.textFeatureIndex),g.collisionArrays.textBox&&(v=(w=this.collisionIndex.placeCollisionBox(g.collisionArrays.textBox,h.get("text-allow-overlap"),a,r,m.predicate)).box.length>0,x=x&&w.offscreen);var M=g.collisionArrays.textCircles;if(M){var T=e.text.placedSymbolArray.get(g.placedTextSymbolIndices[0]),A=t.evaluateSizeForFeature(e.textSizeData,p,T);k=this.collisionIndex.placeCollisionCircles(M,h.get("text-allow-overlap"),o,a,g.key,T,e.lineVertexArray,e.glyphOffsetArray,A,r,n,s,"map"===h.get("text-pitch-alignment"),m.predicate),v=h.get("text-allow-overlap")||k.circles.length>0,x=x&&k.offscreen}g.collisionArrays.iconFeatureIndex&&(S=g.collisionArrays.iconFeatureIndex),g.collisionArrays.iconBox&&(b=(E=this.collisionIndex.placeCollisionBox(g.collisionArrays.iconBox,h.get("icon-allow-overlap"),a,r,m.predicate)).box.length>0,x=x&&E.offscreen);var P=d||0===g.numGlyphVertices&&0===g.numVerticalGlyphVertices,C=f||0===g.numIconVertices;P||C?C?P||(b=b&&v):v=b&&v:b=v=b&&v,v&&w&&this.collisionIndex.insertCollisionBox(w.box,h.get("text-ignore-placement"),e.bucketInstanceId,I,m.ID),b&&E&&this.collisionIndex.insertCollisionBox(E.box,h.get("icon-ignore-placement"),e.bucketInstanceId,S,m.ID),v&&k&&this.collisionIndex.insertCollisionCircles(k.circles,h.get("text-ignore-placement"),e.bucketInstanceId,I,m.ID),this.placements[g.crossTileID]=new be(v,b,x||e.justReloaded),u[g.crossTileID]=!0}}e.justReloaded=!1},we.prototype.commit=function(t,e){this.commitTime=e;var r=!1,n=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,i=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=i[o];s?(this.opacities[o]=new ve(s,n,a.text,a.icon),r=r||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new ve(null,n,a.text,a.icon,a.skipFade),r=r||a.text||a.icon)}for(var l in i){var u=i[l];if(!this.opacities[l]){var c=new ve(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},we.prototype.updateLayerOpacities=function(t,e){for(var r={},n=0,i=e;n<i.length;n+=1){var o=i[n],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}},we.prototype.updateBucketOpacities=function(t,e,r){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();for(var n=t.layers[0].layout,i=new ve(null,0,!1,!1,!0),o=new ve(null,0,n.get("text-allow-overlap"),n.get("icon-allow-overlap"),!0),a=0;a<t.symbolInstances.length;a++){var s=t.symbolInstances[a],l=e[s.crossTileID],u=this.opacities[s.crossTileID];l?u=i:u||(u=o,this.opacities[s.crossTileID]=u),e[s.crossTileID]=!0;var c=s.numGlyphVertices>0||s.numVerticalGlyphVertices>0,h=s.numIconVertices>0;if(c){for(var p=Ce(u.text),d=(s.numGlyphVertices+s.numVerticalGlyphVertices)/4,f=0;f<d;f++)t.text.opacityVertexArray.emplaceBack(p);for(var m=0,_=s.placedTextSymbolIndices;m<_.length;m+=1){var y=_[m];t.text.placedSymbolArray.get(y).hidden=u.text.isHidden()}}if(h){for(var g=Ce(u.icon),v=0;v<s.numIconVertices/4;v++)t.icon.opacityVertexArray.emplaceBack(g);t.icon.placedSymbolArray.get(a).hidden=u.icon.isHidden()}s.collisionArrays||(s.collisionArrays=t.deserializeCollisionBoxes(r,s.textBoxStartIndex,s.textBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex));var b=s.collisionArrays;if(b){b.textBox&&t.hasCollisionBoxData()&&ke(t.collisionBox.collisionVertexArray,u.text.placed,!1),b.iconBox&&t.hasCollisionBoxData()&&ke(t.collisionBox.collisionVertexArray,u.icon.placed,!1);var x=b.textCircles;if(x&&t.hasCollisionCircleData())for(var w=0;w<x.length;w+=5){var k=l||0===x[w+4];ke(t.collisionCircle.collisionVertexArray,u.text.placed,k)}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},we.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},we.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},we.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},we.prototype.setStale=function(){this.stale=!0};var Ee=Math.pow(2,25),Ie=Math.pow(2,24),Se=Math.pow(2,17),Me=Math.pow(2,16),Te=Math.pow(2,9),Ae=Math.pow(2,8),Pe=Math.pow(2,1);function Ce(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*Ee+e*Ie+r*Se+e*Me+r*Te+e*Ae+r*Pe+e}var De=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};De.prototype.continuePlacement=function(t,e,r,n,i){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(n,o,r,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var ze=function(t,e,r,n,i,o){this.placement=new we(t,i,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};ze.prototype.isDone=function(){return this._done},ze.prototype.continuePlacement=function(e,r,n){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=r[e[i._currentPlacementIndex]],l=i.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(i._inProgressLayer||(i._inProgressLayer=new De),i._inProgressLayer.continuePlacement(n[s.source],i.placement,i._showCollisionBoxes,s,a))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},ze.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var Be=512/t.EXTENT/2,Le=function(t,e,r){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0,i=e;n<i.length;n+=1){var o=i[n],a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)})}};Le.prototype.getScaledCoordinates=function(e,r){var n=r.canonical.z-this.tileID.canonical.z,i=Be/Math.pow(2,n),o=e.anchor;return{x:Math.floor((r.canonical.x*t.EXTENT+o.x)*i),y:Math.floor((r.canonical.y*t.EXTENT+o.y)*i)}},Le.prototype.findMatches=function(t,e,r){for(var n=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0,o=t;i<o.length;i+=1){var a=o[i];if(!a.crossTileID){var s=this.indexedSymbolInstances[a.key];if(s)for(var l=this.getScaledCoordinates(a,e),u=0,c=s;u<c.length;u+=1){var h=c[u];if(Math.abs(h.coord.x-l.x)<=n&&Math.abs(h.coord.y-l.y)<=n&&!r[h.crossTileID]){r[h.crossTileID]=!0,a.crossTileID=h.crossTileID;break}}}}};var Re=function(){this.maxCrossTileID=0};Re.prototype.generate=function(){return++this.maxCrossTileID};var Oe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Oe.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var r in this.indexes){var n=this.indexes[r],i={};for(var o in n){var a=n[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[r]=i}this.lng=t},Oe.prototype.addBucket=function(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var n=0,i=e.symbolInstances;n<i.length;n+=1)i[n].crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var o=this.usedCrossTileIDs[t.overscaledZ];for(var a in this.indexes){var s=this.indexes[a];if(Number(a)>t.overscaledZ)for(var l in s){var u=s[l];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,o)}else{var c=s[t.scaledTo(Number(a)).key];c&&c.findMatches(e.symbolInstances,t,o)}}for(var h=0,p=e.symbolInstances;h<p.length;h+=1){var d=p[h];d.crossTileID||(d.crossTileID=r.generate(),o[d.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Le(t,e.symbolInstances,e.bucketInstanceId),!0},Oe.prototype.removeBucketCrossTileIDs=function(t,e){for(var r in e.indexedSymbolInstances)for(var n=0,i=e.indexedSymbolInstances[r];n<i.length;n+=1){var o=i[n];delete this.usedCrossTileIDs[t][o.crossTileID]}},Oe.prototype.removeStaleBuckets=function(t){var e=!1;for(var r in this.indexes){var n=this.indexes[r];for(var i in n)t[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],e=!0)}return e};var Fe=function(){this.layerIndexes={},this.crossTileIDs=new Re,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Fe.prototype.addLayer=function(t,e,r){var n=this.layerIndexes[t.id];void 0===n&&(n=this.layerIndexes[t.id]=new Oe);var i=!1,o={};n.handleWrapJump(r);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(i=!0),o[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(i=!0),i},Fe.prototype.pruneUnusedLayers=function(t){var e={};for(var r in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[r]||delete this.layerIndexes[r]};var Ne=function(e,r){return t.emitValidationErrors(e,r&&r.filter(function(t){return"source.canvas"!==t.identifier}))},Ve=t.pick(Xt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),je=t.pick(Xt,["setCenter","setZoom","setBearing","setPitch"]),Ue=function(e){function r(n,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=n,this.dispatcher=new R((Ut||(Ut=new qt),Ut),this),this.imageManager=new I,this.glyphManager=new C(n._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new L(256,512),this.crossTileSymbolIndex=new Fe,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._resetUpdates();var a=this;this._rtlTextPluginCallback=r.registerForPluginAvailability(function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var r=e.getSource();if(r&&r.vectorLayerIds)for(var n in o._layers){var i=o._layers[n];i.source===r.id&&o._validateLayer(i)}}}})}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadURL=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof r.validate?r.validate:!f(e);e=function(t,e){if(!f(t))return t;var r=b(t);return r.path="/styles/v1"+r.path,d(r,e)}(e,r.accessToken);var o=this.map._transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,function(e,r){n._request=null,e?n.fire(new t.ErrorEvent(e)):r&&n._load(r,i)})},r.prototype.loadJSON=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame(function(){n._request=null,n._load(e,!1!==r.validate)})},r.prototype._load=function(e,r){var n=this;if(!r||!Ne(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)n.addSource(i,e.sources[i],{validate:!1});e.sprite?this._spriteRequest=function(e,r,n){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",l=t.getJSON(r(_(e,s,".json"),t.ResourceType.SpriteJSON),function(t,e){l=null,a||(a=t,i=e,c())}),u=t.getImage(r(_(e,s,".png"),t.ResourceType.SpriteImage),function(t,e){u=null,a||(a=t,o=e,c())});function c(){if(a)n(a);else if(i&&o){var e=t.browser.getImageData(o),r={};for(var s in i){var l=i[s],u=l.width,c=l.height,h=l.x,p=l.y,d=l.sdf,f=l.pixelRatio,m=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,m,{x:h,y:p},{x:0,y:0},{width:u,height:c}),r[s]={data:m,pixelRatio:f,sdf:d}}n(null,r)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e.sprite,this.map._transformRequest,function(e,r){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=Zt(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var l=s[a];(l=t.createStyleLayer(l)).setEventedParent(n,{layer:{id:l.id}}),n._layers[l.id]=l}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new B(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},r.prototype._validateLayer=function(e){var r=this.sourceCaches[e.source];if(r){var n=e.sourceLayer;if(n){var i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(t){var e=this;return t.map(function(t){return e._layers[t].serialize()})},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(e){if(this._loaded){if(this._changed){var r=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var i in(r.length||n.length)&&this._updateWorkerLayers(r,n),this._updatedSources){var o=this._updatedSources[i];"reload"===o?this._reloadSource(i):"clear"===o&&this._clearSource(i)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];h.recalculate(e),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},r.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},r.prototype.setState=function(e){var r=this;if(this._checkLoaded(),Ne(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=Zt(e.layers);var n=function(e,r){if(!e)return[{command:Xt.setStyle,args:[r]}];var n=[];try{if(!t.deepEqual(e.version,r.version))return[{command:Xt.setStyle,args:[r]}];t.deepEqual(e.center,r.center)||n.push({command:Xt.setCenter,args:[r.center]}),t.deepEqual(e.zoom,r.zoom)||n.push({command:Xt.setZoom,args:[r.zoom]}),t.deepEqual(e.bearing,r.bearing)||n.push({command:Xt.setBearing,args:[r.bearing]}),t.deepEqual(e.pitch,r.pitch)||n.push({command:Xt.setPitch,args:[r.pitch]}),t.deepEqual(e.sprite,r.sprite)||n.push({command:Xt.setSprite,args:[r.sprite]}),t.deepEqual(e.glyphs,r.glyphs)||n.push({command:Xt.setGlyphs,args:[r.glyphs]}),t.deepEqual(e.transition,r.transition)||n.push({command:Xt.setTransition,args:[r.transition]}),t.deepEqual(e.light,r.light)||n.push({command:Xt.setLight,args:[r.light]});var i={},o=[];!function(e,r,n,i){var o;for(o in r=r||{},e=e||{})e.hasOwnProperty(o)&&(r.hasOwnProperty(o)||Ht(o,n,i));for(o in r)r.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],r[o])||("geojson"===e[o].type&&"geojson"===r[o].type&&Kt(e,r,o)?n.push({command:Xt.setGeoJSONSourceData,args:[o,r[o].data]}):Yt(o,r,n,i)):Wt(o,r,n))}(e.sources,r.sources,o,i);var a=[];e.layers&&e.layers.forEach(function(t){i[t.source]?n.push({command:Xt.removeLayer,args:[t.id]}):a.push(t)}),n=n.concat(o),function(e,r,n){r=r||[];var i,o,a,s,l,u,c,h=(e=e||[]).map(Qt),p=r.map(Qt),d=e.reduce($t,{}),f=r.reduce($t,{}),m=h.slice(),_=Object.create(null);for(i=0,o=0;i<h.length;i++)a=h[i],f.hasOwnProperty(a)?o++:(n.push({command:Xt.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(i=0,o=0;i<p.length;i++)a=p[p.length-1-i],m[m.length-1-i]!==a&&(d.hasOwnProperty(a)?(n.push({command:Xt.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,u=m[m.length-i],n.push({command:Xt.addLayer,args:[f[a],u]}),m.splice(m.length-i,0,a),_[a]=!0);for(i=0;i<p.length;i++)if(s=d[a=p[i]],l=f[a],!_[a]&&!t.deepEqual(s,l))if(t.deepEqual(s.source,l.source)&&t.deepEqual(s["source-layer"],l["source-layer"])&&t.deepEqual(s.type,l.type)){for(c in Jt(s.layout,l.layout,n,a,null,Xt.setLayoutProperty),Jt(s.paint,l.paint,n,a,null,Xt.setPaintProperty),t.deepEqual(s.filter,l.filter)||n.push({command:Xt.setFilter,args:[a,l.filter]}),t.deepEqual(s.minzoom,l.minzoom)&&t.deepEqual(s.maxzoom,l.maxzoom)||n.push({command:Xt.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Jt(s[c],l[c],n,a,c.slice(6),Xt.setPaintProperty):t.deepEqual(s[c],l[c])||n.push({command:Xt.setLayerProperty,args:[a,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Jt(s[c],l[c],n,a,c.slice(6),Xt.setPaintProperty):t.deepEqual(s[c],l[c])||n.push({command:Xt.setLayerProperty,args:[a,c,l[c]]}))}else n.push({command:Xt.removeLayer,args:[a]}),u=m[m.lastIndexOf(a)+1],n.push({command:Xt.addLayer,args:[l,u]})}(a,r.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:Xt.setStyle,args:[r]}]}return n}(this.serialize(),e).filter(function(t){return!(t.command in je)});if(0===n.length)return!1;var i=n.filter(function(t){return!(t.command in Ve)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return n.forEach(function(t){"setTransition"!==t.command&&r[t.command].apply(r,t.args)}),this.stylesheet=e,!0},r.prototype.addImage=function(e,r){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,r),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.getImage=function(t){return this.imageManager.getImage(t)},r.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},r.prototype.addSource=function(e,r,n){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,r,null,n))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Ot(e,r,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}}),o.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},r.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},r.prototype.addLayer=function(e,r,n){this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone(e),e=t.extend(e,{source:i})),!this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},n)){var o=t.createStyleLayer(e);this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}});var a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o)}}},r.prototype.moveLayer=function(e,r){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==r){var n=this._order.indexOf(e);this._order.splice(n,1);var i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(e){this._checkLoaded();var r=this._layers[e];if(r){r.setEventedParent(null);var n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e]}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(t){return this._layers[t]},r.prototype.setLayerZoomRange=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(e,r){this._checkLoaded();var n=this.getLayer(e);if(n){if(!t.deepEqual(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.validateStyle.filter,"layers."+n.id+".filter",r)||(n.filter=t.clone(r),this._updateLayer(n)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},r.prototype.setLayoutProperty=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?t.deepEqual(i.getLayoutProperty(r),n)||(i.setLayoutProperty(r,n),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},r.prototype.setPaintProperty=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?t.deepEqual(i.getPaintProperty(r),n)||(i.setPaintProperty(r,n)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},r.prototype.setFeatureState=function(e,r){this._checkLoaded();var n=e.source,i=e.sourceLayer,o=this.sourceCaches[n];void 0!==o?"vector"!==o.getSource().type||i?null!=e.id&&""!==e.id?o.setFeatureState(i,e.id,r):this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))):this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.getFeatureState=function(e){this._checkLoaded();var r=e.source,n=e.sourceLayer,i=this.sourceCaches[r];if(void 0!==i){if("vector"!==i.getSource().type||n)return i.getFeatureState(n,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},r.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){var e=this;return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._order.map(function(t){return e._layers[t].serialize()})},function(t){return void 0!==t})},r.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},r.prototype._flattenRenderedFeatures=function(t){for(var e=[],r=this._order.length-1;r>=0;r--)for(var n=this._order[r],i=0,o=t;i<o.length;i+=1){var a=o[i][n];if(a)for(var s=0,l=a;s<l.length;s+=1){var u=l[s];e.push(u)}}return e},r.prototype.queryRenderedFeatures=function(e,r,n){r&&r.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",r.filter);var i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=r.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[l.source]=!0}}var u=[],c=e.map(function(t){return n.pointCoordinate(t)});for(var h in this.sourceCaches)r.layers&&!i[h]||u.push(J(this.sourceCaches[h],this._layers,c,r,n));return this.placement&&u.push(function(t,e,r,n,i,o){for(var a={},s=i.queryRenderedSymbols(r),l=[],u=0,c=Object.keys(s).map(Number);u<c.length;u+=1){var h=c[u];l.push(o[h])}l.sort(Q);for(var p=function(){var e=f[d],r=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,n.filter,n.layers,t);for(var i in r){var o=a[i]=a[i]||[],l=r[i];l.sort(function(t,r){var n=e.featureSortOrder;if(n){var i=n.indexOf(t.featureIndex);return n.indexOf(r.featureIndex)-i}return r.featureIndex-t.featureIndex});for(var u=0,c=l;u<c.length;u+=1){var h=c[u];o.push(h.feature)}}},d=0,f=l;d<f.length;d+=1)p();var m=function(r){a[r].forEach(function(n){var i=t[r],o=e[i.source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=o})};for(var _ in a)m(_);return a}(this._layers,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},r.prototype.querySourceFeatures=function(e,r){r&&r.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",r.filter);var n=this.sourceCaches[e];return n?function(t,e){for(var r=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),n=[],i={},o=0;o<r.length;o++){var a=r[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(n,e))}return n}(n,r):[]},r.prototype.addSourceType=function(t,e,n){return r.getSourceType(t)?n(new Error('A source type called "'+t+'" already exists.')):(r.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(e){this._checkLoaded();var r=this.light.getLight(),n=!1;for(var i in e)if(!t.deepEqual(e[i],r[i])){n=!0;break}if(n){var o={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},r.prototype._validate=function(e,r,n,i,o){return(!o||!1!==o.validate)&&Ne(this,e.call(t.validateStyle,t.extend({key:r,style:this.serialize(),value:n,styleSpec:t.styleSpec},i)))},r.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},r.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},r.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},r.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},r.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},r.prototype._updatePlacement=function(e,r,n,i){for(var o=!1,a=!1,s={},l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];if("symbol"===h.type){if(!s[h.source]){var p=this.sourceCaches[h.source];s[h.source]=p.getRenderableIds(!0).map(function(t){return p.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var d=this.crossTileSymbolIndex.addLayer(h,s[h.source],e.center.lng);o=o||d}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var f=this._layerOrderChanged;if((f||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now()))&&(this.pauseablePlacement=new ze(e,this._order,f,r,n,i),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,t.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var m=0,_=this._order;m<_.length;m+=1){var y=_[m],g=this._layers[y];"symbol"===g.type&&this.placement.updateLayerOpacities(g,s[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},r.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},r.prototype.getImages=function(t,e,r){this.imageManager.getImages(e.icons,r)},r.prototype.getGlyphs=function(t,e,r){this.glyphManager.getGlyphs(e.stacks,r)},r}(t.Evented);Ue.getSourceType=function(t){return Y[t]},Ue.setSourceType=function(t,e){Y[t]=e},Ue.registerForPluginAvailability=t.registerForPluginAvailability;var qe=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ge={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},Ze=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Xe=function(t){var e=Ge[t],r={};e.fragmentSource=e.fragmentSource.replace(Ze,function(t,e,n,i,o){return r[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(Ze,function(t,e,n,i,o){var a="float"===i?"vec2":"vec4";return r[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"})};for(var We in Ge)Xe(We);var He=Ge,Ye=function(e,r,n,i){var o=e.gl;this.program=o.createProgram();var a=n.defines().concat("#define DEVICE_PIXEL_RATIO "+t.browser.devicePixelRatio.toFixed(1));i&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(He.prelude.fragmentSource,r.fragmentSource).join("\n"),l=a.concat(He.prelude.vertexSource,r.vertexSource).join("\n"),u=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(u,s),o.compileShader(u),o.attachShader(this.program,u);var c=o.createShader(o.VERTEX_SHADER);o.shaderSource(c,l),o.compileShader(c),o.attachShader(this.program,c);for(var h=n.layoutAttributes||[],p=0;p<h.length;p++)o.bindAttribLocation(this.program,p,h[p].name);o.linkProgram(this.program),this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var d=0;d<this.numAttributes;d++){var f=o.getActiveAttrib(this.program,d);f&&(this.attributes[f.name]=o.getAttribLocation(this.program,f.name))}for(var m=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS),_=0;_<m;_++){var y=o.getActiveUniform(this.program,_);y&&(this.uniforms[y.name]=o.getUniformLocation(this.program,y.name))}};function Ke(e,r){for(var n=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),i=0;i<n.length;i++){var o={},a=n[i],s=n.slice(i+1);Je(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,r)}}function Je(e,r,n,i,o){for(var a=0;a<n.length;a++){var s=n[a];if(i.isLessThan(s.tileID))break;if(r.key===s.tileID.key)return;if(s.tileID.isChildOf(r)){for(var l=r.children(1/0),u=0;u<l.length;u++)Je(e,l[u],n.slice(a),i,o);return}}var c=r.overscaledZ-e.overscaledZ,h=new t.CanonicalTileID(c,r.canonical.x-(e.canonical.x<<c),r.canonical.y-(e.canonical.y<<c));o[h.key]=o[h.key]||h}function Qe(t,e,r,n,i){var o=t.context,a=o.gl,s=i?t.useProgram("collisionCircle"):t.useProgram("collisionBox");o.setDepthMode(zt.disabled),o.setStencilMode(Bt.disabled),o.setColorMode(t.colorModeForRenderPass());for(var l=0;l<n.length;l++){var u=n[l],c=e.getTile(u),h=c.getBucket(r);if(h){var p=i?h.collisionCircle:h.collisionBox;if(p){a.uniformMatrix4fv(s.uniforms.u_matrix,!1,u.posMatrix),a.uniform1f(s.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance);var d=ye(c,1,t.transform.zoom),f=Math.pow(2,t.transform.zoom-c.tileID.overscaledZ);a.uniform1f(s.uniforms.u_pixels_to_tile_units,d),a.uniform2f(s.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits[0]/(d*f),t.transform.pixelsToGLUnits[1]/(d*f)),a.uniform1f(s.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),s.draw(o,i?a.TRIANGLES:a.LINES,r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,null,p.collisionVertexBuffer,null)}}}}Ye.prototype.draw=function(t,e,r,n,i,o,a,s,l){for(var u,c=t.gl,h=(u={},u[c.LINES]=2,u[c.TRIANGLES]=3,u)[e],p=0,d=o.get();p<d.length;p+=1){var f=d[p],m=f.vaos||(f.vaos={});(m[r]||(m[r]=new Z)).bind(t,this,n,a?a.getPaintVertexBuffers():[],i,f.vertexOffset,s,l),c.drawElements(e,f.primitiveLength*h,c.UNSIGNED_SHORT,f.primitiveOffset*h*2)}};var $e=t.identity(new Float32Array(16)),tr=t.properties.layout;function er(t,e,r,n,i,o,a,s,l,u){var c,h=t.context,p=h.gl,d=t.transform,f="map"===s,m="map"===l,_=f&&"point"!==r.layout.get("symbol-placement"),y=f&&!m&&!_,g=m;h.setDepthMode(g?t.depthModeForSublayer(0,zt.ReadOnly):zt.disabled);for(var v=0,b=n;v<b.length;v+=1){var x=b[v],w=e.getTile(x),k=w.getBucket(r);if(k){var E=i?k.text:k.icon;if(E&&E.segments.get().length){var I=E.programConfigurations.get(r.id),S=i||k.sdfIcons,M=i?k.textSizeData:k.iconSizeData;if(c||(c=t.useProgram(S?"symbolSDF":"symbolIcon",I),I.setUniforms(t.context,c,r.paint,{zoom:t.transform.zoom}),rr(c,t,0,i,y,m,M)),h.activeTexture.set(p.TEXTURE0),p.uniform1i(c.uniforms.u_texture,0),i)w.glyphAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.glyphAtlasTexture.size);else{var T=1!==r.layout.get("icon-size").constantOr(0)||k.iconsNeedLinear,A=m||0!==d.pitch;w.iconAtlasTexture.bind(S||t.options.rotating||t.options.zooming||T||A?p.LINEAR:p.NEAREST,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.iconAtlasTexture.size)}p.uniformMatrix4fv(c.uniforms.u_matrix,!1,t.translatePosMatrix(x.posMatrix,w,o,a));var P=ye(w,1,t.transform.zoom),C=re(x.posMatrix,m,f,t.transform,P),D=ne(x.posMatrix,m,f,t.transform,P);p.uniformMatrix4fv(c.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(D,w,o,a,!0)),_?(p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,$e),ae(k,x.posMatrix,t,i,C,D,m,u)):p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,C),p.uniform1f(c.uniforms.u_fade_change,t.options.fadeDuration?t.symbolFadeChange:1),nr(c,0,t,r,0,E,i,S,m)}}}}function rr(e,r,n,i,o,a,s){var l=r.context.gl,u=r.transform;l.uniform1i(e.uniforms.u_pitch_with_map,a?1:0),l.uniform1f(e.uniforms.u_is_text,i?1:0),l.uniform1f(e.uniforms.u_pitch,u.pitch/360*2*Math.PI);var c="constant"===s.functionType||"source"===s.functionType,h="constant"===s.functionType||"camera"===s.functionType;l.uniform1i(e.uniforms.u_is_size_zoom_constant,c?1:0),l.uniform1i(e.uniforms.u_is_size_feature_constant,h?1:0),l.uniform1f(e.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var p=t.evaluateSizeForZoom(s,u.zoom,tr.properties[i?"text-size":"icon-size"]);void 0!==p.uSizeT&&l.uniform1f(e.uniforms.u_size_t,p.uSizeT),void 0!==p.uSize&&l.uniform1f(e.uniforms.u_size,p.uSize),l.uniform1f(e.uniforms.u_aspect_ratio,u.width/u.height),l.uniform1i(e.uniforms.u_rotate_symbol,o?1:0)}function nr(t,e,r,n,i,o,a,s,l){var u=r.context,c=u.gl,h=r.transform;if(s){var p=0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),d=l?Math.cos(h._pitch)*h.cameraToCenterDistance:1;c.uniform1f(t.uniforms.u_gamma_scale,d),p&&(c.uniform1f(t.uniforms.u_is_halo,1),ir(o,n,u,t)),c.uniform1f(t.uniforms.u_is_halo,0)}ir(o,n,u,t)}function ir(t,e,r,n){n.draw(r,r.gl.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function or(e,r,n,i,o,a,s,l,u){var c,h,p,d,f=r.context,m=f.gl,_=o.paint.get("line-dasharray"),y=o.paint.get("line-pattern");if(l||u){var g=1/ye(n,1,r.transform.tileZoom);if(_){c=r.lineAtlas.getDash(_.from,"round"===o.layout.get("line-cap")),h=r.lineAtlas.getDash(_.to,"round"===o.layout.get("line-cap"));var v=c.width*_.fromScale,b=h.width*_.toScale;m.uniform2f(e.uniforms.u_patternscale_a,g/v,-c.height/2),m.uniform2f(e.uniforms.u_patternscale_b,g/b,-h.height/2),m.uniform1f(e.uniforms.u_sdfgamma,r.lineAtlas.width/(256*Math.min(v,b)*t.browser.devicePixelRatio)/2)}else if(y){if(p=r.imageManager.getPattern(y.from),d=r.imageManager.getPattern(y.to),!p||!d)return;m.uniform2f(e.uniforms.u_pattern_size_a,p.displaySize[0]*y.fromScale/g,p.displaySize[1]),m.uniform2f(e.uniforms.u_pattern_size_b,d.displaySize[0]*y.toScale/g,d.displaySize[1]);var x=r.imageManager.getPixelSize(),w=x.width,k=x.height;m.uniform2fv(e.uniforms.u_texsize,[w,k])}m.uniform2f(e.uniforms.u_gl_units_to_pixels,1/r.transform.pixelsToGLUnits[0],1/r.transform.pixelsToGLUnits[1])}l&&(_?(m.uniform1i(e.uniforms.u_image,0),f.activeTexture.set(m.TEXTURE0),r.lineAtlas.bind(f),m.uniform1f(e.uniforms.u_tex_y_a,c.y),m.uniform1f(e.uniforms.u_tex_y_b,h.y),m.uniform1f(e.uniforms.u_mix,_.t)):y&&(m.uniform1i(e.uniforms.u_image,0),f.activeTexture.set(m.TEXTURE0),r.imageManager.bind(f),m.uniform2fv(e.uniforms.u_pattern_tl_a,p.tl),m.uniform2fv(e.uniforms.u_pattern_br_a,p.br),m.uniform2fv(e.uniforms.u_pattern_tl_b,d.tl),m.uniform2fv(e.uniforms.u_pattern_br_b,d.br),m.uniform1f(e.uniforms.u_fade,y.t))),f.setStencilMode(r.stencilModeForClipping(a));var E=r.translatePosMatrix(a.posMatrix,n,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"));if(m.uniformMatrix4fv(e.uniforms.u_matrix,!1,E),m.uniform1f(e.uniforms.u_ratio,1/ye(n,1,r.transform.zoom)),o.paint.get("line-gradient")){f.activeTexture.set(m.TEXTURE0);var I=o.gradientTexture;if(!o.gradient)return;I||(I=o.gradientTexture=new t.Texture(f,o.gradient,m.RGBA)),I.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.uniform1i(e.uniforms.u_image,0)}e.draw(f,m.TRIANGLES,o.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,s)}var ar=function(t,e){if(!t)return!1;var r=e.imageManager.getPattern(t.from),n=e.imageManager.getPattern(t.to);return!r||!n},sr=function(t,e,r){var n=e.context,i=n.gl,o=e.imageManager.getPattern(t.from),a=e.imageManager.getPattern(t.to);i.uniform1i(r.uniforms.u_image,0),i.uniform2fv(r.uniforms.u_pattern_tl_a,o.tl),i.uniform2fv(r.uniforms.u_pattern_br_a,o.br),i.uniform2fv(r.uniforms.u_pattern_tl_b,a.tl),i.uniform2fv(r.uniforms.u_pattern_br_b,a.br);var s=e.imageManager.getPixelSize(),l=s.width,u=s.height;i.uniform2fv(r.uniforms.u_texsize,[l,u]),i.uniform1f(r.uniforms.u_mix,t.t),i.uniform2fv(r.uniforms.u_pattern_size_a,o.displaySize),i.uniform2fv(r.uniforms.u_pattern_size_b,a.displaySize),i.uniform1f(r.uniforms.u_scale_a,t.fromScale),i.uniform1f(r.uniforms.u_scale_b,t.toScale),n.activeTexture.set(i.TEXTURE0),e.imageManager.bind(e.context)},lr=function(t,e,r){var n=e.context.gl;n.uniform1f(r.uniforms.u_tile_units_to_pixels,1/ye(t,1,e.transform.tileZoom));var i=Math.pow(2,t.tileID.overscaledZ),o=t.tileSize*Math.pow(2,e.transform.tileZoom)/i,a=o*(t.tileID.canonical.x+t.tileID.wrap*i),s=o*t.tileID.canonical.y;n.uniform2f(r.uniforms.u_pixel_coord_upper,a>>16,s>>16),n.uniform2f(r.uniforms.u_pixel_coord_lower,65535&a,65535&s)};function ur(t,e,r,n,i){if(!ar(r.paint.get("fill-pattern"),t))for(var o=!0,a=0,s=n;a<s.length;a+=1){var l=s[a],u=e.getTile(l),c=u.getBucket(r);c&&(t.context.setStencilMode(t.stencilModeForClipping(l)),i(t,e,r,u,l,c,o),o=!1)}}function cr(t,e,r,n,i,o,a){var s=t.context.gl,l=o.programConfigurations.get(r.id);pr("fill",r.paint.get("fill-pattern"),t,l,r,n,i,a).draw(t.context,s.TRIANGLES,r.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,l)}function hr(t,e,r,n,i,o,a){var s=t.context.gl,l=o.programConfigurations.get(r.id),u=pr("fillOutline",r.getPaintProperty("fill-outline-color")?null:r.paint.get("fill-pattern"),t,l,r,n,i,a);s.uniform2f(u.uniforms.u_world,s.drawingBufferWidth,s.drawingBufferHeight),u.draw(t.context,s.LINES,r.id,o.layoutVertexBuffer,o.indexBuffer2,o.segments2,l)}function pr(t,e,r,n,i,o,a,s){var l,u=r.context.program.get();return e?(l=r.useProgram(t+"Pattern",n),(s||l.program!==u)&&(n.setUniforms(r.context,l,i.paint,{zoom:r.transform.zoom}),sr(e,r,l)),lr(o,r,l)):(l=r.useProgram(t,n),(s||l.program!==u)&&n.setUniforms(r.context,l,i.paint,{zoom:r.transform.zoom})),r.context.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,r.translatePosMatrix(a.posMatrix,o,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"))),l}function dr(e,r,n,i,o,a,s){var l=e.context,u=l.gl,c=n.paint.get("fill-extrusion-pattern"),h=e.context.program.get(),p=a.programConfigurations.get(n.id),d=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",p);if((s||d.program!==h)&&p.setUniforms(l,d,n.paint,{zoom:e.transform.zoom}),c){if(ar(c,e))return;sr(c,e,d),lr(i,e,d),u.uniform1f(d.uniforms.u_height_factor,-Math.pow(2,o.overscaledZ)/i.tileSize/8)}e.context.gl.uniformMatrix4fv(d.uniforms.u_matrix,!1,e.translatePosMatrix(o.posMatrix,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor"))),function(e,r){var n=r.context.gl,i=r.style.light,o=i.properties.get("position"),a=[o.x,o.y,o.z],s=t.create$2();"viewport"===i.properties.get("anchor")&&t.fromRotation(s,-r.transform.angle),t.transformMat3(a,a,s);var l=i.properties.get("color");n.uniform3fv(e.uniforms.u_lightpos,a),n.uniform1f(e.uniforms.u_lightintensity,i.properties.get("intensity")),n.uniform3f(e.uniforms.u_lightcolor,l.r,l.g,l.b)}(d,e),d.draw(l,u.TRIANGLES,n.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,p)}function fr(e,r,n){var i=e.context,o=i.gl,a=r.fbo;if(a){var s=e.useProgram("hillshade"),l=e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),!0);!function(t,e,r){var n=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(n-=e.transform.angle),e.context.gl.uniform2f(t.uniforms.u_light,r.paint.get("hillshade-exaggeration"),n)}(s,e,n);var u=function(e,r){var n=r.toCoordinate(),i=new t.Coordinate(n.column,n.row+1,n.zoom);return[e.transform.coordinateLocation(n).lat,e.transform.coordinateLocation(i).lat]}(e,r.tileID);i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,l),o.uniform2fv(s.uniforms.u_latrange,u),o.uniform1i(s.uniforms.u_image,0);var c=n.paint.get("hillshade-shadow-color");o.uniform4f(s.uniforms.u_shadow,c.r,c.g,c.b,c.a);var h=n.paint.get("hillshade-highlight-color");o.uniform4f(s.uniforms.u_highlight,h.r,h.g,h.b,h.a);var p=n.paint.get("hillshade-accent-color");if(o.uniform4f(s.uniforms.u_accent,p.r,p.g,p.b,p.a),r.maskedBoundsBuffer&&r.maskedIndexBuffer&&r.segments)s.draw(i,o.TRIANGLES,n.id,r.maskedBoundsBuffer,r.maskedIndexBuffer,r.segments);else{var d=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(i,s,d,[]),o.drawArrays(o.TRIANGLE_STRIP,0,d.length)}}}function mr(e,r,n){var i=e.context,o=i.gl;if(r.dem&&r.dem.data){var a=r.dem.dim,s=r.dem.getPixels();if(i.activeTexture.set(o.TEXTURE1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(r.tileSize),r.demTexture){var l=r.demTexture;l.update(s,{premultiply:!1}),l.bind(o.NEAREST,o.CLAMP_TO_EDGE)}else r.demTexture=new t.Texture(i,s,o.RGBA,{premultiply:!1}),r.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);i.activeTexture.set(o.TEXTURE0);var u=r.fbo;if(!u){var c=new t.Texture(i,{width:a,height:a,data:null},o.RGBA);c.bind(o.LINEAR,o.CLAMP_TO_EDGE),(u=r.fbo=i.createFramebuffer(a,a)).colorAttachment.set(c.texture)}i.bindFramebuffer.set(u.framebuffer),i.viewport.set([0,0,a,a]);var h=t.create();t.ortho(h,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(h,h,[0,-t.EXTENT,0]);var p=e.useProgram("hillshadePrepare");o.uniformMatrix4fv(p.uniforms.u_matrix,!1,h),o.uniform1f(p.uniforms.u_zoom,r.tileID.overscaledZ),o.uniform2fv(p.uniforms.u_dimension,[2*a,2*a]),o.uniform1i(p.uniforms.u_image,1),o.uniform1f(p.uniforms.u_maxzoom,n);var d=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(i,p,d,[]),o.drawArrays(o.TRIANGLE_STRIP,0,d.length),r.needsHillshadePrepare=!1}}function _r(e,r,n,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),l=(s-e.timeAdded)/a,u=r?(s-r.timeAdded)/a:-1,c=n.getSource(),h=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.clamp(p?l:1-u,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function yr(e,r,n){var i=e.context,o=i.gl,a=n.posMatrix,s=e.useProgram("debug");i.setDepthMode(zt.disabled),i.setStencilMode(Bt.disabled),i.setColorMode(e.colorModeForRenderPass()),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,a),o.uniform4f(s.uniforms.u_color,1,0,0,1),e.debugVAO.bind(i,s,e.debugBuffer,[]),o.drawArrays(o.LINE_STRIP,0,e.debugBuffer.length);for(var l=function(t,e,r,n){n=n||1;var i,o,a,s,l,u,c,h,p=[];for(i=0,o=t.length;i<o;i++)if(l=gr[t[i]]){for(h=null,a=0,s=l[1].length;a<s;a+=2)-1===l[1][a]&&-1===l[1][a+1]?h=null:(u=e+l[1][a]*n,c=200-l[1][a+1]*n,h&&p.push(h.x,h.y,u,c),h={x:u,y:c});e+=l[0]*n}return p}(n.toString(),50,0,5),u=new t.StructArrayLayout2i4,c=0;c<l.length;c+=2)u.emplaceBack(l[c],l[c+1]);var h=i.createVertexBuffer(u,qe.members);(new Z).bind(i,s,h,[]),o.uniform4f(s.uniforms.u_color,1,1,1,1);for(var p=r.getTile(n).tileSize,d=t.EXTENT/(Math.pow(2,e.transform.zoom-n.overscaledZ)*p),f=[[-1,-1],[-1,1],[1,-1],[1,1]],m=0;m<f.length;m++){var _=f[m];o.uniformMatrix4fv(s.uniforms.u_matrix,!1,t.translate([],a,[d*_[0],d*_[1],0])),o.drawArrays(o.LINES,0,h.length)}o.uniform4f(s.uniforms.u_color,0,0,0,1),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,a),o.drawArrays(o.LINES,0,h.length)}var gr={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},vr={symbol:function(t,e,r,n){if("translucent"===t.renderPass){var i=t.context;i.setStencilMode(Bt.disabled),i.setColorMode(t.colorModeForRenderPass()),0!==r.paint.get("icon-opacity").constantOr(1)&&er(t,e,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright")),0!==r.paint.get("text-opacity").constantOr(1)&&er(t,e,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright")),e.map.showCollisionBoxes&&function(t,e,r,n){Qe(t,e,r,n,!1),Qe(t,e,r,n,!0)}(t,e,r,n)}},circle:function(t,e,r,n){if("translucent"===t.renderPass){var i=r.paint.get("circle-opacity"),o=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity");if(0!==i.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=t.context,l=s.gl;s.setDepthMode(t.depthModeForSublayer(0,zt.ReadOnly)),s.setStencilMode(Bt.disabled),s.setColorMode(t.colorModeForRenderPass());for(var u=!0,c=0;c<n.length;c++){var h=n[c],p=e.getTile(h),d=p.getBucket(r);if(d){var f=t.context.program.get(),m=d.programConfigurations.get(r.id),_=t.useProgram("circle",m);if((u||_.program!==f)&&(m.setUniforms(s,_,r.paint,{zoom:t.transform.zoom}),u=!1),l.uniform1f(_.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),l.uniform1i(_.uniforms.u_scale_with_map,"map"===r.paint.get("circle-pitch-scale")?1:0),"map"===r.paint.get("circle-pitch-alignment")){l.uniform1i(_.uniforms.u_pitch_with_map,1);var y=ye(p,1,t.transform.zoom);l.uniform2f(_.uniforms.u_extrude_scale,y,y)}else l.uniform1i(_.uniforms.u_pitch_with_map,0),l.uniform2fv(_.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits);l.uniformMatrix4fv(_.uniforms.u_matrix,!1,t.translatePosMatrix(h.posMatrix,p,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor"))),_.draw(s,l.TRIANGLES,r.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,m)}}}}},heatmap:function(e,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl;o.setDepthMode(e.depthModeForSublayer(0,zt.ReadOnly)),o.setStencilMode(Bt.disabled),function(t,e,r){var n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=r.heatmapFbo;if(i)n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),function t(e,r,n,i){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,r.width/4,r.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(n),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,i.colorAttachment.setDirty(),t(e,r,n,i))}(t,e,o,i=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4))}}(o,e,n),o.clear({color:t.Color.transparent}),o.setColorMode(new Lt([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]));for(var s=!0,l=0;l<i.length;l++){var u=i[l];if(!r.hasRenderableParent(u)){var c=r.getTile(u),h=c.getBucket(n);if(h){var p=e.context.program.get(),d=h.programConfigurations.get(n.id),f=e.useProgram("heatmap",d),m=e.transform.zoom;(s||f.program!==p)&&(d.setUniforms(e.context,f,n.paint,{zoom:m}),s=!1),a.uniform1f(f.uniforms.u_extrude_scale,ye(c,1,m)),a.uniform1f(f.uniforms.u_intensity,n.paint.get("heatmap-intensity")),a.uniformMatrix4fv(f.uniforms.u_matrix,!1,u.posMatrix),f.draw(o,a.TRIANGLES,n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){var n=e.context,i=n.gl,o=r.heatmapFbo;if(o){n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);var a=r.colorRampTexture;a||(a=r.colorRampTexture=new t.Texture(n,r.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),n.setDepthMode(zt.disabled),n.setStencilMode(Bt.disabled);var s=e.useProgram("heatmapTexture"),l=r.paint.get("heatmap-opacity");i.uniform1f(s.uniforms.u_opacity,l),i.uniform1i(s.uniforms.u_image,0),i.uniform1i(s.uniforms.u_color_ramp,1);var u=t.create();t.ortho(u,0,e.width,e.height,0,0,1),i.uniformMatrix4fv(s.uniforms.u_matrix,!1,u),i.uniform2f(s.uniforms.u_world,i.drawingBufferWidth,i.drawingBufferHeight),e.viewportVAO.bind(e.context,s,e.viewportBuffer,[]),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}(e,n))},line:function(t,e,r,n){if("translucent"===t.renderPass){var i=r.paint.get("line-opacity"),o=r.paint.get("line-width");if(0!==i.constantOr(1)&&0!==o.constantOr(1)){var a=t.context;a.setDepthMode(t.depthModeForSublayer(0,zt.ReadOnly)),a.setColorMode(t.colorModeForRenderPass());for(var s,l=r.paint.get("line-dasharray")?"lineSDF":r.paint.get("line-pattern")?"linePattern":r.paint.get("line-gradient")?"lineGradient":"line",u=!0,c=0,h=n;c<h.length;c+=1){var p=h[c],d=e.getTile(p),f=d.getBucket(r);if(f){var m=f.programConfigurations.get(r.id),_=t.context.program.get(),y=t.useProgram(l,m),g=u||y.program!==_,v=s!==d.tileID.overscaledZ;g&&m.setUniforms(t.context,y,r.paint,{zoom:t.transform.zoom}),or(y,t,d,f,r,p,m,g,v),s=d.tileID.overscaledZ,u=!1}}}}},fill:function(e,r,n,i){var o=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.context;s.setColorMode(e.colorModeForRenderPass());var l=n.paint.get("fill-pattern")||1!==o.constantOr(t.Color.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===l&&(s.setDepthMode(e.depthModeForSublayer(1,"opaque"===e.renderPass?zt.ReadWrite:zt.ReadOnly)),ur(e,r,n,i,cr)),"translucent"===e.renderPass&&n.paint.get("fill-antialias")&&(s.setDepthMode(e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,zt.ReadOnly)),ur(e,r,n,i,hr))}},"fill-extrusion":function(e,r,n,i){if(0!==n.paint.get("fill-extrusion-opacity"))if("offscreen"===e.renderPass){!function(e,r){var n=e.context,i=n.gl,o=r.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new t.Texture(n,{width:e.width,height:e.height,data:null},i.RGBA);a.bind(i.LINEAR,i.CLAMP_TO_EDGE),(o=r.viewportFrame=n.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}n.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(n.clear({depth:1}),e.depthRboNeedsClear=!1),n.clear({color:t.Color.transparent}),n.setStencilMode(Bt.disabled),n.setDepthMode(new zt(i.LEQUAL,zt.ReadWrite,[0,1])),n.setColorMode(e.colorModeForRenderPass())}(e,n);for(var o=!0,a=0,s=i;a<s.length;a+=1){var l=s[a],u=r.getTile(l),c=u.getBucket(n);c&&(dr(e,0,n,u,l,c,o),o=!1)}}else"translucent"===e.renderPass&&function(e,r){var n=r.viewportFrame;if(n){var i=e.context,o=i.gl,a=e.useProgram("extrusionTexture");i.setStencilMode(Bt.disabled),i.setDepthMode(zt.disabled),i.setColorMode(e.colorModeForRenderPass()),i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n.colorAttachment.get()),o.uniform1f(a.uniforms.u_opacity,r.paint.get("fill-extrusion-opacity")),o.uniform1i(a.uniforms.u_image,0);var s=t.create();t.ortho(s,0,e.width,e.height,0,0,1),o.uniformMatrix4fv(a.uniforms.u_matrix,!1,s),o.uniform2f(a.uniforms.u_world,o.drawingBufferWidth,o.drawingBufferHeight),e.viewportVAO.bind(i,a,e.viewportBuffer,[]),o.drawArrays(o.TRIANGLE_STRIP,0,4)}}(e,n)},hillshade:function(t,e,r,n){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var i=t.context,o=e.getSource().maxzoom;i.setDepthMode(t.depthModeForSublayer(0,zt.ReadOnly)),i.setStencilMode(Bt.disabled),i.setColorMode(t.colorModeForRenderPass());for(var a=0,s=n;a<s.length;a+=1){var l=s[a],u=e.getTile(l);u.needsHillshadePrepare&&"offscreen"===t.renderPass?mr(t,u,o):"translucent"===t.renderPass&&fr(t,u,r)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,r,n){if("translucent"===t.renderPass&&0!==r.paint.get("raster-opacity")){var i,o,a=t.context,s=a.gl,l=e.getSource(),u=t.useProgram("raster");a.setStencilMode(Bt.disabled),a.setColorMode(t.colorModeForRenderPass()),s.uniform1f(u.uniforms.u_brightness_low,r.paint.get("raster-brightness-min")),s.uniform1f(u.uniforms.u_brightness_high,r.paint.get("raster-brightness-max")),s.uniform1f(u.uniforms.u_saturation_factor,(i=r.paint.get("raster-saturation"))>0?1-1/(1.001-i):-i),s.uniform1f(u.uniforms.u_contrast_factor,(o=r.paint.get("raster-contrast"))>0?1/(1-o):1+o),s.uniform3fv(u.uniforms.u_spin_weights,function(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}(r.paint.get("raster-hue-rotate"))),s.uniform1f(u.uniforms.u_buffer_scale,1),s.uniform1i(u.uniforms.u_image0,0),s.uniform1i(u.uniforms.u_image1,1);for(var c=n.length&&n[0].overscaledZ,h=0,p=n;h<p.length;h+=1){var d=p[h];a.setDepthMode(t.depthModeForSublayer(d.overscaledZ-c,1===r.paint.get("raster-opacity")?zt.ReadWrite:zt.ReadOnly,s.LESS));var f=e.getTile(d),m=t.transform.calculatePosMatrix(d.toUnwrapped(),!0);f.registerFadeDuration(r.paint.get("raster-fade-duration")),s.uniformMatrix4fv(u.uniforms.u_matrix,!1,m);var _=e.findLoadedParent(d,0),y=_r(f,_,e,r,t.transform),g=void 0,v=void 0,b="nearest"===r.paint.get("raster-resampling")?s.NEAREST:s.LINEAR;if(a.activeTexture.set(s.TEXTURE0),f.texture.bind(b,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(s.TEXTURE1),_?(_.texture.bind(b,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),g=Math.pow(2,_.tileID.overscaledZ-f.tileID.overscaledZ),v=[f.tileID.canonical.x*g%1,f.tileID.canonical.y*g%1]):f.texture.bind(b,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),s.uniform2fv(u.uniforms.u_tl_parent,v||[0,0]),s.uniform1f(u.uniforms.u_scale_parent,g||1),s.uniform1f(u.uniforms.u_fade_t,y.mix),s.uniform1f(u.uniforms.u_opacity,y.opacity*r.paint.get("raster-opacity")),l instanceof X){var x=l.boundsBuffer;l.boundsVAO.bind(a,u,x,[]),s.drawArrays(s.TRIANGLE_STRIP,0,x.length)}else if(f.maskedBoundsBuffer&&f.maskedIndexBuffer&&f.segments)u.draw(a,s.TRIANGLES,r.id,f.maskedBoundsBuffer,f.maskedIndexBuffer,f.segments);else{var w=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(a,u,w,[]),s.drawArrays(s.TRIANGLE_STRIP,0,w.length)}}}},background:function(t,e,r){var n=r.paint.get("background-color"),i=r.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,l=s.tileSize,u=r.paint.get("background-pattern"),c=u||1!==n.a||1!==i?"translucent":"opaque";if(t.renderPass===c){var h;if(o.setStencilMode(Bt.disabled),o.setDepthMode(t.depthModeForSublayer(0,"opaque"===c?zt.ReadWrite:zt.ReadOnly)),o.setColorMode(t.colorModeForRenderPass()),u){if(ar(u,t))return;h=t.useProgram("backgroundPattern"),sr(u,t,h),t.tileExtentPatternVAO.bind(o,h,t.tileExtentBuffer,[])}else h=t.useProgram("background"),a.uniform4f(h.uniforms.u_color,n.r,n.g,n.b,n.a),t.tileExtentVAO.bind(o,h,t.tileExtentBuffer,[]);a.uniform1f(h.uniforms.u_opacity,i);for(var p=0,d=s.coveringTiles({tileSize:l});p<d.length;p+=1){var f=d[p];u&&lr({tileID:f,tileSize:l},t,h),a.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.transform.calculatePosMatrix(f.toUnwrapped())),a.drawArrays(a.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}},debug:function(t,e,r){for(var n=0;n<r.length;n++)yr(t,e,r[n])}},br=function(e,r){this.context=new Rt(e),this.transform=r,this._tileTextures={},this.setup(),this.numSublayers=Ot.maxUnderzooming+Ot.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.ProgramConfiguration,this.crossTileSymbolIndex=new Fe};function xr(t,e){if(t.row>e.row){var r=t;t=e,e=r}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function wr(t,e,r,n,i){var o=Math.max(r,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,h=e.dx<0,p=o;p<a;p++){var d=l*Math.max(0,Math.min(t.dy,p+c-t.y0))+t.x0,f=u*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;i(Math.floor(f),Math.ceil(d),p)}}function kr(t,e,r,n,i,o){var a,s=xr(t,e),l=xr(e,r),u=xr(r,t);s.dy>l.dy&&(a=s,s=l,l=a),s.dy>u.dy&&(a=s,s=u,u=a),l.dy>u.dy&&(a=l,l=u,u=a),s.dy&&wr(u,s,n,i,o),l.dy&&wr(u,l,n,i,o)}br.prototype.resize=function(e,r){var n=this.context.gl;if(this.width=e*t.browser.devicePixelRatio,this.height=r*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1){var a=o[i];this.style._layers[a].resize()}this.depthRbo&&(n.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},br.prototype.setup=function(){var e=this.context,r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(r,qe.members),this.tileExtentVAO=new Z,this.tileExtentPatternVAO=new Z;var n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(t.EXTENT,t.EXTENT),n.emplaceBack(0,t.EXTENT),n.emplaceBack(0,0),this.debugBuffer=e.createVertexBuffer(n,qe.members),this.debugVAO=new Z;var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,t.rasterBoundsAttributes.members),this.rasterBoundsVAO=new Z;var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,qe.members),this.viewportVAO=new Z},br.prototype.clearStencil=function(){var e=this.context,r=e.gl;e.setColorMode(Lt.disabled),e.setDepthMode(zt.disabled),e.setStencilMode(new Bt({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO));var n=t.create();t.ortho(n,0,this.width,this.height,0,0,1),t.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);var i=this.useProgram("clippingMask");r.uniformMatrix4fv(i.uniforms.u_matrix,!1,n),this.viewportVAO.bind(e,i,this.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)},br.prototype._renderTileClippingMasks=function(t){var e=this.context,r=e.gl;e.setColorMode(Lt.disabled),e.setDepthMode(zt.disabled);var n=1;this._tileClippingMaskIDs={};for(var i=0,o=t;i<o.length;i+=1){var a=o[i],s=this._tileClippingMaskIDs[a.key]=n++;e.setStencilMode(new Bt({func:r.ALWAYS,mask:0},s,255,r.KEEP,r.KEEP,r.REPLACE));var l=this.useProgram("clippingMask");r.uniformMatrix4fv(l.uniforms.u_matrix,!1,a.posMatrix),this.tileExtentVAO.bind(this.context,l,this.tileExtentBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},br.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Bt({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},br.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Lt([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Lt.unblended:Lt.alphaBlended},br.prototype.depthModeForSublayer=function(t,e,r){var n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,i=n-1+this.depthRange;return new zt(r||this.context.gl.LEQUAL,e,[i,n])},br.prototype.render=function(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now());var n=this.style._order,i=this.style.sourceCaches;for(var o in i){var a=i[o];a.used&&a.prepare(this.context)}var s,l={},u={},c={};for(var h in i){var p=i[h];l[h]=p.getVisibleCoordinates(),u[h]=l[h].slice().reverse(),c[h]=p.getVisibleCoordinates(!0).reverse()}for(var d in i){var f=i[d],m=f.getSource();if("raster"===m.type||"raster-dem"===m.type){for(var _=[],y=0,g=l[d];y<g.length;y+=1){var v=g[y];_.push(f.getTile(v))}Ke(_,this.context)}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var b=0,x=n;b<x.length;b+=1){var w=x[b],k=this.style._layers[w];if(k.hasOffscreenPass()&&!k.isHidden(this.transform.zoom)){var E=u[k.source];E.length&&this.renderLayer(this,i[k.source],k,E)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque",this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){var I=this.style._layers[n[this.currentLayer]],S=i[I.source],M=l[I.source];I.source!==s&&S&&(this.clearStencil(),S.getSource().isTileClipped&&this._renderTileClippingMasks(M)),this.renderLayer(this,S,I,M),s=I.source}for(this.renderPass="translucent",this.currentLayer=0,s=null;this.currentLayer<n.length;this.currentLayer++){var T=this.style._layers[n[this.currentLayer]],A=i[T.source],P=("symbol"===T.type?c:u)[T.source];T.source!==s&&A&&(this.clearStencil(),A.getSource().isTileClipped&&this._renderTileClippingMasks(l[T.source])),this.renderLayer(this,A,T,P),s=T.source}if(this.options.showTileBoundaries)for(var C in i){vr.debug(this,i[C],l[C]);break}},br.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},br.prototype.renderLayer=function(t,e,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||n.length)&&(this.id=r.id,vr[r.type](t,e,r,n))},br.prototype.translatePosMatrix=function(e,r,n,i,o){if(!n[0]&&!n[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[o?n[0]:ye(r,n[0],this.transform.zoom),o?n[1]:ye(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c},br.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},br.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},br.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var r=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new Ye(this.context,He[t],e,this._showOverdrawInspector)),this.cache[r]},br.prototype.useProgram=function(t,e){var r=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.context.program.set(r.program),r};var Er=function(t,e,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||r,this._minZoom=t||0,this._maxZoom=e||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new F(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ir={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};Er.prototype.clone=function(){var t=new Er(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Ir.minZoom.get=function(){return this._minZoom},Ir.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Ir.maxZoom.get=function(){return this._maxZoom},Ir.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Ir.renderWorldCopies.get=function(){return this._renderWorldCopies},Ir.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Ir.worldSize.get=function(){return this.tileSize*this.scale},Ir.centerPoint.get=function(){return this.size._div(2)},Ir.size.get=function(){return new t.Point(this.width,this.height)},Ir.bearing.get=function(){return-this.angle/Math.PI*180},Ir.bearing.set=function(e){var r=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=t.create$4(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ir.pitch.get=function(){return this._pitch/Math.PI*180},Ir.pitch.set=function(e){var r=t.clamp(e,0,60)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Ir.fov.get=function(){return this._fov/Math.PI*180},Ir.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Ir.zoom.get=function(){return this._zoom},Ir.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Ir.center.get=function(){return this._center},Ir.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Er.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Er.prototype.getVisibleUnwrappedCoordinates=function(e){var r=this.pointCoordinate(new t.Point(0,0),0),n=this.pointCoordinate(new t.Point(this.width,0),0),i=Math.floor(r.column),o=Math.floor(n.column),a=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var s=i;s<=o;s++)0!==s&&a.push(new t.UnwrappedTileID(s,e));return a},Er.prototype.coveringTiles=function(e){var r=this.coveringZoomLevel(e),n=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);var i=this.pointCoordinate(this.centerPoint,r),o=new t.Point(i.column-.5,i.row-.5);return function(e,r,n,i){void 0===i&&(i=!0);var o=1<<e,a={};function s(r,s,l){var u,c,h,p;if(l>=0&&l<=o)for(u=r;u<s;u++)c=Math.floor(u/o),h=(u%o+o)%o,0!==c&&!0!==i||(p=new t.OverscaledTileID(n,c,e,h,l),a[p.key]=p)}return kr(r[0],r[1],r[2],0,o,s),kr(r[2],r[3],r[0],0,o,s),Object.keys(a).map(function(t){return a[t]})}(r,[this.pointCoordinate(new t.Point(0,0),r),this.pointCoordinate(new t.Point(this.width,0),r),this.pointCoordinate(new t.Point(this.width,this.height),r),this.pointCoordinate(new t.Point(0,this.height),r)],e.reparseOverscaled?n:r,this._renderWorldCopies).sort(function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)})},Er.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Ir.unmodified.get=function(){return this._unmodified},Er.prototype.zoomScale=function(t){return Math.pow(2,t)},Er.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Er.prototype.project=function(e){return new t.Point(this.lngX(e.lng),this.latY(e.lat))},Er.prototype.unproject=function(t){return new F(this.xLng(t.x),this.yLat(t.y))},Ir.x.get=function(){return this.lngX(this.center.lng)},Ir.y.get=function(){return this.latY(this.center.lat)},Ir.point.get=function(){return new t.Point(this.x,this.y)},Er.prototype.lngX=function(t){return(180+t)*this.worldSize/360},Er.prototype.latY=function(e){return e=t.clamp(e,-this.maxValidLatitude,this.maxValidLatitude),(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))*this.worldSize/360},Er.prototype.xLng=function(t){return 360*t/this.worldSize-180},Er.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},Er.prototype.setLocationAtPoint=function(t,e){var r=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(r)),this._renderWorldCopies&&(this.center=this.center.wrap())},Er.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Er.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Er.prototype.locationCoordinate=function(e){return new t.Coordinate(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},Er.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new F(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},Er.prototype.pointCoordinate=function(e,r){void 0===r&&(r=this.tileZoom);var n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var o=n[3],a=i[3],s=n[0]/o,l=i[0]/a,u=n[1]/o,c=i[1]/a,h=n[2]/o,p=i[2]/a,d=h===p?0:(0-h)/(p-h);return new t.Coordinate(t.number(s,l,d)/this.tileSize,t.number(u,c,d)/this.tileSize,this.zoom)._zoomTo(r)},Er.prototype.coordinatePoint=function(e){var r=e.zoomTo(this.zoom),n=[r.column*this.tileSize,r.row*this.tileSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},Er.prototype.getBounds=function(){return(new N).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Er.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new N([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Er.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Er.prototype.calculatePosMatrix=function(e,r){void 0===r&&(r=!1);var n=e.key,i=r?this._alignedPosMatrixCache:this._posMatrixCache;if(i[n])return i[n];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),i[n]=new Float32Array(l),i[n]},Er.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,r,n,i,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=this.latY(h[1]),e=(a=this.latY(h[0]))-o<u.y?u.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=this.lngX(p[0]),r=(l=this.lngX(p[1]))-s<u.x?u.x/(l-s):0}var d=Math.max(r||0,e||0);if(d)return this.center=this.unproject(new t.Point(r?(l+s)/2:this.x,e?(a+o)/2:this.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var f=this.y,m=u.y/2;f-m<o&&(i=o+m),f+m>a&&(i=a-m)}if(this.lngRange){var _=this.x,y=u.x/2;_-y<s&&(n=s+y),_+y>l&&(n=l-y)}void 0===n&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==n?n:this.x,void 0!==i?i:this.y))),this._unmodified=c,this._constraining=!1}},Er.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,r=Math.PI/2+this._pitch,n=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-r-e),i=this.x,o=this.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance),s=new Float64Array(16);t.perspective(s,this._fov,this.width/this.height,1,a),t.scale(s,s,[1,-1,1]),t.translate(s,s,[0,0,-this.cameraToCenterDistance]),t.rotateX(s,s,this._pitch),t.rotateZ(s,s,this.angle),t.translate(s,s,[-i,-o,0]);var l=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));t.scale(s,s,[1,1,l,1]),this.projMatrix=s;var u=this.width%2/2,c=this.height%2/2,h=Math.cos(this.angle),p=Math.sin(this.angle),d=i-Math.round(i)+h*u+p*c,f=o-Math.round(o)+h*c+p*u,m=new Float64Array(s);if(t.translate(m,m,[d>.5?d-1:d,f>.5?f-1:f,0]),this.alignedProjMatrix=m,s=t.create(),t.scale(s,s,[this.width/2,-this.height/2,1]),t.translate(s,s,[1,-1,0]),this.pixelMatrix=t.multiply(new Float64Array(16),s,this.projMatrix),!(s=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=s,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Er.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)).zoomTo(this.zoom),r=[e.column*this.tileSize,e.row*this.tileSize,0,1];return t.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(Er.prototype,Ir);var Sr=function(){var e,r,n,i;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),r=!1,n=0,i=function(){n=0,r&&(e(),n=setTimeout(i,300),r=!1)},function(){return r=!0,n||i(),n})};Sr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Sr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Sr.prototype.getHashString=function(t){var e=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+o+"/"+a+"/"+r:"#"+r+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},Sr.prototype._onHashChange=function(){var e=t.window.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},Sr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.window.history.replaceState(t.window.history.state,"",e)};var Mr=function(e){function n(n,i,o,a){void 0===a&&(a={});var s=r.mousePos(i.getCanvasContainer(),o),l=i.unproject(s);e.call(this,n,t.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),Tr=function(e){function n(n,i,o){var a=r.touchPos(i.getCanvasContainer(),o),s=a.map(function(t){return i.unproject(t)}),l=a.reduce(function(t,e,r,n){return t.add(e.div(n.length))},new t.Point(0,0)),u=i.unproject(l);e.call(this,n,{points:a,point:l,lngLats:s,lngLat:u,originalEvent:o}),this._defaultPrevented=!1}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),Ar=function(t){function e(e,r,n){t.call(this,e,{originalEvent:n}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,r),e}(t.Event),Pr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Pr.prototype.isEnabled=function(){return!!this._enabled},Pr.prototype.isActive=function(){return!!this._active},Pr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},Pr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pr.prototype.onWheel=function(e){if(this.isEnabled()){var r=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,n=t.browser.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this.isActive()||this._start(e)),e.preventDefault()}},Pr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},Pr.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var n=r.mousePos(this._el,e);this._around=F.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Pr.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:r.zoom,s=this._startZoom,l=this._easing,u=!1;if("wheel"===this._type&&s&&l){var c=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),h=l(c);r.zoom=t.number(s,a,h),c<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):u=!0}else r.zoom=a,u=!0;r.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),u&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},Pr.prototype._smoothOutEasing=function(e){var r=t.ease;if(this._prevEase){var n=this._prevEase,i=(t.browser.now()-n.start)/n.duration,o=n.easing(i+.01)-n.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:r},r};var Cr=function(e,r){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1,t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Cr.prototype.isEnabled=function(){return!!this._enabled},Cr.prototype.isActive=function(){return!!this._active},Cr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Cr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Cr.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.window.document.addEventListener("mousemove",this._onMouseMove,!1),t.window.document.addEventListener("keydown",this._onKeyDown,!1),t.window.document.addEventListener("mouseup",this._onMouseUp,!1),r.disableDrag(),this._startPos=this._lastPos=r.mousePos(this._el,e),this._active=!0)},Cr.prototype._onMouseMove=function(t){var e=r.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var n=this._startPos;this._lastPos=e,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(n.x,e.x),o=Math.max(n.x,e.x),a=Math.min(n.y,e.y),s=Math.max(n.y,e.y);r.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},Cr.prototype._onMouseUp=function(e){if(0===e.button){var n=this._startPos,i=r.mousePos(this._el,e),o=(new N).extend(this._map.unproject(n)).extend(this._map.unproject(i));this._finish(),r.suppressClick(),n.x===i.x&&n.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitBounds(o,{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e,boxZoomBounds:o}))}},Cr.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},Cr.prototype._finish=function(){this._active=!1,t.window.document.removeEventListener("mousemove",this._onMouseMove,!1),t.window.document.removeEventListener("keydown",this._onKeyDown,!1),t.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},Cr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,{originalEvent:r}))};var Dr=t.bezier(0,0,.25,1),zr=function(e,r){this._map=e,this._el=r.element||e.getCanvasContainer(),this._state="disabled",this._button=r.button||"right",this._bearingSnap=r.bearingSnap||0,this._pitchWithRotate=!1!==r.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};zr.prototype.isEnabled=function(){return"disabled"!==this._state},zr.prototype.isActive=function(){return"active"===this._state},zr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},zr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},zr.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=r.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==r.mouseButton(e))return;this._eventButton=0}r.disableDrag(),t.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("mouseup",this._onMouseUp),t.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=r.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},zr.prototype._onMouseMove=function(t){var e=r.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},zr.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var r=this._map.transform,n=this._startPos,i=this._lastPos,o=.8*(n.x-i.x),a=-.5*(n.y-i.y),s=r.bearing-o,l=r.pitch-a,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([t.browser.now(),this._map._normalizeBearing(s,c[1])]),r.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),r.pitch=l),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._startPos=this._lastPos}},zr.prototype._onMouseUp=function(t){if(r.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",r.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},zr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},zr.prototype._unbind=function(){t.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("mouseup",this._onMouseUp),t.window.removeEventListener("blur",this._onBlur),r.enableDrag()},zr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},zr.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var r=this._map,n=r.getBearing(),i=this._inertia,o=function(){Math.abs(n)<e._bearingSnap?r.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],l=i[i.length-2],u=r._normalizeBearing(n,l[1]),c=s[1]-a[1],h=c<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==c&&0!==p){var d=Math.abs(c*(.25/p));d>180&&(d=180);var f=d/180;u+=h*d*(f/2),Math.abs(r._normalizeBearing(u,0))<this._bearingSnap&&(u=r._normalizeBearing(0,u)),r.rotateTo(u,{duration:1e3*f,easing:Dr,noMoveStart:!0},{originalEvent:t})}else o()}},zr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},zr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>0&&r-e[0][0]>160;)e.shift()};var Br=t.bezier(0,0,.3,1),Lr=function(e,r){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",this._clickTolerance=r.clickTolerance||1,t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Lr.prototype.isEnabled=function(){return"disabled"!==this._state},Lr.prototype.isActive=function(){return"active"===this._state},Lr.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Lr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Lr.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==r.mouseButton(e)||(r.addEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),r.addEventListener(t.window.document,"mouseup",this._onMouseUp),this._start(e)))},Lr.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(r.addEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),r.addEventListener(t.window.document,"touchend",this._onTouchEnd),this._start(e)))},Lr.prototype._start=function(e){t.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=r.mousePos(this._el,e),this._inertia=[[t.browser.now(),this._startPos]]},Lr.prototype._onMove=function(e){e.preventDefault();var n=r.mousePos(this._el,e);this._lastPos.equals(n)||"pending"===this._state&&n.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=n,this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Lr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._startPos=this._lastPos,delete this._lastMoveEvent}},Lr.prototype._onMouseUp=function(t){if(0===r.mouseButton(t))switch(this._state){case"active":this._state="enabled",r.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Lr.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Lr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Lr.prototype._unbind=function(){r.removeEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),r.removeEventListener(t.window.document,"touchend",this._onTouchEnd),r.removeEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),r.removeEventListener(t.window.document,"mouseup",this._onMouseUp),r.removeEventListener(t.window,"blur",this._onBlur)},Lr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},Lr.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var r=e[e.length-1],n=e[0],i=r[1].sub(n[1]),o=(r[0]-n[0])/1e3;if(0===o||r[1].equals(n[1]))this._fireEvent("moveend",t);else{var a=i.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var l=s/750,u=a.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:Br,noMoveStart:!0},{originalEvent:t})}}},Lr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},Lr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>0&&r-e[0][0]>160;)e.shift()};var Rr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function Or(t){return t*(2-t)}Rr.prototype.isEnabled=function(){return!!this._enabled},Rr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Rr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Rr.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,r=0,n=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?n=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),l={duration:300,delayEndEvents:500,easing:Or,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*r,pitch:a.getPitch()+10*n,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}};var Fr=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};Fr.prototype.isEnabled=function(){return!!this._enabled},Fr.prototype.isActive=function(){return!!this._active},Fr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fr.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},Fr.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},Fr.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},Fr.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Nr=t.bezier(0,0,.15,1),Vr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Vr.prototype.isEnabled=function(){return!!this._enabled},Vr.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},Vr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Vr.prototype.disableRotation=function(){this._rotationDisabled=!0},Vr.prototype.enableRotation=function(){this._rotationDisabled=!1},Vr.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var n=r.mousePos(this._el,e.touches[0]),i=r.mousePos(this._el,e.touches[1]);this._startVec=n.sub(i),this._gestureIntent=void 0,this._inertia=[],r.addEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),r.addEventListener(t.window.document,"touchend",this._onEnd)}},Vr.prototype._getTouchEventData=function(t){var e=r.mousePos(this._el,t.touches[0]),n=r.mousePos(this._el,t.touches[1]),i=e.sub(n);return{vec:i,center:e.add(n).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},Vr.prototype._onMove=function(e){if(2===e.touches.length){var r=this._getTouchEventData(e),n=r.vec,i=r.scale,o=r.bearing;if(!this._gestureIntent){var a=Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=n)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},Vr.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var r=this._map.transform;this._startScale||(this._startScale=r.scale,this._startBearing=r.bearing);var n=this._getTouchEventData(this._lastTouchEvent),i=n.center,o=n.bearing,a=n.scale,s=r.pointLocation(i),l=r.locationPoint(s);"rotate"===e&&(r.bearing=this._startBearing+o),r.zoom=r.scaleZoom(this._startScale*a),r.setLocationAtPoint(s,l),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),a,i])}},Vr.prototype._onEnd=function(e){r.removeEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),r.removeEventListener(t.window.document,"touchend",this._onEnd);var n=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,n){this._map.fire(new t.Event(n+"end",{originalEvent:e})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:e});else{var s=o[o.length-1],l=o[0],u=a.transform.scaleZoom(i*s[1]),c=a.transform.scaleZoom(i*l[1]),h=u-c,p=(s[0]-l[0])/1e3,d=s[2];if(0!==p&&u!==c){var f=.15*h/p;Math.abs(f)>2.5&&(f=f>0?2.5:-2.5);var m=1e3*Math.abs(f/(12*.15)),_=u+f*m/2e3;_<0&&(_=0),a.easeTo({zoom:_,duration:m,easing:Nr,around:this._aroundCenter?a.getCenter():a.unproject(d),noMoveStart:!0},{originalEvent:e})}else a.snapToNorth({},{originalEvent:e})}}},Vr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>2&&r-e[0][0]>160;)e.shift()};var jr={scrollZoom:Pr,boxZoom:Cr,dragRotate:zr,dragPan:Lr,keyboard:Rr,doubleClickZoom:Fr,touchZoomRotate:Vr},Ur=function(e){function r(r,n){e.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getCenter=function(){return this.transform.center},r.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},r.prototype.panBy=function(e,r,n){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},r),n)},r.prototype.panTo=function(e,r,n){return this.easeTo(t.extend({center:e},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},r.prototype.zoomTo=function(e,r,n){return this.easeTo(t.extend({zoom:e},r),n)},r.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},r.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},r.prototype.rotateTo=function(e,r,n){return this.easeTo(t.extend({bearing:e},r),n)},r.prototype.resetNorth=function(e,r){return this.rotateTo(0,t.extend({duration:1e3},e),r),this},r.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},r.prototype.cameraForBounds=function(e,r){if("number"==typeof(r=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var n=r.padding;r.padding={top:n,bottom:n,right:n,left:n}}if(t.deepEqual(Object.keys(r.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){e=N.convert(e);var i=[(r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2],o=Math.min(r.padding.right,r.padding.left),a=Math.min(r.padding.top,r.padding.bottom);r.offset=[r.offset[0]+i[0],r.offset[1]+i[1]];var s=t.Point.convert(r.offset),l=this.transform,u=l.project(e.getNorthWest()),c=l.project(e.getSouthEast()),h=c.sub(u),p=(l.width-2*o-2*Math.abs(s.x))/h.x,d=(l.height-2*a-2*Math.abs(s.y))/h.y;if(!(d<0||p<0))return r.center=l.unproject(u.add(c).div(2)),r.zoom=Math.min(l.scaleZoom(l.scale*Math.min(p,d)),r.maxZoom),r.bearing=0,r;t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},r.prototype.fitBounds=function(e,r,n){var i=this.cameraForBounds(e,r);return i?(r=t.extend(i,r)).linear?this.easeTo(r,n):this.flyTo(r,n):this},r.prototype.jumpTo=function(e,r){this.stop();var n=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(i=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=F.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(o=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.pitch=+e.pitch),this.fire(new t.Event("movestart",r)).fire(new t.Event("move",r)),i&&this.fire(new t.Event("zoomstart",r)).fire(new t.Event("zoom",r)).fire(new t.Event("zoomend",r)),o&&this.fire(new t.Event("rotatestart",r)).fire(new t.Event("rotate",r)).fire(new t.Event("rotateend",r)),a&&this.fire(new t.Event("pitchstart",r)).fire(new t.Event("pitch",r)).fire(new t.Event("pitchend",r)),this.fire(new t.Event("moveend",r))},r.prototype.easeTo=function(e,r){var n=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=i.centerPoint.add(t.Point.convert(e.offset)),p=i.pointLocation(h),d=F.convert(e.center||p);this._normalizeCenter(d);var f,m,_=i.project(p),y=i.project(d).sub(_),g=i.zoomScale(l-o);return e.around&&(f=F.convert(e.around),m=i.locationPoint(f)),this._zooming=l!==o,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(r,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(n._zooming&&(i.zoom=t.number(o,l,e)),n._rotating&&(i.bearing=t.number(a,u,e)),n._pitching&&(i.pitch=t.number(s,c,e)),f)i.setLocationAtPoint(f,m);else{var p=i.zoomScale(i.zoom-o),d=l>o?Math.min(2,g):Math.max(.5,g),v=Math.pow(d,1-e),b=i.unproject(_.add(y.mult(e*v)).mult(p));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,h)}n._fireMoveEvents(r)},function(){e.delayEndEvents?n._easeEndTimeoutID=setTimeout(function(){return n._afterEase(r)},e.delayEndEvents):n._afterEase(r)},e),this},r.prototype._prepareEase=function(e,r){this._moving=!0,r||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},r.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},r.prototype._afterEase=function(e){var r=this._zooming,n=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,r&&this.fire(new t.Event("zoomend",e)),n&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},r.prototype.flyTo=function(e,r){var n=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=i.zoomScale(l-o),p=i.centerPoint.add(t.Point.convert(e.offset)),d=i.pointLocation(p),f=F.convert(e.center||d);this._normalizeCenter(f);var m=i.project(d),_=i.project(f).sub(m),y=e.curve,g=Math.max(i.width,i.height),v=g/h,b=_.mag();if("minZoom"in e){var x=t.clamp(Math.min(e.minZoom,o,l),i.minZoom,i.maxZoom),w=g/i.zoomScale(x-o);y=Math.sqrt(w/b*2)}var k=y*y;function E(t){var e=(v*v-g*g+(t?-1:1)*k*k*b*b)/(2*(t?v:g)*k*b);return Math.log(Math.sqrt(e*e+1)-e)}function I(t){return(Math.exp(t)-Math.exp(-t))/2}function S(t){return(Math.exp(t)+Math.exp(-t))/2}var M=E(0),T=function(t){return S(M)/S(M+y*t)},A=function(t){return g*((S(M)*(I(e=M+y*t)/S(e))-I(M))/k)/b;var e},P=(E(1)-M)/y;if(Math.abs(b)<1e-6||!isFinite(P)){if(Math.abs(g-v)<1e-6)return this.easeTo(e,r);var C=v<g?-1:1;P=Math.abs(Math.log(v/g))/y,A=function(){return 0},T=function(t){return Math.exp(C*y*t)}}if("duration"in e)e.duration=+e.duration;else{var D="screenSpeed"in e?+e.screenSpeed/y:+e.speed;e.duration=1e3*P/D}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(r,!1),this._ease(function(e){var h=e*P,d=1/T(h);i.zoom=1===e?l:o+i.scaleZoom(d),n._rotating&&(i.bearing=t.number(a,u,e)),n._pitching&&(i.pitch=t.number(s,c,e));var f=i.unproject(m.add(_.mult(A(h))).mult(d));i.setLocationAtPoint(i.renderWorldCopies?f.wrap():f,p),n._fireMoveEvents(r)},function(){return n._afterEase(r)},e),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},r.prototype._ease=function(e,r,n){!1===n.animate||0===n.duration?(e(1),r()):(this._easeStart=t.browser.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(e,r){e=t.wrap(e,-180,180);var n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e},r.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}},r}(t.Evented),qr=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};qr.prototype.getDefaultPosition=function(){return"bottom-right"},qr.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},qr.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},qr.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:h.ACCESS_TOKEN}];if(t){var r=e.reduce(function(t,r,n){return r.value&&(t+=r.key+"="+r.value+(n<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+r+(this._map._hash?this._map._hash.getHashString(!0):"")}},qr.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},qr.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var r=this._map.style.sourceCaches;for(var n in r){var i=r[n].getSource();i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution)}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,r){for(var n=r+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},qr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Gr=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};Gr.prototype.onAdd=function(t){this._map=t,this._container=r.create("div","mapboxgl-ctrl");var e=r.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Gr.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Gr.prototype.getDefaultPosition=function(){return"bottom-left"},Gr.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Gr.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},Gr.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var Zr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Zr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},Zr.prototype.remove=function(t){for(var e=this._currentlyRunning,r=0,n=e?this._queue.concat(e):this._queue;r<n.length;r+=1){var i=n[r];if(i.id===t)return void(i.cancelled=!0)}},Zr.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,r=t;e<r.length;e+=1){var n=r[e];if(!n.cancelled&&(n.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Zr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Xr=t.window.HTMLImageElement,Wr=t.window.HTMLElement,Hr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Yr=function(n){function i(e){var i=this;if(null!=(e=t.extend({},Hr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var o=new Er(e.minZoom,e.maxZoom,e.renderWorldCopies);n.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new Zr,this._controls=[];var a=e.transformRequest;if(this._transformRequest=a?function(t,e){return a(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof Wr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return i._update(!1)}),this.on("zoom",function(){return i._update(!0)}),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var n=t.getCanvasContainer(),i=null,o=!1,a=null;for(var s in jr)t[s]=new jr[s](t,e),e.interactive&&e[s]&&t[s].enable(e[s]);r.addEventListener(n,"mouseout",function(e){t.fire(new Mr("mouseout",t,e))}),r.addEventListener(n,"mousedown",function(i){o=!0,a=r.mousePos(n,i);var s=new Mr("mousedown",t,i);t.fire(s),s.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))}),r.addEventListener(n,"mouseup",function(e){var r=t.dragRotate.isActive();i&&!r&&t.fire(new Mr("contextmenu",t,i)),i=null,o=!1,t.fire(new Mr("mouseup",t,e))}),r.addEventListener(n,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var r=e.target;r&&r!==n;)r=r.parentNode;r===n&&t.fire(new Mr("mousemove",t,e))}}),r.addEventListener(n,"mouseover",function(e){for(var r=e.target;r&&r!==n;)r=r.parentNode;r===n&&t.fire(new Mr("mouseover",t,e))}),r.addEventListener(n,"touchstart",function(r){var n=new Tr("touchstart",t,r);t.fire(n),n.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(r),t.touchZoomRotate.onStart(r),t.doubleClickZoom.onTouchStart(n))},{passive:!1}),r.addEventListener(n,"touchmove",function(e){t.fire(new Tr("touchmove",t,e))},{passive:!1}),r.addEventListener(n,"touchend",function(e){t.fire(new Tr("touchend",t,e))}),r.addEventListener(n,"touchcancel",function(e){t.fire(new Tr("touchcancel",t,e))}),r.addEventListener(n,"click",function(i){var o=r.mousePos(n,i);(o.equals(a)||o.dist(a)<e.clickTolerance)&&t.fire(new Mr("click",t,i))}),r.addEventListener(n,"dblclick",function(e){var r=new Mr("dblclick",t,e);t.fire(r),r.defaultPrevented||t.doubleClickZoom.onDblClick(r)}),r.addEventListener(n,"contextmenu",function(e){var r=t.dragRotate.isActive();o||r?o&&(i=e):t.fire(new Mr("contextmenu",t,e)),e.preventDefault()}),r.addEventListener(n,"wheel",function(r){e.interactive&&t.stop();var n=new Ar("wheel",t,r);t.fire(n),n.defaultPrevented||t.scrollZoom.onWheel(r)},{passive:!1})}(this,e),this._hash=e.hash&&(new Sr).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new qr({customAttribution:e.customAttribution})),this.addControl(new Gr,e.logoPosition),this.on("style.load",function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)}),this.on("data",function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))}),this.on("dataloading",function(e){i.fire(new t.Event(e.dataType+"dataloading",e))})}n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i;var o={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return i.prototype.addControl=function(e,r){if(void 0===r&&e.getDefaultPosition&&(r=e.getDefaultPosition()),void 0===r&&(r="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this},i.prototype.resize=function(e){var r=this._containerDimensions(),n=r[0],i=r[1];return this._resizeCanvas(n,i),this.transform.resize(n,i),this.painter.resize(n,i),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(N.convert(t)),this._update()},i.prototype.setMinZoom=function(t){if((t=null==t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.project=function(t){return this.transform.locationPoint(F.convert(t))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,r){var i,o=this;if(void 0===r)return n.prototype.on.call(this,t,e);var a=function(){if("mouseenter"===t||"mouseover"===t){var n=!1;return{layer:e,listener:r,delegates:{mousemove:function(i){var a=o.getLayer(e)?o.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?n||(n=!0,r.call(o,new Mr(t,o,i.originalEvent,{features:a}))):n=!1},mouseout:function(){n=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:r,delegates:{mousemove:function(n){(o.getLayer(e)?o.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,r.call(o,new Mr(t,o,n.originalEvent)))},mouseout:function(e){a&&(a=!1,r.call(o,new Mr(t,o,e.originalEvent)))}}}}return{layer:e,listener:r,delegates:(i={},i[t]=function(t){var n=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];n.length&&(t.features=n,r.call(o,t),delete t.features)},i)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},i.prototype.off=function(t,e,r){if(void 0===r)return n.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],o=0;o<i.length;o++){var a=i[o];if(a.layer===e&&a.listener===r){for(var s in a.delegates)this.off(s,a.delegates[s]);return i.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,r){if(!this.style)return[];var n;if(void 0!==r||void 0===e||e instanceof t.Point||Array.isArray(e)||(r=e,e=void 0),r=r||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])n=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);n=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(n,r,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,r){if((!r||!1!==r.diff&&!r.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Ue(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var r=t[e]._tiles;for(var n in r){var i=r[n];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,r){return this.style.addSourceType(t,e,r)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,r,n){void 0===n&&(n={});var i=n.pixelRatio;void 0===i&&(i=1);var o=n.sdf;if(void 0===o&&(o=!1),r instanceof Xr){var a=t.browser.getImageData(r),s=a.width,l=a.height,u=a.data;this.style.addImage(e,{data:new t.RGBAImage({width:s,height:l},u),pixelRatio:i,sdf:o})}else{if(void 0===r.width||void 0===r.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=r.width,h=r.height,p=r.data;this.style.addImage(e,{data:new t.RGBAImage({width:c,height:h},new Uint8Array(p)),pixelRatio:i,sdf:o})}},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,r){t.getImage(this._transformRequest(e,t.ResourceType.Image),r)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0)},i.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,r){return this.style.setPaintProperty(t,e,r),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,r){return this.style.setLayoutProperty(t,e,r),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=r.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var i=this._controlContainer=r.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=r.create("div","mapboxgl-ctrl-"+t,i)})},i.prototype._resizeCanvas=function(e,r){var n=t.window.devicePixelRatio||1;this._canvas.width=n*e,this._canvas.height=n*r,this._canvas.style.width=e+"px",this._canvas.style.height=r+"px"},i.prototype._setupPainter=function(){var r=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?this.painter=new br(n,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var r=this.transform.zoom,n=t.browser.now();this.style.zoomHistory.update(r,n);var i=new t.EvaluationParameters(r,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=i.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},i.prototype.remove=function(){this._hash&&this._hash.remove(),this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));for(var e=0,r=this._controls;e<r.length;e+=1)r[e].onRemove(this);this._controls=[];var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),Kr(this._canvasContainer),Kr(this._controlContainer),Kr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype._rerender=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame(function(){e._frame=null,e._render()}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint=t,this._update()},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},Object.defineProperties(i.prototype,o),i}(Ur);function Kr(t){t.parentNode&&t.parentNode.removeChild(t)}var Jr={showCompass:!0,showZoom:!0},Qr=function(e){var n=this;this.options=t.extend({},Jr,e),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return n._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return n._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return n._map.resetNorth()}),this._compassArrow=r.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function $r(t,e,r){if(t=new F(t.lng,t.lat),e){var n=new F(t.lng-360,t.lat),i=new F(t.lng+360,t.lat),o=r.locationPoint(t).distSqr(e);r.locationPoint(n).distSqr(e)<o?t=n:r.locationPoint(i).distSqr(e)<o&&(t=i)}for(;Math.abs(t.lng-r.center.lng)>180;){var a=r.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=r.width&&a.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}Qr.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},Qr.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zr(t,{button:"left",element:this._compass}),r.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},Qr.prototype.onRemove=function(){r.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),r.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},Qr.prototype._createButton=function(t,e,n){var i=r.create("button",t,this._container);return i.type="button",i.setAttribute("aria-label",e),i.addEventListener("click",n),i};var tn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function en(t,e,r){var n=t.classList;for(var i in tn)n.remove("mapboxgl-"+r+"-anchor-"+i);n.add("mapboxgl-"+r+"-anchor-"+e)}var rn,nn=function(e){function n(n){if(e.call(this),(arguments[0]instanceof t.window.HTMLElement||2===arguments.length)&&(n=t.extend({element:n},arguments[1])),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._draggable=n&&n.draggable||!1,this._state="inactive",n&&n.element)this._element=n.element,this._offset=t.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div");var i=r.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var o=r.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var l=0,u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<u.length;l+=1){var c=u[l],h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",c.rx),h.setAttributeNS(null,"ry",c.ry),s.appendChild(h)}var p=r.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var d=r.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),p.appendChild(d);var f=r.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var m=r.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(m);var _=r.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_.setAttributeNS(null,"fill","#FFFFFF");var y=r.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=r.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var v=r.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),y.appendChild(g),y.appendChild(v),a.appendChild(s),a.appendChild(p),a.appendChild(f),a.appendChild(_),a.appendChild(y),i.appendChild(a),this._element.appendChild(i),this._offset=t.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},n.prototype.getElement=function(){return this._element},n.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},n.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},n.prototype.getPopup=function(){return this._popup},n.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},n.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=$r(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),r.setTransform(this._element,tn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),en(this._element,this._anchor,"marker"))},n.prototype.getOffset=function(){return this._offset},n.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},n.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},n.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},n.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},n.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},n.prototype.isDraggable=function(){return this._draggable},n}(t.Evented),on={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},an=function(e){function n(r){e.call(this),this.options=t.extend({},on,r),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(e){var n;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==rn?n(rn):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(function(t){rn="denied"!==t.state,n(rn)}):(rn=!!t.window.navigator.geolocation,n(rn)),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),r.remove(this._container),this._map=void 0},n.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},n.prototype._updateCamera=function(t){var e=new F(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy;this._map.fitBounds(e.toBounds(r),this.options.fitBoundsOptions,{geolocateSource:!0})},n.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},n.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(e){var n=this;!1!==e?(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=r.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new nn(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==n._watchState||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new t.Event("trackuserlocationend")))})):t.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},n.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n}(t.Evented),sn={maxWidth:100,unit:"metric"},ln=function(e){this.options=t.extend({},sn,e),t.bindAll(["_onMove","setUnit"],this)};function un(t,e,r){var n,i,o,a,s,l,u=r&&r.maxWidth||100,c=t._container.clientHeight/2,h=(n=t.unproject([0,c]),i=t.unproject([u,c]),o=Math.PI/180,a=n.lat*o,s=i.lat*o,l=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((i.lng-n.lng)*o),6371e3*Math.acos(Math.min(l,1)));if(r&&"imperial"===r.unit){var p=3.2808*h;p>5280?cn(e,u,p/5280,"mi"):cn(e,u,p,"ft")}else r&&"nautical"===r.unit?cn(e,u,h/1852,"nm"):cn(e,u,h,"m")}function cn(t,e,r,n){var i,o,a,s=(i=r,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:1)),l=s/r;"m"===n&&s>=1e3&&(s/=1e3,n="km"),t.style.width=e*l+"px",t.innerHTML=s+n}ln.prototype.getDefaultPosition=function(){return"bottom-left"},ln.prototype._onMove=function(){un(this._map,this._container,this.options)},ln.prototype.onAdd=function(t){return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ln.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ln.prototype.setUnit=function(t){this.options.unit=t,un(this._map,this._container,this.options)};var hn=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};hn.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=r.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},hn.prototype.onRemove=function(){r.remove(this._container),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},hn.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},hn.prototype._setupUI=function(){var e=this._fullscreenButton=r.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},hn.prototype._isFullscreen=function(){return this._fullscreen},hn.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},hn.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var pn={closeButton:!0,closeOnClick:!0,className:""},dn=function(e){function n(r){e.call(this),this.options=t.extend(Object.create(pn),r),t.bindAll(["_update","_onClickClose"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._update(),this},n.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},n.prototype.setHTML=function(e){var r,n=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;r=i.firstChild;)n.appendChild(r);return this.setDOMContent(n)},n.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},n.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},n.prototype._update=function(){var e=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)})),this._map.transform.renderWorldCopies&&(this._lngLat=$r(this._lngLat,this._pos,this._map.transform));var n=this._pos=this._map.project(this._lngLat),i=this.options.anchor,o=function e(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new t.Point(0,0),top:new t.Point(0,r),"top-left":new t.Point(n,n),"top-right":new t.Point(-n,n),bottom:new t.Point(0,-r),"bottom-left":new t.Point(n,-n),"bottom-right":new t.Point(-n,-n),left:new t.Point(r,0),right:new t.Point(-r,0)}}if(r instanceof t.Point||Array.isArray(r)){var i=t.Point.convert(r);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(r.center||[0,0]),top:t.Point.convert(r.top||[0,0]),"top-left":t.Point.convert(r["top-left"]||[0,0]),"top-right":t.Point.convert(r["top-right"]||[0,0]),bottom:t.Point.convert(r.bottom||[0,0]),"bottom-left":t.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(r["bottom-right"]||[0,0]),left:t.Point.convert(r.left||[0,0]),right:t.Point.convert(r.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!i){var a,s=this._container.offsetWidth,l=this._container.offsetHeight;a=n.y+o.bottom.y<l?["top"]:n.y>this._map.transform.height-l?["bottom"]:[],n.x<s/2?a.push("left"):n.x>this._map.transform.width-s/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}var u=n.add(o[i]).round();r.setTransform(this._container,tn[i]+" translate("+u.x+"px,"+u.y+"px)"),en(this._container,i,"popup")}},n.prototype._onClickClose=function(){this.remove()},n}(t.Evented),fn={version:"0.48.0",supported:e,setRTLTextPlugin:t.setRTLTextPlugin,Map:Yr,NavigationControl:Qr,GeolocateControl:an,AttributionControl:qr,ScaleControl:ln,FullscreenControl:hn,Popup:dn,Marker:nn,Style:Ue,LngLat:F,LngLatBounds:N,Point:t.Point,Evented:t.Evented,config:h,get accessToken(){return h.ACCESS_TOKEN},set accessToken(t){h.ACCESS_TOKEN=t},get workerCount(){return qt.workerCount},set workerCount(t){qt.workerCount=t},workerUrl:""};return fn}),r}()},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e){t.exports=!1},function(t,e,r){var n=r(90),i=r(65);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e,r){var n=r(25),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(4),i=r(91),o=r(65),a=r(64)("IE_PROTO"),s=function(){},l=function(){var t,e=r(61)("iframe"),n=o.length;for(e.style.display="none",r(67).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[o[n]];return l()};t.exports=Object.create||function(t,e){var r;return null!==t?(s.prototype=n(t),r=new s,s.prototype=null,r[a]=t):r=l(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(90),i=r(65).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){var n=r(13),i=r(16),o=r(64)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t){t.exports={baseUrl:"http://213.248.47.89",sourceGroupId:3575,pointsGroupId:4066}},function(t,e,r){var n=r(6).f,i=r(13),o=r(5)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e){t.exports={}},function(t,e,r){var n=r(5)("unscopables"),i=Array.prototype;void 0==i[n]&&r(14)(i,n,{}),t.exports=function(t){i[n][t]=!0}},function(t,e,r){"use strict";var n=r(2),i=r(6),o=r(7),a=r(5)("species");t.exports=function(t){var e=n[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,e,r){var n=r(11);t.exports=function(t,e,r){for(var i in e)n(t,i,e[i],r);return t}},function(t,e,r){var n=r(3);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,r){var n=r(23);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var n=r(15),i=r(9),o=r(34);t.exports=function(t){return function(e,r,a){var s,l=n(e),u=i(l.length),c=o(a,u);if(t&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===r)return t||c||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(23),i=r(5)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?r:o?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,r){var n=r(0),i=r(24),o=r(1),a=r(69),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(t,e,r){var i={},s=o(function(){return!!a[t]()||"​"!="​"[t]()}),l=i[t]=s?e(h):a[t];r&&(i[r]=l),n(n.P+n.F*s,"String",i)},h=c.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},function(t,e,r){var n=r(5)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},t(o)}catch(t){}return r}},function(t,e,r){"use strict";var n=r(14),i=r(11),o=r(1),a=r(24),s=r(5);t.exports=function(t,e,r){var l=s(t),u=r(a,l,""[t]),c=u[0],h=u[1];o(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,c),n(RegExp.prototype,l,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,r){var n=r(21),i=r(103),o=r(78),a=r(4),s=r(9),l=r(80),u={},c={};(e=t.exports=function(t,e,r,h,p){var d,f,m,_,y=p?function(){return t}:l(t),g=n(r,h,e?2:1),v=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(d=s(t.length);d>v;v++)if((_=e?g(a(f=t[v])[0],f[1]):g(t[v]))===u||_===c)return _}else for(m=y.call(t);!(f=m.next()).done;)if((_=i(m,g,f.value,e))===u||_===c)return _}).BREAK=u,e.RETURN=c},function(t,e,r){var n=r(4),i=r(22),o=r(5)("species");t.exports=function(t,e){var r,a=n(t).constructor;return void 0===a||void 0==(r=n(a)[o])?e:i(r)}},function(t,e,r){var n=r(2).navigator;t.exports=n&&n.userAgent||""},function(t,e,r){"use strict";var n=r(2),i=r(0),o=r(11),a=r(44),s=r(28),l=r(55),u=r(43),c=r(3),h=r(1),p=r(53),d=r(39),f=r(70);t.exports=function(t,e,r,m,_,y){var g=n[t],v=g,b=_?"set":"add",x=v&&v.prototype,w={},k=function(t){var e=x[t];o(x,t,"delete"==t?function(t){return!(y&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,r){return e.call(this,0===t?0:t,r),this})};if("function"==typeof v&&(y||x.forEach&&!h(function(){(new v).entries().next()}))){var E=new v,I=E[b](y?{}:-0,1)!=E,S=h(function(){E.has(1)}),M=p(function(t){new v(t)}),T=!y&&h(function(){for(var t=new v,e=5;e--;)t[b](e,e);return!t.has(-0)});M||((v=e(function(e,r){u(e,v,t);var n=f(new g,e,v);return void 0!=r&&l(r,_,n[b],n),n})).prototype=x,x.constructor=v),(S||T)&&(k("delete"),k("has"),_&&k("get")),(T||I)&&k(b),y&&x.clear&&delete x.clear}else v=m.getConstructor(e,t,_,b),a(v.prototype,r),s.NEED=!0;return d(v,t),w[t]=v,i(i.G+i.W+i.F*(v!=g),w),y||m.setStrong(v,t,_),v}},function(t,e,r){for(var n,i=r(2),o=r(14),a=r(31),s=a("typed_array"),l=a("view"),u=!(!i.ArrayBuffer||!i.DataView),c=u,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=i[p[h++]])?(o(n.prototype,s,!0),o(n.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(t,e,r){t.exports=function(){"use strict";var t,e,r;function n(n,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(r=i(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=i;else t=i}return n(0,function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=n;function n(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){var r,n,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if(n=1,(i=t)<(r=0))return r;if(i>n)return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=function(t,e,r){this.column=t,this.row=e,this.zoom=r};i.prototype.clone=function(){return new i(this.column,this.row,this.zoom)},i.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},i.prototype.sub=function(t){return this.clone()._sub(t)},i.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},i.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var o=a;function a(t,e){this.x=t,this.y=e}function s(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!s(t[r],e[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(!s(t[n],e[n]))return!1;return!0}return t===e}function l(t,e,n,i){var o=new r(t,e,n,i);return function(t){return o.solve(t)}}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t};var u=l(.25,.1,.25,1);function c(t,e,r){return Math.min(r,Math.max(e,t))}function h(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}var p=1;function d(){return p++}function f(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function m(t,e){return-1!==t.indexOf(e,t.length-e.length)}function _(t,e,r){var n={};for(var i in t)n[i]=e.call(r||this,t[i],i,t);return n}function y(t,e,r){var n={};for(var i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function g(t){return Array.isArray(t)?t.map(g):"object"==typeof t&&t?_(t,g):t}var v={};function b(t){v[t]||("undefined"!=typeof console&&console.warn(t),v[t]=!0)}function x(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function w(t){for(var e=0,r=0,n=t.length,i=n-1,o=void 0,a=void 0;r<n;i=r++)o=t[r],e+=((a=t[i]).x-o.x)*(o.y+a.y);return e}var k=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),E=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,I=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,S={now:k,frame:function(t){var e=E(t);return{cancel:function(){return I(e)}}},getImageData:function(t){var e=self.document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(0,0,t.width,t.height)},resolveURL:function(t){var e=self.document.createElement("a");return e.href=t,e.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:!1};if(self.document){var M=self.document.createElement("img");M.onload=function(){S.supportsWebp=!0},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var T={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(T);var A=function(t){function e(e,r,n){t.call(this,e),this.status=r,this.url=n,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error);function P(t){var e=new self.XMLHttpRequest;for(var r in e.open(t.method||"GET",t.url,!0),t.headers)e.setRequestHeader(r,t.headers[r]);return e.withCredentials="include"===t.credentials,e}var C=function(t,e){var r=P(t);return r.responseType="arraybuffer",r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){var n=r.response;if(0===n.byteLength&&200===r.status)return e(new Error("http status 200 returned without content."));(r.status>=200&&r.status<300||0===r.status)&&r.response?e(null,{data:n,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")}):e(new A(r.statusText,r.status,t.url))},r.send(),{cancel:function(){return r.abort()}}};function D(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function z(t,e,r){if(r&&r[t]){var n=r[t].indexOf(e);-1!==n&&r[t].splice(n,1)}}var B=function(t,e){void 0===e&&(e={}),h(this,e),this.type=t},L=function(t){function e(e,r){void 0===r&&(r={}),t.call(this,"error",h({error:e},r))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(B),R=function(){};R.prototype.on=function(t,e){return this._listeners=this._listeners||{},D(t,e,this._listeners),this},R.prototype.off=function(t,e){return z(t,e,this._listeners),z(t,e,this._oneTimeListeners),this},R.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},D(t,e,this._oneTimeListeners),this},R.prototype.fire=function(t){"string"==typeof t&&(t=new B(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var r=0,n=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];r<n.length;r+=1)n[r].call(this,t);for(var i=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];i<o.length;i+=1){var a=o[i];z(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(h(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof L&&console.error(t.error);return this},R.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},R.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var O={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-z-order":{type:"enum",values:{"viewport-y":{},source:{}},default:"viewport-y",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},F=function(t,e,r,n){this.message=(t?t+": ":"")+r,n&&(this.identifier=n),null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)};function N(t){var e=t.key,r=t.value;return r?[new F(e,r,"constants have been deprecated as of v8")]:[]}function V(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}function j(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function U(t){return Array.isArray(t)?t.map(U):j(t)}var q=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),G=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var i=n[r],o=i[0],a=i[1];this.bindings[o]=a}};G.prototype.concat=function(t){return new G(this,t)},G.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},G.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Z={kind:"null"},X={kind:"number"},W={kind:"string"},H={kind:"boolean"},Y={kind:"color"},K={kind:"object"},J={kind:"value"},Q={kind:"collator"},$={kind:"formatted"};function tt(t,e){return{kind:"array",itemType:t,N:e}}function et(t){if("array"===t.kind){var e=et(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var rt=[Z,X,W,H,Y,$,K,tt(J)];function nt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!nt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,n=rt;r<n.length;r+=1)if(!nt(n[r],e))return null}return"Expected "+et(t)+" but found "+et(e)+" instead."}var it=e(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=i.indexOf("("),u=i.indexOf(")");if(-1!==l&&u+1===i.length){var c=i.substr(0,l),h=i.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=a(h[1]),m=a(h[2]),_=m<=.5?m*(f+1):m+f-m*f,y=2*m-_;return[n(255*s(y,_,d+1/3)),n(255*s(y,_,d)),n(255*s(y,_,d-1/3)),p];default:return null}}return null}}catch(t){}}).parseCSSColor,ot=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};ot.parse=function(t){if(t){if(t instanceof ot)return t;if("string"==typeof t){var e=it(t);if(e)return new ot(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},ot.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+i+")"},ot.prototype.toArray=function(){var t=this.r,e=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]},ot.black=new ot(0,0,0,1),ot.white=new ot(1,1,1,1),ot.transparent=new ot(0,0,0,0),ot.red=new ot(1,0,0,1);var at=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};at.prototype.compare=function(t,e){return this.collator.compare(t,e)},at.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var st=function(t,e,r){this.text=t,this.scale=e,this.fontStack=r},lt=function(t){this.sections=t};function ut(t,e,r,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ct(t){if(null===t)return Z;if("string"==typeof t)return W;if("boolean"==typeof t)return H;if("number"==typeof t)return X;if(t instanceof ot)return Y;if(t instanceof at)return Q;if(t instanceof lt)return $;if(Array.isArray(t)){for(var e,r=t.length,n=0,i=t;n<i.length;n+=1){var o=ct(i[n]);if(e){if(e===o)continue;e=J;break}e=o}return tt(e||J,r)}return K}function ht(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ot||t instanceof lt?t.toString():JSON.stringify(t)}lt.fromString=function(t){return new lt([new st(t,null,null)])},lt.prototype.toString=function(){return this.sections.map(function(t){return t.text}).join("")},lt.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),t.push(i)}return t};var pt=function(t,e){this.type=t,this.value=e};pt.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof ot)return!0;if(e instanceof at)return!0;if(e instanceof lt)return!0;if(Array.isArray(e)){for(var r=0,n=e;r<n.length;r+=1)if(!t(n[r]))return!1;return!0}if("object"==typeof e){for(var i in e)if(!t(e[i]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var r=t[1],n=ct(r),i=e.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new pt(n,r)},pt.prototype.evaluate=function(){return this.value},pt.prototype.eachChild=function(){},pt.prototype.possibleOutputs=function(){return[this.value]},pt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ot?["rgba"].concat(this.value.toArray()):this.value instanceof lt?this.value.serialize():this.value};var dt=function(t){this.name="ExpressionEvaluationError",this.message=t};dt.prototype.toJSON=function(){return this.message};var ft={string:W,number:X,boolean:H,object:K},mt=function(t,e){this.type=t,this.args=e};mt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,n=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in ft)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=ft[s],n++}else o=J;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],n++}r=tt(o,a)}else r=ft[i];for(var l=[];n<t.length;n++){var u=e.parse(t[n],n,J);if(!u)return null;l.push(u)}return new mt(r,l)},mt.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!nt(this.type,ct(r)))return r;if(e===this.args.length-1)throw new dt("Expected value to be of type "+et(this.type)+", but found "+et(ct(r))+" instead.")}return null},mt.prototype.eachChild=function(t){this.args.forEach(t)},mt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},mt.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map(function(t){return t.serialize()}))};var _t=function(t){this.type=$,this.sections=t};_t.parse=function(t,e){if(t.length<3)return e.error("Expected at least two arguments.");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");for(var r=[],n=1;n<t.length-1;n+=2){var i=e.parse(t[n],1,J);if(!i)return null;var o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o)return e.error("Formatted text type must be 'string', 'value', or 'null'.");var a=t[n+1];if("object"!=typeof a||Array.isArray(a))return e.error("Format options argument must be an object.");var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,X)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,tt(W))))return null;r.push({text:i,scale:s,font:l})}return new _t(r)},_t.prototype.evaluate=function(t){return new lt(this.sections.map(function(e){return new st(ht(e.text.evaluate(t)),e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null)}))},_t.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t(n.text),n.scale&&t(n.scale),n.font&&t(n.font)}},_t.prototype.possibleOutputs=function(){return[void 0]},_t.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.text.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),t.push(i)}return t};var yt={"to-boolean":H,"to-color":Y,"to-number":X,"to-string":W},gt=function(t,e){this.type=t,this.args=e};gt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var n=yt[r],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,J);if(!a)return null;i.push(a)}return new gt(n,i)},gt.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,n=0,i=this.args;n<i.length;n+=1){if(r=null,(e=i[n].evaluate(t))instanceof ot)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ut(e[0],e[1],e[2],e[3])))return new ot(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new dt(r||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}if("number"===this.type.kind){for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(t)))return 0;var u=Number(a);if(!isNaN(u))return u}throw new dt("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?lt.fromString(ht(this.args[0].evaluate(t))):ht(this.args[0].evaluate(t))},gt.prototype.eachChild=function(t){this.args.forEach(t)},gt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},gt.prototype.serialize=function(){if("formatted"===this.type.kind)return new _t([{text:this.args[0],scale:null,font:null}]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var vt=["Unknown","Point","LineString","Polygon"],bt=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};bt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},bt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?vt[this.feature.type]:this.feature.type:null},bt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},bt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ot.parse(t)),e};var xt=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};xt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},xt.prototype.eachChild=function(t){this.args.forEach(t)},xt.prototype.possibleOutputs=function(){return[void 0]},xt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},xt.parse=function(t,e){var r=t[0],n=xt.definitions[r];if(!n)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter(function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1}),s=null,l=0,u=a;l<u.length;l+=1){var c=u[l],h=c[0],p=c[1];s=new Mt(e.registry,e.path,null,e.scope);for(var d=[],f=!1,m=1;m<t.length;m++){var _=t[m],y=Array.isArray(h)?h[m-1]:h.type,g=s.parse(_,1+d.length,y);if(!g){f=!0;break}d.push(g)}if(!f)if(Array.isArray(h)&&h.length!==d.length)s.error("Expected "+h.length+" arguments, but found "+d.length+" instead.");else{for(var v=0;v<d.length;v++){var b=Array.isArray(h)?h[v]:h.type,x=d[v];s.concat(v+1).checkSubtype(b,x.type)}if(0===s.errors.length)return new xt(r,i,p,d)}}if(1===a.length)e.errors.push.apply(e.errors,s.errors);else{for(var w=(a.length?a:o).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(et).join(", ")+")":"("+et(e.type)+"...)"}).join(" | "),k=[],E=1;E<t.length;E++){var I=e.parse(t[E],1+k.length);if(!I)return null;k.push(et(I.type))}e.error("Expected arguments of type "+w+", but found ("+k.join(", ")+") instead.")}return null},xt.register=function(t,e){for(var r in xt.definitions=e,e)t[r]=xt};var wt=function(t,e,r){this.type=Q,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function kt(t){if(t instanceof xt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!kt(t)&&(e=!1)}),e}function Et(t){if(t instanceof xt&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!Et(t)&&(e=!1)}),e}function It(t,e){if(t instanceof xt&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild(function(t){r&&!It(t,e)&&(r=!1)}),r}wt.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,H);if(!n)return null;var i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,H);if(!i)return null;var o=null;return r.locale&&!(o=e.parse(r.locale,1,W))?null:new wt(n,i,o)},wt.prototype.evaluate=function(t){return new at(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},wt.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},wt.prototype.possibleOutputs=function(){return[void 0]},wt.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var St=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};St.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new St(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},St.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},St.prototype.eachChild=function(){},St.prototype.possibleOutputs=function(){return[void 0]},St.prototype.serialize=function(){return["var",this.name]};var Mt=function(t,e,r,n,i){void 0===e&&(e=[]),void 0===n&&(n=new G),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=r};function Tt(t,e){for(var r,n,i=0,o=t.length-1,a=0;i<=o;){if(r=t[a=Math.floor((i+o)/2)],n=t[a+1],e===r||e>r&&e<n)return a;if(r<e)i=a+1;else{if(!(r>e))throw new dt("Input is not a number.");o=a-1}}return Math.max(a-1,0)}Mt.prototype.parse=function(t,e,r,n,i){return void 0===i&&(i={}),e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)},Mt.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new mt(e,[t]):"coerce"===r?new gt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=t[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=r(o,a,e.typeAnnotation||"coerce");else o=r(o,a,e.typeAnnotation||"assert")}if(!(o instanceof pt)&&function t(e){if(e instanceof St)return t(e.boundExpression);if(e instanceof xt&&"error"===e.name)return!1;if(e instanceof wt)return!1;var r=e instanceof gt||e instanceof mt,n=!0;return e.eachChild(function(e){n=r?n&&t(e):n&&e instanceof pt}),!!n&&kt(e)&&It(e,["zoom","heatmap-density","line-progress","is-supported-script"])}(o)){var l=new bt;try{o=new pt(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},Mt.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Mt(this.registry,n,e||null,i,this.errors)},Mt.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var n=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new q(n,t))},Mt.prototype.checkSubtype=function(t,e){var r=nt(t,e);return r&&this.error(r),r};var At=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};function Pt(t,e,r){return t*(1-r)+e*r}At.parse=function(t,e){var r=t[1],n=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,1,X)))return null;var i=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),n.unshift(-1/0);for(var a=0;a<n.length;a+=2){var s=n[a],l=n[a+1],u=a+1,c=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=e.parse(l,c,o);if(!h)return null;o=o||h.type,i.push([s,h])}return new At(o,r,i)},At.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;return n>=e[i-1]?r[i-1].evaluate(t):r[Tt(e,n)].evaluate(t)},At.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},At.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},At.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Ct=Object.freeze({number:Pt,color:function(t,e,r){return new ot(Pt(t.r,e.r,r),Pt(t.g,e.g,r),Pt(t.b,e.b,r),Pt(t.a,e.a,r))},array:function(t,e,r){return t.map(function(t,n){return Pt(t,e[n],r)})}}),Dt=.95047,zt=1,Bt=1.08883,Lt=4/29,Rt=6/29,Ot=3*Rt*Rt,Ft=Rt*Rt*Rt,Nt=Math.PI/180,Vt=180/Math.PI;function jt(t){return t>Ft?Math.pow(t,1/3):t/Ot+Lt}function Ut(t){return t>Rt?t*t*t:Ot*(t-Lt)}function qt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Gt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Zt(t){var e=Gt(t.r),r=Gt(t.g),n=Gt(t.b),i=jt((.4124564*e+.3575761*r+.1804375*n)/Dt),o=jt((.2126729*e+.7151522*r+.072175*n)/zt);return{l:116*o-16,a:500*(i-o),b:200*(o-jt((.0193339*e+.119192*r+.9503041*n)/Bt)),alpha:t.a}}function Xt(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=zt*Ut(e),r=Dt*Ut(r),n=Bt*Ut(n),new ot(qt(3.2404542*r-1.5371385*e-.4985314*n),qt(-.969266*r+1.8760108*e+.041556*n),qt(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}var Wt={forward:Zt,reverse:Xt,interpolate:function(t,e,r){return{l:Pt(t.l,e.l,r),a:Pt(t.a,e.a,r),b:Pt(t.b,e.b,r),alpha:Pt(t.alpha,e.alpha,r)}}},Ht={forward:function(t){var e=Zt(t),r=e.l,n=e.a,i=e.b,o=Math.atan2(i,n)*Vt;return{h:o<0?o+360:o,c:Math.sqrt(n*n+i*i),l:r,alpha:t.a}},reverse:function(t){var e=t.h*Nt,r=t.c;return Xt({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:function(t,e,r){var n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}(t.h,e.h,r),c:Pt(t.c,e.c,r),l:Pt(t.l,e.l,r),alpha:Pt(t.alpha,e.alpha,r)}}},Yt=Object.freeze({lab:Wt,hcl:Ht}),Kt=function(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],l=s[0],u=s[1];this.labels.push(l),this.outputs.push(u)}};function Jt(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}Kt.interpolationFactor=function(t,e,n,i){var o=0;if("exponential"===t.name)o=Jt(e,t.base,n,i);else if("linear"===t.name)o=Jt(e,1,n,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new r(a[0],a[1],a[2],a[3]).solve(Jt(e,1,n,i))}return o},Kt.parse=function(t,e){var r=t[0],n=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(4!==s.length||s.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,X)))return null;var l=[],u=null;"interpolate-hcl"===r||"interpolate-lab"===r?u=Y:e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var c=0;c<o.length;c+=2){var h=o[c],p=o[c+1],d=c+3,f=c+4;if("number"!=typeof h)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(p,f,u);if(!m)return null;u=u||m.type,l.push([h,m])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new Kt(u,r,n,i,l):e.error("Type "+et(u)+" is not interpolatable.")},Kt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);var o=Tt(e,n),a=e[o],s=e[o+1],l=Kt.interpolationFactor(this.interpolation,n,a,s),u=r[o].evaluate(t),c=r[o+1].evaluate(t);return"interpolate"===this.operator?Ct[this.type.kind.toLowerCase()](u,c,l):"interpolate-hcl"===this.operator?Ht.reverse(Ht.interpolate(Ht.forward(u),Ht.forward(c),l)):Wt.reverse(Wt.interpolate(Wt.forward(u),Wt.forward(c),l))},Kt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Kt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Kt.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var Qt=function(t,e){this.type=t,this.args=e};Qt.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,n=e.expectedType;n&&"value"!==n.kind&&(r=n);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],l=e.parse(s,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!l)return null;r=r||l.type,i.push(l)}var u=n&&i.some(function(t){return nt(n,t.type)});return new Qt(u?J:r,i)},Qt.prototype.evaluate=function(t){for(var e=null,r=0,n=this.args;r<n.length&&null===(e=n[r].evaluate(t));r+=1);return e},Qt.prototype.eachChild=function(t){this.args.forEach(t)},Qt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Qt.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var $t=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};$t.prototype.evaluate=function(t){return this.result.evaluate(t)},$t.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},$t.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var i=t[n];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var o=e.parse(t[n+1],n+1);if(!o)return null;r.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return a?new $t(r,a):null},$t.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},$t.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var te=function(t,e,r){this.type=t,this.index=e,this.input=r};te.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,X),n=e.parse(t[2],2,tt(e.expectedType||J));if(!r||!n)return null;var i=n.type;return new te(i.itemType,r,n)},te.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new dt("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new dt("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new dt("Array index must be an integer, but found "+e+" instead.");return r[e]},te.prototype.eachChild=function(t){t(this.index),t(this.input)},te.prototype.possibleOutputs=function(){return[void 0]},te.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ee=function(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o};ee.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,h=s;c<h.length;c+=1){var p=h[c];if("number"!=typeof p&&"string"!=typeof p)return u.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ct(p)))return null}else r=ct(p);if(void 0!==i[String(p)])return u.error("Branch labels must be unique.");i[String(p)]=o.length}var d=e.parse(l,a,n);if(!d)return null;n=n||d.type,o.push(d)}var f=e.parse(t[1],1,J);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,n);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new ee(r,n,f,i,o,m):null},ee.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ct(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},ee.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ee.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},ee.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i],s=n[t.cases[a]];void 0===s?(n[t.cases[a]]=r.length,r.push([t.cases[a],[a]])):r[s][1].push(a)}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=r;u<c.length;u+=1){var h=c[u],p=h[0],d=h[1];1===d.length?e.push(l(d[0])):e.push(d.map(l)),e.push(t.outputs[p].serialize())}return e.push(this.otherwise.serialize()),e};var re=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};function ne(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function ie(t,e,r,n){return 0===n.compare(e,r)}function oe(t,e,r){var n="=="!==t&&"!="!==t;return function(){function i(t,e,r){this.type=H,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],o=e.parse(t[1],1,J);if(!o)return null;if(!ne(r,o.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+et(o.type)+"'.");var a=e.parse(t[2],2,J);if(!a)return null;if(!ne(r,a.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+et(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+et(o.type)+"' and '"+et(a.type)+"'.");n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new mt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new mt(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Q)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=ct(o),l=ct(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new dt('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var u=ct(o),c=ct(a);if("string"!==u.kind||"string"!==c.kind)return e(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},i}()}re.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,H);if(!o)return null;var a=e.parse(t[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new re(r,n,s):null},re.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},re.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t(i),t(o)}t(this.otherwise)},re.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},re.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var ae=oe("==",function(t,e,r){return e===r},ie),se=oe("!=",function(t,e,r){return e!==r},function(t,e,r,n){return!ie(0,e,r,n)}),le=oe("<",function(t,e,r){return e<r},function(t,e,r,n){return n.compare(e,r)<0}),ue=oe(">",function(t,e,r){return e>r},function(t,e,r,n){return n.compare(e,r)>0}),ce=oe("<=",function(t,e,r){return e<=r},function(t,e,r,n){return n.compare(e,r)<=0}),he=oe(">=",function(t,e,r){return e>=r},function(t,e,r,n){return n.compare(e,r)>=0}),pe=function(t){this.type=X,this.input=t};pe.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+et(r.type)+" instead."):new pe(r):null},pe.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new dt("Expected value to be of type string or array, but found "+et(ct(e))+" instead.")},pe.prototype.eachChild=function(t){t(this.input)},pe.prototype.possibleOutputs=function(){return[void 0]},pe.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var de={"==":ae,"!=":se,">":ue,"<":le,">=":he,"<=":ce,array:mt,at:te,boolean:mt,case:re,coalesce:Qt,collator:wt,format:_t,interpolate:Kt,"interpolate-hcl":Kt,"interpolate-lab":Kt,length:pe,let:$t,literal:pt,match:ee,number:mt,object:mt,step:At,string:mt,"to-boolean":gt,"to-color":gt,"to-number":gt,"to-string":gt,var:St};function fe(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];r=r.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=ut(r,n,i,a);if(s)throw new dt(s);return new ot(r/255*a,n/255*a,i/255*a,a)}function me(t,e){return t in e}function _e(t,e){var r=e[t];return void 0===r?null:r}function ye(t){return{type:t}}function ge(t){return{result:"success",value:t}}function ve(t){return{result:"error",value:t}}function be(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function xe(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function we(t){return!!t.expression&&t.expression.interpolated}function ke(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ee(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Ie(t){return t}function Se(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Me(t,e,r,n,i){return Se(typeof r===i?n[r]:void 0,t.default,e.default)}function Te(t,e,r){if("number"!==ke(r))return Se(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var i=Ce(t.stops,r);return t.stops[i][1]}function Ae(t,e,r){var n=void 0!==t.base?t.base:1;if("number"!==ke(r))return Se(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var o=Ce(t.stops,r),a=function(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Ct[e.type]||Ie;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=Yt[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return u(r,n,a)}}:u(s,l,a)}function Pe(t,e,r){return"color"===e.type?r=ot.parse(r):"formatted"===e.type?r=lt.fromString(r.toString()):ke(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Se(r,t.default,e.default)}function Ce(t,e){for(var r,n,i=0,o=t.length-1,a=0;i<=o;){if(r=t[a=Math.floor((i+o)/2)][0],n=t[a+1][0],e===r||e>r&&e<n)return a;r<e?i=a+1:r>e&&(o=a-1)}return Math.max(a-1,0)}xt.register(de,{error:[{kind:"error"},[W],function(t,e){var r=e[0];throw new dt(r.evaluate(t))}],typeof:[W,[J],function(t,e){return et(ct(e[0].evaluate(t)))}],"to-rgba":[tt(X,4),[Y],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Y,[X,X,X],fe],rgba:[Y,[X,X,X,X],fe],has:{type:H,overloads:[[[W],function(t,e){return me(e[0].evaluate(t),t.properties())}],[[W,K],function(t,e){var r=e[0],n=e[1];return me(r.evaluate(t),n.evaluate(t))}]]},get:{type:J,overloads:[[[W],function(t,e){return _e(e[0].evaluate(t),t.properties())}],[[W,K],function(t,e){var r=e[0],n=e[1];return _e(r.evaluate(t),n.evaluate(t))}]]},"feature-state":[J,[W],function(t,e){return _e(e[0].evaluate(t),t.featureState||{})}],properties:[K,[],function(t){return t.properties()}],"geometry-type":[W,[],function(t){return t.geometryType()}],id:[J,[],function(t){return t.id()}],zoom:[X,[],function(t){return t.globals.zoom}],"heatmap-density":[X,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[X,[],function(t){return t.globals.lineProgress||0}],"+":[X,ye(X),function(t,e){for(var r=0,n=0,i=e;n<i.length;n+=1)r+=i[n].evaluate(t);return r}],"*":[X,ye(X),function(t,e){for(var r=1,n=0,i=e;n<i.length;n+=1)r*=i[n].evaluate(t);return r}],"-":{type:X,overloads:[[[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[X],function(t,e){return-e[0].evaluate(t)}]]},"/":[X,[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[X,[X,X],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],ln2:[X,[],function(){return Math.LN2}],pi:[X,[],function(){return Math.PI}],e:[X,[],function(){return Math.E}],"^":[X,[X,X],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[X,[X],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[X,[X],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN10}],ln:[X,[X],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[X,[X],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN2}],sin:[X,[X],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[X,[X],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[X,[X],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[X,[X],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[X,[X],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[X,[X],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[X,ye(X),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[X,ye(X),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[X,[X],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[X,[X],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[X,[X],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[X,[X],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[H,[W,J],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[H,[J],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[H,[W],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<o}],"filter-id-<":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>o}],"filter-id->":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[H,[W,J],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[H,[J],function(t,e){var r=e[0],n=t.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[H,[J],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[H,[],function(t){return null!==t.id()}],"filter-type-in":[H,[tt(W)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[H,[tt(J)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[H,[W,tt(J)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[H,[W,tt(J)],function(t,e){var r=e[0],n=e[1];return function(t,e,r,n){for(;r<=n;){var i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}(t.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[ye(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1)if(!n[r].evaluate(t))return!1;return!0}]]},any:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[ye(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1)if(n[r].evaluate(t))return!0;return!1}]]},"!":[H,[H],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[H,[W],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[W,[W],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[W,[W],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[W,ye(J),function(t,e){return e.map(function(e){return ht(e.evaluate(t))}).join("")}],"resolved-locale":[W,[Q],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var De=function(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new bt,this._defaultValue="color"===(r=e).type&&Ee(r.default)?new ot(0,0,0,0):"color"===r.type?ot.parse(r.default)||null:void 0===r.default?null:r.default,this._enumValues="enum"===e.type?e.values:null};function ze(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in de}function Be(t,e){var r=new Mt(de,[],function(t){var e={color:Y,string:W,number:X,enum:W,boolean:H,formatted:$};return"array"===t.type?tt(e[t.value]||J,t.length):e[t.type]}(e)),n=r.parse(t,void 0,void 0,void 0,"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?ge(new De(n,e)):ve(r.errors)}De.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this.expression.evaluate(this._evaluator)},De.prototype.evaluate=function(t,e,r){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null;try{var n=this.expression.evaluate(this._evaluator);if(null===n||void 0===n)return this._defaultValue;if(this._enumValues&&!(n in this._enumValues))throw new dt("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(n)+" instead.");return n}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Le=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Et(e.expression)};Le.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r)},Le.prototype.evaluate=function(t,e,r){return this._styleExpression.evaluate(t,e,r)};var Re=function(t,e,r){this.kind=t,this.zoomStops=r.labels,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Et(e.expression),r instanceof Kt&&(this._interpolationType=r.interpolation)};function Oe(t,e){if("error"===(t=Be(t,e)).result)return t;var r=t.value.expression,n=kt(r);if(!n&&!be(e))return ve([new q("","data expressions not supported")]);var i=It(r,["zoom"]);if(!i&&!xe(e))return ve([new q("","zoom expressions not supported")]);var o=function t(e){var r=null;if(e instanceof $t)r=t(e.result);else if(e instanceof Qt)for(var n=0,i=e.args;n<i.length;n+=1){var o=i[n];if(r=t(o))break}else(e instanceof At||e instanceof Kt)&&e.input instanceof xt&&"zoom"===e.input.name&&(r=e);return r instanceof q?r:(e.eachChild(function(e){var n=t(e);n instanceof q?r=n:!r&&n?r=new q("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new q("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r)}(r);return o||i?o instanceof q?ve([o]):o instanceof Kt&&!we(e)?ve([new q("",'"interpolate" expressions cannot be used with this property')]):ge(o?new Re(n?"camera":"composite",t.value,o):new Le(n?"constant":"source",t.value)):ve([new q("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Re.prototype.evaluateWithoutErrorHandling=function(t,e,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r)},Re.prototype.evaluate=function(t,e,r){return this._styleExpression.evaluate(t,e,r)},Re.prototype.interpolationFactor=function(t,e,r){return this._interpolationType?Kt.interpolationFactor(this._interpolationType,t,e,r):0};var Fe=function(t,e){this._parameters=t,this._specification=e,V(this,function t(e,r){var n,i,o,a="color"===r.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||void 0!==e.property,u=s||!l,c=e.type||(we(r)?"exponential":"interval");if(a&&((e=V({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],ot.parse(t[1])]})),e.default?e.default=ot.parse(e.default):e.default=ot.parse(r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Yt[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)n=Ae;else if("interval"===c)n=Te;else if("categorical"===c){n=Me,i=Object.create(null);for(var h=0,p=e.stops;h<p.length;h+=1){var d=p[h];i[d[0]]=d[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');n=Pe}if(s){for(var f={},m=[],_=0;_<e.stops.length;_++){var y=e.stops[_],g=y[0].zoom;void 0===f[g]&&(f[g]={zoom:g,type:e.type,property:e.property,default:e.default,stops:[]},m.push(g)),f[g].stops.push([y[0].value,y[1]])}for(var v=[],b=0,x=m;b<x.length;b+=1){var w=x[b];v.push([f[w].zoom,t(f[w],r)])}return{kind:"composite",interpolationFactor:Kt.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:v.map(function(t){return t[0]}),evaluate:function(t,n){var i=t.zoom;return Ae({stops:v,base:e.base},r,i).evaluate(i,n)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Kt.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var a=t.zoom;return n(e,r,a,i,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Se(e.default,r.default):n(e,r,s,i,o)}}}(this._parameters,this._specification))};function Ne(t,e){if(Ee(t))return new Fe(t,e);if(ze(t)){var r=Oe(t,e);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return r.value}var n=t;return"string"==typeof t&&"color"===e.type&&(n=ot.parse(t)),{kind:"constant",evaluate:function(){return n}}}function Ve(t){var e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=ke(r);if("object"!==l)return[new F(e,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],h=n[c]||n["*"],p=void 0;if(i[c])p=i[c];else if(n[c])p=cr;else if(i["*"])p=i["*"];else{if(!n["*"]){s.push(new F(e,r[u],'unknown property "'+u+'"'));continue}p=cr}s=s.concat(p({key:(e?e+".":e)+u,value:r[u],valueSpec:h,style:o,styleSpec:a,object:r,objectKey:u},r))}for(var d in n)i[d]||n[d].required&&void 0===n[d].default&&void 0===r[d]&&s.push(new F(e,r,'missing required property "'+d+'"'));return s}function je(t){var e=t.value,r=t.valueSpec,n=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||cr;if("array"!==ke(e))return[new F(o,e,"array expected, "+ke(e)+" found")];if(r.length&&e.length!==r.length)return[new F(o,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new F(o,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value};i.$version<7&&(s.function=r.function),"object"===ke(r.value)&&(s=r.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:n,styleSpec:i,key:o+"["+u+"]"}));return l}function Ue(t){var e=t.key,r=t.value,n=t.valueSpec,i=ke(r);return"number"!==i?[new F(e,r,"number expected, "+i+" found")]:"minimum"in n&&r<n.minimum?[new F(e,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new F(e,r,r+" is greater than the maximum value "+n.maximum)]:[]}function qe(t){var e,r,n,i=t.valueSpec,o=j(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,u="array"===ke(t.value.stops)&&"array"===ke(t.value.stops[0])&&"object"===ke(t.value.stops[0][0]),c=Ve({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new F(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;return e=e.concat(je({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===ke(r)&&0===r.length&&e.push(new F(t.key,r,"array must have at least one stop")),e},default:function(t){return cr({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&c.push(new F(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||c.push(new F(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!we(t.valueSpec)&&c.push(new F(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!be(t.valueSpec)?c.push(new F(t.key,t.value,"property functions not supported")):s&&!xe(t.valueSpec)&&c.push(new F(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==t.value.property||c.push(new F(t.key,t.value,'"property" property is required')),c;function h(t){var e=[],o=t.value,s=t.key;if("array"!==ke(o))return[new F(s,o,"array expected, "+ke(o)+" found")];if(2!==o.length)return[new F(s,o,"array length 2 expected, length "+o.length+" found")];if(u){if("object"!==ke(o[0]))return[new F(s,o,"object expected, "+ke(o[0])+" found")];if(void 0===o[0].zoom)return[new F(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new F(s,o,"object stop key must have value")];if(n&&n>j(o[0].zoom))return[new F(s,o[0].zoom,"stop zoom values must appear in ascending order")];j(o[0].zoom)!==n&&(n=j(o[0].zoom),r=void 0,a={}),e=e.concat(Ve({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Ue,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return e.concat(cr({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function p(t,n){var s=ke(t.value),l=j(t.value),u=null!==t.value?t.value:n;if(e){if(s!==e)return[new F(t.key,u,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new F(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var c="number expected, "+s+" found";return be(i)&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new F(t.key,u,c)]}return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==r&&l<r?[new F(t.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===o&&l in a?[new F(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new F(t.key,u,"integer expected, found "+l)]}}function Ge(t){var e=("property"===t.expressionContext?Oe:Be)(U(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new F(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new F(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')]:"property"!==t.expressionContext||"layout"!==t.propertyType||Et(e.value._styleExpression.expression)?[]:[new F(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')]}function Ze(t){var e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(j(r))&&i.push(new F(e,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(j(r))&&i.push(new F(e,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),i}function Xe(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var n=r[e];if(!Xe(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}Fe.deserialize=function(t){return new Fe(t._parameters,t._specification)},Fe.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var We={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function He(t){if(null===t||void 0===t)return function(){return!0};Xe(t)||(t=Ke(t));var e=Be(t,We);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,r){return e.value.evaluate(t,r)}}function Ye(t,e){return t<e?-1:t>e?1:0}function Ke(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?Je(t[1],t[2],"=="):"!="===r?tr(Je(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Je(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(Ke))):"all"===r?["all"].concat(t.slice(1).map(Ke)):"none"===r?["all"].concat(t.slice(1).map(Ke).map(tr)):"in"===r?Qe(t[1],t.slice(2)):"!in"===r?tr(Qe(t[1],t.slice(2))):"has"===r?$e(t[1]):"!has"!==r||tr($e(t[1]))}function Je(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function Qe(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Ye)]]:["filter-in-small",t,["literal",e]]}}function $e(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function tr(t){return["!",t]}function er(t){return Xe(U(t.value))?Ge(V({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value,n=e.key;if("array"!==ke(r))return[new F(n,r,"array expected, "+ke(r)+" found")];var i,o=e.styleSpec,a=[];if(r.length<1)return[new F(n,r,"filter array must have at least 1 element")];switch(a=a.concat(Ze({key:n+"[0]",value:r[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),j(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===j(r[1])&&a.push(new F(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new F(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(i=ke(r[1]))&&a.push(new F(n+"[1]",r[1],"string expected, "+i+" found"));for(var s=2;s<r.length;s++)i=ke(r[s]),"$type"===j(r[1])?a=a.concat(Ze({key:n+"["+s+"]",value:r[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new F(n+"["+s+"]",r[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(t({key:n+"["+l+"]",value:r[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=ke(r[1]),2!==r.length?a.push(new F(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new F(n+"[1]",r[1],"string expected, "+i+" found"))}return a}(t)}function rr(t,e){var r=t.key,n=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return cr({key:r,value:o,valueSpec:i.transition,style:n,styleSpec:i});var u,c=t.valueSpec||s[a];if(!c)return[new F(r,o,'unknown property "'+a+'"')];if("string"===ke(o)&&be(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new F(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&n&&!n.glyphs&&h.push(new F(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Ee(U(o))&&"identity"===j(o.type)&&h.push(new F(r,o,'"text-font" does not support identity functions'))),h.concat(cr({key:t.key,value:o,valueSpec:c,style:n,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function nr(t){return rr(t,"paint")}function ir(t){return rr(t,"layout")}function or(t){var e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;r.type||r.ref||e.push(new F(n,r,'either "type" or "ref" is required'));var a,s=j(r.type),l=j(r.ref);if(r.id)for(var u=j(r.id),c=0;c<t.arrayIndex;c++){var h=i.layers[c];j(h.id)===u&&e.push(new F(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+h.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(t){t in r&&e.push(new F(n,r[t],'"'+t+'" is prohibited for ref layers'))}),i.layers.forEach(function(t){j(t.id)===l&&(a=t)}),a?a.ref?e.push(new F(n,r.ref,"ref cannot reference another ref layer")):s=j(a.type):e.push(new F(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var p=i.sources&&i.sources[r.source],d=p&&j(p.type);p?"vector"===d&&"raster"===s?e.push(new F(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new F(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new F(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&p.lineMetrics||e.push(new F(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new F(n,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new F(n,r.source,'source "'+r.source+'" not found'))}else e.push(new F(n,r,'missing required property "source"'));return e=e.concat(Ve({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return cr({key:n+".type",value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:er,layout:function(t){return Ve({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return ir(V({layerType:s},t))}}})},paint:function(t){return Ve({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return nr(V({layerType:s},t))}}})}}}))}function ar(t){var e=t.value,r=t.key,n=t.styleSpec,i=t.style;if(!e.type)return[new F(r,e,'"type" is required')];var o=j(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(Ve({key:r,value:e,valueSpec:n["source_"+o.replace("-","_")],style:t.style,styleSpec:n})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new F(r+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return Ve({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n});case"video":return Ve({key:r,value:e,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return Ve({key:r,value:e,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return a.push(new F(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return Ze({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function sr(t){var e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=ke(e);if(void 0===e)return o;if("object"!==a)return o.concat([new F("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=l&&n[l[1]]&&n[l[1]].transition?o.concat(cr({key:s,value:e[s],valueSpec:r.transition,style:i,styleSpec:r})):n[s]?o.concat(cr({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):o.concat([new F(s,e[s],'unknown property "'+s+'"')])}return o}function lr(t){var e=t.value,r=t.key,n=ke(e);return"string"!==n?[new F(r,e,"string expected, "+n+" found")]:[]}var ur={"*":function(){return[]},array:je,boolean:function(t){var e=t.value,r=t.key,n=ke(e);return"boolean"!==n?[new F(r,e,"boolean expected, "+n+" found")]:[]},number:Ue,color:function(t){var e=t.key,r=t.value,n=ke(r);return"string"!==n?[new F(e,r,"color expected, "+n+" found")]:null===it(r)?[new F(e,r,'color expected, "'+r+'" found')]:[]},constants:N,enum:Ze,filter:er,function:qe,layer:or,object:Ve,source:ar,light:sr,string:lr,formatted:function(t){return 0===lr(t).length?[]:Ge(t)}};function cr(t){var e=t.value,r=t.valueSpec,n=t.styleSpec;return r.expression&&Ee(j(e))?qe(t):r.expression&&ze(U(e))?Ge(t):r.type&&ur[r.type]?ur[r.type](t):Ve(V({},t,{valueSpec:r.type?n[r.type]:r}))}function hr(t){var e=t.value,r=t.key,n=lr(t);return n.length?n:(-1===e.indexOf("{fontstack}")&&n.push(new F(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new F(r,e,'"glyphs" url must include a "{range}" token')),n)}function pr(t,e){e=e||O;var r=[];return r=r.concat(cr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:hr,"*":function(){return[]}}})),t.constants&&(r=r.concat(N({key:"constants",value:t.constants,style:t,styleSpec:e}))),dr(r)}function dr(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function fr(t){return function(){return dr(t.apply(this,arguments))}}pr.source=fr(ar),pr.light=fr(sr),pr.layer=fr(or),pr.filter=fr(er),pr.paintProperty=fr(nr),pr.layoutProperty=fr(ir);var mr=pr,_r=pr.light,yr=pr.paintProperty,gr=pr.layoutProperty;function vr(t,e){var r=!1;if(e&&e.length)for(var n=0,i=e;n<i.length;n+=1){var o=i[n];t.fire(new L(new Error(o.message))),r=!0}return r}var br=wr,xr=3;function wr(t,e,r){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],e=i[1],r=i[2],this.d=e+2*r;for(var o=0;o<this.d*this.d;o++){var a=i[xr+o],s=i[xr+o+1];n.push(a===s?null:i.subarray(a,s))}var l=i[xr+n.length],u=i[xr+n.length+1];this.keys=i.subarray(l,u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var h=r/e*t;this.min=-h,this.max=t+h}wr.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},wr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},wr.prototype._insertCell=function(t,e,r,n,i,o){this.cells[i].push(o)},wr.prototype.query=function(t,e,r,n){var i=this.min,o=this.max;if(t<=i&&e<=i&&o<=r&&o<=n)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,r,n,this._queryCell,a,{}),a},wr.prototype._queryCell=function(t,e,r,n,i,o,a){var s=this.cells[i];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var h=s[c];if(void 0===a[h]){var p=4*h;t<=u[p+2]&&e<=u[p+3]&&r>=u[p+0]&&n>=u[p+1]?(a[h]=!0,o.push(l[h])):a[h]=!1}}},wr.prototype._forEachCell=function(t,e,r,n,i,o,a){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(r),c=this._convertToCellCoord(n),h=s;h<=u;h++)for(var p=l;p<=c;p++){var d=this.d*p+h;if(i.call(this,t,e,r,n,d,o,a))return}},wr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},wr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=xr+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(e+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[xr+a]=o,i.set(s,o),o+=s.length}return i[xr+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[xr+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var kr=self.ImageData,Er={};function Ir(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Er[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var Sr in Ir("Object",Object),br.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},br.deserialize=function(t){return new br(t.buffer)},Ir("Grid",br),Ir("Color",ot),Ir("Error",Error),Ir("StylePropertyFunction",Fe),Ir("StyleExpression",De,{omit:["_evaluator"]}),Ir("ZoomDependentExpression",Re),Ir("ZoomConstantExpression",Le),Ir("CompoundExpression",xt,{omit:["_evaluate"]}),de)de[Sr]._classRegistryKey||Ir("Expression_"+Sr,de[Sr]);function Mr(t,e){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof kr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var n=[],i=0,o=t;i<o.length;i+=1){var a=o[i];n.push(Mr(a,e))}return n}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var c in t)if(t.hasOwnProperty(c)&&!(Er[l].omit.indexOf(c)>=0)){var h=t[c];u[c]=Er[l].shallow.indexOf(c)>=0?h:Mr(h,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof t)}function Tr(t){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof kr)return t;if(Array.isArray(t))return t.map(Tr);if("object"==typeof t){var e=t.$name||"Object",r=Er[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var n=Object.create(r.prototype),i=0,o=Object.keys(t);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=t[a];n[a]=Er[e].shallow.indexOf(a)>=0?s:Tr(s)}}return n}throw new Error("can't deserialize object of type "+typeof t)}var Ar=function(){this.first=!0};Ar.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var Pr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Cr(t){for(var e=0,r=t;e<r.length;e+=1)if(zr(r[e].charCodeAt(0)))return!0;return!1}function Dr(t){return!(Pr.Arabic(t)||Pr["Arabic Supplement"](t)||Pr["Arabic Extended-A"](t)||Pr["Arabic Presentation Forms-A"](t)||Pr["Arabic Presentation Forms-B"](t))}function zr(t){return!(746!==t&&747!==t&&(t<4352||!(Pr["Bopomofo Extended"](t)||Pr.Bopomofo(t)||Pr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Pr["CJK Compatibility Ideographs"](t)||Pr["CJK Compatibility"](t)||Pr["CJK Radicals Supplement"](t)||Pr["CJK Strokes"](t)||!(!Pr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Pr["CJK Unified Ideographs Extension A"](t)||Pr["CJK Unified Ideographs"](t)||Pr["Enclosed CJK Letters and Months"](t)||Pr["Hangul Compatibility Jamo"](t)||Pr["Hangul Jamo Extended-A"](t)||Pr["Hangul Jamo Extended-B"](t)||Pr["Hangul Jamo"](t)||Pr["Hangul Syllables"](t)||Pr.Hiragana(t)||Pr["Ideographic Description Characters"](t)||Pr.Kanbun(t)||Pr["Kangxi Radicals"](t)||Pr["Katakana Phonetic Extensions"](t)||Pr.Katakana(t)&&12540!==t||!(!Pr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Pr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Pr["Unified Canadian Aboriginal Syllabics"](t)||Pr["Unified Canadian Aboriginal Syllabics Extended"](t)||Pr["Vertical Forms"](t)||Pr["Yijing Hexagram Symbols"](t)||Pr["Yi Syllables"](t)||Pr["Yi Radicals"](t))))}function Br(t){return!(zr(t)||function(t){return!!(Pr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Pr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Pr["Letterlike Symbols"](t)||Pr["Number Forms"](t)||Pr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Pr["Control Pictures"](t)&&9251!==t||Pr["Optical Character Recognition"](t)||Pr["Enclosed Alphanumerics"](t)||Pr["Geometric Shapes"](t)||Pr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Pr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Pr["CJK Symbols and Punctuation"](t)||Pr.Katakana(t)||Pr["Private Use Area"](t)||Pr["CJK Compatibility Forms"](t)||Pr["Small Form Variants"](t)||Pr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Lr(t,e){return!(!e&&(t>=1424&&t<=2303||Pr["Arabic Presentation Forms-A"](t)||Pr["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||Pr.Khmer(t))}var Rr,Or=!1,Fr=null,Nr=!1,Vr=new R,jr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Nr||null!=jr.applyArabicShaping}},Ur=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ar,this.transition={})};Ur.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,n=t;r<n.length;r+=1)if(!Lr(n[r].charCodeAt(0),e))return!1;return!0}(t,jr.isLoaded())},Ur.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ur.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}};var qr=function(t,e){this.property=t,this.value=e,this.expression=Ne(void 0===e?t.specification.default:e,t.specification)};qr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},qr.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var Gr=function(t){this.property=t,this.value=new qr(t,void 0)};Gr.prototype.transitioned=function(t,e){return new Xr(this.property,this.value,e,h({},t.transition,this.transition),t.now)},Gr.prototype.untransitioned=function(){return new Xr(this.property,this.value,null,{},0)};var Zr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Zr.prototype.getValue=function(t){return g(this._values[t].value.value)},Zr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Gr(this._values[t].property)),this._values[t].value=new qr(this._values[t].property,null===e?void 0:g(e))},Zr.prototype.getTransition=function(t){return g(this._values[t].transition)},Zr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Gr(this._values[t].property)),this._values[t].transition=g(e)||void 0},Zr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i);var o=this.getTransition(n);void 0!==o&&(t[n+"-transition"]=o)}return t},Zr.prototype.transitioned=function(t,e){for(var r=new Wr(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n];r._values[o]=this._values[o].transitioned(t,e._values[o])}return r},Zr.prototype.untransitioned=function(){for(var t=new Wr(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e];t._values[n]=this._values[n].untransitioned()}return t};var Xr=function(t,e,r,n,i){this.property=t,this.value=e,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};Xr.prototype.possiblyEvaluate=function(t){var e=t.now||0,r=this.value.possiblyEvaluate(t),n=this.prior;if(n){if(e>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(e<this.begin)return n.possiblyEvaluate(t);var i=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(t),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}(i))}return r};var Wr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Wr.prototype.possiblyEvaluate=function(t){for(var e=new Kr(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];e._values[i]=this._values[i].possiblyEvaluate(t)}return e},Wr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var r=e[t];if(this._values[r].prior)return!0}return!1};var Hr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Hr.prototype.getValue=function(t){return g(this._values[t].value)},Hr.prototype.setValue=function(t,e){this._values[t]=new qr(this._values[t].property,null===e?void 0:g(e))},Hr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],i=this.getValue(n);void 0!==i&&(t[n]=i)}return t},Hr.prototype.possiblyEvaluate=function(t){for(var e=new Kr(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];e._values[i]=this._values[i].possiblyEvaluate(t)}return e};var Yr=function(t,e,r){this.property=t,this.value=e,this.parameters=r};Yr.prototype.isConstant=function(){return"constant"===this.value.kind},Yr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Yr.prototype.evaluate=function(t,e){return this.property.evaluate(this.value,this.parameters,t,e)};var Kr=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Kr.prototype.get=function(t){return this._values[t]};var Jr=function(t){this.specification=t};Jr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Jr.prototype.interpolate=function(t,e,r){var n=Ct[this.specification.type];return n?n(t,e,r):t};var Qr=function(t){this.specification=t};Qr.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Yr(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Yr(this,t.expression,e)},Qr.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Yr(this,{kind:"constant",value:void 0},t.parameters);var n=Ct[this.specification.type];return n?new Yr(this,{kind:"constant",value:n(t.value.value,e.value.value,r)},t.parameters):t},Qr.prototype.evaluate=function(t,e,r,n){return"constant"===t.kind?t.value:t.evaluate(e,r,n)};var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(t,e){if(void 0===t.value)return new Yr(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var r=t.expression.evaluate(e),n=this._calculate(r,r,r,e);return new Yr(this,{kind:"constant",value:n},e)}if("camera"===t.expression.kind){var i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Yr(this,{kind:"constant",value:i},e)}return new Yr(this,t.expression,e)},e.prototype.evaluate=function(t,e,r,n){if("source"===t.kind){var i=t.evaluate(e,r,n);return this._calculate(i,i,i,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,n),t.evaluate({zoom:Math.floor(e.zoom)},r,n),t.evaluate({zoom:Math.floor(e.zoom)+1},r,n),e):t.value},e.prototype._calculate=function(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},e.prototype.interpolate=function(t){return t},e}(Qr),tn=function(t){this.specification=t};tn.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Ur(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Ur(Math.floor(e.zoom),e)),t.expression.evaluate(new Ur(Math.floor(e.zoom+1),e)),e)}},tn.prototype._calculate=function(t,e,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},tn.prototype.interpolate=function(t){return t};var en=function(t){this.specification=t};en.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},en.prototype.interpolate=function(){return!1};var rn=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var r=t[e],n=this.defaultPropertyValues[e]=new qr(r,void 0),i=this.defaultTransitionablePropertyValues[e]=new Gr(r);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({})}};Ir("DataDrivenProperty",Qr),Ir("DataConstantProperty",Jr),Ir("CrossFadedDataDrivenProperty",$r),Ir("CrossFadedProperty",tn),Ir("ColorRampProperty",en);var nn=function(t){function e(e,r){if(t.call(this),this.id=e.id,this.type=e.type,this.visibility="visible",this._featureFilter=function(){return!0},"custom"!==e.type&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Hr(r.layout)),r.paint)){for(var n in this._transitionablePaint=new Zr(r.paint),e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,r){if(null!==e&&void 0!==e){var n="layers."+this.id+".layout."+t;if(this._validate(gr,n,t,e,r))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return m(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,r){if(null!==e&&void 0!==e){var n="layers."+this.id+".paint."+t;if(this._validate(yr,n,t,e,r))return!1}if(m(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],o="cross-faded-data-driven"===i.property.specification["property-type"]&&!i.value.value&&e,a=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,e);var s=this._transitionablePaint._values[t].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(t),s||a||o},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),y(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,r,n,i){return(!i||!1!==i.validate)&&vr(this,t.call(mr,{key:e,layerType:this.type,objectKey:r,value:n,styleSpec:O,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof Yr&&be(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(R),on={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},an=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},sn=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ln(t,e){void 0===e&&(e=1);var r=0,n=0;return{members:t.map(function(t){var i,o=(i=t.type,on[i].BYTES_PER_ELEMENT),a=r=un(r,Math.max(e,o)),s=t.components||1;return n=Math.max(n,o),r+=o*s,{name:t.name,type:t.type,components:s,offset:a}}),size:un(r,Math.max(n,e)),alignment:e}}function un(t,e){return Math.ceil(t/e)*e}sn.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},sn.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},sn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},sn.prototype.clear=function(){this.length=0},sn.prototype.resize=function(t){this.reserve(t),this.length=t},sn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},sn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var cn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.int16[n+0]=t,this.int16[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.int16[n+0]=e,this.int16[n+1]=r,t},e}(sn);cn.prototype.bytesPerElement=4,Ir("StructArrayLayout2i4",cn);var hn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var i=this.length;this.resize(i+1);var o=4*i;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,i},e.prototype.emplace=function(t,e,r,n,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=i,t},e}(sn);hn.prototype.bytesPerElement=8,Ir("StructArrayLayout4i8",hn);var pn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,r,n,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(sn);pn.prototype.bytesPerElement=12,Ir("StructArrayLayout2i4i12",pn);var dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint8[c+8]=i,this.uint8[c+9]=o,this.uint8[c+10]=a,this.uint8[c+11]=s,l},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l){var u=6*t,c=12*t;return this.int16[u+0]=e,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.uint8[c+8]=o,this.uint8[c+9]=a,this.uint8[c+10]=s,this.uint8[c+11]=l,t},e}(sn);dn.prototype.bytesPerElement=12,Ir("StructArrayLayout4i4ub12",dn);var fn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var l=this.length;this.resize(l+1);var u=8*l;return this.uint16[u+0]=t,this.uint16[u+1]=e,this.uint16[u+2]=r,this.uint16[u+3]=n,this.uint16[u+4]=i,this.uint16[u+5]=o,this.uint16[u+6]=a,this.uint16[u+7]=s,l},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l){var u=8*t;return this.uint16[u+0]=e,this.uint16[u+1]=r,this.uint16[u+2]=n,this.uint16[u+3]=i,this.uint16[u+4]=o,this.uint16[u+5]=a,this.uint16[u+6]=s,this.uint16[u+7]=l,t},e}(sn);fn.prototype.bytesPerElement=16,Ir("StructArrayLayout8ui16",fn);var mn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint16[u+4]=i,this.uint16[u+5]=o,this.uint16[u+6]=a,this.uint16[u+7]=s,l},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l){var u=8*t;return this.int16[u+0]=e,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.uint16[u+4]=o,this.uint16[u+5]=a,this.uint16[u+6]=s,this.uint16[u+7]=l,t},e}(sn);mn.prototype.bytesPerElement=16,Ir("StructArrayLayout4i4ui16",mn);var _n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=r,this.float32[i+2]=n,t},e}(sn);_n.prototype.bytesPerElement=12,Ir("StructArrayLayout3f12",_n);var yn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.uint32[r+0]=t,e},e.prototype.emplace=function(t,e){var r=1*t;return this.uint32[r+0]=e,t},e}(sn);yn.prototype.bytesPerElement=4,Ir("StructArrayLayout1ul4",yn);var gn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s,l,u,c){var h=this.length;this.resize(h+1);var p=12*h,d=6*h;return this.int16[p+0]=t,this.int16[p+1]=e,this.int16[p+2]=r,this.int16[p+3]=n,this.int16[p+4]=i,this.int16[p+5]=o,this.uint32[d+3]=a,this.uint16[p+8]=s,this.uint16[p+9]=l,this.int16[p+10]=u,this.int16[p+11]=c,h},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l,u,c,h){var p=12*t,d=6*t;return this.int16[p+0]=e,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=i,this.int16[p+4]=o,this.int16[p+5]=a,this.uint32[d+3]=s,this.uint16[p+8]=l,this.uint16[p+9]=u,this.int16[p+10]=c,this.int16[p+11]=h,t},e}(sn);gn.prototype.bytesPerElement=24,Ir("StructArrayLayout6i1ul2ui2i24",gn);var vn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,r,n,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(sn);vn.prototype.bytesPerElement=12,Ir("StructArrayLayout2i2i2i12",vn);var bn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=4*r;return this.uint8[n+0]=t,this.uint8[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=4*t;return this.uint8[n+0]=e,this.uint8[n+1]=r,t},e}(sn);bn.prototype.bytesPerElement=4,Ir("StructArrayLayout2ub4",bn);var xn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d){var f=this.length;this.resize(f+1);var m=20*f,_=10*f,y=40*f;return this.int16[m+0]=t,this.int16[m+1]=e,this.uint16[m+2]=r,this.uint16[m+3]=n,this.uint32[_+2]=i,this.uint32[_+3]=o,this.uint32[_+4]=a,this.uint16[m+10]=s,this.uint16[m+11]=l,this.uint16[m+12]=u,this.float32[_+7]=c,this.float32[_+8]=h,this.uint8[y+36]=p,this.uint8[y+37]=d,f},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m=20*t,_=10*t,y=40*t;return this.int16[m+0]=e,this.int16[m+1]=r,this.uint16[m+2]=n,this.uint16[m+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[m+10]=l,this.uint16[m+11]=u,this.uint16[m+12]=c,this.float32[_+7]=h,this.float32[_+8]=p,this.uint8[y+36]=d,this.uint8[y+37]=f,t},e}(sn);xn.prototype.bytesPerElement=40,Ir("StructArrayLayout2i2ui3ul3ui2f2ub40",xn);var wn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d){var f=this.length;this.resize(f+1);var m=16*f,_=8*f;return this.int16[m+0]=t,this.int16[m+1]=e,this.int16[m+2]=r,this.int16[m+3]=n,this.uint16[m+4]=i,this.uint16[m+5]=o,this.uint16[m+6]=a,this.uint16[m+7]=s,this.uint16[m+8]=l,this.uint16[m+9]=u,this.uint16[m+10]=c,this.uint16[m+11]=h,this.uint16[m+12]=p,this.uint32[_+7]=d,f},e.prototype.emplace=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m=16*t,_=8*t;return this.int16[m+0]=e,this.int16[m+1]=r,this.int16[m+2]=n,this.int16[m+3]=i,this.uint16[m+4]=o,this.uint16[m+5]=a,this.uint16[m+6]=s,this.uint16[m+7]=l,this.uint16[m+8]=u,this.uint16[m+9]=c,this.uint16[m+10]=h,this.uint16[m+11]=p,this.uint16[m+12]=d,this.uint32[_+7]=f,t},e}(sn);wn.prototype.bytesPerElement=32,Ir("StructArrayLayout4i9ui1ul32",wn);var kn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.float32[r+0]=t,e},e.prototype.emplace=function(t,e){var r=1*t;return this.float32[r+0]=e,t},e}(sn);kn.prototype.bytesPerElement=4,Ir("StructArrayLayout1f4",kn);var En=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=r,this.int16[i+2]=n,t},e}(sn);En.prototype.bytesPerElement=6,Ir("StructArrayLayout3i6",En);var In=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=2*n,o=4*n;return this.uint32[i+0]=t,this.uint16[o+2]=e,this.uint16[o+3]=r,n},e.prototype.emplace=function(t,e,r,n){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=r,this.uint16[o+3]=n,t},e}(sn);In.prototype.bytesPerElement=8,Ir("StructArrayLayout1ul2ui8",In);var Sn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var i=3*n;return this.uint16[i+0]=t,this.uint16[i+1]=e,this.uint16[i+2]=r,n},e.prototype.emplace=function(t,e,r,n){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,this.uint16[i+2]=n,t},e}(sn);Sn.prototype.bytesPerElement=6,Ir("StructArrayLayout3ui6",Sn);var Mn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.uint16[n+0]=t,this.uint16[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=r,t},e}(sn);Mn.prototype.bytesPerElement=4,Ir("StructArrayLayout2ui4",Mn);var Tn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.uint16[r+0]=t,e},e.prototype.emplace=function(t,e){var r=1*t;return this.uint16[r+0]=e,t},e}(sn);Tn.prototype.bytesPerElement=2,Ir("StructArrayLayout1ui2",Tn);var An=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.float32[n+0]=t,this.float32[n+1]=e,r},e.prototype.emplace=function(t,e,r){var n=2*t;return this.float32[n+0]=e,this.float32[n+1]=r,t},e}(sn);An.prototype.bytesPerElement=8,Ir("StructArrayLayout2f8",An);var Pn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var i=this.length;this.resize(i+1);var o=4*i;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=r,this.float32[o+3]=n,i},e.prototype.emplace=function(t,e,r,n,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,t},e}(sn);Pn.prototype.bytesPerElement=16,Ir("StructArrayLayout4f16",Pn);var Cn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.radius.get=function(){return this._structArray.int16[this._pos2+10]},r.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},r.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},r.anchorPoint.get=function(){return new o(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(an);Cn.prototype.size=24;var Dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Cn(this,t)},e}(gn);Ir("CollisionBoxArray",Dn);var zn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,r),e}(an);zn.prototype.size=40;var Bn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new zn(this,t)},e}(xn);Ir("PlacedSymbolArray",Bn);var Ln=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},horizontalPlacedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.horizontalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.horizontalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+2]=t},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.verticalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+3]=t},r.key.get=function(){return this._structArray.uint16[this._pos2+4]},r.key.set=function(t){this._structArray.uint16[this._pos2+4]=t},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+5]},r.textBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+5]=t},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+6]},r.textBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+6]=t},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},r.iconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+7]=t},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.iconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.featureIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.numGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+10]},r.numGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+11]},r.numVerticalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+12]},r.numIconVertices.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+7]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+7]=t},Object.defineProperties(e.prototype,r),e}(an);Ln.prototype.size=32;var Rn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Ln(this,t)},e}(wn);Ir("SymbolInstanceArray",Rn);var On=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={offsetX:{configurable:!0}};return r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},r.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,r),e}(an);On.prototype.size=4;var Fn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new On(this,t)},e}(kn);Ir("GlyphOffsetArray",Fn);var Nn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return r.x.get=function(){return this._structArray.int16[this._pos2+0]},r.x.set=function(t){this._structArray.int16[this._pos2+0]=t},r.y.get=function(){return this._structArray.int16[this._pos2+1]},r.y.set=function(t){this._structArray.int16[this._pos2+1]=t},r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},r.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,r),e}(an);Nn.prototype.size=6;var Vn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new Nn(this,t)},e}(En);Ir("SymbolLineVertexArray",Vn);var jn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,r),e}(an);jn.prototype.size=8;var Un=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new jn(this,t)},e}(In);Ir("FeatureIndexArray",Un);var qn=ln([{name:"a_pos",components:2,type:"Int16"}],4),Gn=qn.members,Zn=(qn.size,qn.alignment,function(t){void 0===t&&(t=[]),this.segments=t});Zn.prototype.prepareSegment=function(t,e,r){var n=this.segments[this.segments.length-1];return t>Zn.MAX_VERTEX_ARRAY_LENGTH&&b("Max vertices per segment is "+Zn.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>Zn.MAX_VERTEX_ARRAY_LENGTH)&&(n={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},this.segments.push(n)),n},Zn.prototype.get=function(){return this.segments},Zn.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var n in r.vaos)r.vaos[n].destroy()}},Zn.simpleSegment=function(t,e,r,n){return new Zn([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:n,vaos:{}}])},Zn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ir("SegmentVector",Zn);var Xn=function(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)},Wn=function(){this.ids=[],this.positions=[],this.indexed=!1};function Hn(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}Wn.prototype.add=function(t,e,r,n){this.ids.push(t),this.positions.push(e,r,n)},Wn.prototype.getPositions=function(t){for(var e=0,r=this.ids.length-1;e<r;){var n=e+r>>1;this.ids[n]>=t?r=n:e=n+1}for(var i=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];i.push({index:o,start:a,end:s}),e++}return i},Wn.serialize=function(t,e){var r=new Float64Array(t.ids),n=new Uint32Array(t.positions);return function t(e,r,n,i){if(!(n>=i)){for(var o=e[n+i>>1],a=n-1,s=i+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;Hn(e,a,s),Hn(r,3*a,3*s),Hn(r,3*a+1,3*s+1),Hn(r,3*a+2,3*s+2)}t(e,r,n,s),t(e,r,s+1,i)}}(r,n,0,r.length-1),e.push(r.buffer,n.buffer),{ids:r,positions:n}},Wn.deserialize=function(t){var e=new Wn;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},Ir("FeaturePositionMap",Wn);var Yn=function(t,e){this.gl=t.gl,this.location=e},Kn=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(Yn),Jn=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(Yn),Qn=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(Yn),$n=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(Yn),ti=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(Yn),ei=function(t){function e(e,r){t.call(this,e,r),this.current=ot.transparent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(Yn),ri=new Float32Array(16),ni=function(t){function e(e,r){t.call(this,e,r),this.current=ri}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(Yn);function ii(t){return[Xn(255*t.r,255*t.g),Xn(255*t.b,255*t.a)]}var oi=function(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0};oi.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},oi.prototype.setConstantPatternPositions=function(){},oi.prototype.populatePaintArray=function(){},oi.prototype.updatePaintArray=function(){},oi.prototype.upload=function(){},oi.prototype.destroy=function(){},oi.prototype.setUniforms=function(t,e,r,n){e.set(n.constantOr(this.value))},oi.prototype.getBinding=function(t,e){return"color"===this.type?new ei(t,e):new Jn(t,e)},oi.serialize=function(t){var e=t.value,r=t.names,n=t.type;return{value:Mr(e),names:r,type:n}},oi.deserialize=function(t){var e=t.value,r=t.names,n=t.type;return new oi(Tr(e),r,n)};var ai=function(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};ai.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},ai.prototype.populatePaintArray=function(){},ai.prototype.updatePaintArray=function(){},ai.prototype.upload=function(){},ai.prototype.destroy=function(){},ai.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},ai.prototype.setUniforms=function(t,e,r,n,i){var o=this.patternPositions;"u_pattern_to"===i&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===i&&o.patternFrom&&e.set(o.patternFrom)},ai.prototype.getBinding=function(t,e){return new ti(t,e)};var si=function(t,e,r,n){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"a_"+t}),this.maxValue=-1/0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new n};si.prototype.defines=function(){return[]},si.prototype.setConstantPatternPositions=function(){},si.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var i=this.expression.evaluate(new Ur(0),e,{});if("color"===this.type)for(var o=ii(i),a=n;a<t;a++)r.emplaceBack(o[0],o[1]);else{for(var s=n;s<t;s++)r.emplaceBack(i);this.maxValue=Math.max(this.maxValue,i)}},si.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},r,n);if("color"===this.type)for(var a=ii(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var l=t;l<e;l++)i.emplace(l,o);this.maxValue=Math.max(this.maxValue,o)}},si.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},si.prototype.setUniforms=function(t,e){e.set(0)},si.prototype.getBinding=function(t,e){return new Jn(t,e)};var li=function(t,e,r,n,i,o){this.expression=t,this.names=e,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new a};li.prototype.defines=function(){return[]},li.prototype.setConstantPatternPositions=function(){},li.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var i=this.expression.evaluate(new Ur(this.zoom),e,{}),o=this.expression.evaluate(new Ur(this.zoom+1),e,{});if("color"===this.type)for(var a=ii(i),s=ii(o),l=n;l<t;l++)r.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var u=n;u<t;u++)r.emplaceBack(i,o);this.maxValue=Math.max(this.maxValue,i,o)}},li.prototype.updatePaintArray=function(t,e,r,n){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);if("color"===this.type)for(var s=ii(o),l=ii(a),u=t;u<e;u++)i.emplace(u,s[0],s[1],l[0],l[1]);else{for(var c=t;c<e;c++)i.emplace(c,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},li.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},li.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},li.prototype.setUniforms=function(t,e,r){e.set(this.interpolationFactor(r.zoom))},li.prototype.getBinding=function(t,e){return new Jn(t,e)};var ui=function(t,e,r,n,i,o,a){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};ui.prototype.defines=function(){return[]},ui.prototype.setConstantPatternPositions=function(){},ui.prototype.populatePaintArray=function(t,e,r){var n=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,o=this.layerId,a=n.length;if(n.reserve(t),i.reserve(t),r&&e.patterns&&e.patterns[o]){var s=e.patterns[o],l=s.min,u=s.mid,c=s.max,h=r[l],p=r[u],d=r[c];if(!h||!p||!d)return;for(var f=a;f<t;f++)n.emplaceBack(p.tl[0],p.tl[1],p.br[0],p.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),i.emplaceBack(p.tl[0],p.tl[1],p.br[0],p.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},ui.prototype.updatePaintArray=function(t,e,r,n,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId;if(i&&r.patterns&&r.patterns[s]){var l=r.patterns[s],u=l.min,c=l.mid,h=l.max,p=i[u],d=i[c],f=i[h];if(!p||!d||!f)return;for(var m=t;m<e;m++)o.emplace(m,d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1]),a.emplace(m,d.tl[0],d.tl[1],d.br[0],d.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1])}},ui.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ui.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ui.prototype.setUniforms=function(t,e){e.set(0)},ui.prototype.getBinding=function(t,e){return new Jn(t,e)};var ci=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Wn,this._bufferOffset=0};ci.createDynamic=function(t,e,r){var n=new ci,i=[];for(var o in t.paint._values)if(r(o)){var a=t.paint.get(o);if(a instanceof Yr&&be(a.property.specification)){var s=pi(o,t.type),l=a.property.specification.type,u=a.property.useIntegerZoom;if("cross-faded"===a.property.specification["property-type"]||"cross-faded-data-driven"===a.property.specification["property-type"])if("constant"===a.value.kind)n.binders[o]=new ai(a.value.value,s,l),i.push("/u_"+o);else{var c=di(o,l,"source");n.binders[o]=new ui(a.value,s,l,u,e,c,t.id),i.push("/a_"+o)}else if("constant"===a.value.kind)n.binders[o]=new oi(a.value.value,s,l),i.push("/u_"+o);else if("source"===a.value.kind){var h=di(o,l,"source");n.binders[o]=new si(a.value,s,l,h),i.push("/a_"+o)}else{var p=di(o,l,"composite");n.binders[o]=new li(a.value,s,l,u,e,p),i.push("/z_"+o)}}}return n.cacheKey=i.sort().join(""),n},ci.prototype.populatePaintArrays=function(t,e,r,n){for(var i in this.binders)this.binders[i].populatePaintArray(t,e,n);void 0!==e.id&&this._featureMap.add(+e.id,r,this._bufferOffset,t),this._bufferOffset=t},ci.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders)this.binders[r].setConstantPatternPositions(t,e)},ci.prototype.updatePaintArrays=function(t,e,r,n){var i=!1;for(var o in t)for(var a=0,s=this._featureMap.getPositions(+o);a<s.length;a+=1){var l=s[a],u=e.feature(l.index);for(var c in this.binders){var h=this.binders[c];if(!(h instanceof oi||h instanceof ai)&&!0===h.expression.isStateDependent){var p=r.paint.get(c);h.expression=p.value,h.updatePaintArray(l.start,l.end,u,t[o],n),i=!0}}}return i},ci.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},ci.prototype.getPaintVertexBuffers=function(){return this._buffers},ci.prototype.getUniforms=function(t,e){var r={};for(var n in this.binders)for(var i=this.binders[n],o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];r[s]=i.getBinding(t,e[s])}return r},ci.prototype.setUniforms=function(t,e,r,n){for(var i in this.binders)for(var o=this.binders[i],a=0,s=o.uniformNames;a<s.length;a+=1){var l=s[a];o.setUniforms(t,e[l],n,r.get(i),l)}},ci.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var r in this.binders){var n=this.binders[r];if(n instanceof ui){var i=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&e.push(i)}else(n instanceof si||n instanceof li)&&n.paintVertexBuffer&&e.push(n.paintVertexBuffer)}this._buffers=e},ci.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof si||i instanceof li)&&i.paintVertexBuffer&&r.push(i.paintVertexBuffer)}this._buffers=r},ci.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var hi=function(t,e,r,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,o=e;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=ci.createDynamic(a,r,n),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1};function pi(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function di(t,e,r){var n={color:{source:An,composite:Pn},number:{source:kn,composite:An}},i=function(t){return{"line-pattern":{source:fn,composite:fn},"fill-pattern":{source:fn,composite:fn},"fill-extrusion-pattern":{source:fn,composite:fn}}[t]}(t);return i&&i[r]||n[e][r]}hi.prototype.populatePaintArrays=function(t,e,r,n){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,r,n);this.needsUpload=!0},hi.prototype.updatePaintArrays=function(t,e,r,n){for(var i=0,o=r;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,e,a,n)||this.needsUpload}},hi.prototype.get=function(t){return this.programConfigurations[t]},hi.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},hi.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Ir("ConstantBinder",oi),Ir("CrossFadedConstantBinder",ai),Ir("SourceExpressionBinder",si),Ir("CrossFadedCompositeBinder",ui),Ir("CompositeExpressionBinder",li),Ir("ProgramConfiguration",ci,{omit:["_buffers"]}),Ir("ProgramConfigurationSet",hi);var fi=8192,mi={min:-1*Math.pow(2,15),max:Math.pow(2,15)-1};function _i(t){for(var e=fi/t.extent,r=t.loadGeometry(),n=0;n<r.length;n++)for(var i=r[n],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<mi.min||a.x>mi.max||a.y<mi.min||a.y>mi.max)&&b("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function yi(t,e,r,n,i){t.emplaceBack(2*e+(n+1)/2,2*r+(i+1)/2)}var gi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new cn,this.indexArray=new Sn,this.segments=new Zn,this.programConfigurations=new hi(Gn,t.layers,t.zoom)};function vi(t,e,r){for(var n=0;n<t.length;n++){var i=t[n];if(Ti(i,e))return!0;if(Ii(e,i,r))return!0}return!1}function bi(t,e){if(1===t.length&&1===t[0].length)return Mi(e,t[0][0]);for(var r=0;r<e.length;r++)for(var n=e[r],i=0;i<n.length;i++)if(Mi(t,n[i]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if(Mi(e,a[s]))return!0;for(var l=0;l<e.length;l++)if(ki(a,e[l]))return!0}return!1}function xi(t,e,r){for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<i.length;s++)if(Ti(a,i[s]))return!0;if(wi(a,i,r))return!0}return!1}function wi(t,e,r){if(t.length>1){if(ki(t,e))return!0;for(var n=0;n<e.length;n++)if(Ii(e[n],t,r))return!0}for(var i=0;i<t.length;i++)if(Ii(t[i],e,r))return!0;return!1}function ki(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var n=t[r],i=t[r+1],o=0;o<e.length-1;o++)if(Ei(n,i,e[o],e[o+1]))return!0;return!1}function Ei(t,e,r,n){return x(t,r,n)!==x(e,r,n)&&x(t,e,r)!==x(t,e,n)}function Ii(t,e,r){var n=r*r;if(1===e.length)return t.distSqr(e[0])<n;for(var i=1;i<e.length;i++)if(Si(t,e[i-1],e[i])<n)return!0;return!1}function Si(t,e,r){var n=e.distSqr(r);if(0===n)return t.distSqr(e);var i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function Mi(t,e){for(var r,n,i,o=!1,a=0;a<t.length;a++)for(var s=0,l=(r=t[a]).length-1;s<r.length;l=s++)n=r[s],i=r[l],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(o=!o);return o}function Ti(t,e){for(var r=!1,n=0,i=t.length-1;n<t.length;i=n++){var o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Ai(t,e,r){var n=e.paint.get(t).value;return"constant"===n.kind?n.value:r.programConfigurations.get(e.id).binders[t].maxValue}function Pi(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ci(t,e,r,n,i){if(!e[0]&&!e[1])return t;var a=o.convert(e);"viewport"===r&&a._rotate(-n);for(var s=[],l=0;l<t.length;l++){for(var u=t[l],c=[],h=0;h<u.length;h++)c.push(u[h].sub(a._mult(i)));s.push(c)}return s}gi.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Ur(this.zoom),o)){var l=_i(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},gi.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},gi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},gi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},gi.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},gi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},gi.prototype.addFeature=function(t,e,r){for(var n=0,i=e;n<i.length;n+=1)for(var o=0,a=i[n];o<a.length;o+=1){var s=a[o],l=s.x,u=s.y;if(!(l<0||l>=fi||u<0||u>=fi)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=c.vertexLength;yi(this.layoutVertexArray,l,u,-1,-1),yi(this.layoutVertexArray,l,u,1,-1),yi(this.layoutVertexArray,l,u,1,1),yi(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{})},Ir("CircleBucket",gi,{omit:["layers"]});var Di={paint:new rn({"circle-radius":new Qr(O.paint_circle["circle-radius"]),"circle-color":new Qr(O.paint_circle["circle-color"]),"circle-blur":new Qr(O.paint_circle["circle-blur"]),"circle-opacity":new Qr(O.paint_circle["circle-opacity"]),"circle-translate":new Jr(O.paint_circle["circle-translate"]),"circle-translate-anchor":new Jr(O.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jr(O.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jr(O.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qr(O.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qr(O.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qr(O.paint_circle["circle-stroke-opacity"])})},zi="undefined"!=typeof Float32Array?Float32Array:Array;function Bi(){var t=new zi(9);return zi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Li(){var t=new zi(3);return zi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ri(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function Oi(t,e,r){var n=new zi(3);return n[0]=t,n[1]=e,n[2]=r,n}Math.PI;var Fi,Ni=Ri,Vi=(Fi=Li(),function(t,e,r,n,i,o){var a,s=void 0;for(e||(e=3),r||(r=0),a=n?Math.min(n*e+r,t.length):t.length,s=r;s<a;s+=e)Fi[0]=t[s],Fi[1]=t[s+1],Fi[2]=t[s+2],i(Fi,Fi,o),t[s]=Fi[0],t[s+1]=Fi[1],t[s+2]=Fi[2];return t});function ji(){var t=new zi(4);return zi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ui(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t}function qi(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}var Gi=function(){var t=ji();return function(e,r,n,i,o,a){var s,l=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,l=n;l<s;l+=r)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],o(t,t,a),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}}();function Zi(){var t=new zi(4);return zi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}Li(),Oi(1,0,0),Oi(0,1,0),Zi(),Zi(),Bi(),function(){var t;t=new zi(2),zi!=Float32Array&&(t[0]=0,t[1]=0)}();var Xi=function(t){function e(e){t.call(this,e,Di)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new gi(t)},e.prototype.queryRadius=function(t){var e=t;return Ai("circle-radius",this,e)+Ai("circle-stroke-width",this,e)+Pi(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a,s){for(var l=Ci(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(t,e,r){return l.map(function(t){return t.map(function(t){return Wi(t,e,r)})})}(0,s,o),p=c?u*a:u,d=0,f=n;d<f.length;d+=1)for(var m=0,_=f[d];m<_.length;m+=1){var y=_[m],g=c?y:Wi(y,s,o),v=p,b=qi([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?v*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(v*=o.cameraToCenterDistance/b[3]),vi(h,g,v))return!0}return!1},e}(nn);function Wi(t,e,r){var n=qi([],[t.x,t.y,0,1],e);return new o((n[0]/n[3]+1)*r.width*.5,(n[1]/n[3]+1)*r.height*.5)}var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(gi);function Yi(t,e,r,n){var i=e.width,o=e.height;if(n){if(n.length!==i*o*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*o*r);return t.width=i,t.height=o,t.data=n,t}function Ki(t,e,r){var n=e.width,i=e.height;if(n!==t.width||i!==t.height){var o=Yi({},{width:n,height:i},r);Ji(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,n),height:Math.min(t.height,i)},r),t.width=n,t.height=i,t.data=o.data}}function Ji(t,e,r,n,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<i.height;l++)for(var u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o,h=0;h<i.width*o;h++)s[c+h]=a[u+h];return e}Ir("HeatmapBucket",Hi,{omit:["layers"]});var Qi=function(t,e){Yi(this,t,1,e)};Qi.prototype.resize=function(t){Ki(this,t,1)},Qi.prototype.clone=function(){return new Qi({width:this.width,height:this.height},new Uint8Array(this.data))},Qi.copy=function(t,e,r,n,i){Ji(t,e,r,n,i,1)};var $i=function(t,e){Yi(this,t,4,e)};$i.prototype.resize=function(t){Ki(this,t,4)},$i.prototype.clone=function(){return new $i({width:this.width,height:this.height},new Uint8Array(this.data))},$i.copy=function(t,e,r,n,i){Ji(t,e,r,n,i,4)},Ir("AlphaImage",Qi),Ir("RGBAImage",$i);var to={paint:new rn({"heatmap-radius":new Qr(O.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qr(O.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jr(O.paint_heatmap["heatmap-intensity"]),"heatmap-color":new en(O.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jr(O.paint_heatmap["heatmap-opacity"])})};function eo(t,e){for(var r=new Uint8Array(1024),n={},i=0,o=0;i<256;i++,o+=4){n[e]=i/255;var a=t.evaluate(n);r[o+0]=Math.floor(255*a.r/a.a),r[o+1]=Math.floor(255*a.g/a.a),r[o+2]=Math.floor(255*a.b/a.a),r[o+3]=Math.floor(255*a.a)}return new $i({width:256,height:1},r)}var ro=function(t){function e(e){t.call(this,e,to),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Hi(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=eo(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(nn),no={paint:new rn({"hillshade-illumination-direction":new Jr(O.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jr(O.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jr(O.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jr(O.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jr(O.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jr(O.paint_hillshade["hillshade-accent-color"])})},io=function(t){function e(e){t.call(this,e,no)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(nn),oo=ln([{name:"a_pos",components:2,type:"Int16"}],4),ao=oo.members,so=(oo.size,oo.alignment,uo),lo=uo;function uo(t,e,r){r=r||2;var n,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*r:t.length,p=co(t,0,h,r,!0),d=[];if(!p)return d;if(c&&(p=function(t,e,r,n){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=co(t,e[i]*n,i<o-1?e[i+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),s.push(xo(a));for(s.sort(go),i=0;i<s.length;i++)vo(s[i],r),r=ho(r,r.next);return r}(t,e,p,r)),t.length>80*r){n=o=t[0],i=a=t[1];for(var f=r;f<h;f+=r)s=t[f],l=t[f+1],s<n&&(n=s),l<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return po(p,d,r,n,i,u),d}function co(t,e,r,n,i){var o,a;if(i===Do(t,e,r,n)>0)for(o=e;o<r;o+=n)a=Ao(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=Ao(o,t[o],t[o+1],a);return a&&Io(a,a.next)&&(Po(a),a=a.next),a}function ho(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Io(n,n.next)&&0!==Eo(n.prev,n,n.next))n=n.next;else{if(Po(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function po(t,e,r,n,i,o,a){if(t){!a&&o&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=bo(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,a,s,l,u=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(t,n,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?mo(t,n,i,o):fo(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),Po(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?po(t=_o(t,e,r),e,r,n,i,o,2):2===a&&yo(t,e,r,n,i,o):po(ho(t),e,r,n,i,o,1);break}}}function fo(t){var e=t.prev,r=t,n=t.next;if(Eo(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(wo(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Eo(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function mo(t,e,r,n){var i=t.prev,o=t,a=t.next;if(Eo(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=bo(s,l,e,r,n),p=bo(u,c,e,r,n),d=t.prevZ,f=t.nextZ;d&&d.z>=h&&f&&f.z<=p;){if(d!==t.prev&&d!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Eo(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Eo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Eo(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Eo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function _o(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Io(i,o)&&So(i,n,n.next,o)&&Mo(i,o)&&Mo(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),Po(n),Po(n.next),n=t=o),n=n.next}while(n!==t);return n}function yo(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ko(a,s)){var l=To(a,s);return a=ho(a,a.next),l=ho(l,l.next),po(a,e,r,n,i,o),void po(l,e,r,n,i,o)}s=s.next}a=a.next}while(a!==t)}function go(t,e){return t.x-e.x}function vo(t,e){if(e=function(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var l,u=r,c=r.x,h=r.y,p=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=c&&i!==n.x&&wo(o<h?i:a,o,c,h,o<h?a:i,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(i-n.x))<p||l===p&&n.x>r.x)&&Mo(n,t)&&(r=n,p=l),n=n.next;return r}(t,e)){var r=To(e,t);ho(r,r.next)}}function bo(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xo(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function wo(t,e,r,n,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function ko(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&So(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&Mo(t,e)&&Mo(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function Eo(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Io(t,e){return t.x===e.x&&t.y===e.y}function So(t,e,r,n){return!!(Io(t,e)&&Io(r,n)||Io(t,n)&&Io(r,e))||Eo(t,e,r)>0!=Eo(t,e,n)>0&&Eo(r,n,t)>0!=Eo(r,n,e)>0}function Mo(t,e){return Eo(t.prev,t,t.next)<0?Eo(t,e,t.next)>=0&&Eo(t,t.prev,e)>=0:Eo(t,e,t.prev)<0||Eo(t,t.next,e)<0}function To(t,e){var r=new Co(t.i,t.x,t.y),n=new Co(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Ao(t,e,r,n){var i=new Co(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Po(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Co(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Do(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}uo.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(Do(t,0,o,r));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(Do(t,u,c,r))}var h=0;for(s=0;s<n.length;s+=3){var p=n[s]*r,d=n[s+1]*r,f=n[s+2]*r;h+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},uo.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r},so.default=lo;var zo=e(function(t,e){t.exports=function(){function t(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(r,n,i,o,a){!function e(r,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=n-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-l*c/s+h)),Math.min(o,Math.floor(n+(s-l)*c/s+h)),a)}var p=r[n],d=i,f=o;for(t(r,i,n),a(r[o],p)>0&&t(r,i,o);d<f;){for(t(r,d,f),d++,f--;a(r[d],p)<0;)d++;for(;a(r[f],p)>0;)f--}0===a(r[i],p)?t(r,i,f):t(r,++f,o),f<=n&&(i=f+1),n<=f&&(o=f-1)}}(r,n,i||0,o||r.length-1,a||e)}}()});function Bo(t,e){var r=t.length;if(r<=1)return[t];for(var n,i,o=[],a=0;a<r;a++){var s=w(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(n&&o.push(n),n=[t[a]]):n.push(t[a]))}if(n&&o.push(n),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(zo(o[l],e,1,o[l].length-1,Lo),o[l]=o[l].slice(0,e));return o}function Lo(t,e){return e.area-t.area}function Ro(t,e,r){for(var n=r.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(i=!0);var l=s.constantOr(null);l&&(i=!0,n[l.to]=!0,n[l.from]=!0)}return i}function Oo(t,e,r,n,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.paint.get(t+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:n-1},r,{}),h=u.evaluate({zoom:n},r,{}),p=u.evaluate({zoom:n+1},r,{});o[c]=!0,o[h]=!0,o[p]=!0,r.patterns[l.id]={min:c,mid:h,max:p}}}return r}var Fo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new cn,this.indexArray=new Sn,this.indexArray2=new Mn,this.programConfigurations=new hi(ao,t.layers,t.zoom),this.segments=new Zn,this.segments2=new Zn};Fo.prototype.populate=function(t,e){this.features=[],this.hasPattern=Ro("fill",this.layers,e);for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Ur(this.zoom),o)){var l=_i(o),u={sourceLayerIndex:s,index:a,geometry:l,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(u.id=o.id),this.hasPattern?this.features.push(Oo("fill",this.layers,u,this.zoom,e)):this.addFeature(u,l,a,{}),e.featureIndex.insert(o,l,a,s,this.index)}}},Fo.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Fo.prototype.addFeatures=function(t,e){for(var r=0,n=this.features;r<n.length;r+=1){var i=n[r],o=i.geometry;this.addFeature(i,o,i.index,e)}},Fo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Fo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ao),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Fo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Fo.prototype.addFeature=function(t,e,r,n){for(var i=0,o=Bo(e,500);i<o.length;i+=1){for(var a=o[i],s=0,l=0,u=a;l<u.length;l+=1)s+=u[l].length;for(var c=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),h=c.vertexLength,p=[],d=[],f=0,m=a;f<m.length;f+=1){var _=m[f];if(0!==_.length){_!==a[0]&&d.push(p.length/2);var y=this.segments2.prepareSegment(_.length,this.layoutVertexArray,this.indexArray2),g=y.vertexLength;this.layoutVertexArray.emplaceBack(_[0].x,_[0].y),this.indexArray2.emplaceBack(g+_.length-1,g),p.push(_[0].x),p.push(_[0].y);for(var v=1;v<_.length;v++)this.layoutVertexArray.emplaceBack(_[v].x,_[v].y),this.indexArray2.emplaceBack(g+v-1,g+v),p.push(_[v].x),p.push(_[v].y);y.vertexLength+=_.length,y.primitiveLength+=_.length}}for(var b=so(p,d),x=0;x<b.length;x+=3)this.indexArray.emplaceBack(h+b[x],h+b[x+1],h+b[x+2]);c.vertexLength+=s,c.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n)},Ir("FillBucket",Fo,{omit:["layers","features"]});var No={paint:new rn({"fill-antialias":new Jr(O.paint_fill["fill-antialias"]),"fill-opacity":new Qr(O.paint_fill["fill-opacity"]),"fill-color":new Qr(O.paint_fill["fill-color"]),"fill-outline-color":new Qr(O.paint_fill["fill-outline-color"]),"fill-translate":new Jr(O.paint_fill["fill-translate"]),"fill-translate-anchor":new Jr(O.paint_fill["fill-translate-anchor"]),"fill-pattern":new $r(O.paint_fill["fill-pattern"])})},Vo=function(t){function e(e){t.call(this,e,No)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new Fo(t)},e.prototype.queryRadius=function(){return Pi(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a){return bi(Ci(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),n)},e}(nn),jo=ln([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Uo=jo.members,qo=(jo.size,jo.alignment,Math.pow(2,13));function Go(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,2*Math.floor(n*qo)+a,i*qo*2,o*qo*2,Math.round(s))}var Zo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new pn,this.indexArray=new Sn,this.programConfigurations=new hi(Uo,t.layers,t.zoom),this.segments=new Zn};function Xo(t,e){return t.x===e.x&&(t.x<0||t.x>fi)||t.y===e.y&&(t.y<0||t.y>fi)}function Wo(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>fi})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>fi})}Zo.prototype.populate=function(t,e){this.features=[],this.hasPattern=Ro("fill-extrusion",this.layers,e);for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Ur(this.zoom),o)){var l=_i(o),u={sourceLayerIndex:s,index:a,geometry:l,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(u.id=o.id),this.hasPattern?this.features.push(Oo("fill-extrusion",this.layers,u,this.zoom,e)):this.addFeature(u,l,a,{}),e.featureIndex.insert(o,l,a,s,this.index)}}},Zo.prototype.addFeatures=function(t,e){for(var r=0,n=this.features;r<n.length;r+=1){var i=n[r],o=i.geometry;this.addFeature(i,o,i.index,e)}},Zo.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Zo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Uo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.addFeature=function(t,e,r,n){for(var i=0,o=Bo(e,500);i<o.length;i+=1){for(var a=o[i],s=0,l=0,u=a;l<u.length;l+=1)s+=u[l].length;for(var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,p=a;h<p.length;h+=1){var d=p[h];if(0!==d.length&&!Wo(d))for(var f=0,m=0;m<d.length;m++){var _=d[m];if(m>=1){var y=d[m-1];if(!Xo(_,y)){c.vertexLength+4>Zn.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var g=_.sub(y)._perp()._unit(),v=y.dist(_);f+v>32768&&(f=0),Go(this.layoutVertexArray,_.x,_.y,g.x,g.y,0,0,f),Go(this.layoutVertexArray,_.x,_.y,g.x,g.y,0,1,f),f+=v,Go(this.layoutVertexArray,y.x,y.y,g.x,g.y,0,0,f),Go(this.layoutVertexArray,y.x,y.y,g.x,g.y,0,1,f);var b=c.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),c.vertexLength+=4,c.primitiveLength+=2}}}}c.vertexLength+s>Zn.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray));for(var x=[],w=[],k=c.vertexLength,E=0,I=a;E<I.length;E+=1){var S=I[E];if(0!==S.length){S!==a[0]&&w.push(x.length/2);for(var M=0;M<S.length;M++){var T=S[M];Go(this.layoutVertexArray,T.x,T.y,0,0,1,1,0),x.push(T.x),x.push(T.y)}}}for(var A=so(x,w),P=0;P<A.length;P+=3)this.indexArray.emplaceBack(k+A[P],k+A[P+2],k+A[P+1]);c.primitiveLength+=A.length/3,c.vertexLength+=s}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n)},Ir("FillExtrusionBucket",Zo,{omit:["layers","features"]});var Ho={paint:new rn({"fill-extrusion-opacity":new Jr(O["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qr(O["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jr(O["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jr(O["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $r(O["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qr(O["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qr(O["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jr(O["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Yo=function(t){function e(e){t.call(this,e,Ho)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Zo(t)},e.prototype.queryRadius=function(){return Pi(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,o,a){return bi(Ci(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),n)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(nn),Ko=ln([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Jo=Ko.members,Qo=(Ko.size,Ko.alignment,$o);function $o(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(ta,this,e)}function ta(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function ea(t){for(var e,r,n=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],n+=((r=t[a]).x-e.x)*(e.y+r.y);return n}$o.types=["Unknown","Point","LineString","Polygon"],$o.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,i=0,a=0,s=0,l=[];t.pos<r;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)a+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new o(a,s));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&l.push(e),l},$o.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,u]},$o.prototype.toGeoJSON=function(t,e,r){var n,i,o=this.extent*Math.pow(2,r),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=$o.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+s)/o;t[e]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];c(l=h);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var a=ea(t[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}(l),n=0;n<l.length;n++)for(i=0;i<l[n].length;i++)c(l[n][i])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var ra=na;function na(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ia,this,e),this.length=this._features.length}function ia(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}function oa(t,e,r){if(3===t){var n=new ra(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}na.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Qo(this._pbf,e,this.extent,this._keys,this._values)};var aa={VectorTile:function(t,e){this.layers=t.readFields(oa,{},e)},VectorTileFeature:Qo,VectorTileLayer:ra},sa=aa.VectorTileFeature.types,la=63,ua=Math.cos(Math.PI/180*37.5),ca=.5,ha=Math.pow(2,14)/ca;function pa(t,e,r,n,i,o,a){t.emplaceBack(e.x,e.y,n?1:0,i?1:-1,Math.round(la*r.x)+128,Math.round(la*r.y)+128,1+(0===o?0:o<0?-1:1)|(a*ca&63)<<2,a*ca>>6)}var da=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new dn,this.indexArray=new Sn,this.programConfigurations=new hi(Jo,t.layers,t.zoom),this.segments=new Zn};function fa(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(ha-1)}da.prototype.populate=function(t,e){this.features=[],this.hasPattern=Ro("line",this.layers,e);for(var r=0,n=t;r<n.length;r+=1){var i=n[r],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Ur(this.zoom),o)){var l=_i(o),u={sourceLayerIndex:s,index:a,geometry:l,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(u.id=o.id),this.hasPattern?this.features.push(Oo("line",this.layers,u,this.zoom,e)):this.addFeature(u,l,a,{}),e.featureIndex.insert(o,l,a,s,this.index)}}},da.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},da.prototype.addFeatures=function(t,e){for(var r=0,n=this.features;r<n.length;r+=1){var i=n[r],o=i.geometry;this.addFeature(i,o,i.index,e)}},da.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},da.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},da.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},da.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},da.prototype.addFeature=function(t,e,r,n){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(t,{}),a=i.get("line-cap"),s=i.get("line-miter-limit"),l=i.get("line-round-limit"),u=0,c=e;u<c.length;u+=1){var h=c[u];this.addLine(h,t,o,a,s,l,r,n)}},da.prototype.addLine=function(t,e,r,n,i,o,a,s){var l=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(l={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var u="Polygon"===sa[e.type],c=t.length;c>=2&&t[c-1].equals(t[c-2]);)c--;for(var h=0;h<c-1&&t[h].equals(t[h+1]);)h++;if(!(c<(u?3:2))){l&&(l.tileTotal=function(t,e,r){for(var n,i,o=0,a=h;a<r-1;a++)n=t[a],i=t[a+1],o+=n.dist(i);return o}(t,0,c)),"bevel"===r&&(i=1.05);var p=fi/(512*this.overscaling)*15,d=t[h],f=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);this.distance=0;var m,_,y,g=n,v=u?"butt":n,b=!0,x=void 0,w=void 0,k=void 0,E=void 0;this.e1=this.e2=this.e3=-1,u&&(m=t[c-2],E=d.sub(m)._unit()._perp());for(var I=h;I<c;I++)if(!(w=u&&I===c-1?t[h+1]:t[I+1])||!t[I].equals(w)){E&&(k=E),m&&(x=m),m=t[I],E=w?w.sub(m)._unit()._perp():k;var S=(k=k||E).add(E);0===S.x&&0===S.y||S._unit();var M=S.x*E.x+S.y*E.y,T=0!==M?1/M:1/0,A=M<ua&&x&&w;if(A&&I>h){var P=m.dist(x);if(P>2*p){var C=m.sub(m.sub(x)._mult(p/P)._round());this.distance+=C.dist(x),this.addCurrentVertex(C,this.distance,k.mult(1),0,0,!1,f,l),x=C}}var D=x&&w,z=D?r:w?g:v;if(D&&"round"===z&&(T<o?z="miter":T<=2&&(z="fakeround")),"miter"===z&&T>i&&(z="bevel"),"bevel"===z&&(T>2&&(z="flipbevel"),T<i&&(z="miter")),x&&(this.distance+=m.dist(x)),"miter"===z)S._mult(T),this.addCurrentVertex(m,this.distance,S,0,0,!1,f,l);else if("flipbevel"===z){if(T>100)S=E.clone().mult(-1);else{var B=k.x*E.y-k.y*E.x>0?-1:1,L=T*k.add(E).mag()/k.sub(E).mag();S._perp()._mult(L*B)}this.addCurrentVertex(m,this.distance,S,0,0,!1,f,l),this.addCurrentVertex(m,this.distance,S.mult(-1),0,0,!1,f,l)}else if("bevel"===z||"fakeround"===z){var R=k.x*E.y-k.y*E.x>0,O=-Math.sqrt(T*T-1);if(R?(y=0,_=O):(_=0,y=O),b||this.addCurrentVertex(m,this.distance,k,_,y,!1,f,l),"fakeround"===z){for(var F=Math.floor(8*(.5-(M-.5))),N=void 0,V=0;V<F;V++)N=E.mult((V+1)/(F+1))._add(k)._unit(),this.addPieSliceVertex(m,this.distance,N,R,f,l);this.addPieSliceVertex(m,this.distance,S,R,f,l);for(var j=F-1;j>=0;j--)N=k.mult((j+1)/(F+1))._add(E)._unit(),this.addPieSliceVertex(m,this.distance,N,R,f,l)}w&&this.addCurrentVertex(m,this.distance,E,-_,-y,!1,f,l)}else"butt"===z?(b||this.addCurrentVertex(m,this.distance,k,0,0,!1,f,l),w&&this.addCurrentVertex(m,this.distance,E,0,0,!1,f,l)):"square"===z?(b||(this.addCurrentVertex(m,this.distance,k,1,1,!1,f,l),this.e1=this.e2=-1),w&&this.addCurrentVertex(m,this.distance,E,-1,-1,!1,f,l)):"round"===z&&(b||(this.addCurrentVertex(m,this.distance,k,0,0,!1,f,l),this.addCurrentVertex(m,this.distance,k,1,1,!0,f,l),this.e1=this.e2=-1),w&&(this.addCurrentVertex(m,this.distance,E,-1,-1,!0,f,l),this.addCurrentVertex(m,this.distance,E,0,0,!1,f,l)));if(A&&I<c-1){var U=m.dist(w);if(U>2*p){var q=m.add(w.sub(m)._mult(p/U)._round());this.distance+=q.dist(m),this.addCurrentVertex(q,this.distance,E.mult(1),0,0,!1,f,l),m=q}}b=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},da.prototype.addCurrentVertex=function(t,e,r,n,i,o,a,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(e=fa(e,s)),l=r.clone(),n&&l._sub(r.perp()._mult(n)),pa(u,t,l,o,!1,n,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=r.mult(-1),i&&l._sub(r.perp()._mult(i)),pa(u,t,l,o,!0,-i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>ha/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,r,n,i,o,a))},da.prototype.addPieSliceVertex=function(t,e,r,n,i,o){r=r.mult(n?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=fa(e,o)),pa(a,t,r,!1,n,0,e),this.e3=i.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),i.primitiveLength++),n?this.e2=this.e3:this.e1=this.e3},Ir("LineBucket",da,{omit:["layers","features"]});var ma=new rn({"line-cap":new Jr(O.layout_line["line-cap"]),"line-join":new Qr(O.layout_line["line-join"]),"line-miter-limit":new Jr(O.layout_line["line-miter-limit"]),"line-round-limit":new Jr(O.layout_line["line-round-limit"])}),_a={paint:new rn({"line-opacity":new Qr(O.paint_line["line-opacity"]),"line-color":new Qr(O.paint_line["line-color"]),"line-translate":new Jr(O.paint_line["line-translate"]),"line-translate-anchor":new Jr(O.paint_line["line-translate-anchor"]),"line-width":new Qr(O.paint_line["line-width"]),"line-gap-width":new Qr(O.paint_line["line-gap-width"]),"line-offset":new Qr(O.paint_line["line-offset"]),"line-blur":new Qr(O.paint_line["line-blur"]),"line-dasharray":new tn(O.paint_line["line-dasharray"]),"line-pattern":new $r(O.paint_line["line-pattern"]),"line-gradient":new en(O.paint_line["line-gradient"])}),layout:ma},ya=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new Ur(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,n,i){return r=h({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,n,i)},e}(Qr))(_a.paint.properties["line-width"].specification);ya.useIntegerZoom=!0;var ga=function(t){function e(e){t.call(this,e,_a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=eo(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=ya.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new da(t)},e.prototype.queryRadius=function(t){var e=t,r=va(Ai("line-width",this,e),Ai("line-gap-width",this,e)),n=Ai("line-offset",this,e);return r/2+Math.abs(n)+Pi(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,i,a,s){var l=Ci(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*va(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),c=this.paint.get("line-offset").evaluate(e,r);return c&&(n=function(t,e){for(var r=[],n=new o(0,0),i=0;i<t.length;i++){for(var a=t[i],s=[],l=0;l<a.length;l++){var u=a[l-1],c=a[l],h=a[l+1],p=0===l?n:c.sub(u)._unit()._perp(),d=l===a.length-1?n:h.sub(c)._unit()._perp(),f=p._add(d)._unit(),m=f.x*d.x+f.y*d.y;f._mult(1/m),s.push(f._mult(e)._add(c))}r.push(s)}return r}(n,c*s)),xi(l,n,u)},e}(nn);function va(t,e){return e>0?e+2*t:t}var ba=ln([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),xa=ln([{name:"a_projected_pos",components:3,type:"Float32"}],4),wa=(ln([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ln([{name:"a_placed",components:2,type:"Uint8"}],4)),ka=(ln([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),ln([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ea=ln([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function Ia(t,e,r){return t.sections.forEach(function(t){t.text=function(t,e,r){var n=e.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),jr.applyArabicShaping&&(t=jr.applyArabicShaping(t)),t}(t.text,e,r)}),t}ln([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),ln([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"horizontalPlacedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"}]),ln([{type:"Float32",name:"offsetX"}]),ln([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Sa={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Ma=function(t){function e(e,r,n,i){t.call(this,e,r),this.angle=n,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(o);function Ta(t,e){var r=e.expression;if("constant"===r.kind)return{functionType:"constant",layoutSize:r.evaluate(new Ur(t+1))};if("source"===r.kind)return{functionType:"source"};for(var n=r.zoomStops,i=0;i<n.length&&n[i]<=t;)i++;for(var o=i=Math.max(0,i-1);o<n.length&&n[o]<t+1;)o++;o=Math.min(n.length-1,o);var a={min:n[i],max:n[o]};return"composite"===r.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:r.evaluate(new Ur(t+1)),zoomRange:a,sizeRange:{min:r.evaluate(new Ur(a.min)),max:r.evaluate(new Ur(a.max))},propertyValue:e.value}}Ir("Anchor",Ma);var Aa=aa.VectorTileFeature.types,Pa=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ca(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.round(32*n),Math.round(32*i),o,a,s?s[0]:0,s?s[1]:0)}function Da(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}var za=function(t){this.layoutVertexArray=new mn,this.indexArray=new Sn,this.programConfigurations=t,this.segments=new Zn,this.dynamicLayoutVertexArray=new _n,this.opacityVertexArray=new yn,this.placedSymbolArray=new Bn};za.prototype.upload=function(t,e,r,n){r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ba.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,xa.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Pa,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(t)},za.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ir("SymbolBuffers",za);var Ba=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Zn,this.collisionVertexArray=new bn};Ba.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,wa.members,!0)},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ir("CollisionBuffers",Ba);var La=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ta(this.zoom,e["text-size"]),this.iconSizeData=Ta(this.zoom,e["icon-size"]);var r=this.layers[0].layout,n="viewport-y"===r.get("symbol-z-order");this.sortFeaturesByY=n&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),this.sourceID=t.sourceID};La.prototype.createArrays=function(){this.text=new za(new hi(ba.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new za(new hi(ba.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new Ba(vn,ka.members,Mn),this.collisionCircle=new Ba(vn,Ea.members,Sn),this.glyphOffsetArray=new Fn,this.lineVertexArray=new Vn,this.symbolInstances=new Rn},La.prototype.calculateGlyphDependencies=function(t,e,r,n){for(var i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,r&&n){var o=Sa[t.charAt(i)];o&&(e[o.charCodeAt(0)]=!0)}},La.prototype.populate=function(t,e){var r=this.layers[0],n=r.layout,i=n.get("text-font"),o=n.get("text-field"),a=n.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),l="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||l){for(var u=e.iconDependencies,c=e.glyphDependencies,h=new Ur(this.zoom),p=0,d=t;p<d.length;p+=1){var f=d[p],m=f.feature,_=f.index,y=f.sourceLayerIndex;if(r._featureFilter(h,m)){var g=void 0;if(s){var v=r.getValueAndResolveTokens("text-field",m);g=Ia(v instanceof lt?v:lt.fromString(v),r,m)}var b=void 0;if(l&&(b=r.getValueAndResolveTokens("icon-image",m)),g||b){var x={text:g,icon:b,index:_,sourceLayerIndex:y,geometry:_i(m),properties:m.properties,type:Aa[m.type]};if(void 0!==m.id&&(x.id=m.id),this.features.push(x),b&&(u[b]=!0),g)for(var w=i.evaluate(m,{}).join(","),k="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),E=0,I=g.sections;E<I.length;E+=1){var S=I[E],M=Cr(g.toString()),T=S.fontStack||w,A=c[T]=c[T]||{};this.calculateGlyphDependencies(S.text,A,k,M)}}}}"line"===n.get("symbol-placement")&&(this.features=function(t){var e={},r={},n=[],i=0;function o(e){n.push(t[e]),i++}function a(t,e,i){var o=r[t];return delete r[t],r[e]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function s(t,r,i){var o=e[r];return delete e[r],e[t]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function l(t,e,r){var n=r?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}for(var u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.text?c.text.toString():null;if(p){var d=l(p,h),f=l(p,h,!0);if(d in r&&f in e&&r[d]!==e[f]){var m=s(d,f,h),_=a(d,f,n[m].geometry);delete e[d],delete r[f],r[l(p,n[_].geometry,!0)]=_,n[m].geometry=null}else d in r?a(d,f,h):f in e?s(d,f,h):(o(u),e[d]=i-1,r[f]=i-1)}else o(u)}return n.filter(function(t){return t.geometry})}(this.features))}},La.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},La.prototype.isEmpty=function(){return 0===this.symbolInstances.length},La.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},La.prototype.upload=function(t){this.uploaded||(this.collisionBox.upload(t),this.collisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},La.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},La.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:n},a<e.length-1&&(n+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},La.prototype.addSymbols=function(t,e,r,n,i,o,a,s,l,u){for(var c=t.indexArray,h=t.layoutVertexArray,p=t.dynamicLayoutVertexArray,d=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),f=this.glyphOffsetArray.length,m=d.vertexLength,_=0,y=e;_<y.length;_+=1){var g=y[_],v=g.tl,b=g.tr,x=g.bl,w=g.br,k=g.tex,E=d.vertexLength,I=g.glyphOffset[1];Ca(h,s.x,s.y,v.x,I+v.y,k.x,k.y,r),Ca(h,s.x,s.y,b.x,I+b.y,k.x+k.w,k.y,r),Ca(h,s.x,s.y,x.x,I+x.y,k.x,k.y+k.h,r),Ca(h,s.x,s.y,w.x,I+w.y,k.x+k.w,k.y+k.h,r),Da(p,s,0),c.emplaceBack(E,E+1,E+2),c.emplaceBack(E+1,E+2,E+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(g.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,f,this.glyphOffsetArray.length-f,m,l,u,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})},La.prototype._addCollisionDebugVertex=function(t,e,r,n,i,o){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,n,i,Math.round(o.x),Math.round(o.y))},La.prototype.addCollisionDebugVertices=function(t,e,r,n,i,a,s,l){var u=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),c=u.vertexLength,h=i.layoutVertexArray,p=i.collisionVertexArray,d=s.anchorX,f=s.anchorY;if(this._addCollisionDebugVertex(h,p,a,d,f,new o(t,e)),this._addCollisionDebugVertex(h,p,a,d,f,new o(r,e)),this._addCollisionDebugVertex(h,p,a,d,f,new o(r,n)),this._addCollisionDebugVertex(h,p,a,d,f,new o(t,n)),u.vertexLength+=4,l){var m=i.indexArray;m.emplaceBack(c,c+1,c+2),m.emplaceBack(c,c+2,c+3),u.primitiveLength+=2}else{var _=i.indexArray;_.emplaceBack(c,c+1),_.emplaceBack(c+1,c+2),_.emplaceBack(c+2,c+3),_.emplaceBack(c+3,c),u.primitiveLength+=4}},La.prototype.addDebugCollisionBoxes=function(t,e,r){for(var n=t;n<e;n++){var i=this.collisionBoxArray.get(n),o=i.x1,a=i.y1,s=i.x2,l=i.y2,u=i.radius>0;this.addCollisionDebugVertices(o,a,s,l,u?this.collisionCircle:this.collisionBox,i.anchorPoint,r,u)}},La.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e)}},La.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,n,i){for(var o={},a=e;a<r;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=n;l<i;l++){var u=t.get(l);if(0===u.radius){o.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},o.iconFeatureIndex=u.featureIndex;break}}return o},La.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex))}},La.prototype.hasTextData=function(){return this.text.segments.get().length>0},La.prototype.hasIconData=function(){return this.icon.segments.get().length>0},La.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},La.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},La.prototype.addIndicesForPlacedTextSymbol=function(t){for(var e=this.text.placedSymbolArray.get(t),r=e.vertexStartIndex+4*e.numGlyphs,n=e.vertexStartIndex;n<r;n+=4)this.text.indexArray.emplaceBack(n,n+1,n+2),this.text.indexArray.emplaceBack(n+1,n+2,n+3)},La.prototype.sortFeatures=function(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var e=[],r=0;r<this.symbolInstances.length;r++)e.push(r);for(var n=Math.sin(t),i=Math.cos(t),o=[],a=[],s=0;s<this.symbolInstances.length;s++){var l=this.symbolInstances.get(s);o.push(0|Math.round(n*l.anchorX+i*l.anchorY)),a.push(l.featureIndex)}e.sort(function(t,e){return o[t]-o[e]||a[e]-a[t]}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,c=e;u<c.length;u+=1){var h=c[u],p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),p.horizontalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(p.horizontalPlacedTextSymbolIndex),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(p.verticalPlacedTextSymbolIndex);var d=this.icon.placedSymbolArray.get(h);if(d.numGlyphs){var f=d.vertexStartIndex;this.icon.indexArray.emplaceBack(f,f+1,f+2),this.icon.indexArray.emplaceBack(f+1,f+2,f+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ir("SymbolBucket",La,{omit:["layers","collisionBoxArray","features","compareText"]}),La.MAX_GLYPHS=65535,La.addDynamicAttributes=Da;var Ra=new rn({"symbol-placement":new Jr(O.layout_symbol["symbol-placement"]),"symbol-spacing":new Jr(O.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jr(O.layout_symbol["symbol-avoid-edges"]),"symbol-z-order":new Jr(O.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jr(O.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jr(O.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jr(O.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jr(O.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qr(O.layout_symbol["icon-size"]),"icon-text-fit":new Jr(O.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jr(O.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qr(O.layout_symbol["icon-image"]),"icon-rotate":new Qr(O.layout_symbol["icon-rotate"]),"icon-padding":new Jr(O.layout_symbol["icon-padding"]),"icon-keep-upright":new Jr(O.layout_symbol["icon-keep-upright"]),"icon-offset":new Qr(O.layout_symbol["icon-offset"]),"icon-anchor":new Qr(O.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jr(O.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jr(O.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jr(O.layout_symbol["text-rotation-alignment"]),"text-field":new Qr(O.layout_symbol["text-field"]),"text-font":new Qr(O.layout_symbol["text-font"]),"text-size":new Qr(O.layout_symbol["text-size"]),"text-max-width":new Qr(O.layout_symbol["text-max-width"]),"text-line-height":new Jr(O.layout_symbol["text-line-height"]),"text-letter-spacing":new Qr(O.layout_symbol["text-letter-spacing"]),"text-justify":new Qr(O.layout_symbol["text-justify"]),"text-anchor":new Qr(O.layout_symbol["text-anchor"]),"text-max-angle":new Jr(O.layout_symbol["text-max-angle"]),"text-rotate":new Qr(O.layout_symbol["text-rotate"]),"text-padding":new Jr(O.layout_symbol["text-padding"]),"text-keep-upright":new Jr(O.layout_symbol["text-keep-upright"]),"text-transform":new Qr(O.layout_symbol["text-transform"]),"text-offset":new Qr(O.layout_symbol["text-offset"]),"text-allow-overlap":new Jr(O.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jr(O.layout_symbol["text-ignore-placement"]),"text-optional":new Jr(O.layout_symbol["text-optional"])}),Oa={paint:new rn({"icon-opacity":new Qr(O.paint_symbol["icon-opacity"]),"icon-color":new Qr(O.paint_symbol["icon-color"]),"icon-halo-color":new Qr(O.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qr(O.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qr(O.paint_symbol["icon-halo-blur"]),"icon-translate":new Jr(O.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jr(O.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qr(O.paint_symbol["text-opacity"]),"text-color":new Qr(O.paint_symbol["text-color"]),"text-halo-color":new Qr(O.paint_symbol["text-halo-color"]),"text-halo-width":new Qr(O.paint_symbol["text-halo-width"]),"text-halo-blur":new Qr(O.paint_symbol["text-halo-blur"]),"text-translate":new Jr(O.paint_symbol["text-translate"]),"text-translate-anchor":new Jr(O.paint_symbol["text-translate-anchor"])}),layout:Ra},Fa=function(t){function e(e){t.call(this,e,Oa)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var r,n=this.layout.get(t).evaluate(e,{}),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||ze(i.value)?n:(r=e.properties,n.replace(/{([^{}]+)}/g,function(t,e){return e in r?String(r[e]):""}))},e.prototype.createBucket=function(t){return new La(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(nn),Na={paint:new rn({"background-color":new Jr(O.paint_background["background-color"]),"background-pattern":new tn(O.paint_background["background-pattern"]),"background-opacity":new Jr(O.paint_background["background-opacity"])})},Va=function(t){function e(e){t.call(this,e,Na)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(nn),ja={paint:new rn({"raster-opacity":new Jr(O.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jr(O.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jr(O.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jr(O.paint_raster["raster-brightness-max"]),"raster-saturation":new Jr(O.paint_raster["raster-saturation"]),"raster-contrast":new Jr(O.paint_raster["raster-contrast"]),"raster-resampling":new Jr(O.paint_raster["raster-resampling"]),"raster-fade-duration":new Jr(O.paint_raster["raster-fade-duration"])})},Ua=function(t){function e(e){t.call(this,e,ja)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(nn),qa=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender||"3d"===this.implementation.renderingMode},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t)},e}(nn),Ga={circle:Xi,heatmap:ro,hillshade:io,fill:Vo,"fill-extrusion":Yo,line:ga,symbol:Fa,background:Va,raster:Ua};function Za(t){for(var e=0,r=0,n=0,i=t;n<i.length;n+=1){var o=i[n];e+=o.w*o.h,r=Math.max(r,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=0,l=0,u=0,c=t;u<c.length;u+=1)for(var h=c[u],p=a.length-1;p>=0;p--){var d=a[p];if(!(h.w>d.w||h.h>d.h)){if(h.x=d.x,h.y=d.y,l=Math.max(l,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===d.w&&h.h===d.h){var f=a.pop();p<a.length&&(a[p]=f)}else h.h===d.h?(d.x+=h.w,d.w-=h.w):h.w===d.w?(d.y+=h.h,d.h-=h.h):(a.push({x:d.x+h.w,y:d.y,w:d.w-h.w,h:h.h}),d.y+=h.h,d.h-=h.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}var Xa=function(t,e){var r=e.pixelRatio;this.paddedRect=t,this.pixelRatio=r},Wa={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wa.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wa.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wa.tlbr.get=function(){return this.tl.concat(this.br)},Wa.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Xa.prototype,Wa);var Ha=function(t,e){var r={},n={},i=[];for(var o in t){var a=t[o],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};i.push(s),r[o]=new Xa(s,a)}for(var l in e){var u=e[l],c={x:0,y:0,w:u.data.width+2,h:u.data.height+2};i.push(c),n[l]=new Xa(c,u)}var h=Za(i),p=h.w,d=h.h,f=new $i({width:p||1,height:d||1});for(var m in t){var _=t[m],y=r[m].paddedRect;$i.copy(_.data,f,{x:0,y:0},{x:y.x+1,y:y.y+1},_.data)}for(var g in e){var v=e[g],b=n[g].paddedRect,x=b.x+1,w=b.y+1,k=v.data.width,E=v.data.height;$i.copy(v.data,f,{x:0,y:0},{x:x,y:w},v.data),$i.copy(v.data,f,{x:0,y:E-1},{x:x,y:w-1},{width:k,height:1}),$i.copy(v.data,f,{x:0,y:0},{x:x,y:w+E},{width:k,height:1}),$i.copy(v.data,f,{x:k-1,y:0},{x:x-1,y:w},{width:1,height:E}),$i.copy(v.data,f,{x:0,y:0},{x:x+k,y:w},{width:1,height:E})}this.image=f,this.iconPositions=r,this.patternPositions=n};Ir("ImagePosition",Xa),Ir("ImageAtlas",Ha);var Ya=self.HTMLImageElement,Ka=self.HTMLCanvasElement,Ja=self.HTMLVideoElement,Qa=self.ImageData,$a=function(t,e,r,n){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,n)};$a.prototype.update=function(t,e){var r=t.width,n=t.height,i=!this.size||this.size[0]!==r||this.size[1]!==n,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),i?(this.size=[r,n],t instanceof Ya||t instanceof Ka||t instanceof Ja||t instanceof Qa?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,r,n,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof Ya||t instanceof Ka||t instanceof Ja||t instanceof Qa?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,r,n,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},$a.prototype.bind=function(t,e,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)},$a.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},$a.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ts=function(t,e,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,p=r?-1:1,d=t[e+h];for(h+=p,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},es=function(t,e,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&s,d+=f,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+d]=255&a,d+=f,a/=256,u-=8);t[r+d-f]|=128*m},rs=ns;function ns(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function is(t){return t.type===ns.Bytes?t.readVarint()+t.pos:t.pos+1}function os(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function as(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function ss(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function ls(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function us(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function cs(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function hs(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function ps(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function ds(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function fs(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function ms(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function _s(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function ys(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function gs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}ns.Varint=0,ns.Fixed64=1,ns.Bytes=2,ns.Fixed32=5,ns.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_s(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=gs(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_s(this.buf,this.pos)+4294967296*_s(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=_s(this.buf,this.pos)+4294967296*gs(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ts(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ts(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(n=(112&(i=o[r.pos++]))>>4,i<128)return os(t,n,e);if(n|=(127&(i=o[r.pos++]))<<3,i<128)return os(t,n,e);if(n|=(127&(i=o[r.pos++]))<<10,i<128)return os(t,n,e);if(n|=(127&(i=o[r.pos++]))<<17,i<128)return os(t,n,e);if(n|=(127&(i=o[r.pos++]))<<24,i<128)return os(t,n,e);if(n|=(1&(i=o[r.pos++]))<<31,i<128)return os(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){for(var n="",i=e;i<r;){var o,a,s,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=is(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ns.Varint)for(;this.buf[this.pos++]>127;);else if(e===ns.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ns.Fixed32)this.pos+=4;else{if(e!==ns.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ys(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ys(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ys(this.buf,-1&t,this.pos),ys(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ys(this.buf,-1&t,this.pos),ys(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&as(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),es(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),es(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&as(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,ns.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,ss,e)},writePackedSVarint:function(t,e){this.writeMessage(t,ls,e)},writePackedBoolean:function(t,e){this.writeMessage(t,hs,e)},writePackedFloat:function(t,e){this.writeMessage(t,us,e)},writePackedDouble:function(t,e){this.writeMessage(t,cs,e)},writePackedFixed32:function(t,e){this.writeMessage(t,ps,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,ds,e)},writePackedFixed64:function(t,e){this.writeMessage(t,fs,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,ms,e)},writeBytesField:function(t,e){this.writeTag(t,ns.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ns.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ns.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ns.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ns.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ns.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ns.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ns.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ns.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ns.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var vs=3;function bs(t,e,r){1===t&&r.readMessage(xs,e)}function xs(t,e,r){if(3===t){var n=r.readMessage(ws,{}),i=n.id,o=n.bitmap,a=n.width,s=n.height,l=n.left,u=n.top,c=n.advance;e.push({id:i,bitmap:new Qi({width:a+2*vs,height:s+2*vs},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function ws(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}var ks=vs,Es=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.callbackID=0,f(["receive"],this),this.target.addEventListener("message",this.receive,!1)};function Is(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[t*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}Es.prototype.send=function(t,e,r,n){var i=r?this.mapId+":"+this.callbackID++:null;r&&(this.callbacks[i]=r);var o=[];this.target.postMessage({targetMapId:n,sourceMapId:this.mapId,type:t,id:String(i),data:Mr(e,o)},o)},Es.prototype.receive=function(t){var e,r=this,n=t.data,i=n.id;if(!n.targetMapId||this.mapId===n.targetMapId){var o=function(t,e){var n=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(i),error:t?Mr(t):null,data:Mr(e,n)},n)};if("<response>"===n.type)e=this.callbacks[n.id],delete this.callbacks[n.id],e&&n.error?e(Tr(n.error)):e&&e(null,Tr(n.data));else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,Tr(n.data),o);else if(void 0!==n.id&&this.parent.getWorkerSource){var a=n.type.split("."),s=Tr(n.data);this.parent.getWorkerSource(n.sourceMapId,a[0],s.source)[a[1]](s,o)}else this.parent[n.type](Tr(n.data))}},Es.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Ss=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=As(0,t,e,r)};Ss.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ss.prototype.url=function(t,e){var r,n,i,o,a,s=(r=this.x,n=this.y,i=this.z,o=Is(256*r,256*(n=Math.pow(2,i)-n-1),i),a=Is(256*(r+1),256*(n+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,r){for(var n,i="",o=t;o>0;o--)i+=(e&(n=1<<o-1)?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)};var Ms=function(t,e){this.wrap=t,this.canonical=e,this.key=As(t,e.z,e.x,e.y)},Ts=function(t,e,r,n,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Ss(r,+n,+i),this.key=As(e,t,n,i)};function As(t,e,r,n){(t*=2)<0&&(t=-1*t-1);var i=1<<e;return 32*(i*i*t+i*n+r)+e}Ts.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Ts.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Ts(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ts(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Ts.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Ts.prototype.children=function(t){if(this.overscaledZ>=t)return[new Ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Ts(e,this.wrap,e,r,n),new Ts(e,this.wrap,e,r+1,n),new Ts(e,this.wrap,e,r,n+1),new Ts(e,this.wrap,e,r+1,n+1)]},Ts.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Ts.prototype.wrapped=function(){return new Ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ts.prototype.unwrapTo=function(t){return new Ts(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Ts.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ts.prototype.toUnwrapped=function(){return new Ms(this.wrap,this.canonical)},Ts.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ts.prototype.toCoordinate=function(){return new i(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},Ir("CanonicalTileID",Ss),Ir("OverscaledTileID",Ts,{omit:["posMatrix"]});var Ps=function(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return b('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var n=this.dim=e.height;this.border=Math.max(Math.ceil(e.height/2),1),this.stride=this.dim+2*this.border,this.data=new Int32Array(this.stride*this.stride);for(var i=e.data,o="terrarium"===r?this._unpackTerrarium:this._unpackMapbox,a=0;a<n;a++)for(var s=0;s<n;s++){var l=4*(a*n+s);this.set(s,a,o(i[l],i[l+1],i[l+2]))}for(var u=0;u<n;u++)this.set(-1,u,this.get(0,u)),this.set(n,u,this.get(n-1,u)),this.set(u,-1,this.get(u,0)),this.set(u,n,this.get(u,n-1));this.set(-1,-1,this.get(0,0)),this.set(n,-1,this.get(n-1,0)),this.set(-1,n,this.get(0,n-1)),this.set(n,n,this.get(n-1,n-1))};Ps.prototype.set=function(t,e,r){this.data[this._idx(t,e)]=r+65536},Ps.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},Ps.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},Ps.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Ps.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Ps.prototype.getPixels=function(){return new $i({width:this.dim+2*this.border,height:this.dim+2*this.border},new Uint8Array(this.data.buffer))},Ps.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var n=e*this.dim,i=e*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(e){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}for(var s=c(n,-this.border,this.dim+this.border),l=c(i,-this.border,this.dim+this.border),u=c(o,-this.border,this.dim+this.border),h=c(a,-this.border,this.dim+this.border),p=-e*this.dim,d=-r*this.dim,f=u;f<h;f++)for(var m=s;m<l;m++)this.set(m,f,t.get(m+p,f+d))},Ir("DEMData",Ps);var Cs=ln([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ds=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};Ds.prototype.encode=function(t){return this._stringToNumber[t]},Ds.prototype.decode=function(t){return this._numberToString[t]};var zs=function(t,e,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=n,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Bs={geometry:{configurable:!0}};Bs.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Bs.geometry.set=function(t){this._geometry=t},zs.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(zs.prototype,Bs);var Ls=function(){this.state={},this.stateChanges={}};Ls.prototype.updateState=function(t,e,r){var n=String(e);this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},h(this.stateChanges[t][n],r)},Ls.prototype.getState=function(t,e){var r=String(e),n=this.state[t]||{},i=this.stateChanges[t]||{};return h({},n[r],i[r])},Ls.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Ls.prototype.coalesceChanges=function(t,e){var r={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var i={};for(var o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),h(this.state[n][o],this.stateChanges[n][o]),i[o]=this.state[n][o];r[n]=i}if(this.stateChanges={},0!==Object.keys(r).length)for(var a in t)t[a].setFeatureState(r,e)};var Rs=function(t,e,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new br(fi,16,0),this.featureIndexArray=r||new Un};function Os(t,e){return e-t}Rs.prototype.insert=function(t,e,r,n,i){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);for(var a=0;a<e.length;a++){for(var s=e[a],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<fi&&l[1]<fi&&l[2]>=0&&l[3]>=0&&this.grid.insert(o,l[0],l[1],l[2],l[3])}},Rs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new aa.VectorTile(new rs(this.rawTileData)).layers,this.sourceLayerCoder=new Ds(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Rs.prototype.query=function(t,e,r){var n=this;this.loadVTLayers();for(var i=t.params||{},o=fi/t.tileSize/t.scale,a=He(i.filter),s=t.queryGeometry,l=t.queryPadding*o,u=1/0,c=1/0,h=-1/0,p=-1/0,d=0;d<s.length;d++)for(var f=s[d],m=0;m<f.length;m++){var _=f[m];u=Math.min(u,_.x),c=Math.min(c,_.y),h=Math.max(h,_.x),p=Math.max(p,_.y)}var y=this.grid.query(u-l,c-l,h+l,p+l);y.sort(Os);for(var g,v={},b=function(l){var u=y[l];if(u!==g){g=u;var c=n.featureIndexArray.get(u),h=null;n.loadMatchingFeature(v,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,a,i.layers,e,function(e,i){h||(h=_i(e));var a={};return e.id&&(a=r.getState(i.sourceLayer||"_geojsonTileLayer",e.id)),i.queryIntersectsFeature(s,e,a,h,n.z,t.transform,o,t.posMatrix)})}},x=0;x<y.length;x++)b(x);return v},Rs.prototype.loadMatchingFeature=function(t,e,r,n,i,o,a,s){var l=this.bucketLayerIDs[e];if(!o||function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}(o,l)){var u=this.sourceLayerCoder.decode(r),c=this.vtLayers[u].feature(n);if(i(new Ur(this.tileID.overscaledZ),c))for(var h=0;h<l.length;h++){var p=l[h];if(!(o&&o.indexOf(p)<0)){var d=a[p];if(d&&(!s||s(c,d))){var f=new zs(c,this.z,this.x,this.y);f.layer=d.serialize();var m=t[p];void 0===m&&(m=t[p]=[]),m.push({featureIndex:n,feature:f})}}}}},Rs.prototype.lookupSymbolFeatures=function(t,e,r,n,i,o){var a={};this.loadVTLayers();for(var s=He(n),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(a,e,r,c,s,i,o)}return a},Rs.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var n=0,i=r[e];n<i.length;n+=1)if(t===i[n])return!0;return!1},Ir("FeatureIndex",Rs,{omit:["rawTileData","sourceLayerCoder"]});var Fs=function(t,e){this.tileID=t,this.uid=d(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};Fs.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<S.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Fs.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Fs.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var n in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var r={};if(!e)return r;for(var n=0,i=t;n<i.length;n+=1){var o=i[n],a=o.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length){o.layers=a,o.stateDependentLayers=a.filter(function(t){return t.isStateDependent()});for(var s=0,l=a;s<l.length;s+=1)r[l[s].id]=o}}return r}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[n];if(i instanceof La){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(a))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Dn},Fs.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Fs.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},Fs.prototype.getBucket=function(t){return this.buckets[t.id]},Fs.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $a(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $a(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},Fs.prototype.queryRenderedFeatures=function(t,e,r,n,i,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,scale:n,tileSize:this.tileSize,posMatrix:s,transform:o,params:i,queryPadding:this.queryPadding*a},t,e):{}},Fs.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var r=this.latestFeatureIndex.loadVTLayers(),n=e?e.sourceLayer:"",i=r._geojsonTileLayer||r[n];if(i)for(var o=He(e&&e.filter),a=this.tileID.canonical,s=a.z,l=a.x,u=a.y,c={z:s,x:l,y:u},h=0;h<i.length;h++){var p=i.feature(h);if(o(new Ur(this.tileID.overscaledZ),p)){var d=new zs(p,s,l,u);d.tile=c,t.push(d)}}}},Fs.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},Fs.prototype.setMask=function(t,e){if(!s(this.mask,t)&&(this.mask=t,this.clearMask(),!s(t,{0:!0}))){var r=new hn,n=new Sn;this.segments=new Zn,this.segments.prepareSegment(0,r,n);for(var i=Object.keys(t),a=0;a<i.length;a++){var l=t[i[a]],u=fi>>l.z,c=new o(l.x*u,l.y*u),h=new o(c.x+u,c.y+u),p=this.segments.prepareSegment(4,r,n);r.emplaceBack(c.x,c.y,c.x,c.y),r.emplaceBack(h.x,c.y,h.x,c.y),r.emplaceBack(c.x,h.y,c.x,h.y),r.emplaceBack(h.x,h.y,h.x,h.y);var d=p.vertexLength;n.emplaceBack(d,d+1,d+2),n.emplaceBack(d+1,d+2,d+3),p.vertexLength+=4,p.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(r,Cs.members),this.maskedIndexBuffer=e.createIndexBuffer(n)}},Fs.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Fs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Fs.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,r,n,i){var o=n||i;return e[r]=!o||o.toLowerCase(),""}),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var n=Date.now(),i=!1;if(this.expirationTime>n)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=n+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Fs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Fs.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var r=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets){var i=this.buckets[n],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=r[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(n).queryRadius(i))))}}},Fs.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Fs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<S.now()},Fs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Fs.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=S.now()+t};var Ns={horizontal:1,vertical:2,horizontalOnly:3},Vs=function(){this.text="",this.sectionIndex=[],this.sections=[]};Vs.fromFeature=function(t,e){for(var r=new Vs,n=0;n<t.sections.length;n++){var i=t.sections[n];r.sections.push({scale:i.scale||1,fontStack:i.fontStack||e}),r.text+=i.text;for(var o=0;o<i.text.length;o++)r.sectionIndex.push(n)}return r},Vs.prototype.length=function(){return this.text.length},Vs.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Vs.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Vs.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;n&&Br(n)&&!Sa[t[r+1]]||i&&Br(i)&&!Sa[t[r-1]]||!Sa[t[r]]?e+=t[r]:e+=Sa[t[r]]}return e}(this.text)},Vs.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&js[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=t&&js[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},Vs.prototype.substring=function(t,e){var r=new Vs;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},Vs.prototype.toString=function(){return this.text},Vs.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)};var js={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Us={};function qs(t,e,r,n){var i=Math.pow(t-e,2);return n?t<e?i/2:2*i:i+Math.abs(r)*r}function Gs(t,e){var r=0;return 10===t&&(r-=1e4),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Zs(t,e,r,n,i,o){for(var a=null,s=qs(e,r,i,o),l=0,u=n;l<u.length;l+=1){var c=u[l],h=qs(e-c.x,r,i,o)+c.badness;h<=s&&(a=c,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function Xs(t,e,r,n){if(!r)return[];if(!t)return[];for(var i,o=[],a=function(t,e,r,n){for(var i=0,o=0;o<t.length();o++){var a=t.getSection(o),s=n[a.fontStack],l=s&&s[t.getCharCode(o)];l&&(i+=l.metrics.advance*a.scale+e)}return i/Math.max(1,Math.ceil(i/r))}(t,e,r,n),s=0,l=0;l<t.length();l++){var u=t.getSection(l),c=t.getCharCode(l),h=n[u.fontStack],p=h&&h[c];p&&!js[c]&&(s+=p.metrics.advance*u.scale+e),l<t.length()-1&&(Us[c]||!((i=c)<11904)&&(Pr["Bopomofo Extended"](i)||Pr.Bopomofo(i)||Pr["CJK Compatibility Forms"](i)||Pr["CJK Compatibility Ideographs"](i)||Pr["CJK Compatibility"](i)||Pr["CJK Radicals Supplement"](i)||Pr["CJK Strokes"](i)||Pr["CJK Symbols and Punctuation"](i)||Pr["CJK Unified Ideographs Extension A"](i)||Pr["CJK Unified Ideographs"](i)||Pr["Enclosed CJK Letters and Months"](i)||Pr["Halfwidth and Fullwidth Forms"](i)||Pr.Hiragana(i)||Pr["Ideographic Description Characters"](i)||Pr["Kangxi Radicals"](i)||Pr["Katakana Phonetic Extensions"](i)||Pr.Katakana(i)||Pr["Vertical Forms"](i)||Pr["Yi Radicals"](i)||Pr["Yi Syllables"](i)))&&o.push(Zs(l+1,s,a,o,Gs(c,t.getCharCode(l+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Zs(t.length(),s,a,o,0,!0))}function Ws(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Hs(t,e,r,n,i){if(i){var o=t[n],a=e[o.fontStack],s=a&&a[o.glyph];if(s)for(var l=s.metrics.advance*o.scale,u=(t[n].x+l)*i,c=r;c<=n;c++)t[c].x-=u}}Us[10]=!0,Us[32]=!0,Us[38]=!0,Us[40]=!0,Us[41]=!0,Us[43]=!0,Us[45]=!0,Us[47]=!0,Us[173]=!0,Us[183]=!0,Us[8203]=!0,Us[8208]=!0,Us[8211]=!0,Us[8231]=!0,t.createCommonjsModule=e,t.Point=o,t.window=self,t.browser=S,t.uuid=function(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()},t.validateUuid=function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},t.storageAvailable=function(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}},t.warnOnce=b,t.postData=function(t,e,r){var n=P(h(t,{method:"POST"}));return n.onerror=function(){r(new Error(n.statusText))},n.onload=function(){n.status>=200&&n.status<300?r(null,n.response):r(new A(n.statusText,n.status,t.url))},n.send(e),{cancel:function(){return n.abort()}}},t.getJSON=function(t,e){var r=P(t);return r.setRequestHeader("Accept","application/json"),r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||0===r.status)&&r.response){var n;try{n=JSON.parse(r.response)}catch(t){return e(t)}e(null,n)}else 401===r.status&&t.url.match(/mapbox.com/)?e(new A(r.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",r.status,t.url)):e(new A(r.statusText,r.status,t.url))},r.send(),{cancel:function(){return r.abort()}}},t.getImage=function(t,e){return C(t,function(t,r){if(t)e(t);else if(r){var n=new self.Image,i=self.URL||self.webkitURL;n.onload=function(){e(null,n),i.revokeObjectURL(n.src)},n.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new self.Blob([new Uint8Array(r.data)],{type:"image/png"});n.cacheControl=r.cacheControl,n.expires=r.expires,n.src=r.data.byteLength?i.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},t.ResourceType=T,t.RGBAImage=$i,t.potpack=Za,t.ImagePosition=Xa,t.Texture=$a,t.getArrayBuffer=C,t.parseGlyphPBF=function(t){return new rs(t).readFields(bs,[])},t.isChar=Pr,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--n&&r(o,i)})})},t.AlphaImage=Qi,t.styleSpec=O,t.endsWith=m,t.extend=h,t.sphericalToCartesian=function(t){var e=t[0],r=t[1],n=t[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(n),y:e*Math.sin(r)*Math.sin(n),z:e*Math.cos(n)}},t.Evented=R,t.validateStyle=mr,t.validateLight=_r,t.emitValidationErrors=vr,t.Color=ot,t.number=Pt,t.Properties=rn,t.Transitionable=Zr,t.Transitioning=Wr,t.PossiblyEvaluated=Kr,t.DataConstantProperty=Jr,t.uniqueId=d,t.Actor=Es,t.pick=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n];i in t&&(r[i]=t[i])}return r},t.wrap=function(t,e,r){var n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i},t.clamp=c,t.Event=B,t.ErrorEvent=L,t.OverscaledTileID=Ts,t.EXTENT=fi,t.getCoordinatesCenter=function(t){for(var e=1/0,r=1/0,n=-1/0,o=-1/0,a=0;a<t.length;a++)e=Math.min(e,t[a].column),r=Math.min(r,t[a].row),n=Math.max(n,t[a].column),o=Math.max(o,t[a].row);var s=n-e,l=o-r,u=Math.max(s,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new i((e+n)/2,(r+o)/2,0).zoomTo(c)},t.CanonicalTileID=Ss,t.StructArrayLayout4i8=hn,t.rasterBoundsAttributes=Cs,t.SegmentVector=Zn,t.getVideo=function(t,e){var r,n,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");r=t[o],n=void 0,(n=self.document.createElement("a")).href=r,(n.protocol!==self.document.location.protocol||n.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=t[o],i.appendChild(a)}return{cancel:function(){}}},t.ValidationError=F,t.bindAll=f,t.isEqual=s,t.Tile=Fs,t.Coordinate=i,t.keysDifference=function(t,e){var r=[];for(var n in t)n in e||r.push(n);return r},t.SourceFeatureState=Ls,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.create=function(){var t=new zi(16);return zi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],_=e[14],y=e[15],g=r*s-n*a,v=r*l-i*a,b=r*u-o*a,x=n*l-i*s,w=n*u-o*s,k=i*u-o*l,E=c*m-h*f,I=c*_-p*f,S=c*y-d*f,M=h*_-p*m,T=h*y-d*m,A=p*y-d*_,P=g*A-v*T+b*M+x*S-w*I+k*E;return P?(P=1/P,t[0]=(s*A-l*T+u*M)*P,t[1]=(i*T-n*A-o*M)*P,t[2]=(m*k-_*w+y*x)*P,t[3]=(p*w-h*k-d*x)*P,t[4]=(l*S-a*A-u*I)*P,t[5]=(r*A-i*S+o*I)*P,t[6]=(_*b-f*k-y*v)*P,t[7]=(c*k-p*b+d*v)*P,t[8]=(a*T-s*S+u*E)*P,t[9]=(n*S-r*T-o*E)*P,t[10]=(f*w-m*b+y*g)*P,t[11]=(h*b-c*w-d*g)*P,t[12]=(s*I-a*M-l*E)*P,t[13]=(r*M-n*I+i*E)*P,t[14]=(m*v-f*x-_*g)*P,t[15]=(c*x-h*v+p*g)*P,t):null},t.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],m=e[12],_=e[13],y=e[14],g=e[15],v=r[0],b=r[1],x=r[2],w=r[3];return t[0]=v*n+b*s+x*h+w*m,t[1]=v*i+b*l+x*p+w*_,t[2]=v*o+b*u+x*d+w*y,t[3]=v*a+b*c+x*f+w*g,v=r[4],b=r[5],x=r[6],w=r[7],t[4]=v*n+b*s+x*h+w*m,t[5]=v*i+b*l+x*p+w*_,t[6]=v*o+b*u+x*d+w*y,t[7]=v*a+b*c+x*f+w*g,v=r[8],b=r[9],x=r[10],w=r[11],t[8]=v*n+b*s+x*h+w*m,t[9]=v*i+b*l+x*p+w*_,t[10]=v*o+b*u+x*d+w*y,t[11]=v*a+b*c+x*f+w*g,v=r[12],b=r[13],x=r[14],w=r[15],t[12]=v*n+b*s+x*h+w*m,t[13]=v*i+b*l+x*p+w*_,t[14]=v*o+b*u+x*d+w*y,t[15]=v*a+b*c+x*f+w*g,t},t.translate=function(t,e,r){var n=r[0],i=r[1],o=r[2],a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,p=void 0,d=void 0,f=void 0,m=void 0,_=void 0,y=void 0;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*o+e[12],t[13]=e[1]*n+e[5]*i+e[9]*o+e[13],t[14]=e[2]*n+e[6]*i+e[10]*o+e[14],t[15]=e[3]*n+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],l=e[2],u=e[3],c=e[4],h=e[5],p=e[6],d=e[7],f=e[8],m=e[9],_=e[10],y=e[11],t[0]=a,t[1]=s,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=p,t[7]=d,t[8]=f,t[9]=m,t[10]=_,t[11]=y,t[12]=a*n+c*i+f*o+e[12],t[13]=s*n+h*i+m*o+e[13],t[14]=l*n+p*i+_*o+e[14],t[15]=u*n+d*i+y*o+e[15]),t},t.scale=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*n,t[5]=a*i+c*n,t[6]=s*i+h*n,t[7]=l*i+p*n,t[8]=u*i-o*n,t[9]=c*i-a*n,t[10]=h*i-s*n,t[11]=p*i-l*n,t},t.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*n,t[1]=a*i+c*n,t[2]=s*i+h*n,t[3]=l*i+p*n,t[4]=u*i-o*n,t[5]=c*i-a*n,t[6]=h*i-s*n,t[7]=p*i-l*n,t},t.perspective=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=void 0;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t},t.ortho=function(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*u,t[15]=1,t},t.create$1=ji,t.normalize=Ui,t.transformMat4=qi,t.forEach=Gi,t.getSizeData=Ta,t.evaluateSizeForFeature=function(t,e,r){var n=e;return"source"===t.functionType?r.lowerSize/256:"composite"===t.functionType?Pt(r.lowerSize/256,r.upperSize/256,n.uSizeT):n.uSize},t.evaluateSizeForZoom=function(t,e,r){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var n=t.propertyValue,i=t.zoomRange,o=t.sizeRange,a=c(Ne(n,r.specification).interpolationFactor(e,i.min,i.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var s=t.propertyValue,l=t.zoomRange;return{uSizeT:c(Ne(s,r.specification).interpolationFactor(e,l.min,l.max),0,1),uSize:0}},t.SIZE_PACK_FACTOR=256,t.addDynamicAttributes=Da,t.properties=Oa,t.WritingMode=Ns,t.multiPolygonIntersectsBufferedPoint=vi,t.multiPolygonIntersectsMultiPolygon=bi,t.multiPolygonIntersectsBufferedMultiLine=xi,t.polygonIntersectsPolygon=function(t,e){for(var r=0;r<t.length;r++)if(Ti(e,t[r]))return!0;for(var n=0;n<e.length;n++)if(Ti(t,e[n]))return!0;return!!ki(t,e)},t.distToSegmentSquared=Si,t.SymbolInstanceArray=Rn,t.StyleLayer=nn,t.createStyleLayer=function(t){return"custom"===t.type?new qa(t):new Ga[t.type](t)},t.clone=g,t.filterObject=y,t.mapObject=_,t.registerForPluginAvailability=function(t){return Fr?t({pluginURL:Fr,completionCallback:Rr}):Vr.once("pluginAvailable",t),t},t.evented=Vr,t.ZoomHistory=Ar,t.validateCustomStyleLayer=function(t){var e=[],r=t.id;return void 0===r&&e.push({message:"layers."+r+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},t.createLayout=ln,t.ProgramConfiguration=ci,t.Uniform1i=Kn,t.Uniform1f=Jn,t.Uniform2f=Qn,t.Uniform4f=ti,t.Uniform3f=$n,t.UniformMatrix4f=ni,t.create$2=Bi,t.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.create$3=Li,t.length=Ri,t.fromValues=Oi,t.normalize$1=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2];return t[0]=i*l-o*s,t[1]=o*a-n*l,t[2]=n*s-i*a,t},t.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},t.len=Ni,t.forEach$1=Vi,t.UniformColor=ei,t.StructArrayLayout2i4=cn,t.StructArrayLayout2ui4=Mn,t.StructArrayLayout3ui6=Sn,t.StructArrayLayout1ui2=Tn,t.UnwrappedTileID=Ms,t.create$4=function(){var t=new zi(4);return zi!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*s,t[1]=i*l+a*s,t[2]=n*-s+o*l,t[3]=i*-s+a*l,t},t.ease=u,t.bezier=l,t.EvaluationParameters=Ur,t.setRTLTextPlugin=function(t,e){if(Or)throw new Error("setRTLTextPlugin cannot be called multiple times.");Or=!0,Fr=S.resolveURL(t),Rr=function(t){t?(Or=!1,Fr=null,e&&e(t)):Nr=!0},Vr.fire(new B("pluginAvailable",{pluginURL:Fr,completionCallback:Rr}))},t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.featureFilter=He,t.Anchor=Ma,t.GLYPH_PBF_BORDER=ks,t.shapeText=function(t,e,r,n,i,o,a,s,l,u,c){var h=Vs.fromFeature(t,r);c===Ns.vertical&&h.verticalizePunctuation();var p,d=[],f={positionedGlyphs:d,text:h,top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:c},m=jr.processBidirectionalText,_=jr.processStyledBidirectionalText;if(m&&1===h.sections.length){p=[];for(var y=0,g=m(h.toString(),Xs(h,s,n,e));y<g.length;y+=1){var v=g[y],b=new Vs;b.text=v,b.sections=h.sections;for(var x=0;x<v.length;x++)b.sectionIndex.push(0);p.push(b)}}else if(_){p=[];for(var w=0,k=_(h.text,h.sectionIndex,Xs(h,s,n,e));w<k.length;w+=1){var E=k[w],I=new Vs;I.text=E[0],I.sectionIndex=E[1],I.sections=h.sections,p.push(I)}}else p=function(t,e){for(var r=[],n=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];r.push(t.substring(i,s)),i=s}return i<n.length&&r.push(t.substring(i,n.length)),r}(h,Xs(h,s,n,e));return function(t,e,r,n,i,o,a,s,l){for(var u=0,c=-17,h=0,p=t.positionedGlyphs,d="right"===o?1:"left"===o?0:.5,f=0,m=r;f<m.length;f+=1){var _=m[f];_.trim();var y=_.getMaxScale();if(_.length()){for(var g=p.length,v=0;v<_.length();v++){var b=_.getSection(v),x=_.getCharCode(v),w=24*(y-b.scale),k=e[b.fontStack],E=k&&k[x];E&&(zr(x)&&a!==Ns.horizontal?(p.push({glyph:x,x:u,y:w,vertical:!0,scale:b.scale,fontStack:b.fontStack}),u+=l*b.scale+s):(p.push({glyph:x,x:u,y:c+w,vertical:!1,scale:b.scale,fontStack:b.fontStack}),u+=E.metrics.advance*b.scale+s))}if(p.length!==g){var I=u-s;h=Math.max(I,h),Hs(p,e,g,p.length-1,d)}u=0,c+=n*y}else c+=n}var S=Ws(i),M=S.horizontalAlign,T=S.verticalAlign;!function(t,e,r,n,i,o,a){for(var s=(e-r)*i,l=(-n*a+.5)*o,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l}(p,d,M,T,h,n,r.length);var A=c- -17;t.top+=-T*A,t.bottom=t.top+A,t.left+=-M*h,t.right=t.left+h}(f,e,p,i,o,a,c,s,u),!!d.length&&(f.text=f.text.toString(),f)},t.shapeIcon=function(t,e,r){var n=Ws(r),i=n.horizontalAlign,o=n.verticalAlign,a=e[0],s=e[1],l=a-t.displaySize[0]*i,u=l+t.displaySize[0],c=s-t.displaySize[1]*o;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:u}},t.allowsVerticalWritingMode=Cr,t.allowsLetterSpacing=function(t){for(var e=0,r=t;e<r.length;e+=1)if(!Dr(r[e].charCodeAt(0)))return!1;return!0},t.classifyRings=Bo,t.SymbolBucket=La,t.register=Ir,t.FeatureIndex=Rs,t.CollisionBoxArray=Dn,t.DictionaryCoder=Ds,t.LineBucket=da,t.FillBucket=Fo,t.FillExtrusionBucket=Zo,t.ImageAtlas=Ha,t.mvt=aa,t.Protobuf=rs,t.DEMData=Ps,t.vectorTile=aa,t.Point$1=o,t.pbf=rs,t.plugin=jr}),n(0,function(t){function e(t){var r=typeof t;if("number"===r||"boolean"===r||"string"===r||void 0===t||null===t)return JSON.stringify(t);if(Array.isArray(t)){for(var n="[",i=0,o=t;i<o.length;i+=1)n+=e(o[i])+",";return n+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function r(r){for(var n="",i=0,o=t.refProperties;i<o.length;i+=1)n+="/"+e(r[o[i]]);return n}var n=function(t){t&&this.replace(t)};function i(t,e,r,n,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-r/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<r/2;){var c=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var d=c.angleTo(h)-h.angleTo(p);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:d}),u+=d;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=h.dist(p)}return!0}function o(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function a(t,e,r){return t?.6*e*r:0}function s(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function l(e,r,n,l,u,c){for(var h=a(n,u,c),p=s(n,l)*c,d=0,f=o(e)/2,m=0;m<e.length-1;m++){var _=e[m],y=e[m+1],g=_.dist(y);if(d+g>f){var v=(f-d)/g,b=t.number(_.x,y.x,v),x=t.number(_.y,y.y,v),w=new t.Anchor(b,x,y.angleTo(_),m);return w._round(),!h||i(e,w,p,h,r)?w:void 0}d+=g}}function u(e,r,n,l,u,c,h,p,d){var f=a(l,c,h),m=s(l,u),_=m*h,y=0===e[0].x||e[0].x===d||0===e[0].y||e[0].y===d;return r-_<r/4&&(r=_+r/4),function e(r,n,a,s,l,u,c,h,p){for(var d=u/2,f=o(r),m=0,_=n-a,y=[],g=0;g<r.length-1;g++){for(var v=r[g],b=r[g+1],x=v.dist(b),w=b.angleTo(v);_+a<m+x;){var k=((_+=a)-m)/x,E=t.number(v.x,b.x,k),I=t.number(v.y,b.y,k);if(E>=0&&E<p&&I>=0&&I<p&&_-d>=0&&_+d<=f){var S=new t.Anchor(E,I,w,g);S._round(),s&&!i(r,S,u,s,l)||y.push(S)}}m+=x}return h||y.length||c||(y=e(r,m/2,a,s,l,u,c,!0,p)),y}(e,y?r/2*p%r:(m/2+2*c)*h*p%r,r,f,n,_,y,!1,d)}n.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},n.prototype.update=function(e,n){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];i._layerConfigs[s.id]=s;var l=i._layers[s.id]=t.createStyleLayer(s);l._featureFilter=t.featureFilter(l.filter)}for(var u=0,c=n;u<c.length;u+=1){var h=c[u];delete i._layerConfigs[h],delete i._layers[h]}this.familiesBySource={};for(var p=0,d=function(t){for(var e={},n=0;n<t.length;n++){var i=r(t[n]),o=e[i];o||(o=e[i]=[]),o.push(t[n])}var a=[];for(var s in e)a.push(e[s]);return a}(t.values(this._layerConfigs));p<d.length;p+=1){var f=d[p].map(function(t){return i._layers[t.id]}),m=f[0];if("none"!==m.visibility){var _=m.source||"",y=i.familiesBySource[_];y||(y=i.familiesBySource[_]={});var g=m.sourceLayer||"_geojsonTileLayer",v=y[g];v||(v=y[g]=[]),v.push(f)}}};var c=function(e,r,n,i,o,a,s,l,u,c,h,p){var d=s.top*l-u,f=s.bottom*l+u,m=s.left*l-u,_=s.right*l+u;if(this.boxStartIndex=e.length,c){var y=f-d,g=_-m;y>0&&(y=Math.max(10*l,y),this._addLineCollisionCircles(e,r,n,n.segment,g,y,i,o,a,h))}else{if(p){var v=new t.Point(m,d),b=new t.Point(_,d),x=new t.Point(m,f),w=new t.Point(_,f),k=p*Math.PI/180;v._rotate(k),b._rotate(k),x._rotate(k),w._rotate(k),m=Math.min(v.x,b.x,x.x,w.x),_=Math.max(v.x,b.x,x.x,w.x),d=Math.min(v.y,b.y,x.y,w.y),f=Math.max(v.y,b.y,x.y,w.y)}e.emplaceBack(n.x,n.y,m,d,_,f,i,o,a,0,0)}this.boxEndIndex=e.length};c.prototype._addLineCollisionCircles=function(t,e,r,n,i,o,a,s,l,u){var c=o/2,h=Math.floor(i/c)||1,p=1+.4*Math.log(u)/Math.LN2,d=Math.floor(h*p/2),f=-o/2,m=r,_=n+1,y=f,g=-i/2,v=g-i/4;do{if(--_<0){if(y>g)return;_=0;break}y-=e[_].dist(m),m=e[_]}while(y>v);for(var b=e[_].dist(e[_+1]),x=-d;x<h+d;x++){var w=x*c,k=g+w;if(w<0&&(k+=w),w>i&&(k+=w-i),!(k<y)){for(;y+b<k;){if(y+=b,++_+1>=e.length)return;b=e[_].dist(e[_+1])}var E=k-y,I=e[_],S=e[_+1].sub(I)._unit()._mult(E)._add(I)._round(),M=Math.abs(k-f)<c?0:.8*(k-f);t.emplaceBack(S.x,S.y,-o/2,-o/2,o/2,o/2,a,s,l,o/2,M)}}};var h=d,p=d;function d(t,e){if(!(this instanceof d))return new d(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||f,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function f(t,e){return t<e?-1:t>e?1:0}function m(e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,l=e[0],u=0;u<l.length;u++){var c=l[u];(!u||c.x<i)&&(i=c.x),(!u||c.y<o)&&(o=c.y),(!u||c.x>a)&&(a=c.x),(!u||c.y>s)&&(s=c.y)}var p=a-i,d=s-o,f=Math.min(p,d),m=f/2,g=new h(null,_);if(0===f)return new t.Point(i,o);for(var v=i;v<a;v+=f)for(var b=o;b<s;b+=f)g.push(new y(v+m,b+m,m,e));for(var x=function(t){for(var e=0,r=0,n=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=3*c}return new y(r/e,n/e,0,t)}(e),w=g.length;g.length;){var k=g.pop();(k.d>x.d||!x.d)&&(x=k,n&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,w)),k.max-x.d<=r||(m=k.h/2,g.push(new y(k.p.x-m,k.p.y-m,m,e)),g.push(new y(k.p.x+m,k.p.y-m,m,e)),g.push(new y(k.p.x-m,k.p.y+m,m,e)),g.push(new y(k.p.x+m,k.p.y+m,m,e)),w+=4)}return n&&(console.log("num probes: "+w),console.log("best distance: "+x.d)),x.p}function _(t,e){return e.max-t.max}function y(e,r,n,i){this.p=new t.Point(e,r),this.h=n,this.d=function(e,r){for(var n=!1,i=1/0,o=0;o<r.length;o++)for(var a=r[o],s=0,l=a.length,u=l-1;s<l;u=s++){var c=a[s],h=a[u];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(n=!n),i=Math.min(i,t.distToSegmentSquared(e,c,h))}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}d.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var i=t-1>>1,o=e[i];if(r(n,o)>=0)break;e[t]=o,t=i}e[t]=n},_down:function(t){for(var e=this.data,r=this.compare,n=this.length>>1,i=e[t];t<n;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&r(e[a],s)<0&&(o=a,s=e[a]),r(s,i)>=0)break;e[t]=s,t=o}e[t]=i}},h.default=p;var g=t.createCommonjsModule(function(t){t.exports=function(t,e){var r,n,i,o,a,s,l,u;for(r=3&t.length,n=t.length-r,i=e,a=3432918353,s=461845907,u=0;u<n;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}}),v=g,b=g,x=t.createCommonjsModule(function(t){t.exports=function(t,e){for(var r,n=t.length,i=e^n,o=0;n>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}});function w(e,r,n,i,o,a){e.createArrays();var s=512*e.overscaling;e.tilePixelRatio=t.EXTENT/s,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var h=e.textSizeData.zoomRange,p=h.min,d=h.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new t.EvaluationParameters(p)),u["text-size"].possiblyEvaluate(new t.EvaluationParameters(d))]}if("composite"===e.iconSizeData.functionType){var f=e.iconSizeData.zoomRange,m=f.min,_=f.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(m)),u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(_))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new t.EvaluationParameters(18));for(var y=24*l.get("text-line-height"),g="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),v=l.get("text-keep-upright"),b=0,x=e.features;b<x.length;b+=1){var w=x[b],E=l.get("text-font").evaluate(w,{}).join(","),I=n,S={},M=w.text;if(M){var T=M.toString(),A=l.get("text-offset").evaluate(w,{}).map(function(t){return 24*t}),P=24*l.get("text-letter-spacing").evaluate(w,{}),C=t.allowsLetterSpacing(T)?P:0,D=l.get("text-anchor").evaluate(w,{}),z=l.get("text-justify").evaluate(w,{}),B="point"===l.get("symbol-placement")?24*l.get("text-max-width").evaluate(w,{}):0;S.horizontal=t.shapeText(M,r,E,B,y,D,z,C,A,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(T)&&g&&v&&(S.vertical=t.shapeText(M,r,E,B,y,D,z,C,A,24,t.WritingMode.vertical))}var L=void 0;if(w.icon){var R=i[w.icon];R&&(L=t.shapeIcon(o[w.icon],l.get("icon-offset").evaluate(w,{}),l.get("icon-anchor").evaluate(w,{})),void 0===e.sdfIcons?e.sdfIcons=R.sdf:e.sdfIcons!==R.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),R.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(S.horizontal||L)&&k(e,w,S,L,I,c)}a&&e.generateCollisionDebugBuffers()}function k(e,r,n,i,o,a){var s=a.layoutTextSize.evaluate(r,{}),h=a.layoutIconSize.evaluate(r,{}),p=a.textMaxSize.evaluate(r,{});void 0===p&&(p=s);var d=e.layers[0].layout,f=d.get("text-offset").evaluate(r,{}),_=d.get("icon-offset").evaluate(r,{}),y=s/24,g=e.tilePixelRatio*y,b=e.tilePixelRatio*p/24,x=e.tilePixelRatio*h,w=e.tilePixelRatio*d.get("symbol-spacing"),k=d.get("text-padding")*e.tilePixelRatio,M=d.get("icon-padding")*e.tilePixelRatio,T=d.get("text-max-angle")/180*Math.PI,A="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),P="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),C=d.get("symbol-placement"),D=w/2,z=function(s,l){l.x<0||l.x>=t.EXTENT||l.y<0||l.y>=t.EXTENT||function(e,r,n,i,o,a,s,l,u,h,p,d,f,m,_,y,g,b,x,w,k){var S,M,T=e.addToLineVertexArray(r,n),A=0,P=0,C=0,D=v(i.horizontal?i.horizontal.text:""),z=[];if(i.horizontal){var B=a.layout.get("text-rotate").evaluate(x,{});S=new c(s,n,r,l,u,h,i.horizontal,p,d,f,e.overscaling,B),P+=I(e,r,i.horizontal,a,f,x,m,T,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,z,w,k),i.vertical&&(C+=I(e,r,i.vertical,a,f,x,m,T,t.WritingMode.vertical,z,w,k))}var L=S?S.boxStartIndex:e.collisionBoxArray.length,R=S?S.boxEndIndex:e.collisionBoxArray.length;if(o){var O=function(e,r,n,i,o,a){var s,l,u,c,h=r.image,p=n.layout,d=r.top-1/h.pixelRatio,f=r.left-1/h.pixelRatio,m=r.bottom+1/h.pixelRatio,_=r.right+1/h.pixelRatio;if("none"!==p.get("icon-text-fit")&&o){var y=_-f,g=m-d,v=p.get("text-size").evaluate(a,{})/24,b=o.left*v,x=o.right*v,w=o.top*v,k=x-b,E=o.bottom*v-w,I=p.get("icon-text-fit-padding")[0],S=p.get("icon-text-fit-padding")[1],M=p.get("icon-text-fit-padding")[2],T=p.get("icon-text-fit-padding")[3],A="width"===p.get("icon-text-fit")?.5*(E-g):0,P="height"===p.get("icon-text-fit")?.5*(k-y):0,C="width"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?k:y,D="height"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?E:g;s=new t.Point(b+P-T,w+A-I),l=new t.Point(b+P+S+C,w+A-I),u=new t.Point(b+P+S+C,w+A+M+D),c=new t.Point(b+P-T,w+A+M+D)}else s=new t.Point(f,d),l=new t.Point(_,d),u=new t.Point(_,m),c=new t.Point(f,m);var z=n.layout.get("icon-rotate").evaluate(a,{})*Math.PI/180;if(z){var B=Math.sin(z),L=Math.cos(z),R=[L,-B,B,L];s._matMult(R),l._matMult(R),c._matMult(R),u._matMult(R)}return[{tl:s,tr:l,bl:c,br:u,tex:h.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,o,a,0,i.horizontal,x),F=a.layout.get("icon-rotate").evaluate(x,{});M=new c(s,n,r,l,u,h,o,_,y,!1,e.overscaling,F),A=4*O.length;var N=e.iconSizeData,V=null;"source"===N.functionType?(V=[t.SIZE_PACK_FACTOR*a.layout.get("icon-size").evaluate(x,{})])[0]>E&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===N.functionType&&((V=[t.SIZE_PACK_FACTOR*k.compositeIconSizes[0].evaluate(x,{}),t.SIZE_PACK_FACTOR*k.compositeIconSizes[1].evaluate(x,{})])[0]>E||V[1]>E)&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),e.addSymbols(e.icon,O,V,b,g,x,!1,r,T.lineStartIndex,T.lineLength)}var j=M?M.boxStartIndex:e.collisionBoxArray.length,U=M?M.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=t.SymbolBucket.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),e.symbolInstances.emplaceBack(r.x,r.y,z.length>0?z[0]:-1,z.length>1?z[1]:-1,D,L,R,j,U,l,P,C,A,0)}(e,l,s,n,i,e.layers[0],e.collisionBoxArray,r.index,r.sourceLayerIndex,e.index,g,k,A,f,x,M,P,_,r,o,a)};if("line"===C)for(var B=0,L=function(e,r,n,i,o){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var h=l[c],p=l[c+1];h.x<0&&p.x<0||(h.x<0?h=new t.Point(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round():p.x<0&&(p=new t.Point(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round()),h.y<0&&p.y<0||(h.y<0?h=new t.Point(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round():p.y<0&&(p=new t.Point(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round()),h.x>=i&&p.x>=i||(h.x>=i?h=new t.Point(i,h.y+(p.y-h.y)*((i-h.x)/(p.x-h.x)))._round():p.x>=i&&(p=new t.Point(i,h.y+(p.y-h.y)*((i-h.x)/(p.x-h.x)))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new t.Point(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round():p.y>=o&&(p=new t.Point(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(p)))))}return a}(r.geometry,0,0,t.EXTENT,t.EXTENT);B<L.length;B+=1)for(var R=L[B],O=0,F=u(R,w,T,n.vertical||n.horizontal,i,24,b,e.overscaling,t.EXTENT);O<F.length;O+=1){var N=F[O],V=n.horizontal;V&&S(e,V.text,D,N)||z(R,N)}else if("line-center"===C)for(var j=0,U=r.geometry;j<U.length;j+=1){var q=U[j];if(q.length>1){var G=l(q,T,n.vertical||n.horizontal,i,24,b);G&&z(q,G)}}else if("Polygon"===r.type)for(var Z=0,X=t.classifyRings(r.geometry,0);Z<X.length;Z+=1){var W=X[Z],H=m(W,16);z(W[0],new t.Anchor(H.x,H.y,0))}else if("LineString"===r.type)for(var Y=0,K=r.geometry;Y<K.length;Y+=1){var J=K[Y];z(J,new t.Anchor(J[0].x,J[0].y,0))}else if("Point"===r.type)for(var Q=0,$=r.geometry;Q<$.length;Q+=1)for(var tt=0,et=$[Q];tt<et.length;tt+=1){var rt=et[tt];z([rt],new t.Anchor(rt.x,rt.y,0))}}v.murmur3=b,v.murmur2=x;var E=65535;function I(e,r,n,i,o,a,s,l,u,c,h,p){var d=function(e,r,n,i,o,a){for(var s=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,l=n.layout.get("text-offset").evaluate(o,{}).map(function(t){return 24*t}),u=r.positionedGlyphs,c=[],h=0;h<u.length;h++){var p=u[h],d=a[p.fontStack],f=d&&d[p.glyph];if(f){var m=f.rect;if(m){var _=t.GLYPH_PBF_BORDER+1,y=f.metrics.advance*p.scale/2,g=i?[p.x+y,p.y]:[0,0],v=i?[0,0]:[p.x+y+l[0],p.y+l[1]],b=(f.metrics.left-_)*p.scale-y+v[0],x=(-f.metrics.top-_)*p.scale+v[1],w=b+m.w*p.scale,k=x+m.h*p.scale,E=new t.Point(b,x),I=new t.Point(w,x),S=new t.Point(b,k),M=new t.Point(w,k);if(i&&p.vertical){var T=new t.Point(-y,y),A=-Math.PI/2,P=new t.Point(5,0);E._rotateAround(A,T)._add(P),I._rotateAround(A,T)._add(P),S._rotateAround(A,T)._add(P),M._rotateAround(A,T)._add(P)}if(s){var C=Math.sin(s),D=Math.cos(s),z=[D,-C,C,D];E._matMult(z),I._matMult(z),S._matMult(z),M._matMult(z)}c.push({tl:E,tr:I,bl:S,br:M,tex:m,writingMode:r.writingMode,glyphOffset:g})}}}return c}(0,n,i,o,a,h),f=e.textSizeData,m=null;return"source"===f.functionType?(m=[t.SIZE_PACK_FACTOR*i.layout.get("text-size").evaluate(a,{})])[0]>E&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===f.functionType&&((m=[t.SIZE_PACK_FACTOR*p.compositeTextSizes[0].evaluate(a,{}),t.SIZE_PACK_FACTOR*p.compositeTextSizes[1].evaluate(a,{})])[0]>E||m[1]>E)&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),e.addSymbols(e.text,d,m,s,o,a,u,r,l.lineStartIndex,l.lineLength),c.push(e.text.placedSymbolArray.length-1),4*d.length}function S(t,e,r,n){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}else i[e]=[];return i[e].push(n),!1}var M=function(e){var r={},n=[];for(var i in e){var o=e[i],a=r[i]={};for(var s in o){var l=o[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};n.push(u),a[s]={rect:u,metrics:l.metrics}}}}var c=t.potpack(n),h=c.w,p=c.h,d=new t.AlphaImage({width:h||1,height:p||1});for(var f in e){var m=e[f];for(var _ in m){var y=m[+_];if(y&&0!==y.bitmap.width&&0!==y.bitmap.height){var g=r[f][_].rect;t.AlphaImage.copy(y.bitmap,d,{x:0,y:0},{x:g.x+1,y:g.y+1},y.bitmap)}}}this.image=d,this.positions=r};t.register("GlyphAtlas",M);var T=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};function A(e,r){for(var n=new t.EvaluationParameters(r),i=0,o=e;i<o.length;i+=1)o[i].recalculate(n)}T.prototype.parse=function(e,r,n,i){var o=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var a=new t.DictionaryCoder(Object.keys(e.layers).sort()),s=new t.FeatureIndex(this.tileID);s.bucketLayerIDs=[];var l,u,c,h,p={},d={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},f=r.familiesBySource[this.source];for(var m in f){var _=e.layers[m];if(_){1===_.version&&t.warnOnce('Vector tile source "'+o.source+'" layer "'+m+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var y=a.encode(m),g=[],v=0;v<_.length;v++){var b=_.feature(v);g.push({feature:b,index:v,sourceLayerIndex:y})}for(var x=0,k=f[m];x<k.length;x+=1){var E=k[x],I=E[0];I.minzoom&&o.zoom<Math.floor(I.minzoom)||I.maxzoom&&o.zoom>=I.maxzoom||"none"!==I.visibility&&(A(E,o.zoom),(p[I.id]=I.createBucket({index:s.bucketLayerIDs.length,layers:E,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:y,sourceID:o.source})).populate(g,d),s.bucketLayerIDs.push(E.map(function(t){return t.id})))}}}var S=t.mapObject(d.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(S).length?n.send("getGlyphs",{uid:this.uid,stacks:S},function(t,e){l||(l=t,u=e,C.call(o))}):u={};var T=Object.keys(d.iconDependencies);T.length?n.send("getImages",{icons:T},function(t,e){l||(l=t,c=e,C.call(o))}):c={};var P=Object.keys(d.patternDependencies);function C(){if(l)return i(l);if(u&&c&&h){var e=new M(u),r=new t.ImageAtlas(c,h);for(var n in p){var o=p[n];o instanceof t.SymbolBucket?(A(o.layers,this.zoom),w(o,u,e.positions,c,r.iconPositions,this.showCollisionBoxes)):o.hasPattern&&(o instanceof t.LineBucket||o instanceof t.FillBucket||o instanceof t.FillExtrusionBucket)&&(A(o.layers,this.zoom),o.addFeatures(d,r.patternPositions))}this.status="done",i(null,{buckets:t.values(p).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:r})}}P.length?n.send("getImages",{icons:P},function(t,e){l||(l=t,h=e,C.call(o))}):h={},C.call(this)};var P="undefined"!=typeof performance,C={getEntriesByName:function(t){return!!(P&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(P&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,r){return!!(P&&performance&&performance.measure)&&performance.measure(t,e,r)},clearMarks:function(t){return!!(P&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(P&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},D=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},C.mark(this._marks.start)};function z(e,r){var n=t.getArrayBuffer(e.request,function(e,n){e?r(e):n&&r(null,{vectorTile:new t.mvt.VectorTile(new t.Protobuf(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires})});return function(){n.cancel(),r()}}D.prototype.finish=function(){C.mark(this._marks.end);var t=C.getEntriesByName(this._marks.measure);return 0===t.length&&(C.measure(this._marks.measure,this._marks.start,this._marks.end),t=C.getEntriesByName(this._marks.measure),C.clearMarks(this._marks.start),C.clearMarks(this._marks.end),C.clearMeasures(this._marks.measure)),t},C.Performance=D;var B=function(t,e,r){this.actor=t,this.layerIndex=e,this.loadVectorData=r||z,this.loading={},this.loaded={}};B.prototype.loadTile=function(e,r){var n=this,i=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new C.Performance(e.request),a=this.loading[i]=new T(e);a.abort=this.loadVectorData(e,function(e,s){if(delete n.loading[i],e||!s)return a.status="done",n.loaded[i]=a,r(e);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(o){var h=o.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,n.layerIndex,n.actor,function(e,n){if(e||!n)return r(e);r(null,t.extend({rawTileData:l.slice(0)},n,u,c))}),n.loaded=n.loaded||{},n.loaded[i]=a})},B.prototype.reloadTile=function(t,e){var r=this.loaded,n=t.uid,i=this;if(r&&r[n]){var o=r[n];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,r){var n=o.reloadCallback;n&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,i.actor,n)),e(t,r)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.actor,a):a())}},B.prototype.abortTile=function(t,e){var r=this.loading,n=t.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),e()},B.prototype.removeTile=function(t,e){var r=this.loaded,n=t.uid;r&&r[n]&&delete r[n],e()};var L=function(){this.loaded={}};L.prototype.loadTile=function(e,r){var n=e.uid,i=e.encoding,o=e.rawImageData,a=new t.DEMData(n,o,i);this.loaded=this.loaded||{},this.loaded[n]=a,r(null,a)},L.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var R={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function O(t){var e=0;if(t&&t.length>0){e+=Math.abs(F(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(F(t[r]))}return e}function F(t){var e,r,n,i,o,a,s=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(n=l-2,i=l-1,o=0):a===l-1?(n=l-1,i=0,o=1):(n=a,i=a+1,o=a+2),e=t[n],r=t[i],s+=(N(t[o][0])-N(e[0]))*Math.sin(N(r[1]));s=s*R.RADIUS*R.RADIUS/2}return s}function N(t){return t*Math.PI/180}var V={geometry:function t(e){var r,n=0;switch(e.type){case"Polygon":return O(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)n+=O(e.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)n+=t(e.geometries[r]);return n}},ring:F};function j(t,e){return function(r){return t(r,e)}}function U(t,e){e=!!e,t[0]=q(t[0],e);for(var r=1;r<t.length;r++)t[r]=q(t[r],!e);return t}function q(t,e){return function(t){return V.ring(t)>=0}(t)===e?t:t.reverse()}var G=t.mvt.VectorTileFeature.prototype.toGeoJSON,Z=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};Z.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var i=n[r];e.push([new t.Point(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],u=0,c=s[a];u<c.length;u+=1){var h=c[u];l.push(new t.Point(h[0],h[1]))}o.push(l)}return o},Z.prototype.toGeoJSON=function(t,e,r){return G.call(this,t,e,r)};var X=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};X.prototype.feature=function(t){return new Z(this._features[t])};var W=t.vectorTile.VectorTileFeature,H=Y;function Y(t,e){this.options=e||{},this.features=t,this.length=t.length}function K(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Y.prototype.feature=function(t){return new K(this.features[t],this.options.extent)},K.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var n=e[r],i=[],o=0;o<n.length;o++)i.push(new t.Point$1(n[o][0],n[o][1]));this.geometry.push(i)}return this.geometry},K.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]},K.prototype.toGeoJSON=W.prototype.toGeoJSON;var J=tt,Q=tt,$=H;function tt(e){var r=new t.pbf;return function(t,e){for(var r in t.layers)e.writeMessage(3,et,t.layers[r])}(e,r),r.finish()}function et(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,rt,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,st,o[r])}function rt(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,nt,t),e.writeVarintField(3,r.type),e.writeMessage(4,at,r)}function nt(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=o[s];void 0===l&&(n.push(s),l=n.length-1,o[s]=l),e.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=a[h];void 0===p&&(i.push(u),p=i.length-1,a[h]=p),e.writeVarint(p)}}function it(t,e){return(e<<3)+(7&t)}function ot(t){return t<<1^t>>31}function at(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;1===n&&(u=l.length),e.writeVarint(it(1,u));for(var c=3===n?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==n&&e.writeVarint(it(2,c-1));var p=l[h].x-i,d=l[h].y-o;e.writeVarint(ot(p)),e.writeVarint(ot(d)),i+=p,o+=d}3===n&&e.writeVarint(it(7,1))}}function st(t,e){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(7,t):"number"===r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function lt(t,e,r,n){ut(t,r,n),ut(e,2*r,2*n),ut(e,2*r+1,2*n+1)}function ut(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function ct(t,e,r,n){var i=t-r,o=e-n;return i*i+o*o}function ht(t,e,r,n,i){return new pt(t,e,r,n,i)}function pt(t,e,r,n,i){e=e||dt,r=r||ft,i=i||Array,this.nodeSize=n||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=r(t[o]);!function t(e,r,n,i,o,a){if(!(o-i<=n)){var s=Math.floor((i+o)/2);!function t(e,r,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=n-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,r,n,Math.max(i,Math.floor(n-l*c/s+h)),Math.min(o,Math.floor(n+(s-l)*c/s+h)),a)}var p=r[2*n+a],d=i,f=o;for(lt(e,r,i,n),r[2*o+a]>p&&lt(e,r,i,o);d<f;){for(lt(e,r,d,f),d++,f--;r[2*d+a]<p;)d++;for(;r[2*f+a]>p;)f--}r[2*i+a]===p?lt(e,r,i,f):lt(e,r,++f,o),f<=n&&(i=f+1),n<=f&&(o=f-1)}}(e,r,s,i,o,a%2),t(e,r,n,i,s-1,a+1),t(e,r,n,s+1,o,a+1)}}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function dt(t){return t[0]}function ft(t){return t[1]}function mt(t){this.options=xt(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function _t(t,e,r,n,i){return{x:t,y:e,zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function yt(t){return{type:"Feature",id:t.id,properties:gt(t),geometry:{type:"Point",coordinates:[(n=t.x,360*(n-.5)),(e=t.y,r=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var e,r,n}function gt(t){var e=t.numPoints,r=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return xt(xt({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function vt(t){return t/360+.5}function bt(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function xt(t,e){for(var r in e)t[r]=e[r];return t}function wt(t){return t.x}function kt(t){return t.y}function Et(t,e,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return(a=t-r)*a+(s=e-n)*s}function It(t,e,r,n){var i={id:void 0===t?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)St(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<e.length;n++)St(t,e[n]);else if("MultiPolygon"===r)for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)St(t,e[n][i])}(i),i}function St(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Mt(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===o)Tt(i,s);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)Tt(i[u],s);else if("LineString"===o)At(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],At(i[u],s,a,!1),t.push(It(l,"LineString",s,e.properties));return}Pt(i,s,a,!1)}else if("Polygon"===o)Pt(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)Mt(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];Pt(i[u],c,a,!0),s.push(c)}}t.push(It(l,o,s,e.properties))}}function Tt(t,e){e.push(Ct(t[0])),e.push(Dt(t[1])),e.push(0)}function At(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var l=Ct(t[s][0]),u=Dt(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=n?(i*u-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,function t(e,r,n,i){for(var o,a=i,s=n-r>>1,l=n-r,u=e[r],c=e[r+1],h=e[n],p=e[n+1],d=r+3;d<n;d+=3){var f=Et(e[d],e[d+1],u,c,h,p);if(f>a)o=d,a=f;else if(f===a){var m=Math.abs(d-s);m<l&&(o=d,l=m)}}a>i&&(o-r>3&&t(e,r,o,i),e[o+2]=a,n-o>3&&t(e,o,n,i))}(e,0,c,r),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Pt(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];At(t[i],o,r,n),e.push(o)}}function Ct(t){return t/360+.5}function Dt(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function zt(t,e,r,n,i,o,a,s){if(n/=e,o>=(r/=e)&&a<n)return t;if(a<r||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,d=0===i?c.minX:c.minY,f=0===i?c.maxX:c.maxY;if(d>=r&&f<n)l.push(c);else if(!(f<r||d>=n)){var m=[];if("Point"===p||"MultiPoint"===p)Bt(h,m,r,n,i);else if("LineString"===p)Lt(h,m,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===p)Ot(h,m,r,n,i,!1);else if("Polygon"===p)Ot(h,m,r,n,i,!0);else if("MultiPolygon"===p)for(var _=0;_<h.length;_++){var y=[];Ot(h[_],y,r,n,i,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(_=0;_<m.length;_++)l.push(It(c.id,p,m[_],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(It(c.id,p,m,c.tags))}}}return l.length?l:null}function Bt(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=r&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function Lt(t,e,r,n,i,o,a){for(var s,l,u=Rt(t),c=0===i?Nt:Vt,h=t.start,p=0;p<t.length-3;p+=3){var d=t[p],f=t[p+1],m=t[p+2],_=t[p+3],y=t[p+4],g=0===i?d:f,v=0===i?_:y,b=!1;a&&(s=Math.sqrt(Math.pow(d-_,2)+Math.pow(f-y,2))),g<r?v>=r&&(l=c(u,d,f,_,y,r),a&&(u.start=h+s*l)):g>=n?v<n&&(l=c(u,d,f,_,y,n),a&&(u.start=h+s*l)):Ft(u,d,f,m),v<r&&g>=r&&(l=c(u,d,f,_,y,r),b=!0),v>n&&g<=n&&(l=c(u,d,f,_,y,n),b=!0),!o&&b&&(a&&(u.end=h+s*l),e.push(u),u=Rt(t)),a&&(h+=s)}var x=t.length-3;d=t[x],f=t[x+1],m=t[x+2],(g=0===i?d:f)>=r&&g<=n&&Ft(u,d,f,m),x=u.length-3,o&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&Ft(u,u[0],u[1],u[2]),u.length&&e.push(u)}function Rt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Ot(t,e,r,n,i,o){for(var a=0;a<t.length;a++)Lt(t[a],e,r,n,i,o,!1)}function Ft(t,e,r,n){t.push(e),t.push(r),t.push(n)}function Nt(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function Vt(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function jt(t,e){for(var r=[],n=0;n<t.length;n++){var i,o=t[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=Ut(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(Ut(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(Ut(o.geometry[s][u],e));i.push(l)}r.push(It(o.id,a,i,o.tags))}return r}function Ut(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function qt(t,e){if(t.transformed)return t;var r,n,i,o=1<<t.z,a=t.x,s=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(Gt(u[n],u[n+1],e,o,a,s));else for(n=0;n<u.length;n++){var h=[];for(i=0;i<u[n].length;i+=2)h.push(Gt(u[n][i],u[n][i+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function Gt(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function Zt(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Xt(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Xt(t,e,r,n){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Wt(a,i,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Wt(a,i[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Wt(a,u[s],t,r,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function Wt(t,e,r,n,i,o){var a=n*n;if(n>0&&e.size<(i?a:n))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===n||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;i&&function(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}(s,o),t.push(s)}}function Ht(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)Mt(r,t.features[n],e,n);else"Feature"===t.type?Mt(r,t,e):Mt(r,{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var r=e.buffer/e.extent,n=t,i=zt(t,1,-1-r,r,0,-1,2,e),o=zt(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=zt(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=jt(i,1).concat(n)),o&&(n=n.concat(jt(o,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yt(t,e,r){return 32*((1<<t)*r+e)+t}function Kt(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return e(null,null);var i=new X(n.features),o=J(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}J.fromVectorTileJs=Q,J.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var n in t)r[n]=new H(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return tt({layers:r})},J.GeoJSONWrapper=$,pt.prototype={range:function(t,e,r,n){return function(t,e,r,n,i,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),d=u.pop();if(p-d<=a)for(var f=d;f<=p;f++)s=e[2*f],l=e[2*f+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(t[f]);else{var m=Math.floor((d+p)/2);s=e[2*m],l=e[2*m+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(t[m]);var _=(h+1)%2;(0===h?r<=s:n<=l)&&(u.push(d),u.push(m-1),u.push(_)),(0===h?i>=s:o>=l)&&(u.push(m+1),u.push(p),u.push(_))}}return c}(this.ids,this.coords,t,e,r,n,this.nodeSize)},within:function(t,e,r){return function(t,e,r,n,i,o){for(var a=[0,t.length-1,0],s=[],l=i*i;a.length;){var u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var p=h;p<=c;p++)ct(e[2*p],e[2*p+1],r,n)<=l&&s.push(t[p]);else{var d=Math.floor((h+c)/2),f=e[2*d],m=e[2*d+1];ct(f,m,r,n)<=l&&s.push(t[d]);var _=(u+1)%2;(0===u?r-i<=f:n-i<=m)&&(a.push(h),a.push(d-1),a.push(_)),(0===u?r+i>=f:n+i>=m)&&(a.push(d+1),a.push(c),a.push(_))}}return s}(this.ids,this.coords,t,e,r,this.nodeSize)}},mt.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var r="prepare "+t.length+" points";e&&console.time(r),this.points=t;for(var n,i,o=[],a=0;a<t.length;a++)t[a].geometry&&o.push((n=a,{x:vt((i=t[a].geometry.coordinates)[0]),y:bt(i[1]),zoom:1/0,index:n,parentId:-1}));this.trees[this.options.maxZoom+1]=ht(o,wt,kt,this.options.nodeSize,Float32Array),e&&console.timeEnd(r);for(var s=this.options.maxZoom;s>=this.options.minZoom;s--){var l=+Date.now();o=this._cluster(o,s),this.trees[s]=ht(o,wt,kt,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",s,o.length,+Date.now()-l)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var r=((t[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,i=180;else if(r>i){var a=this.getClusters([r,n,180,o],e),s=this.getClusters([-180,n,i,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],u=l.range(vt(r),bt(o),vt(i),bt(n)),c=[],h=0;h<u.length;h++){var p=l.points[u[h]];c.push(p.numPoints?yt(p):this.points[p.index])}return c},getChildren:function(t){var e=t>>5,r=t%32,n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);var o=i.points[e];if(!o)throw new Error(n);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(o.x,o.y,a),l=[],u=0;u<s.length;u++){var c=i.points[s[u]];c.parentId===t&&l.push(c.numPoints?yt(c):this.points[c.index])}if(0===l.length)throw new Error(n);return l},getLeaves:function(t,e,r){e=e||10,r=r||0;var n=[];return this._appendLeaves(n,t,e,r,0),n},getTile:function(t,e,r){var n=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(r-a)/i,l=(r+1+a)/i,u={features:[]};return this._addTileFeatures(n.range((e-a)/i,s,(e+1+a)/i,l),n.points,e,r,i,u),0===e&&this._addTileFeatures(n.range(1-a/i,s,1,l),n.points,i,r,i,u),e===i-1&&this._addTileFeatures(n.range(0,s,a/i,l),n.points,-1,r,i,u),u.features.length?u:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},_appendLeaves:function(t,e,r,n,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=n?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,r,n,i):i<n?i++:t.push(o[a]),t.length===r)break}return i},_addTileFeatures:function(t,e,r,n,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]],l={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-r)),Math.round(this.options.extent*(s.y*i-n))]],tags:s.numPoints?gt(s):this.points[s.index].properties},u=s.numPoints?s.id:this.points[s.index].id;void 0!==u&&(l.id=u),o.features.push(l)}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var r=[],n=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,n),l=o.numPoints||1,u=o.x*l,c=o.y*l,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var p=(i<<5)+(e+1),d=0;d<s.length;d++){var f=a.points[s[d]];if(!(f.zoom<=e)){f.zoom=e;var m=f.numPoints||1;u+=f.x*m,c+=f.y*m,l+=m,f.parentId=p,this.options.reduce&&this._accumulate(h,f)}}1===l?r.push(o):(o.parentId=p,r.push(_t(u/l,c/l,p,l,h)))}}return r},_accumulate:function(t,e){var r=e.numPoints?e.properties:this.options.map(this.points[e.index].properties);this.options.reduce(t,r)}},Ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ht.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=Yt(e,r,n),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=Zt(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,i){if(e===l.maxZoom||e===i)continue;var f=1<<i-e;if(r!==Math.floor(o/f)||n!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,_,y,g,v,b,x=.5*l.buffer/l.extent,w=.5-x,k=.5+x,E=1+x;m=_=y=g=null,v=zt(t,c,r-x,r+k,0,p.minX,p.maxX,l),b=zt(t,c,r+w,r+E,0,p.minX,p.maxX,l),t=null,v&&(m=zt(v,c,n-x,n+k,1,p.minY,p.maxY,l),_=zt(v,c,n+w,n+E,1,p.minY,p.maxY,l),v=null),b&&(y=zt(b,c,n-x,n+k,1,p.minY,p.maxY,l),g=zt(b,c,n+w,n+E,1,p.minY,p.maxY,l),b=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*n),s.push(_||[],e+1,2*r,2*n+1),s.push(y||[],e+1,2*r+1,2*n),s.push(g||[],e+1,2*r+1,2*n+1)}}},Ht.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t,s=Yt(t,e=(e%a+a)%a,r);if(this.tiles[s])return qt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,u=t,c=e,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[Yt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?qt(this.tiles[s],i):null):null};var Jt=function(e){function r(t,r,n){e.call(this,t,r,Kt),n&&(this.loadGeoJSON=n)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var n=!!(r&&r.request&&r.request.collectResourceTiming)&&new C.Performance(r.request);this.loadGeoJSON(r,function(i,o){if(i||!o)return e(i);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));!function t(e,r){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(j(t,r)),e;case"Feature":return e.geometry=t(e.geometry,r),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=U(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(j(U,e))),t}(e,r);default:return e}}(o,!0);try{t._geoJSONIndex=r.cluster?(a=r.superclusterOptions,new mt(a)).load(o.features):new Ht(o,r.geojsonVtOptions)}catch(i){return e(i)}t.loaded={};var a,s={};if(n){var l=n.finish();l&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(l)))}e(null,s)})}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(t,r){var n=this.loaded,i=t.uid;return n&&n[i]?e.prototype.reloadTile.call(this,t,r):this.loadTile(t,r)},r.prototype.loadGeoJSON=function(e,r){if(e.request)t.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error("Input data is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},r.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},r.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},r.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},r}(B),Qt=function(e){var r=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:B,geojson:Jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Qt.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},Qt.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},Qt.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},Qt.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},Qt.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},Qt.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},Qt.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},Qt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Qt.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var n=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==n.removeSource?n.removeSource(e,r):r()}},Qt.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},Qt.prototype.loadRTLTextPlugin=function(e,r,n){try{t.plugin.isLoaded()||(this.self.importScripts(r),n(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+r)))}catch(t){n(t.toString())}},Qt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new n),e},Qt.prototype.getWorkerSource=function(t,e,r){var n=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][r]){var i={send:function(e,r,i){n.actor.send(e,r,i,t)}};this.workerSources[t][e][r]=new this.workerSourceTypes[e](i,this.getLayerIndex(t))}return this.workerSources[t][e][r]},Qt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new L),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Qt(self),Qt}),n(0,function(t){var e=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{e=new Worker(n),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(n),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===r[t]&&(r[t]=function(t){var r=document.createElement("canvas"),n=Object.create(e.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(t)),r[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r={create:function(e,r,n){var i=t.window.document.createElement(e);return r&&(i.className=r),n&&n.appendChild(i),i},createNS:function(e,r){return t.window.document.createElementNS(e,r)}},n=t.window.document?t.window.document.documentElement.style:null;function i(t){if(!n)return null;for(var e=0;e<t.length;e++)if(t[e]in n)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){n&&a&&(o=n[a],n[a]="none")},r.enableDrag=function(){n&&a&&(n[a]=o)};var s=i(["transform","WebkitTransform"]);r.setTransform=function(t,e){t.style[s]=e};var l=!1;try{var u=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",u,u),t.window.removeEventListener("test",u,u)}catch(t){l=!1}r.addEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&l?t.addEventListener(e,r,n):t.addEventListener(e,r,n.capture)},r.removeEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&l?t.removeEventListener(e,r,n):t.removeEventListener(e,r,n.capture)};var c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};r.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout(function(){t.window.removeEventListener("click",c,!0)},0)},r.mousePos=function(e,r){var n=e.getBoundingClientRect();return r=r.touches?r.touches[0]:r,new t.Point(r.clientX-n.left-e.clientLeft,r.clientY-n.top-e.clientTop)},r.touchPos=function(e,r){for(var n=e.getBoundingClientRect(),i=[],o="touchend"===r.type?r.changedTouches:r.touches,a=0;a<o.length;a++)i.push(new t.Point(o[a].clientX-n.left-e.clientLeft,o[a].clientY-n.top-e.clientTop));return i},r.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},r.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var h={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return 0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":"https://events.mapbox.com/events/v2"},REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},p="See https://www.mapbox.com/api-documentation/#access-tokens";function d(t,e){var r=b(h.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!h.REQUIRE_ACCESS_TOKEN)return x(t);if(!(e=e||h.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+p);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+p);return t.params.push("access_token="+e),x(t)}function f(t){return 0===t.indexOf("mapbox:")}var m=function(t,e){if(!f(t))return t;var r=b(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),d(r,e)},_=function(t,e,r,n){var i=b(t);return f(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+r,d(i,n)):(i.path+=""+e+r,x(i))},y=/(\.(png|jpg)\d*)(?=$)/,g=function(e,r,n){if(!r||!f(r))return e;var i=b(e),o=t.browser.devicePixelRatio>=2||512===n?"@2x":"",a=t.browser.supportsWebp?".webp":"$1";return i.path=i.path.replace(y,""+o+a),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(h.ACCESS_TOKEN||""))}(i.params),x(i)},v=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function b(t){var e=t.match(v);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function x(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var w=function(){this.eventData={anonId:null,lastSuccess:null,accessToken:h.ACCESS_TOKEN},this.queue=[],this.pending=!1,this.pendingRequest=null};w.prototype.postTurnstileEvent=function(e){h.ACCESS_TOKEN&&Array.isArray(e)&&e.some(function(t){return/(mapbox\.c)(n|om)/i.test(t)})&&this.queueRequest(t.browser.now())},w.prototype.queueRequest=function(t){this.queue.push(t),this.processRequests()},w.prototype.processRequests=function(){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var r="mapbox.turnstileEventData:"+(h.ACCESS_TOKEN||""),n=t.storageAvailable("localStorage"),i=!!this.eventData.accessToken&&this.eventData.accessToken!==h.ACCESS_TOKEN;if(i&&(this.eventData.anonId=this.eventData.lastSuccess=null),(!this.eventData.anonId||!this.eventData.lastSuccess)&&n)try{var o=t.window.localStorage.getItem(r);o&&(this.eventData=JSON.parse(o))}catch(e){t.warnOnce("Unable to read from LocalStorage")}t.validateUuid(this.eventData.anonId)||(this.eventData.anonId=t.uuid(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var s=new Date(this.eventData.lastSuccess),l=new Date(a),u=(a-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||s.getDate()!==l.getDate()}if(!i)return this.processRequests();var c=b(h.EVENTS_URL);c.params.push("access_token="+(h.ACCESS_TOKEN||""));var p={url:x(c),headers:{"Content-Type":"text/plain"}},d=JSON.stringify([{event:"appUserTurnstile",created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"0.50.0-beta.1","enabled.telemetry":!1,userId:this.eventData.anonId}]);this.pendingRequest=t.postData(p,d,function(i){if(e.pendingRequest=null,!i){if(e.eventData.lastSuccess=a,e.eventData.accessToken=h.ACCESS_TOKEN,n)try{t.window.localStorage.setItem(r,JSON.stringify(e.eventData))}catch(e){t.warnOnce("Unable to write to LocalStorage")}e.processRequests()}})}};var k=new w,E=k.postTurnstileEvent.bind(k),I=function(){this.images={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0};I.prototype.isLoaded=function(){return this.loaded},I.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,r=this.requestors;e<r.length;e+=1){var n=r[e],i=n.ids,o=n.callback;this._notify(i,o)}this.requestors=[]}},I.prototype.getImage=function(t){return this.images[t]},I.prototype.addImage=function(t,e){this.images[t]=e},I.prototype.removeImage=function(t){delete this.images[t],delete this.patterns[t]},I.prototype.listImages=function(){return Object.keys(this.images)},I.prototype.getImages=function(t,e){var r=!0;if(!this.isLoaded())for(var n=0,i=t;n<i.length;n+=1){var o=i[n];this.images[o]||(r=!1)}this.isLoaded()||r?this._notify(t,e):this.requestors.push({ids:t,callback:e})},I.prototype._notify=function(t,e){for(var r={},n=0,i=t;n<i.length;n+=1){var o=i[n],a=this.images[o];a&&(r[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,r)},I.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},I.prototype.getPattern=function(e){var r=this.patterns[e];if(r)return r.position;var n=this.getImage(e);if(!n)return null;var i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},o=new t.ImagePosition(i,n);return this.patterns[e]={bin:i,position:o},this._updatePatternAtlas(),o},I.prototype.bind=function(e){var r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)},I.prototype._updatePatternAtlas=function(){var e=[];for(var r in this.patterns)e.push(this.patterns[r].bin);var n=t.potpack(e),i=n.w,o=n.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,h=this.images[s].data,p=h.width,d=h.height;t.RGBAImage.copy(h,a,{x:0,y:0},{x:u,y:c},{width:p,height:d}),t.RGBAImage.copy(h,a,{x:0,y:d-1},{x:u,y:c-1},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:u,y:c+d},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:p-1,y:0},{x:u-1,y:c},{width:1,height:d}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:u+p,y:c},{width:1,height:d})}this.dirty=!0};var S=T,M=1e20;function T(t,e,r,n,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function A(t,e,r,n,i,o,a){for(var s=0;s<e;s++){for(var l=0;l<r;l++)n[l]=t[l*e+s];for(P(n,i,o,a,r),l=0;l<r;l++)t[l*e+s]=i[l]}for(l=0;l<r;l++){for(s=0;s<e;s++)n[s]=t[l*e+s];for(P(n,i,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(i[s])}}function P(t,e,r,n,i){r[0]=0,n[0]=-M,n[1]=+M;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=n[a];)a--,s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,n[a]=s,n[a+1]=+M}for(o=0,a=0;o<i;o++){for(;n[a+1]<o;)a++;e[o]=(o-r[a])*(o-r[a])+t[r[a]]}}T.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var i=e.data[4*n+3]/255;this.gridOuter[n]=1===i?0:0===i?M:Math.pow(Math.max(0,.5-i),2),this.gridInner[n]=1===i?M:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(A(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),A(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++){var o=this.gridOuter[n]-this.gridInner[n];r[n]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return r};var C=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};C.prototype.setURL=function(t){this.url=t},C.prototype.getGlyphs=function(e,r){var n=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var l=s[a];i.push({stack:o,id:l})}t.asyncAll(i,function(t,e){var r=t.stack,i=t.id,o=n.entries[r];o||(o=n.entries[r]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a)if(a=n._tinySDF(o,r,i))e(null,{stack:r,id:i,glyph:a});else{var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var l=o.requests[s];l||(l=o.requests[s]=[],C.loadGlyphRange(r,s,n.url,n.requestTransform,function(t,e){if(e)for(var r in e)o.glyphs[+r]=e[+r];for(var n=0,i=l;n<i.length;n+=1)(0,i[n])(t,e);delete o.requests[s]})),l.push(function(t,n){t?e(t):n&&e(null,{stack:r,id:i,glyph:n[i]||null})})}}else e(null,{stack:r,id:i,glyph:a})},function(t,e){if(t)r(t);else if(e){for(var n={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,l=a.id,u=a.glyph;(n[s]||(n[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,n)}})},C.prototype._tinySDF=function(e,r,n){var i=this.localIdeographFontFamily;if(i&&(t.isChar["CJK Unified Ideographs"](n)||t.isChar["Hangul Syllables"](n))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(r)?a="900":/medium/i.test(r)?a="500":/light/i.test(r)&&(a="200"),o=e.tinySDF=new C.TinySDF(24,3,8,.25,i,a)}return{id:n,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},C.loadGlyphRange=function(e,r,n,i,o){var a=256*r,s=a+255,l=i(function(t,e){if(!f(t))return t;var r=b(t);return r.path="/fonts/v1"+r.path,d(r,e)}(n).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,function(e,r){if(e)o(e);else if(r){for(var n={},i=0,a=t.parseGlyphPBF(r.data);i<a.length;i+=1){var s=a[i];n[s.id]=s}o(null,n)}})},C.TinySDF=S;var D=function(){this.specification=t.styleSpec.light.position};D.prototype.possiblyEvaluate=function(e,r){return t.sphericalToCartesian(e.expression.evaluate(r))},D.prototype.interpolate=function(e,r,n){return{x:t.number(e.x,r.x,n),y:t.number(e.y,r.y,n),z:t.number(e.z,r.z,n)}};var z=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new D,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),B=function(e){function r(r){e.call(this),this._transitionable=new t.Transitionable(z),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var r in e){var n=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),n):this._transitionable.setValue(r,n)}},r.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},r.prototype._validate=function(e,r){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},r}(t.Evented),L=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};L.prototype.getDash=function(t,e){var r=t.join(",")+String(e);return this.positions[r]||(this.positions[r]=this.addDash(t,e)),this.positions[r]},L.prototype.addDash=function(e,r){var n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,l=s/2,u=e.length%2==1,c=-n;c<=n;c++)for(var h=this.nextRow+n+c,p=this.width*h,d=u?-e[e.length-1]:0,f=e[0],m=1,_=0;_<this.width;_++){for(;f<_/s;)d=f,f+=e[m],u&&m===e.length-1&&(f+=e[0]),m++;var y=Math.abs(_-d*s),g=Math.abs(_-f*s),v=Math.min(y,g),b=m%2==1,x=void 0;if(r){var w=n?c/n*(l+1):0;if(b){var k=l-Math.abs(w);x=Math.sqrt(v*v+k*k)}else x=l-Math.sqrt(v*v+w*w)}else x=(b?1:-1)*v;this.data[3+4*(p+_)]=Math.max(0,Math.min(255,x+128))}var E={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:o};return this.nextRow+=i,this.dirty=!0,E},L.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var R=function e(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=i[o],s=new e.Actor(a,n,this.id);s.name="Worker "+o,this.actors.push(s)}};function O(e,r,n){var i=function(e,r){if(e)return n(e);if(r){var i=t.pick(r,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);r.vector_layers&&(i.vectorLayers=r.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(t){return t.id})),n(null,i)}};return e.url?t.getJSON(r(m(e.url),t.ResourceType.Source),i):t.browser.frame(function(){return i(null,e)})}R.prototype.broadcast=function(e,r,n){n=n||function(){},t.asyncAll(this.actors,function(t,n){t.send(e,r,n)},n)},R.prototype.send=function(t,e,r,n){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,r),n},R.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=t.Actor;var F=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};F.prototype.wrap=function(){return new F(t.wrap(this.lng,-180,180),this.lat)},F.prototype.toArray=function(){return[this.lng,this.lat]},F.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},F.prototype.toBounds=function(t){var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new N(new F(this.lng-r,this.lat-e),new F(this.lng+r,this.lat+e))},F.convert=function(t){if(t instanceof F)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new F(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new F(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var N=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};N.prototype.setNorthEast=function(t){return this._ne=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.setSouthWest=function(t){return this._sw=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.extend=function(t){var e,r,n=this._sw,i=this._ne;if(t instanceof F)e=t,r=t;else{if(!(t instanceof N))return Array.isArray(t)?t.every(Array.isArray)?this.extend(N.convert(t)):this.extend(F.convert(t)):this;if(e=t._sw,r=t._ne,!e||!r)return this}return n||i?(n.lng=Math.min(e.lng,n.lng),n.lat=Math.min(e.lat,n.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new F(e.lng,e.lat),this._ne=new F(r.lng,r.lat)),this},N.prototype.getCenter=function(){return new F((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},N.prototype.getSouthWest=function(){return this._sw},N.prototype.getNorthEast=function(){return this._ne},N.prototype.getNorthWest=function(){return new F(this.getWest(),this.getNorth())},N.prototype.getSouthEast=function(){return new F(this.getEast(),this.getSouth())},N.prototype.getWest=function(){return this._sw.lng},N.prototype.getSouth=function(){return this._sw.lat},N.prototype.getEast=function(){return this._ne.lng},N.prototype.getNorth=function(){return this._ne.lat},N.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},N.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},N.prototype.isEmpty=function(){return!(this._sw&&this._ne)},N.convert=function(t){return!t||t instanceof N?t:new N(t)};var V=function(t,e,r){this.bounds=N.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=r||24};V.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},V.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),r=Math.floor(this.latY(this.bounds.getNorth(),t.z)),n=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),i=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<n&&t.y>=r&&t.y<i},V.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},V.prototype.latY=function(e,r){var n=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),i=Math.pow(2,r)/(2*Math.PI);return Math.pow(2,r-1)+.5*Math.log((1+n)/(1-n))*-i};var j=function(e){function r(r,n,i,o){if(e.call(this),this.id=r,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(n,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._transformRequest,function(r,n){e._tileJSONRequest=null,r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new V(n.bounds,e.minzoom,e.maxzoom)),E(n.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.loadTile=function(e,r){var n=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(n,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(t,n){return e.aborted?r(null):t&&404!==t.status?r(t):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",i,o.bind(this)):"loading"===e.state?e.reloadCallback=r:this.dispatcher.send("reloadTile",i,o.bind(this),e.workerID)},r.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.hasTransition=function(){return!1},r}(t.Evented),U=function(e){function r(r,n,i,o){e.call(this),this.id=r,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._transformRequest,function(r,n){e._tileJSONRequest=null,r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new V(n.bounds,e.minzoom,e.maxzoom)),E(n.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.loadTile=function(e,r){var n=this,i=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(i,o){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(i)e.state="errored",r(i);else if(o){n.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=n.map.painter.context,s=a.gl;e.texture=n.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",r(null)}})},r.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},r.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},r.prototype.hasTransition=function(){return!1},r}(t.Evented),q=function(e){function r(r,n,i,o){e.call(this,r,n,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},n),this.encoding=n.encoding||"mapbox"}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(e,r){var n=g(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(n,t.ResourceType.Tile),function(n,i){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(n)e.state="errored",r(n);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=t.browser.getImageData(i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,n){t&&(e.state="errored",r(t)),n&&(e.dem=n,e.needsHillshadePrepare=!0,e.state="loaded",r(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},r.prototype._getNeighboringTiles=function(e){var r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,o=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},r}(U),G=function(e){function r(r,n,i,o){e.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=i,this.setEventedParent(o),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution);var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(n.clusterRadius||50)*a,log:!1}},n.workerOptions)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(r){if(r)e.fire(new t.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(n.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",n))}})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setData=function(e){var r=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)r.fire(new t.ErrorEvent(e));else{var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new t.Event("data",n))}}),this},r.prototype.getClusterExpansionZoom=function(t,e){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e,this.workerID),this},r.prototype.getClusterChildren=function(t,e){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e,this.workerID),this},r.prototype.getClusterLeaves=function(t,e,r,n){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:r},n,this.workerID),this},r.prototype._updateWorkerData=function(e){var r=this,n=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(n.request=this.map._transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(i),this.workerID=this.dispatcher.send(this.type+".loadData",n,function(t,i){r._removed||i&&i.abandoned||(r._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[r.id]&&(r._resourceTiming=i.resourceTiming[r.id].slice(0)),r.dispatcher.send(r.type+".coalesce",{source:n.source},null,r.workerID),e(t))},this.workerID)},r.prototype.loadTile=function(e,r){var n=this,i=void 0===e.workerID?"loadTile":"reloadTile",o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(i,o,function(t,o){return e.unloadVectorData(),e.aborted?r(null):t?r(t):(e.loadVectorData(o,n.map.painter,"reloadTile"===i),r(null))},this.workerID)},r.prototype.abortTile=function(t){t.aborted=!0},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},r.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},r.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(t.Evented),Z=function(e){function r(t,r,n,i){e.call(this),this.id=t,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(e,r){var n=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(i,o){i?n.fire(new t.ErrorEvent(i)):o&&(n.image=t.browser.getImageData(o),e&&(n.coordinates=e),r&&r(),n._finishLoading())})},r.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,function(){e.texture=null}),this):this},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setCoordinates=function(e){this.coordinates=e;var r=this.map,n=e.map(function(t){return r.transform.locationCoordinate(F.convert(t)).zoomTo(0)}),i=this.centerCoord=t.getCoordinatesCenter(n);i.column=Math.floor(i.column),i.row=Math.floor(i.row),this.tileID=new t.CanonicalTileID(i.zoom,i.column,i.row),this.minzoom=this.maxzoom=i.zoom;var o=n.map(function(e){var r=e.zoomTo(i.zoom);return new t.Point(Math.round((r.column-i.column)*t.EXTENT),Math.round((r.row-i.row)*t.EXTENT))});return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,r=e.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(t.Evented),X=function(e){function r(t,r,n,i){e.call(this,t,r,n,i),this.roundZoom=!0,this.type="video",this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this,r=this.options;this.urls=[];for(var n=0,i=r.urls;n<i.length;n+=1){var o=i[n];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(e.video=n,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map.triggerRepaint()}),e.map&&e.video.play(),e._finishLoading())})},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,r=e.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(Z),W=function(e){function r(r,n,i,o){e.call(this,r,n,i,o),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing=!1},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(r,this.canvas,n.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var r=e[t];if(isNaN(r)||r<=0)return!0}return!1},r}(Z),H={vector:j,raster:U,"raster-dem":q,geojson:G,video:X,image:Z,canvas:W},Y=function(e,r,n,i){var o=new H[r.type](e,r,n,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function K(t,e,r,n,i){var o=i.maxPitchScaleFactor(),a=t.tilesIn(r,o);a.sort(J);for(var s=[],l=0,u=a;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(e,t._state,c.queryGeometry,c.scale,n,i,o,t.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}var h=function(t){for(var e={},r={},n=0,i=t;n<i.length;n+=1){var o=i[n],a=o.queryResults,s=o.wrappedTileID,l=r[s]=r[s]||{};for(var u in a)for(var c=a[u],h=l[u]=l[u]||{},p=e[u]=e[u]||[],d=0,f=c;d<f.length;d+=1){var m=f[d];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m.feature))}}return e}(s);for(var p in h)h[p].forEach(function(e){var r=t.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=r});return h}function J(t,e){var r=t.tileID,n=e.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var Q=function(t,e){this.max=t,this.onRemove=e,this.reset()};Q.prototype.reset=function(){for(var t in this.data)for(var e=0,r=this.data[t];e<r.length;e+=1){var n=r[e];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},Q.prototype.add=function(t,e,r){var n=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==r&&(o.timeout=setTimeout(function(){n.remove(t,o)},r)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Q.prototype.has=function(t){return t.wrapped().key in this.data},Q.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},Q.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},Q.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},Q.prototype.remove=function(t,e){if(!this.has(t))return this;var r=t.wrapped().key,n=void 0===e?0:this.data[r].indexOf(e),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this},Q.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var $=function(t,e,r){this.context=t;var n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};$.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},$.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},$.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var tt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},et=function(t,e,r,n){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};et.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},et.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},et.prototype.enableAttributes=function(t,e){for(var r=0;r<this.attributes.length;r++){var n=this.attributes[r],i=e.attributes[n.name];void 0!==i&&t.enableVertexAttribArray(i)}},et.prototype.setVertexAttribPointers=function(t,e,r){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[tt[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}},et.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var rt=function(e){this.context=e,this.default=t.Color.transparent,this.current=this.default,this.dirty=!1};rt.prototype.get=function(){return this.current},rt.prototype.setDefault=function(){this.set(this.default)},rt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!0!==this.dirty||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)};var nt=function(t){this.context=t,this.default=1,this.current=this.default,this.dirty=!1};nt.prototype.get=function(){return this.current},nt.prototype.setDefault=function(){this.set(this.default)},nt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.clearDepth(t),this.current=t,this.dirty=!1)};var it=function(t){this.context=t,this.default=0,this.current=this.default,this.dirty=!1};it.prototype.get=function(){return this.current},it.prototype.setDefault=function(){this.set(this.default)},it.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.clearStencil(t),this.current=t,this.dirty=!1)};var ot=function(t){this.context=t,this.default=[!0,!0,!0,!0],this.current=this.default,this.dirty=!1};ot.prototype.get=function(){return this.current},ot.prototype.setDefault=function(){this.set(this.default)},ot.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!0!==this.dirty||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)};var at=function(t){this.context=t,this.default=!0,this.current=this.default,this.dirty=!1};at.prototype.get=function(){return this.current},at.prototype.setDefault=function(){this.set(this.default)},at.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.depthMask(t),this.current=t,this.dirty=!1)};var st=function(t){this.context=t,this.default=255,this.current=this.default,this.dirty=!1};st.prototype.get=function(){return this.current},st.prototype.setDefault=function(){this.set(this.default)},st.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.stencilMask(t),this.current=t,this.dirty=!1)};var lt=function(t){this.context=t,this.default={func:t.gl.ALWAYS,ref:0,mask:255},this.current=this.default,this.dirty=!1};lt.prototype.get=function(){return this.current},lt.prototype.setDefault=function(){this.set(this.default)},lt.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!0!==this.dirty||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)};var ut=function(t){this.context=t;var e=this.context.gl;this.default=[e.KEEP,e.KEEP,e.KEEP],this.current=this.default,this.dirty=!1};ut.prototype.get=function(){return this.current},ut.prototype.setDefault=function(){this.set(this.default)},ut.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!0!==this.dirty||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)};var ct=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};ct.prototype.get=function(){return this.current},ct.prototype.setDefault=function(){this.set(this.default)},ct.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}};var ht=function(t){this.context=t,this.default=[0,1],this.current=this.default,this.dirty=!1};ht.prototype.get=function(){return this.current},ht.prototype.setDefault=function(){this.set(this.default)},ht.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!0!==this.dirty||(this.context.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)};var pt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};pt.prototype.get=function(){return this.current},pt.prototype.setDefault=function(){this.set(this.default)},pt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}};var dt=function(t){this.context=t,this.default=t.gl.LESS,this.current=this.default,this.dirty=!1};dt.prototype.get=function(){return this.current},dt.prototype.setDefault=function(){this.set(this.default)},dt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.depthFunc(t),this.current=t,this.dirty=!1)};var ft=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};ft.prototype.get=function(){return this.current},ft.prototype.setDefault=function(){this.set(this.default)},ft.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}};var mt=function(t){this.context=t;var e=this.context.gl;this.default=[e.ONE,e.ZERO],this.current=this.default,this.dirty=!1};mt.prototype.get=function(){return this.current},mt.prototype.setDefault=function(){this.set(this.default)},mt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!0!==this.dirty||(this.context.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)};var _t=function(e){this.context=e,this.default=t.Color.transparent,this.current=this.default,this.dirty=!1};_t.prototype.get=function(){return this.current},_t.prototype.setDefault=function(){this.set(this.default)},_t.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!0!==this.dirty||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)};var yt=function(t){this.context=t,this.default=this.context.gl.FUNC_ADD,this.current=this.default,this.dirty=!1};yt.prototype.get=function(){return this.current},yt.prototype.setDefault=function(){this.set(this.default)},yt.prototype.set=function(t){t===this.current&&!0!==this.dirty||(this.context.gl.blendEquation(t),this.current=t,this.dirty=!1)};var gt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};gt.prototype.get=function(){return this.current},gt.prototype.setDefault=function(){this.set(this.default)},gt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}};var vt=function(t){this.context=t;var e=this.context.gl;this.default=e.BACK,this.current=this.default,this.dirty=!1};vt.prototype.get=function(){return this.current},vt.prototype.setDefault=function(){this.set(this.default)},vt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.cullFace(t),this.current=t,this.dirty=!1)};var bt=function(t){this.context=t;var e=this.context.gl;this.default=e.CCW,this.current=this.default,this.dirty=!1};bt.prototype.get=function(){return this.current},bt.prototype.setDefault=function(){this.set(this.default)},bt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.frontFace(t),this.current=t,this.dirty=!1)};var xt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};xt.prototype.get=function(){return this.current},xt.prototype.setDefault=function(){this.set(this.default)},xt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.useProgram(t),this.current=t,this.dirty=!1)};var wt=function(t){this.context=t,this.default=t.gl.TEXTURE0,this.current=this.default,this.dirty=!1};wt.prototype.get=function(){return this.current},wt.prototype.setDefault=function(){this.set(this.default)},wt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.activeTexture(t),this.current=t,this.dirty=!1)};var kt=function(t){this.context=t;var e=this.context.gl;this.default=[0,0,e.drawingBufferWidth,e.drawingBufferHeight],this.current=this.default,this.dirty=!1};kt.prototype.get=function(){return this.current},kt.prototype.setDefault=function(){this.set(this.default)},kt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!0!==this.dirty||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)};var Et=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Et.prototype.get=function(){return this.current},Et.prototype.setDefault=function(){this.set(this.default)},Et.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}};var It=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};It.prototype.get=function(){return this.current},It.prototype.setDefault=function(){this.set(this.default)},It.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}};var St=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};St.prototype.get=function(){return this.current},St.prototype.setDefault=function(){this.set(this.default)},St.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}};var Mt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Mt.prototype.get=function(){return this.current},Mt.prototype.setDefault=function(){this.set(this.default)},Mt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}};var Tt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Tt.prototype.get=function(){return this.current},Tt.prototype.setDefault=function(){this.set(this.default)},Tt.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1};var At=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};At.prototype.get=function(){return this.current},At.prototype.setDefault=function(){this.set(this.default)},At.prototype.set=function(t){(this.current!==t&&this.context.extVertexArrayObject||!0===this.dirty)&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t,this.dirty=!1)};var Pt=function(t){this.context=t,this.default=4,this.current=this.default,this.dirty=!1};Pt.prototype.get=function(){return this.current},Pt.prototype.setDefault=function(){this.set(this.default)},Pt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}};var Ct=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};Ct.prototype.get=function(){return this.current},Ct.prototype.setDefault=function(){this.set(this.default)},Ct.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}};var Dt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};Dt.prototype.get=function(){return this.current},Dt.prototype.setDefault=function(){this.set(this.default)},Dt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}};var zt=function(t,e){this.context=t,this.default=null,this.current=this.default,this.dirty=!1,this.parent=e};zt.prototype.get=function(){return this.current};var Bt=function(t){function e(e,r){t.call(this,e,r),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDefault=function(){this.set(this.default)},e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(zt),Lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDefault=function(){this.set(this.default)},e.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(zt),Rt=function(t,e,r){this.context=t,this.width=e,this.height=r;var n=t.gl,i=this.framebuffer=n.createFramebuffer();this.colorAttachment=new Bt(t,i),this.depthAttachment=new Lt(t,i)};Rt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r),t.deleteFramebuffer(this.framebuffer)};var Ot=function(t,e,r){this.func=t,this.mask=e,this.range=r};Ot.ReadOnly=!1,Ot.ReadWrite=!0,Ot.disabled=new Ot(519,Ot.ReadOnly,[0,1]);var Ft=function(t,e,r,n,i,o){this.test=t,this.ref=e,this.mask=r,this.fail=n,this.depthFail=i,this.pass=o};Ft.disabled=new Ft({func:519,mask:0},0,0,7680,7680,7680);var Nt=function(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r};Nt.disabled=new Nt(Nt.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),Nt.unblended=new Nt(Nt.Replace,t.Color.transparent,[!0,!0,!0,!0]),Nt.alphaBlended=new Nt([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Vt=function(t,e,r){this.enable=t,this.mode=e,this.frontFace=r};Vt.disabled=new Vt(!1,1029,2305),Vt.backCCW=new Vt(!0,1029,2305);var jt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new rt(this),this.clearDepth=new nt(this),this.clearStencil=new it(this),this.colorMask=new ot(this),this.depthMask=new at(this),this.stencilMask=new st(this),this.stencilFunc=new lt(this),this.stencilOp=new ut(this),this.stencilTest=new ct(this),this.depthRange=new ht(this),this.depthTest=new pt(this),this.depthFunc=new dt(this),this.blend=new ft(this),this.blendFunc=new mt(this),this.blendColor=new _t(this),this.blendEquation=new yt(this),this.cullFace=new gt(this),this.cullFaceSide=new vt(this),this.frontFace=new bt(this),this.program=new xt(this),this.activeTexture=new wt(this),this.viewport=new kt(this),this.bindFramebuffer=new Et(this),this.bindRenderbuffer=new It(this),this.bindTexture=new St(this),this.bindVertexBuffer=new Mt(this),this.bindElementBuffer=new Tt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new At(this),this.pixelStoreUnpack=new Pt(this),this.pixelStoreUnpackPremultiplyAlpha=new Ct(this),this.pixelStoreUnpackFlipY=new Dt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};jt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},jt.prototype.createIndexBuffer=function(t,e){return new $(this,t,e)},jt.prototype.createVertexBuffer=function(t,e,r){return new et(this,t,e,r)},jt.prototype.createRenderbuffer=function(t,e,r){var n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),i},jt.prototype.createFramebuffer=function(t,e){return new Rt(this,t,e)},jt.prototype.clear=function(t){var e=t.color,r=t.depth,n=this.gl,i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(i|=n.DEPTH_BUFFER_BIT,this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(i)},jt.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},jt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},jt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},jt.prototype.setColorMode=function(e){t.isEqual(e.blendFunction,Nt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},jt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ut=function(e){function r(r,n,i){var o=this;e.call(this),this.id=r,this.dispatcher=i,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=Y(r,n,i,this),this._tiles={},this._cache=new Q(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},r.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},r.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},r.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[e].upload(t)},r.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(Gt)},r.prototype.getRenderableIds=function(e){var r=this,n=[];for(var i in r._tiles)r._isIdRenderable(+i,e)&&n.push(+i);return e?n.sort(function(e,n){var i=r._tiles[e].tileID,o=r._tiles[n].tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(r.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(r.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x}):n.sort(Gt)},r.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},r.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},r.prototype._reloadTile=function(t,e){var r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))},r.prototype._tileLoaded=function(e,r,n,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},r.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),r=0;r<e.length;r++){var n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){var i=this.getTileByID(n);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var r=e.tileID.canonical.x-t.tileID.canonical.x,n=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,n),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},r.prototype.getTile=function(t){return this.getTileByID(t.key)},r.prototype.getTileByID=function(t){return this._tiles[t]},r.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},r.prototype._retainLoadedChildren=function(t,e,r,n){for(var i in this._tiles){var o=this._tiles[i];if(!(n[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>r)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){n[a.key]=a;break}}}},r.prototype.findLoadedParent=function(t,e){for(var r=t.overscaledZ-1;r>=e;r--){var n=t.scaledTo(r);if(!n)return;var i=String(n.key),o=this._tiles[i];if(o&&o.hasData())return o;if(this._cache.has(n))return this._cache.get(n)}},r.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),r=Math.floor(5*e),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)},r.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,r=Math.round(e);if(this._prevLng=t,r){var n={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+r),n[o.tileID.key]=o}for(var a in this._tiles=n,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},r.prototype.update=function(e){var n=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return n._source.hasTile(t)}))):i=[];var o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),a=Math.max(o-r.maxOverzooming,this._source.minzoom),s=Math.max(o+r.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(i,o);if(Zt(this._source.type)){for(var u={},c={},h=0,p=Object.keys(l);h<p.length;h+=1){var d=p[h],f=l[d],m=n._tiles[d];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var _=n.findLoadedParent(f,a);_&&(n._addTile(_.tileID),u[_.tileID.key]=_.tileID),c[d]=f}}for(var y in this._retainLoadedChildren(c,o,s,l),u)l[y]||(n._coveredTiles[y]=!0,l[y]=u[y])}for(var g in l)n._tiles[g].clearFadeHold();for(var v=0,b=t.keysDifference(this._tiles,l);v<b.length;v+=1){var x=b[v],w=n._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(n.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||n._removeTile(x)}}},r.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},r.prototype._updateRetainedTiles=function(t,e){for(var n={},i={},o=Math.max(e-r.maxOverzooming,this._source.minzoom),a=Math.max(e+r.maxUnderzooming,this._source.minzoom),s={},l=0,u=t;l<u.length;l+=1){var c=u[l],h=this._addTile(c);n[c.key]=c,h.hasData()||e<this._source.maxzoom&&(s[c.key]=c)}this._retainLoadedChildren(s,e,a,n);for(var p=0,d=t;p<d.length;p+=1){var f=d[p],m=this._tiles[f.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var _=f.children(this._source.maxzoom)[0],y=this.getTile(_);if(y&&y.hasData()){n[_.key]=_;continue}}else{var g=f.children(this._source.maxzoom);if(n[g[0].key]&&n[g[1].key]&&n[g[2].key]&&n[g[3].key])continue}for(var v=m.wasRequested(),b=f.overscaledZ-1;b>=o;--b){var x=f.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(m=this.getTile(x))&&v&&(m=this._addTile(x)),m&&(n[x.key]=x,v=m.wasRequested(),m.hasData()))break}}}return n},r.prototype._addTile=function(e){var r=this._tiles[e.key];if(r)return r;(r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));var n=Boolean(r);return n||(r=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))),r?(r.uses++,this._tiles[e.key]=r,n||this._source.fire(new t.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(t,e){var r=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(function(){r._reloadTile(t,"expired"),delete r._timers[t]},n))},r.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},r.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},r.prototype.tilesIn=function(e,r){for(var n=[],i=this.getIds(),o=1/0,a=1/0,s=-1/0,l=-1/0,u=e[0].zoom,c=0;c<e.length;c++){var h=e[c];o=Math.min(o,h.column),a=Math.min(a,h.row),s=Math.max(s,h.column),l=Math.max(l,h.row)}for(var p=0;p<i.length;p++){var d=this._tiles[i[p]];if(!d.holdingForFade()){var f=d.tileID,m=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),_=r*d.queryPadding*t.EXTENT/d.tileSize/m,y=[qt(f,new t.Coordinate(o,a,u)),qt(f,new t.Coordinate(s,l,u))];if(y[0].x-_<t.EXTENT&&y[0].y-_<t.EXTENT&&y[1].x+_>=0&&y[1].y+_>=0){for(var g=[],v=0;v<e.length;v++)g.push(qt(f,e[v]));n.push({tile:d,tileID:f,queryGeometry:[g],scale:m})}}}return n},r.prototype.getVisibleCoordinates=function(t){for(var e=this,r=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),n=0,i=r;n<i.length;n+=1){var o=i[n];o.posMatrix=e.transform.calculatePosMatrix(o.toUnwrapped())}return r},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Zt(this._source.type))for(var e in this._tiles){var r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=t.browser.now())return!0}return!1},r.prototype.setFeatureState=function(t,e,r){t=t||"_geojsonTileLayer",this._state.updateState(t,e,r)},r.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},r}(t.Evented);function qt(e,r){var n=r.zoomTo(e.canonical.z);return new t.Point((n.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.EXTENT,(n.row-e.canonical.y)*t.EXTENT)}function Gt(t,e){return t%32-e%32||e-t}function Zt(t){return"raster"===t||"image"===t||"video"===t}function Xt(){return new t.window.Worker(Vn.workerUrl)}Ut.maxOverzooming=10,Ut.maxUnderzooming=3;var Wt,Ht=function(){this.active={}};function Yt(e,r){var n={};for(var i in e)"ref"!==i&&(n[i]=e[i]);return t.refProperties.forEach(function(t){t in r&&(n[t]=r[t])}),n}function Kt(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Yt(t[n],e[t[n].ref]));return t}Ht.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Ht.workerCount;)this.workers.push(new Xt);return this.active[t]=!0,this.workers.slice()},Ht.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},Ht.workerCount=Math.max(Math.floor(t.browser.hardwareConcurrency/2),1);var Jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Qt(t,e,r){r.push({command:Jt.addSource,args:[t,e[t]]})}function $t(t,e,r){e.push({command:Jt.removeSource,args:[t]}),r[t]=!0}function te(t,e,r,n){$t(t,r,n),Qt(t,e,r)}function ee(e,r,n){var i;for(i in e[n])if(e[n].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[n][i],r[n][i]))return!1;for(i in r[n])if(r[n].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[n][i],r[n][i]))return!1;return!0}function re(e,r,n,i,o,a){var s;for(s in e=e||{},r=r||{},e)e.hasOwnProperty(s)&&(t.isEqual(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}));for(s in r)r.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.isEqual(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}))}function ne(t){return t.id}function ie(t,e){return t[e.id]=e,t}var oe=function(t,e,r){var n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};oe.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},oe.prototype.insert=function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},oe.prototype.insertCircle=function(t,e,r,n){this._forEachCell(e-n,r-n,e+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(n)},oe.prototype._insertBoxCell=function(t,e,r,n,i,o){this.boxCells[i].push(o)},oe.prototype._insertCircleCell=function(t,e,r,n,i,o){this.circleCells[i].push(o)},oe.prototype._query=function(t,e,r,n,i,o){if(r<0||t>this.width||n<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return o?a.filter(o):a}var p={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,r,n,this._queryCell,a,p,o),i?a.length>0:a},oe.prototype._queryCircle=function(t,e,r,n,i){var o=t-r,a=t+r,s=e-r,l=e+r;if(a<0||o>this.width||l<0||s>this.height)return!n&&[];var u=[],c={hitTest:n,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,i),n?u.length>0:u},oe.prototype.query=function(t,e,r,n,i){return this._query(t,e,r,n,!1,i)},oe.prototype.hitTest=function(t,e,r,n,i){return this._query(t,e,r,n,!0,i)},oe.prototype.hitTestCircle=function(t,e,r,n){return this._queryCircle(t,e,r,!0,n)},oe.prototype._queryCell=function(t,e,r,n,i,o,a,s){var l=a.seenUids,u=this.boxCells[i];if(null!==u)for(var c=this.bboxes,h=0,p=u;h<p.length;h+=1){var d=p[h];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=c[f+2]&&e<=c[f+3]&&r>=c[f+0]&&n>=c[f+1]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[f],y1:c[f+1],x2:c[f+2],y2:c[f+3]})}}}var m=this.circleCells[i];if(null!==m)for(var _=this.circles,y=0,g=m;y<g.length;y+=1){var v=g[y];if(!l.circle[v]){l.circle[v]=!0;var b=3*v;if(this._circleAndRectCollide(_[b],_[b+1],_[b+2],t,e,r,n)&&(!s||s(this.circleKeys[v]))){if(a.hitTest)return o.push(!0),!0;var x=_[b],w=_[b+1],k=_[b+2];o.push({key:this.circleKeys[v],x1:x-k,y1:w-k,x2:x+k,y2:w+k})}}}},oe.prototype._queryCellCircle=function(t,e,r,n,i,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var h=this.bboxes,p=0,d=c;p<d.length;p+=1){var f=d[p];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var _=this.circleCells[i];if(null!==_)for(var y=this.circles,g=0,v=_;g<v.length;g+=1){var b=v[g];if(!u.circle[b]){u.circle[b]=!0;var x=3*b;if(this._circlesCollide(y[x],y[x+1],y[x+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},oe.prototype._forEachCell=function(t,e,r,n,i,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++){var f=this.xCellCount*d+p;if(i.call(this,t,e,r,n,f,o,a,s))return}},oe.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},oe.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},oe.prototype._circlesCollide=function(t,e,r,n,i,o){var a=n-t,s=i-e,l=r+o;return l*l>a*a+s*s},oe.prototype._circleAndRectCollide=function(t,e,r,n,i,o,a){var s=(o-n)/2,l=Math.abs(t-(n+s));if(l>s+r)return!1;var u=(a-i)/2,c=Math.abs(e-(i+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=r*r};var ae=t.properties.layout;function se(e,r,n,i,o){var a=t.identity(new Float32Array(16));return r?(t.identity(a),t.scale(a,a,[1/o,1/o,1]),n||t.rotateZ(a,a,i.angle)):(t.scale(a,a,[i.width/2,-i.height/2,1]),t.translate(a,a,[1,-1,0]),t.multiply(a,a,e)),a}function le(e,r,n,i,o){var a=t.identity(new Float32Array(16));return r?(t.multiply(a,a,e),t.scale(a,a,[o,o,1]),n||t.rotateZ(a,a,-i.angle)):(t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/i.width,2/i.height,1])),a}function ue(e,r){var n=[e.x,e.y,0,1];ve(n,n,r);var i=n[3];return{point:new t.Point(n[0]/i,n[1]/i),signedDistanceFromCamera:i}}function ce(t,e){var r=t[0]/t[3],n=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&n>=-e[1]&&n<=e[1]}function he(e,r,n,i,o,a,s,l){var u=i?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,n.transform.zoom,ae.properties[i?"text-size":"icon-size"]),h=[256/n.width*2+1,256/n.height*2+1],p=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var d=e.lineVertexArray,f=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=n.transform.width/n.transform.height,_=!1,y=0;y<f.length;y++){var g=f.get(y);if(g.hidden||g.writingMode===t.WritingMode.vertical&&!_)ge(g.numGlyphs,p);else{_=!1;var v=[g.anchorX,g.anchorY,0,1];if(t.transformMat4(v,v,r),ce(v,h)){var b=.5+v[3]/n.transform.cameraToCenterDistance*.5,x=t.evaluateSizeForFeature(u,c,g),w=s?x*b:x/b,k=new t.Point(g.anchorX,g.anchorY),E=ue(k,o).point,I={},S=fe(g,w,!1,l,r,o,a,e.glyphOffsetArray,d,p,E,k,I,m);_=S.useVertical,(S.notEnoughRoom||_||S.needsFlipping&&fe(g,w,!0,l,r,o,a,e.glyphOffsetArray,d,p,E,k,I,m).notEnoughRoom)&&ge(g.numGlyphs,p)}else ge(g.numGlyphs,p)}}i?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function pe(t,e,r,n,i,o,a,s,l,u,c,h){var p=s.glyphStartIndex+s.numGlyphs,d=s.lineStartIndex,f=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),_=e.getoffsetX(p-1),y=_e(t*m,r,n,i,o,a,s.segment,d,f,l,u,c,h);if(!y)return null;var g=_e(t*_,r,n,i,o,a,s.segment,d,f,l,u,c,h);return g?{first:y,last:g}:null}function de(e,r,n,i){return e===t.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function fe(e,r,n,i,o,a,s,l,u,c,h,p,d,f){var m,_=r/24,y=e.lineOffsetX*r,g=e.lineOffsetY*r;if(e.numGlyphs>1){var v=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=pe(_,l,y,g,n,h,p,e,u,a,d,!1);if(!w)return{notEnoughRoom:!0};var k=ue(w.first.point,s).point,E=ue(w.last.point,s).point;if(i&&!n){var I=de(e.writingMode,k,E,f);if(I)return I}m=[w.first];for(var S=e.glyphStartIndex+1;S<v-1;S++)m.push(_e(_*l.getoffsetX(S),y,g,n,h,p,e.segment,b,x,u,a,d,!1));m.push(w.last)}else{if(i&&!n){var M=ue(p,o).point,T=e.lineStartIndex+e.segment+1,A=new t.Point(u.getx(T),u.gety(T)),P=ue(A,o),C=P.signedDistanceFromCamera>0?P.point:me(p,A,M,1,o),D=de(e.writingMode,M,C,f);if(D)return D}var z=_e(_*l.getoffsetX(e.glyphStartIndex),y,g,n,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,d,!1);if(!z)return{notEnoughRoom:!0};m=[z]}for(var B=0,L=m;B<L.length;B+=1){var R=L[B];t.addDynamicAttributes(c,R.point,R.angle)}return{}}function me(t,e,r,n,i){var o=ue(t.add(t.sub(e)._unit()),i).point,a=r.sub(o);return r.add(a._mult(n/a.mag()))}function _e(e,r,n,i,o,a,s,l,u,c,h,p,d){var f=i?e-r:e+r,m=f>0?1:-1,_=0;i&&(m*=-1,_=Math.PI),m<0&&(_+=Math.PI);for(var y=m>0?l+s:l+s+1,g=y,v=o,b=o,x=0,w=0,k=Math.abs(f);x+w<=k;){if((y+=m)<l||y>=u)return null;if(b=v,void 0===(v=p[y])){var E=new t.Point(c.getx(y),c.gety(y)),I=ue(E,h);if(I.signedDistanceFromCamera>0)v=p[y]=I.point;else{var S=y-m;v=me(0===x?a:new t.Point(c.getx(S),c.gety(S)),E,b,k-x+1,h)}}x+=w,w=b.dist(v)}var M=(k-x)/w,T=v.sub(b),A=T.mult(M)._add(b);return A._add(T._unit()._perp()._mult(n*m)),{point:A,angle:_+Math.atan2(v.y-b.y,v.x-b.x),tileDistance:d?{prevTileDistance:y-m===g?0:c.gettileUnitDistanceFromAnchor(y-m),lastSegmentViewportDistance:k-x}:null}}var ye=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ge(t,e){for(var r=0;r<t;r++){var n=e.length;e.resize(n+4),e.float32.set(ye,3*n)}}function ve(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t[3]=r[3]*n+r[7]*i+r[15],t}var be=function(t,e,r){void 0===e&&(e=new oe(t.width+200,t.height+200,25)),void 0===r&&(r=new oe(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function xe(t,e,r){t[e+4]=r?1:0}function we(e,r,n){return r*(t.EXTENT/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}be.prototype.placeCollisionBox=function(t,e,r,n,i){var o=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY),a=r*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!e&&this.grid.hitTest(s,l,u,c,i)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},be.prototype.approximateTileDistance=function(t,e,r,n,i){var o=i?1:n/this.pitchfactor,a=t.lastSegmentViewportDistance*r;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},be.prototype.placeCollisionCircles=function(e,r,n,i,o,a,s,l,u,c,h,p,d){var f=[],m=this.projectAnchor(u,o.anchorX,o.anchorY),_=l/24,y=o.lineOffsetX*l,g=o.lineOffsetY*l,v=new t.Point(o.anchorX,o.anchorY),b=pe(_,s,y,g,!1,ue(v,c).point,v,o,a,c,{},!0),x=!1,w=!1,k=!0,E=m.perspectiveRatio*i,I=1/(i*n),S=0,M=0;b&&(S=this.approximateTileDistance(b.first.tileDistance,b.first.angle,I,m.cameraDistance,p),M=this.approximateTileDistance(b.last.tileDistance,b.last.angle,I,m.cameraDistance,p));for(var T=0;T<e.length;T+=5){var A=e[T],P=e[T+1],C=e[T+2],D=e[T+3];if(!b||D<-S||D>M)xe(e,T,!1);else{var z=this.projectPoint(u,A,P),B=C*E;if(f.length>0){var L=z.x-f[f.length-4],R=z.y-f[f.length-3];if(B*B*2>L*L+R*R&&T+8<e.length){var O=e[T+8];if(O>-S&&O<M){xe(e,T,!1);continue}}}var F=T/5;f.push(z.x,z.y,B,F),xe(e,T,!0);var N=z.x-B,V=z.y-B,j=z.x+B,U=z.y+B;if(k=k&&this.isOffscreen(N,V,j,U),w=w||this.isInsideGrid(N,V,j,U),!r&&this.grid.hitTestCircle(z.x,z.y,B,d)){if(!h)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!w?[]:f,offscreen:k}},be.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,i=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var u=l[s],c=new t.Point(u.x+100,u.y+100);n=Math.min(n,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),r.push(c)}for(var h={},p={},d=0,f=this.grid.query(n,i,o,a).concat(this.ignoredGrid.query(n,i,o,a));d<f.length;d+=1){var m=f[d],_=m.key;if(void 0===h[_.bucketInstanceId]&&(h[_.bucketInstanceId]={}),!h[_.bucketInstanceId][_.featureIndex]){var y=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(r,y)&&(h[_.bucketInstanceId][_.featureIndex]=!0,void 0===p[_.bucketInstanceId]&&(p[_.bucketInstanceId]=[]),p[_.bucketInstanceId].push(_.featureIndex))}}return p},be.prototype.insertCollisionBox=function(t,e,r,n,i){var o={bucketInstanceId:r,featureIndex:n,collisionGroupID:i};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},be.prototype.insertCollisionCircles=function(t,e,r,n,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:n,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},be.prototype.projectAnchor=function(t,e,r){var n=[e,r,0,1];return ve(n,n,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5,cameraDistance:n[3]}},be.prototype.projectPoint=function(e,r,n){var i=[r,n,0,1];return ve(i,i,e),new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},be.prototype.projectAndGetPerspectiveRatio=function(e,r,n){var i=[r,n,0,1];return ve(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},be.prototype.isOffscreen=function(t,e,r,n){return r<100||t>=this.screenRightBoundary||n<100||e>this.screenBottomBoundary},be.prototype.isInsideGrid=function(t,e,r,n){return r>=0&&t<this.gridRightBoundary&&n>=0&&e<this.gridBottomBoundary};var ke=function(t,e,r,n){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):n&&r?1:0,this.placed=r};ke.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Ee=function(t,e,r,n,i){this.text=new ke(t?t.text:null,e,r,i),this.icon=new ke(t?t.icon:null,e,n,i)};Ee.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ie=function(t,e,r){this.text=t,this.icon=e,this.skipFade=r},Se=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};Se.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var Me=function(t,e,r){this.transform=t.clone(),this.collisionIndex=new be(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Se(r)};function Te(t,e,r){t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0)}Me.prototype.placeLayerTile=function(e,r,n,i){var o=r.getBucket(e),a=r.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=r.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),p=se(h,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,we(r,1,this.transform.zoom)),d=se(h,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,we(r,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,r,n,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID),this.placeLayerBucket(o,h,p,d,u,c,n,r.holdingForFade(),i,s)}},Me.prototype.placeLayerBucket=function(e,r,n,i,o,a,s,l,u,c){var h=e.layers[0].layout,p=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,t.properties.layout.properties["text-size"]),d=h.get("text-optional"),f=h.get("icon-optional"),m=h.get("text-allow-overlap"),_=h.get("icon-allow-overlap"),y=m&&(_||!e.hasIconData()||f),g=_&&(m||!e.hasTextData()||d),v=this.collisionGroups.get(e.sourceID);!e.collisionArrays&&c&&e.deserializeCollisionBoxes(c);for(var b=0;b<e.symbolInstances.length;b++){var x=e.symbolInstances.get(b);if(!u[x.crossTileID]){if(l){this.placements[x.crossTileID]=new Ie(!1,!1,!1);continue}var w=!1,k=!1,E=!0,I=null,S=null,M=null,T=0,A=0,P=e.collisionArrays[b];P.textFeatureIndex&&(T=P.textFeatureIndex),P.textBox&&(w=(I=this.collisionIndex.placeCollisionBox(P.textBox,h.get("text-allow-overlap"),a,r,v.predicate)).box.length>0,E=E&&I.offscreen);var C=P.textCircles;if(C){var D=e.text.placedSymbolArray.get(x.horizontalPlacedTextSymbolIndex),z=t.evaluateSizeForFeature(e.textSizeData,p,D);S=this.collisionIndex.placeCollisionCircles(C,h.get("text-allow-overlap"),o,a,D,e.lineVertexArray,e.glyphOffsetArray,z,r,n,s,"map"===h.get("text-pitch-alignment"),v.predicate),w=h.get("text-allow-overlap")||S.circles.length>0,E=E&&S.offscreen}P.iconFeatureIndex&&(A=P.iconFeatureIndex),P.iconBox&&(k=(M=this.collisionIndex.placeCollisionBox(P.iconBox,h.get("icon-allow-overlap"),a,r,v.predicate)).box.length>0,E=E&&M.offscreen);var B=d||0===x.numGlyphVertices&&0===x.numVerticalGlyphVertices,L=f||0===x.numIconVertices;B||L?L?B||(k=k&&w):w=k&&w:k=w=k&&w,w&&I&&this.collisionIndex.insertCollisionBox(I.box,h.get("text-ignore-placement"),e.bucketInstanceId,T,v.ID),k&&M&&this.collisionIndex.insertCollisionBox(M.box,h.get("icon-ignore-placement"),e.bucketInstanceId,A,v.ID),w&&S&&this.collisionIndex.insertCollisionCircles(S.circles,h.get("text-ignore-placement"),e.bucketInstanceId,T,v.ID),this.placements[x.crossTileID]=new Ie(w||y,k||g,E||e.justReloaded),u[x.crossTileID]=!0}}e.justReloaded=!1},Me.prototype.commit=function(t,e){this.commitTime=e;var r=!1,n=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,i=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=i[o];s?(this.opacities[o]=new Ee(s,n,a.text,a.icon),r=r||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new Ee(null,n,a.text,a.icon,a.skipFade),r=r||a.text||a.icon)}for(var l in i){var u=i[l];if(!this.opacities[l]){var c=new Ee(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},Me.prototype.updateLayerOpacities=function(t,e){for(var r={},n=0,i=e;n<i.length;n+=1){var o=i[n],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}},Me.prototype.updateBucketOpacities=function(t,e,r){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();var n=t.layers[0].layout,i=new Ee(null,0,!1,!1,!0),o=n.get("text-allow-overlap"),a=n.get("icon-allow-overlap"),s=new Ee(null,0,o&&(a||!t.hasIconData()||n.get("icon-optional")),a&&(o||!t.hasTextData()||n.get("text-optional")),!0);!t.collisionArrays&&r&&(t.hasCollisionBoxData()||t.hasCollisionCircleData())&&t.deserializeCollisionBoxes(r);for(var l=0;l<t.symbolInstances.length;l++){var u=t.symbolInstances.get(l),c=e[u.crossTileID],h=this.opacities[u.crossTileID];c?h=i:h||(h=s,this.opacities[u.crossTileID]=h),e[u.crossTileID]=!0;var p=u.numGlyphVertices>0||u.numVerticalGlyphVertices>0,d=u.numIconVertices>0;if(p){for(var f=Re(h.text),m=(u.numGlyphVertices+u.numVerticalGlyphVertices)/4,_=0;_<m;_++)t.text.opacityVertexArray.emplaceBack(f);t.text.placedSymbolArray.get(u.horizontalPlacedTextSymbolIndex).hidden=h.text.isHidden(),u.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).hidden=h.text.isHidden())}if(d){for(var y=Re(h.icon),g=0;g<u.numIconVertices/4;g++)t.icon.opacityVertexArray.emplaceBack(y);t.icon.placedSymbolArray.get(l).hidden=h.icon.isHidden()}if(t.hasCollisionBoxData()||t.hasCollisionCircleData()){var v=t.collisionArrays[l];if(v){v.textBox&&Te(t.collisionBox.collisionVertexArray,h.text.placed,!1),v.iconBox&&Te(t.collisionBox.collisionVertexArray,h.icon.placed,!1);var b=v.textCircles;if(b&&t.hasCollisionCircleData())for(var x=0;x<b.length;x+=5){var w=c||0===b[x+4];Te(t.collisionCircle.collisionVertexArray,h.text.placed,w)}}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},Me.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},Me.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Me.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},Me.prototype.setStale=function(){this.stale=!0};var Ae=Math.pow(2,25),Pe=Math.pow(2,24),Ce=Math.pow(2,17),De=Math.pow(2,16),ze=Math.pow(2,9),Be=Math.pow(2,8),Le=Math.pow(2,1);function Re(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*Ae+e*Pe+r*Ce+e*De+r*ze+e*Be+r*Le+e}var Oe=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};Oe.prototype.continuePlacement=function(t,e,r,n,i){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(n,o,r,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var Fe=function(t,e,r,n,i,o){this.placement=new Me(t,i,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};Fe.prototype.isDone=function(){return this._done},Fe.prototype.continuePlacement=function(e,r,n){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=r[e[i._currentPlacementIndex]],l=i.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(i._inProgressLayer||(i._inProgressLayer=new Oe),i._inProgressLayer.continuePlacement(n[s.source],i.placement,i._showCollisionBoxes,s,a))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},Fe.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var Ne=512/t.EXTENT/2,Ve=function(t,e,r){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0;n<e.length;n++){var i=e.get(n),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};Ve.prototype.getScaledCoordinates=function(e,r){var n=r.canonical.z-this.tileID.canonical.z,i=Ne/Math.pow(2,n);return{x:Math.floor((r.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((r.canonical.y*t.EXTENT+e.anchorY)*i)}},Ve.prototype.findMatches=function(t,e,r){for(var n=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),l=0,u=a;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-s.x)<=n&&Math.abs(c.coord.y-s.y)<=n&&!r[c.crossTileID]){r[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}}};var je=function(){this.maxCrossTileID=0};je.prototype.generate=function(){return++this.maxCrossTileID};var Ue=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ue.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var r in this.indexes){var n=this.indexes[r],i={};for(var o in n){var a=n[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[r]=i}this.lng=t},Ue.prototype.addBucket=function(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var n=0;n<e.symbolInstances.length;n++)e.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,i)}else{var u=a[t.scaledTo(Number(o)).key];u&&u.findMatches(e.symbolInstances,t,i)}}for(var c=0;c<e.symbolInstances.length;c++){var h=e.symbolInstances.get(c);h.crossTileID||(h.crossTileID=r.generate(),i[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ve(t,e.symbolInstances,e.bucketInstanceId),!0},Ue.prototype.removeBucketCrossTileIDs=function(t,e){for(var r in e.indexedSymbolInstances)for(var n=0,i=e.indexedSymbolInstances[r];n<i.length;n+=1){var o=i[n];delete this.usedCrossTileIDs[t][o.crossTileID]}},Ue.prototype.removeStaleBuckets=function(t){var e=!1;for(var r in this.indexes){var n=this.indexes[r];for(var i in n)t[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],e=!0)}return e};var qe=function(){this.layerIndexes={},this.crossTileIDs=new je,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};qe.prototype.addLayer=function(t,e,r){var n=this.layerIndexes[t.id];void 0===n&&(n=this.layerIndexes[t.id]=new Ue);var i=!1,o={};n.handleWrapJump(r);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(i=!0),o[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(i=!0),i},qe.prototype.pruneUnusedLayers=function(t){var e={};for(var r in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[r]||delete this.layerIndexes[r]};var Ge=function(e,r){return t.emitValidationErrors(e,r&&r.filter(function(t){return"source.canvas"!==t.identifier}))},Ze=t.pick(Jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Xe=t.pick(Jt,["setCenter","setZoom","setBearing","setPitch"]),We=function(e){function r(n,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=n,this.dispatcher=new R((Wt||(Wt=new Ht),Wt),this),this.imageManager=new I,this.glyphManager=new C(n._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new L(256,512),this.crossTileSymbolIndex=new qe,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._resetUpdates();var a=this;this._rtlTextPluginCallback=r.registerForPluginAvailability(function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var r=e.getSource();if(r&&r.vectorLayerIds)for(var n in o._layers){var i=o._layers[n];i.source===r.id&&o._validateLayer(i)}}}})}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadURL=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof r.validate?r.validate:!f(e);e=function(t,e){if(!f(t))return t;var r=b(t);return r.path="/styles/v1"+r.path,d(r,e)}(e,r.accessToken);var o=this.map._transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,function(e,r){n._request=null,e?n.fire(new t.ErrorEvent(e)):r&&n._load(r,i)})},r.prototype.loadJSON=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame(function(){n._request=null,n._load(e,!1!==r.validate)})},r.prototype._load=function(e,r){var n=this;if(!r||!Ge(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)n.addSource(i,e.sources[i],{validate:!1});e.sprite?this._spriteRequest=function(e,r,n){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",l=t.getJSON(r(_(e,s,".json"),t.ResourceType.SpriteJSON),function(t,e){l=null,a||(a=t,i=e,c())}),u=t.getImage(r(_(e,s,".png"),t.ResourceType.SpriteImage),function(t,e){u=null,a||(a=t,o=e,c())});function c(){if(a)n(a);else if(i&&o){var e=t.browser.getImageData(o),r={};for(var s in i){var l=i[s],u=l.width,c=l.height,h=l.x,p=l.y,d=l.sdf,f=l.pixelRatio,m=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,m,{x:h,y:p},{x:0,y:0},{width:u,height:c}),r[s]={data:m,pixelRatio:f,sdf:d}}n(null,r)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e.sprite,this.map._transformRequest,function(e,r){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=Kt(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var l=s[a];(l=t.createStyleLayer(l)).setEventedParent(n,{layer:{id:l.id}}),n._layers[l.id]=l}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new B(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},r.prototype._validateLayer=function(e){var r=this.sourceCaches[e.source];if(r){var n=e.sourceLayer;if(n){var i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(t){for(var e=[],r=0,n=t;r<n.length;r+=1){var i=n[r],o=this._layers[i];"custom"!==o.type&&e.push(o.serialize())}return e},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(e){if(this._loaded){if(this._changed){var r=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var i in(r.length||n.length)&&this._updateWorkerLayers(r,n),this._updatedSources){var o=this._updatedSources[i];"reload"===o?this._reloadSource(i):"clear"===o&&this._clearSource(i)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];h.recalculate(e),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},r.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},r.prototype.setState=function(e){var r=this;if(this._checkLoaded(),Ge(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=Kt(e.layers);var n=function(e,r){if(!e)return[{command:Jt.setStyle,args:[r]}];var n=[];try{if(!t.isEqual(e.version,r.version))return[{command:Jt.setStyle,args:[r]}];t.isEqual(e.center,r.center)||n.push({command:Jt.setCenter,args:[r.center]}),t.isEqual(e.zoom,r.zoom)||n.push({command:Jt.setZoom,args:[r.zoom]}),t.isEqual(e.bearing,r.bearing)||n.push({command:Jt.setBearing,args:[r.bearing]}),t.isEqual(e.pitch,r.pitch)||n.push({command:Jt.setPitch,args:[r.pitch]}),t.isEqual(e.sprite,r.sprite)||n.push({command:Jt.setSprite,args:[r.sprite]}),t.isEqual(e.glyphs,r.glyphs)||n.push({command:Jt.setGlyphs,args:[r.glyphs]}),t.isEqual(e.transition,r.transition)||n.push({command:Jt.setTransition,args:[r.transition]}),t.isEqual(e.light,r.light)||n.push({command:Jt.setLight,args:[r.light]});var i={},o=[];!function(e,r,n,i){var o;for(o in e=e||{},r=r||{},e)e.hasOwnProperty(o)&&(r.hasOwnProperty(o)||$t(o,n,i));for(o in r)r.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.isEqual(e[o],r[o])||("geojson"===e[o].type&&"geojson"===r[o].type&&ee(e,r,o)?n.push({command:Jt.setGeoJSONSourceData,args:[o,r[o].data]}):te(o,r,n,i)):Qt(o,r,n))}(e.sources,r.sources,o,i);var a=[];e.layers&&e.layers.forEach(function(t){i[t.source]?n.push({command:Jt.removeLayer,args:[t.id]}):a.push(t)}),n=n.concat(o),function(e,r,n){e=e||[],r=r||[];var i,o,a,s,l,u,c,h=e.map(ne),p=r.map(ne),d=e.reduce(ie,{}),f=r.reduce(ie,{}),m=h.slice(),_=Object.create(null);for(i=0,o=0;i<h.length;i++)a=h[i],f.hasOwnProperty(a)?o++:(n.push({command:Jt.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(i=0,o=0;i<p.length;i++)a=p[p.length-1-i],m[m.length-1-i]!==a&&(d.hasOwnProperty(a)?(n.push({command:Jt.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,u=m[m.length-i],n.push({command:Jt.addLayer,args:[f[a],u]}),m.splice(m.length-i,0,a),_[a]=!0);for(i=0;i<p.length;i++)if(s=d[a=p[i]],l=f[a],!_[a]&&!t.isEqual(s,l))if(t.isEqual(s.source,l.source)&&t.isEqual(s["source-layer"],l["source-layer"])&&t.isEqual(s.type,l.type)){for(c in re(s.layout,l.layout,n,a,null,Jt.setLayoutProperty),re(s.paint,l.paint,n,a,null,Jt.setPaintProperty),t.isEqual(s.filter,l.filter)||n.push({command:Jt.setFilter,args:[a,l.filter]}),t.isEqual(s.minzoom,l.minzoom)&&t.isEqual(s.maxzoom,l.maxzoom)||n.push({command:Jt.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?re(s[c],l[c],n,a,c.slice(6),Jt.setPaintProperty):t.isEqual(s[c],l[c])||n.push({command:Jt.setLayerProperty,args:[a,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?re(s[c],l[c],n,a,c.slice(6),Jt.setPaintProperty):t.isEqual(s[c],l[c])||n.push({command:Jt.setLayerProperty,args:[a,c,l[c]]}))}else n.push({command:Jt.removeLayer,args:[a]}),u=m[m.lastIndexOf(a)+1],n.push({command:Jt.addLayer,args:[l,u]})}(a,r.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:Jt.setStyle,args:[r]}]}return n}(this.serialize(),e).filter(function(t){return!(t.command in Xe)});if(0===n.length)return!1;var i=n.filter(function(t){return!(t.command in Ze)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return n.forEach(function(t){"setTransition"!==t.command&&r[t.command].apply(r,t.args)}),this.stylesheet=e,!0},r.prototype.addImage=function(e,r){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,r),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.getImage=function(t){return this.imageManager.getImage(t)},r.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},r.prototype.addSource=function(e,r,n){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,r,null,n))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Ut(e,r,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}}),o.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},r.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},r.prototype.addLayer=function(e,r,n){this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===e.type){if(Ge(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},n))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}var a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},r.prototype.moveLayer=function(e,r){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==r){var n=this._order.indexOf(e);this._order.splice(n,1);var i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(e){this._checkLoaded();var r=this._layers[e];if(r){r.setEventedParent(null);var n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(t){return this._layers[t]},r.prototype.setLayerZoomRange=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(e,r){this._checkLoaded();var n=this.getLayer(e);if(n){if(!t.isEqual(n.filter,r))return null===r||void 0===r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.validateStyle.filter,"layers."+n.id+".filter",r)||(n.filter=t.clone(r),this._updateLayer(n)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},r.prototype.setLayoutProperty=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getLayoutProperty(r),n)||(i.setLayoutProperty(r,n),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},r.prototype.setPaintProperty=function(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getPaintProperty(r),n)||(i.setPaintProperty(r,n)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},r.prototype.setFeatureState=function(e,r){this._checkLoaded();var n=e.source,i=e.sourceLayer,o=this.sourceCaches[n],a=parseInt(e.id,10);void 0!==o?"vector"!==o.getSource().type||i?isNaN(a)||a<0?this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):o.setFeatureState(i,a,r):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))):this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},r.prototype.getFeatureState=function(e){this._checkLoaded();var r=e.source,n=e.sourceLayer,i=this.sourceCaches[r],o=parseInt(e.id,10);if(void 0!==i)if("vector"!==i.getSource().type||n){if(!(isNaN(o)||o<0))return i.getFeatureState(n,o);this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},r.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._serializeLayers(this._order)},function(t){return void 0!==t})},r.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},r.prototype._flattenRenderedFeatures=function(t){for(var e=[],r=this._order.length-1;r>=0;r--)for(var n=this._order[r],i=0,o=t;i<o.length;i+=1){var a=o[i][n];if(a)for(var s=0,l=a;s<l.length;s+=1){var u=l[s];e.push(u)}}return e},r.prototype.queryRenderedFeatures=function(e,r,n){r&&r.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",r.filter);var i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=r.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[l.source]=!0}}var u=[],c=e.map(function(t){return n.pointCoordinate(t)});for(var h in this.sourceCaches)r.layers&&!i[h]||u.push(K(this.sourceCaches[h],this._layers,c,r,n));return this.placement&&u.push(function(t,e,r,n,i,o){for(var a={},s=i.queryRenderedSymbols(r),l=[],u=0,c=Object.keys(s).map(Number);u<c.length;u+=1){var h=c[u];l.push(o[h])}l.sort(J);for(var p=function(){var e=f[d],r=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,n.filter,n.layers,t);for(var i in r){var o=a[i]=a[i]||[],l=r[i];l.sort(function(t,r){var n=e.featureSortOrder;if(n){var i=n.indexOf(t.featureIndex);return n.indexOf(r.featureIndex)-i}return r.featureIndex-t.featureIndex});for(var u=0,c=l;u<c.length;u+=1){var h=c[u];o.push(h.feature)}}},d=0,f=l;d<f.length;d+=1)p();var m=function(r){a[r].forEach(function(n){var i=t[r],o=e[i.source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=o})};for(var _ in a)m(_);return a}(this._layers,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},r.prototype.querySourceFeatures=function(e,r){r&&r.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",r.filter);var n=this.sourceCaches[e];return n?function(t,e){for(var r=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),n=[],i={},o=0;o<r.length;o++){var a=r[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(n,e))}return n}(n,r):[]},r.prototype.addSourceType=function(t,e,n){return r.getSourceType(t)?n(new Error('A source type called "'+t+'" already exists.')):(r.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(e){this._checkLoaded();var r=this.light.getLight(),n=!1;for(var i in e)if(!t.isEqual(e[i],r[i])){n=!0;break}if(n){var o={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},r.prototype._validate=function(e,r,n,i,o){return(!o||!1!==o.validate)&&Ge(this,e.call(t.validateStyle,t.extend({key:r,style:this.serialize(),value:n,styleSpec:t.styleSpec},i)))},r.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},r.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},r.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},r.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},r.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},r.prototype._updatePlacement=function(e,r,n,i){for(var o=!1,a=!1,s={},l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];if("symbol"===h.type){if(!s[h.source]){var p=this.sourceCaches[h.source];s[h.source]=p.getRenderableIds(!0).map(function(t){return p.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var d=this.crossTileSymbolIndex.addLayer(h,s[h.source],e.center.lng);o=o||d}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var f=this._layerOrderChanged;if((f||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now()))&&(this.pauseablePlacement=new Fe(e,this._order,f,r,n,i),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,t.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var m=0,_=this._order;m<_.length;m+=1){var y=_[m],g=this._layers[y];"symbol"===g.type&&this.placement.updateLayerOpacities(g,s[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},r.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},r.prototype.getImages=function(t,e,r){this.imageManager.getImages(e.icons,r)},r.prototype.getGlyphs=function(t,e,r){this.glyphManager.getGlyphs(e.stacks,r)},r}(t.Evented);We.getSourceType=function(t){return H[t]},We.setSourceType=function(t,e){H[t]=e},We.registerForPluginAvailability=t.registerForPluginAvailability;var He=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ye={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"\nuniform vec2 u_texsize;\nuniform sampler2D u_image;\nuniform float u_fade;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_fade) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_fade) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileZoomRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileZoomRatio, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n\nvoid main() {\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\nuniform float u_vertical_gradient;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize highp float base\n    #pragma mapbox: initialize highp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_fade);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_height_factor;\nuniform vec4 u_scale;\nuniform float u_vertical_gradient;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\nuniform mediump vec4 u_scale;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    vec2 pattern_size_a = vec2(display_size_a.x * fromScale / tileZoomRatio, display_size_a.y);\n    vec2 pattern_size_b = vec2(display_size_b.x * toScale / tileZoomRatio, display_size_b.y);\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_a.y + 2.0) / 2.0) / pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_b.y + 2.0) / 2.0) / pattern_size_b.y);\n    vec2 pos_a = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform vec2 u_gl_units_to_pixels;\nuniform mediump float u_ratio;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n    // float tileRatio = u_scale.y;\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},Ke=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Je=function(t){var e=Ye[t],r={};e.fragmentSource=e.fragmentSource.replace(Ke,function(t,e,n,i,o){return r[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(Ke,function(t,e,n,i,o){var a="float"===i?"vec2":"vec4",s=o.match(/color/)?"color":a;return r[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"})};for(var Qe in Ye)Je(Qe);var $e=Ye,tr=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};tr.prototype.bind=function(t,e,r,n,i,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==n.length,u=0;!l&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||l||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,r,n,i,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},tr.prototype.freshBind=function(t,e,r,n,i,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var h=l;h<s;h++)c.disableVertexAttribArray(h)}e.enableAttributes(c,t);for(var p=0,d=r;p<d.length;p+=1)d[p].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,i);for(var f=0,m=r;f<m.length;f+=1){var _=m[f];_.bind(),_.setVertexAttribPointers(c,t,i)}o&&(o.bind(),o.setVertexAttribPointers(c,t,i)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,i)),u.currentNumAttributes=l},tr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var er=function(e,r,n,i,o){var a=e.gl;this.program=a.createProgram();var s=n.defines().concat("#define DEVICE_PIXEL_RATIO "+t.browser.devicePixelRatio.toFixed(1));o&&s.push("#define OVERDRAW_INSPECTOR;");var l=s.concat($e.prelude.fragmentSource,r.fragmentSource).join("\n"),u=s.concat($e.prelude.vertexSource,r.vertexSource).join("\n"),c=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(c,l),a.compileShader(c),a.attachShader(this.program,c);var h=a.createShader(a.VERTEX_SHADER);a.shaderSource(h,u),a.compileShader(h),a.attachShader(this.program,h);for(var p=n.layoutAttributes||[],d=0;d<p.length;d++)a.bindAttribLocation(this.program,d,p[d].name);a.linkProgram(this.program),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={};for(var f={},m=0;m<this.numAttributes;m++){var _=a.getActiveAttrib(this.program,m);_&&(this.attributes[_.name]=a.getAttribLocation(this.program,_.name))}for(var y=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),g=0;g<y;g++){var v=a.getActiveUniform(this.program,g);v&&(f[v.name]=a.getUniformLocation(this.program,v.name))}this.fixedUniforms=i(e,f),this.binderUniforms=n.getUniforms(e,f)};function rr(e,r,n){var i=1/we(n,1,r.transform.tileZoom),o=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,r.transform.tileZoom)/o,s=a*(n.tileID.canonical.x+n.tileID.wrap*o),l=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[t.browser.devicePixelRatio,i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}er.prototype.draw=function(t,e,r,n,i,o,a,s,l,u,c,h,p,d,f,m){var _,y=t.gl;for(var g in t.program.set(this.program),t.setDepthMode(r),t.setStencilMode(n),t.setColorMode(i),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[g].set(a[g]);d&&d.setUniforms(t,this.binderUniforms,h,{zoom:p});for(var v=(_={},_[y.LINES]=2,_[y.TRIANGLES]=3,_[y.LINE_STRIP]=1,_)[e],b=0,x=c.get();b<x.length;b+=1){var w=x[b],k=w.vaos||(w.vaos={});(k[s]||(k[s]=new tr)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,w.vertexOffset,f,m),y.drawElements(e,w.primitiveLength*v,y.UNSIGNED_SHORT,w.primitiveOffset*v*2)}};var nr=function(e,r,n){var i=r.style.light,o=i.properties.get("position"),a=[o.x,o.y,o.z],s=t.create$2();"viewport"===i.properties.get("anchor")&&t.fromRotation(s,-r.transform.angle),t.transformMat3(a,a,s);var l=i.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+n}},ir=function(e,r,n,i,o,a){return t.extend(nr(e,r,n),rr(o,r,a),{u_height_factor:-Math.pow(2,i.overscaledZ)/a.tileSize/8})},or=function(e,r,n){var i=t.create();t.ortho(i,0,e.width,e.height,0,0,1);var o=e.context.gl;return{u_matrix:i,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:n,u_opacity:r}},ar=function(t){return{u_matrix:t}},sr=function(e,r,n,i){return t.extend(ar(e),rr(n,r,i))},lr=function(t,e){return{u_matrix:t,u_world:e}},ur=function(e,r,n,i,o){return t.extend(sr(e,r,n,i),{u_world:o})},cr=function(t,e,r,n){var i,o,a=t.transform;if("map"===n.paint.get("circle-pitch-alignment")){var s=we(r,1,a.zoom);i=!0,o=[s,s]}else i=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,r,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_extrude_scale:o}},hr=function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,r.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,r.u_overscale_factor)}},pr=function(t,e,r){var n=we(r,1,e.zoom),i=Math.pow(2,e.zoom-r.tileID.overscaledZ),o=r.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[e.pixelsToGLUnits[0]/(n*i),e.pixelsToGLUnits[1]/(n*i)],u_overscale_factor:o}},dr=function(t,e){return{u_matrix:t,u_color:e}},fr=function(t){return{u_matrix:t}},mr=function(t,e,r,n){return{u_matrix:t,u_extrude_scale:we(e,1,r),u_intensity:n}},_r=function(e,r,n){var i=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),a=n.paint.get("hillshade-accent-color"),s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle),{u_matrix:e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),!0),u_image:0,u_latrange:function(e,r){var n=r.toCoordinate(),i=new t.Coordinate(n.column,n.row+1,n.zoom);return[e.transform.coordinateLocation(n).lat,e.transform.coordinateLocation(i).lat]}(e,r.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}},yr=function(e,r){var n=e.dem.dim,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[2*n,2*n],u_zoom:e.tileID.overscaledZ,u_maxzoom:r}},gr=function(t,e,r){var n=t.transform;return{u_matrix:kr(t,e,r),u_ratio:1/we(e,1,n.zoom),u_gl_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},vr=function(e,r,n){return t.extend(gr(e,r,n),{u_image:0})},br=function(e,r,n,i){var o=e.transform,a=wr(r,o);return{u_matrix:kr(e,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:1/we(r,1,o.zoom),u_image:0,u_scale:[t.browser.devicePixelRatio,a,i.fromScale,i.toScale],u_fade:i.t,u_gl_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},xr=function(e,r,n,i,o){var a=e.transform,s=e.lineAtlas,l=wr(r,a),u="round"===n.layout.get("line-cap"),c=s.getDash(i.from,u),h=s.getDash(i.to,u),p=c.width*o.fromScale,d=h.width*o.toScale;return t.extend(gr(e,r,n),{u_patternscale_a:[l/p,-c.height/2],u_patternscale_b:[l/d,-h.height/2],u_sdfgamma:s.width/(256*Math.min(p,d)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:o.t})};function wr(t,e){return 1/we(t,1,e.tileZoom)}function kr(t,e,r){return t.translatePosMatrix(e.tileID.posMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var Er=function(t,e,r,n,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}(i.paint.get("raster-hue-rotate"))};var o,a},Ir=function(t,e,r,n,i,o,a,s,l,u){var c=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_gl_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+n,u_texsize:u,u_texture:0}},Sr=function(e,r,n,i,o,a,s,l,u,c,h){var p=o.transform;return t.extend(Ir(e,r,n,i,o,a,s,l,u,c),{u_gamma_scale:i?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_is_halo:+h})},Mr=function(t,e,r){return{u_matrix:t,u_opacity:e,u_color:r}},Tr=function(e,r,n,i,o,a){return t.extend(function(t,e,r,n){var i=r.imageManager.getPattern(t.from),o=r.imageManager.getPattern(t.to),a=r.imageManager.getPixelSize(),s=a.width,l=a.height,u=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,r.transform.tileZoom)/u,h=c*(n.tileID.canonical.x+n.tileID.wrap*u),p=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,l],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/we(n,1,r.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(i,a,n,o),{u_matrix:e,u_opacity:r})},Ar={fillExtrusion:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient)}},fillExtrusionPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,r.u_height_factor),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},extrusionTexture:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_opacity:new t.Uniform1f(e,r.u_opacity)}},fill:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},fillPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},fillOutline:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world)}},fillOutlinePattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},circle:function(e,r){return{u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,r.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},collisionBox:hr,collisionCircle:hr,debug:function(e,r){return{u_color:new t.UniformColor(e,r.u_color),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},clippingMask:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},heatmap:function(e,r){return{u_extrude_scale:new t.Uniform1f(e,r.u_extrude_scale),u_intensity:new t.Uniform1f(e,r.u_intensity),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},heatmapTexture:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_color_ramp:new t.Uniform1i(e,r.u_color_ramp),u_opacity:new t.Uniform1f(e,r.u_opacity)}},hillshade:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_latrange:new t.Uniform2f(e,r.u_latrange),u_light:new t.Uniform2f(e,r.u_light),u_shadow:new t.UniformColor(e,r.u_shadow),u_highlight:new t.UniformColor(e,r.u_highlight),u_accent:new t.UniformColor(e,r.u_accent)}},hillshadePrepare:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_dimension:new t.Uniform2f(e,r.u_dimension),u_zoom:new t.Uniform1f(e,r.u_zoom),u_maxzoom:new t.Uniform1f(e,r.u_maxzoom)}},line:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,r.u_gl_units_to_pixels)}},lineGradient:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,r.u_gl_units_to_pixels),u_image:new t.Uniform1i(e,r.u_image)}},linePattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_texsize:new t.Uniform2f(e,r.u_texsize),u_ratio:new t.Uniform1f(e,r.u_ratio),u_image:new t.Uniform1i(e,r.u_image),u_gl_units_to_pixels:new t.Uniform2f(e,r.u_gl_units_to_pixels),u_scale:new t.Uniform4f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},lineSDF:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,r.u_gl_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,r.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,r.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,r.u_sdfgamma),u_image:new t.Uniform1i(e,r.u_image),u_tex_y_a:new t.Uniform1f(e,r.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,r.u_tex_y_b),u_mix:new t.Uniform1f(e,r.u_mix)}},raster:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_tl_parent:new t.Uniform2f(e,r.u_tl_parent),u_scale_parent:new t.Uniform1f(e,r.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,r.u_buffer_scale),u_fade_t:new t.Uniform1f(e,r.u_fade_t),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image0:new t.Uniform1i(e,r.u_image0),u_image1:new t.Uniform1i(e,r.u_image1),u_brightness_low:new t.Uniform1f(e,r.u_brightness_low),u_brightness_high:new t.Uniform1f(e,r.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,r.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,r.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,r.u_spin_weights)}},symbolIcon:function(e,r){return{u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,r.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture)}},symbolSDF:function(e,r){return{u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,r.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture),u_gamma_scale:new t.Uniform1f(e,r.u_gamma_scale),u_is_halo:new t.Uniform1f(e,r.u_is_halo)}},background:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_color:new t.UniformColor(e,r.u_color)}},backgroundPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image:new t.Uniform1i(e,r.u_image),u_pattern_tl_a:new t.Uniform2f(e,r.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,r.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,r.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,r.u_pattern_br_b),u_texsize:new t.Uniform2f(e,r.u_texsize),u_mix:new t.Uniform1f(e,r.u_mix),u_pattern_size_a:new t.Uniform2f(e,r.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,r.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,r.u_scale_a),u_scale_b:new t.Uniform1f(e,r.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,r.u_tile_units_to_pixels)}}};function Pr(e,r){for(var n=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),i=0;i<n.length;i++){var o={},a=n[i],s=n.slice(i+1);Cr(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,r)}}function Cr(e,r,n,i,o){for(var a=0;a<n.length;a++){var s=n[a];if(i.isLessThan(s.tileID))break;if(r.key===s.tileID.key)return;if(s.tileID.isChildOf(r)){for(var l=r.children(1/0),u=0;u<l.length;u++)Cr(e,l[u],n.slice(a),i,o);return}}var c=r.overscaledZ-e.overscaledZ,h=new t.CanonicalTileID(c,r.canonical.x-(e.canonical.x<<c),r.canonical.y-(e.canonical.y<<c));o[h.key]=o[h.key]||h}function Dr(t,e,r,n,i){for(var o=t.context,a=o.gl,s=i?t.useProgram("collisionCircle"):t.useProgram("collisionBox"),l=0;l<n.length;l++){var u=n[l],c=e.getTile(u),h=c.getBucket(r);if(h){var p=i?h.collisionCircle:h.collisionBox;p&&s.draw(o,i?a.TRIANGLES:a.LINES,Ot.disabled,Ft.disabled,t.colorModeForRenderPass(),Vt.disabled,pr(u.posMatrix,t.transform,c),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,null,t.transform.zoom,null,null,p.collisionVertexBuffer)}}}var zr=t.identity(new Float32Array(16)),Br=t.properties.layout;function Lr(e,r,n,i,o,a,s,l,u,c,h,p){for(var d,f,m=e.context,_=m.gl,y=e.transform,g="map"===l,v="map"===u,b=g&&"point"!==n.layout.get("symbol-placement"),x=g&&!v&&!b,w=v?e.depthModeForSublayer(0,Ot.ReadOnly):Ot.disabled,k=0,E=i;k<E.length;k+=1){var I=E[k],S=r.getTile(I),M=S.getBucket(n);if(M){var T=o?M.text:M.icon;if(T&&T.segments.get().length){var A=T.programConfigurations.get(n.id),P=o||M.sdfIcons,C=o?M.textSizeData:M.iconSizeData;d||(d=e.useProgram(P?"symbolSDF":"symbolIcon",A),f=t.evaluateSizeForZoom(C,y.zoom,Br.properties[o?"text-size":"icon-size"])),m.activeTexture.set(_.TEXTURE0);var D=void 0;if(o)S.glyphAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),D=S.glyphAtlasTexture.size;else{var z=1!==n.layout.get("icon-size").constantOr(0)||M.iconsNeedLinear,B=v||0!==y.pitch;S.imageAtlasTexture.bind(P||e.options.rotating||e.options.zooming||z||B?_.LINEAR:_.NEAREST,_.CLAMP_TO_EDGE),D=S.imageAtlasTexture.size}var L=we(S,1,e.transform.zoom),R=se(I.posMatrix,v,g,e.transform,L),O=le(I.posMatrix,v,g,e.transform,L);b&&he(M,I.posMatrix,e,o,R,O,v,c);var F=e.translatePosMatrix(I.posMatrix,S,a,s),N=b?zr:R,V=e.translatePosMatrix(O,S,a,s,!0),j=void 0;if(P){var U=0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);j=Sr(C.functionType,f,x,v,e,F,N,V,o,D,!0),U&&Rr(T,n,e,d,w,h,p,j),j.u_is_halo=0}else j=Ir(C.functionType,f,x,v,e,F,N,V,o,D);Rr(T,n,e,d,w,h,p,j)}}}}function Rr(t,e,r,n,i,o,a,s){var l=r.context,u=l.gl;n.draw(l,u.TRIANGLES,i,o,a,Vt.disabled,s,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,e.paint,r.transform.zoom,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Or(t,e,r,n,i,o,a){var s,l,u,c,h,p=t.context.gl,d=r.paint.get("fill-pattern"),f=d&&d.constantOr(1),m=r.getCrossfadeParameters();a?(l=f&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(l=f?"fillPattern":"fill",s=p.TRIANGLES);for(var _=0,y=n;_<y.length;_+=1){var g=y[_],v=e.getTile(g);if(!f||v.patternsLoaded()){var b=v.getBucket(r);if(b){var x=b.programConfigurations.get(r.id),w=t.useProgram(l,x);f&&(t.context.activeTexture.set(p.TEXTURE0),v.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),x.updatePatternPaintBuffers(m));var k=d.constantOr(null);if(k&&v.imageAtlas){var E=v.imageAtlas.patternPositions[k.to],I=v.imageAtlas.patternPositions[k.from];E&&I&&x.setConstantPatternPositions(E,I)}var S=t.translatePosMatrix(g.posMatrix,v,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(a){c=b.indexBuffer2,h=b.segments2;var M=[p.drawingBufferWidth,p.drawingBufferHeight];u="fillOutlinePattern"===l&&f?ur(S,t,m,v,M):lr(S,M)}else c=b.indexBuffer,h=b.segments,u=f?sr(S,t,m,v):ar(S);w.draw(t.context,s,i,t.stencilModeForClipping(g),o,Vt.disabled,u,r.id,b.layoutVertexBuffer,c,h,r.paint,t.transform.zoom,x)}}}}function Fr(e,r){var n=e.context,i=n.gl,o=r.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new t.Texture(n,{width:e.width,height:e.height,data:null},i.RGBA);a.bind(i.LINEAR,i.CLAMP_TO_EDGE),(o=r.viewportFrame=n.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}n.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(n.clear({depth:1}),e.depthRboNeedsClear=!1),n.clear({color:t.Color.transparent}),n.setStencilMode(Ft.disabled),n.setDepthMode(new Ot(i.LEQUAL,Ot.ReadWrite,[0,1])),n.setColorMode(e.colorModeForRenderPass())}function Nr(t,e,r){var n=e.viewportFrame;if(n){var i=t.context,o=i.gl;i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n.colorAttachment.get()),t.useProgram("extrusionTexture").draw(i,o.TRIANGLES,Ot.disabled,Ft.disabled,t.colorModeForRenderPass(),Vt.disabled,or(t,r,0),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}function Vr(t,e,r,n,i,o){var a=t.context,s=a.gl,l=e.fbo;if(l){var u=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var c=_r(t,e,r);e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments?u.draw(a,s.TRIANGLES,n,i,o,Vt.disabled,c,r.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments):u.draw(a,s.TRIANGLES,n,i,o,Vt.disabled,c,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function jr(e,r,n,i,o,a,s){var l=e.context,u=l.gl;if(r.dem&&r.dem.data){var c=r.dem.dim,h=r.dem.getPixels();if(l.activeTexture.set(u.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(r.tileSize),r.demTexture){var p=r.demTexture;p.update(h,{premultiply:!1}),p.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else r.demTexture=new t.Texture(l,h,u.RGBA,{premultiply:!1}),r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);l.activeTexture.set(u.TEXTURE0);var d=r.fbo;if(!d){var f=new t.Texture(l,{width:c,height:c,data:null},u.RGBA);f.bind(u.LINEAR,u.CLAMP_TO_EDGE),(d=r.fbo=l.createFramebuffer(c,c)).colorAttachment.set(f.texture)}l.bindFramebuffer.set(d.framebuffer),l.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(l,u.TRIANGLES,o,a,s,Vt.disabled,yr(r,i),n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Ur(e,r,n,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),l=(s-e.timeAdded)/a,u=r?(s-r.timeAdded)/a:-1,c=n.getSource(),h=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.clamp(p?l:1-u,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function qr(e,r,n){var i=e.context,o=i.gl,a=n.posMatrix,s=e.useProgram("debug"),l=Ot.disabled,u=Ft.disabled,c=e.colorModeForRenderPass(),h="$debug";s.draw(i,o.LINE_STRIP,l,u,c,Vt.disabled,dr(a,t.Color.red),h,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);for(var p=function(t,e,r,n){n=n||1;var i,o,a,s,l,u,c,h,p=[];for(i=0,o=t.length;i<o;i++)if(l=Gr[t[i]]){for(h=null,a=0,s=l[1].length;a<s;a+=2)-1===l[1][a]&&-1===l[1][a+1]?h=null:(u=e+l[1][a]*n,c=200-l[1][a+1]*n,h&&p.push(h.x,h.y,u,c),h={x:u,y:c});e+=l[0]*n}return p}(n.toString(),50,0,5),d=new t.StructArrayLayout2i4,f=new t.StructArrayLayout2ui4,m=0;m<p.length;m+=2)d.emplaceBack(p[m],p[m+1]),f.emplaceBack(m,m+1);for(var _=i.createVertexBuffer(d,He.members),y=i.createIndexBuffer(f),g=t.SegmentVector.simpleSegment(0,0,d.length/2,d.length/2),v=r.getTile(n).tileSize,b=t.EXTENT/(Math.pow(2,e.transform.zoom-n.overscaledZ)*v),x=[[-1,-1],[-1,1],[1,-1],[1,1]],w=0;w<x.length;w++){var k=x[w];s.draw(i,o.LINES,l,u,c,Vt.disabled,dr(t.translate([],a,[b*k[0],b*k[1],0]),t.Color.white),h,_,y,g)}s.draw(i,o.LINES,l,u,c,Vt.disabled,dr(a,t.Color.black),h,_,y,g)}var Gr={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},Zr={symbol:function(t,e,r,n){if("translucent"===t.renderPass){var i=Ft.disabled,o=t.colorModeForRenderPass();0!==r.paint.get("icon-opacity").constantOr(1)&&Lr(t,e,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),i,o),0!==r.paint.get("text-opacity").constantOr(1)&&Lr(t,e,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),i,o),e.map.showCollisionBoxes&&function(t,e,r,n){Dr(t,e,r,n,!1),Dr(t,e,r,n,!0)}(t,e,r,n)}},circle:function(t,e,r,n){if("translucent"===t.renderPass){var i=r.paint.get("circle-opacity"),o=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity");if(0!==i.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1))for(var s=t.context,l=s.gl,u=t.depthModeForSublayer(0,Ot.ReadOnly),c=Ft.disabled,h=t.colorModeForRenderPass(),p=0;p<n.length;p++){var d=n[p],f=e.getTile(d),m=f.getBucket(r);if(m){var _=m.programConfigurations.get(r.id);t.useProgram("circle",_).draw(s,l.TRIANGLES,u,c,h,Vt.disabled,cr(t,d,f,r),r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,r.paint,t.transform.zoom,_)}}}},heatmap:function(e,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=e.depthModeForSublayer(0,Ot.ReadOnly),l=Ft.disabled,u=new Nt([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,r){var n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=r.heatmapFbo;if(i)n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),function t(e,r,n,i){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,r.width/4,r.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(n),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,i.colorAttachment.setDirty(),t(e,r,n,i))}(t,e,o,i=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4))}}(o,e,n),o.clear({color:t.Color.transparent});for(var c=0;c<i.length;c++){var h=i[c];if(!r.hasRenderableParent(h)){var p=r.getTile(h),d=p.getBucket(n);if(d){var f=d.programConfigurations.get(n.id),m=e.useProgram("heatmap",f),_=e.transform.zoom;m.draw(o,a.TRIANGLES,s,l,u,Vt.disabled,mr(h.posMatrix,p,_,n.paint.get("heatmap-intensity")),n.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,n.paint,e.transform.zoom,f)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){var n=e.context,i=n.gl,o=r.heatmapFbo;if(o){n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);var a=r.colorRampTexture;a||(a=r.colorRampTexture=new t.Texture(n,r.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(n,i.TRIANGLES,Ot.disabled,Ft.disabled,e.colorModeForRenderPass(),Vt.disabled,function(e,r,n,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:n,u_color_ramp:i,u_opacity:r.paint.get("heatmap-opacity")}}(e,r,0,1),r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom)}}(e,n))},line:function(e,r,n,i){if("translucent"===e.renderPass){var o=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,Ot.ReadOnly),l=e.colorModeForRenderPass(),u=n.paint.get("line-dasharray"),c=n.paint.get("line-pattern"),h=c.constantOr(1),p=n.paint.get("line-gradient"),d=n.getCrossfadeParameters(),f=u?"lineSDF":h?"linePattern":p?"lineGradient":"line",m=e.context,_=m.gl,y=!0;if(p){m.activeTexture.set(_.TEXTURE0);var g=n.gradientTexture;if(!n.gradient)return;g||(g=n.gradientTexture=new t.Texture(m,n.gradient,_.RGBA)),g.bind(_.LINEAR,_.CLAMP_TO_EDGE)}for(var v=0,b=i;v<b.length;v+=1){var x=b[v],w=r.getTile(x);if(!h||w.patternsLoaded()){var k=w.getBucket(n);if(k){var E=k.programConfigurations.get(n.id),I=e.context.program.get(),S=e.useProgram(f,E),M=y||S.program!==I,T=c.constantOr(null);if(T&&w.imageAtlas){var A=w.imageAtlas.patternPositions[T.to],P=w.imageAtlas.patternPositions[T.from];A&&P&&E.setConstantPatternPositions(A,P)}var C=u?xr(e,w,n,u,d):h?br(e,w,n,d):p?vr(e,w,n):gr(e,w,n);u&&(M||e.lineAtlas.dirty)?(m.activeTexture.set(_.TEXTURE0),e.lineAtlas.bind(m)):h&&(m.activeTexture.set(_.TEXTURE0),w.imageAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),E.updatePatternPaintBuffers(d)),S.draw(m,_.TRIANGLES,s,e.stencilModeForClipping(x),l,Vt.disabled,C,n.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,n.paint,e.transform.zoom,E),y=!1}}}}}},fill:function(e,r,n,i){var o=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),l=n.paint.get("fill-pattern").constantOr(1)||1!==o.constantOr(t.Color.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===l&&Or(e,r,n,i,e.depthModeForSublayer(1,"opaque"===e.renderPass?Ot.ReadWrite:Ot.ReadOnly),s,!1),"translucent"===e.renderPass&&n.paint.get("fill-antialias")&&Or(e,r,n,i,e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ot.ReadOnly),s,!0)}},"fill-extrusion":function(t,e,r,n){0!==r.paint.get("fill-extrusion-opacity")&&("offscreen"===t.renderPass?(Fr(t,r),function(t,e,r,n,i,o,a){for(var s=t.context,l=s.gl,u=r.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),h=r.getCrossfadeParameters(),p=0,d=n;p<d.length;p+=1){var f=d[p],m=e.getTile(f),_=m.getBucket(r);if(_){var y=_.programConfigurations.get(r.id),g=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",y);c&&(t.context.activeTexture.set(l.TEXTURE0),m.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePatternPaintBuffers(h));var v=u.constantOr(null);if(v&&m.imageAtlas){var b=m.imageAtlas.patternPositions[v.to],x=m.imageAtlas.patternPositions[v.from];b&&x&&y.setConstantPatternPositions(b,x)}var w=t.translatePosMatrix(f.posMatrix,m,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),k=r.paint.get("fill-extrusion-vertical-gradient"),E=c?ir(w,t,k,f,h,m):nr(w,t,k);g.draw(s,s.gl.TRIANGLES,i,o,a,Vt.backCCW,E,r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,r.paint,t.transform.zoom,y)}}}(t,e,r,n,new Ot(t.context.gl.LEQUAL,Ot.ReadWrite,[0,1]),Ft.disabled,t.colorModeForRenderPass())):"translucent"===t.renderPass&&Nr(t,r,r.paint.get("fill-extrusion-opacity")))},hillshade:function(t,e,r,n){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,Ot.ReadOnly),s=Ft.disabled,l=t.colorModeForRenderPass(),u=0,c=n;u<c.length;u+=1){var h=c[u],p=e.getTile(h);p.needsHillshadePrepare&&"offscreen"===t.renderPass?jr(t,p,r,o,a,s,l):"translucent"===t.renderPass&&Vr(t,p,r,a,s,l)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,r,n){if("translucent"===t.renderPass&&0!==r.paint.get("raster-opacity"))for(var i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),l=Ft.disabled,u=t.colorModeForRenderPass(),c=n.length&&n[0].overscaledZ,h=0,p=n;h<p.length;h+=1){var d=p[h],f=t.depthModeForSublayer(d.overscaledZ-c,1===r.paint.get("raster-opacity")?Ot.ReadWrite:Ot.ReadOnly,o.LESS),m=e.getTile(d),_=t.transform.calculatePosMatrix(d.toUnwrapped(),!0);m.registerFadeDuration(r.paint.get("raster-fade-duration"));var y=e.findLoadedParent(d,0),g=Ur(m,y,e,r,t.transform),v=void 0,b=void 0,x="nearest"===r.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),m.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),y?(y.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),v=Math.pow(2,y.tileID.overscaledZ-m.tileID.overscaledZ),b=[m.tileID.canonical.x*v%1,m.tileID.canonical.y*v%1]):m.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var w=Er(_,b||[0,0],v||1,g,r);a instanceof Z?s.draw(i,o.TRIANGLES,f,l,u,Vt.disabled,w,r.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):m.maskedBoundsBuffer&&m.maskedIndexBuffer&&m.segments?s.draw(i,o.TRIANGLES,f,l,u,Vt.disabled,w,r.id,m.maskedBoundsBuffer,m.maskedIndexBuffer,m.segments,r.paint,t.transform.zoom):s.draw(i,o.TRIANGLES,f,l,u,Vt.disabled,w,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,r){var n=r.paint.get("background-color"),i=r.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,l=s.tileSize,u=r.paint.get("background-pattern");if(!t.isPatternMissing(u)){var c=u||1!==n.a||1!==i?"translucent":"opaque";if(t.renderPass===c){var h=Ft.disabled,p=t.depthModeForSublayer(0,"opaque"===c?Ot.ReadWrite:Ot.ReadOnly),d=t.colorModeForRenderPass(),f=t.useProgram(u?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:l});u&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var _=r.getCrossfadeParameters(),y=0,g=m;y<g.length;y+=1){var v=g[y],b=t.transform.calculatePosMatrix(v.toUnwrapped()),x=u?Tr(b,i,t,u,{tileID:v,tileSize:l},_):Mr(b,i,n);f.draw(o,a.TRIANGLES,p,h,d,Vt.disabled,x,r.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,r){for(var n=0;n<r.length;n++)qr(t,e,r[n])},custom:function(t,e,r){var n=t.context,i=r.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),o.call(i,n.gl,t.transform.customLayerMatrix()),n.setDirty(),t.setBaseState()),"3d"===i.renderingMode&&(t.setCustomLayerDefaults(),Fr(t,r),i.render(n.gl,t.transform.customLayerMatrix()),n.setDirty(),t.setBaseState())}else"translucent"===t.renderPass&&("3d"===i.renderingMode?Nr(t,r,1):(t.setCustomLayerDefaults(),n.setStencilMode(Ft.disabled),n.setDepthMode(Ot.disabled),i.render(n.gl,t.transform.customLayerMatrix()),n.setDirty(),t.setBaseState(),n.bindFramebuffer.set(null)))}},Xr=function(e,r){this.context=new jt(e),this.transform=r,this._tileTextures={},this.setup(),this.numSublayers=Ut.maxUnderzooming+Ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.ProgramConfiguration,this.crossTileSymbolIndex=new qe};function Wr(t,e){if(t.row>e.row){var r=t;t=e,e=r}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function Hr(t,e,r,n,i){var o=Math.max(r,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,h=e.dx<0,p=o;p<a;p++){var d=l*Math.max(0,Math.min(t.dy,p+c-t.y0))+t.x0,f=u*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;i(Math.floor(f),Math.ceil(d),p)}}function Yr(t,e,r,n,i,o){var a,s=Wr(t,e),l=Wr(e,r),u=Wr(r,t);s.dy>l.dy&&(a=s,s=l,l=a),s.dy>u.dy&&(a=s,s=u,u=a),l.dy>u.dy&&(a=l,l=u,u=a),s.dy&&Hr(u,s,n,i,o),l.dy&&Hr(u,l,n,i,o)}Xr.prototype.resize=function(e,r){var n=this.context.gl;if(this.width=e*t.browser.devicePixelRatio,this.height=r*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1){var a=o[i];this.style._layers[a].resize()}this.depthRbo&&(n.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Xr.prototype.setup=function(){var e=this.context,r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(r,He.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(n,He.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,t.rasterBoundsAttributes.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,He.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);var l=this.context.gl;this.stencilClearMode=new Ft({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},Xr.prototype.clearStencil=function(){var e=this.context,r=e.gl,n=t.create();t.ortho(n,0,this.width,this.height,0,0,1),t.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,Ot.disabled,this.stencilClearMode,Nt.disabled,Vt.disabled,fr(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Xr.prototype._renderTileClippingMasks=function(t){var e=this.context,r=e.gl;e.setColorMode(Nt.disabled),e.setDepthMode(Ot.disabled);var n=this.useProgram("clippingMask"),i=1;this._tileClippingMaskIDs={};for(var o=0,a=t;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=i++;n.draw(e,r.TRIANGLES,Ot.disabled,new Ft({func:r.ALWAYS,mask:0},l,255,r.KEEP,r.KEEP,r.REPLACE),Nt.disabled,Vt.disabled,fr(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}},Xr.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Ft({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Xr.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Nt([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Nt.unblended:Nt.alphaBlended},Xr.prototype.depthModeForSublayer=function(t,e,r){var n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,i=n-1+this.depthRange;return new Ot(r||this.context.gl.LEQUAL,e,[i,n])},Xr.prototype.render=function(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now());var n=this.style._order,i=this.style.sourceCaches;for(var o in i){var a=i[o];a.used&&a.prepare(this.context)}var s,l={},u={},c={};for(var h in i){var p=i[h];l[h]=p.getVisibleCoordinates(),u[h]=l[h].slice().reverse(),c[h]=p.getVisibleCoordinates(!0).reverse()}for(var d in i){var f=i[d],m=f.getSource();if("raster"===m.type||"raster-dem"===m.type){for(var _=[],y=0,g=l[d];y<g.length;y+=1){var v=g[y];_.push(f.getTile(v))}Pr(_,this.context)}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var b=0,x=n;b<x.length;b+=1){var w=x[b],k=this.style._layers[w];if(k.hasOffscreenPass()&&!k.isHidden(this.transform.zoom)){var E=u[k.source];("custom"===k.type||E.length)&&this.renderLayer(this,i[k.source],k,E)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque",this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){var I=this.style._layers[n[this.currentLayer]],S=i[I.source],M=l[I.source];I.source!==s&&S&&(this.clearStencil(),S.getSource().isTileClipped&&this._renderTileClippingMasks(M)),this.renderLayer(this,S,I,M),s=I.source}for(this.renderPass="translucent",this.currentLayer=0,s=null;this.currentLayer<n.length;this.currentLayer++){var T=this.style._layers[n[this.currentLayer]],A=i[T.source],P=("symbol"===T.type?c:u)[T.source];T.source!==s&&A&&(this.clearStencil(),A.getSource().isTileClipped&&this._renderTileClippingMasks(l[T.source])),this.renderLayer(this,A,T,P),s=T.source}if(this.options.showTileBoundaries)for(var C in i){Zr.debug(this,i[C],l[C]);break}this.setCustomLayerDefaults()},Xr.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},Xr.prototype.renderLayer=function(t,e,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"custom"===r.type||n.length)&&(this.id=r.id,Zr[r.type](t,e,r,n))},Xr.prototype.translatePosMatrix=function(e,r,n,i,o){if(!n[0]&&!n[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[o?n[0]:we(r,n[0],this.transform.zoom),o?n[1]:we(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c},Xr.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Xr.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},Xr.prototype.isPatternMissing=function(t){if(!t)return!1;var e=this.imageManager.getPattern(t.from),r=this.imageManager.getPattern(t.to);return!e||!r},Xr.prototype.useProgram=function(t,e){void 0===e&&(e=this.emptyProgramConfiguration),this.cache=this.cache||{};var r=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new er(this.context,$e[t],e,Ar[t],this._showOverdrawInspector)),this.cache[r]},Xr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Xr.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)};var Kr=function(t,e,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||r,this._minZoom=t||0,this._maxZoom=e||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new F(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Jr={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};Kr.prototype.clone=function(){var t=new Kr(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Jr.minZoom.get=function(){return this._minZoom},Jr.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Jr.maxZoom.get=function(){return this._maxZoom},Jr.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Jr.renderWorldCopies.get=function(){return this._renderWorldCopies},Jr.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Jr.worldSize.get=function(){return this.tileSize*this.scale},Jr.centerPoint.get=function(){return this.size._div(2)},Jr.size.get=function(){return new t.Point(this.width,this.height)},Jr.bearing.get=function(){return-this.angle/Math.PI*180},Jr.bearing.set=function(e){var r=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=t.create$4(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Jr.pitch.get=function(){return this._pitch/Math.PI*180},Jr.pitch.set=function(e){var r=t.clamp(e,0,60)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Jr.fov.get=function(){return this._fov/Math.PI*180},Jr.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Jr.zoom.get=function(){return this._zoom},Jr.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Jr.center.get=function(){return this._center},Jr.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Kr.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Kr.prototype.getVisibleUnwrappedCoordinates=function(e){var r=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new t.Point(0,0),0),i=this.pointCoordinate(new t.Point(this.width,0),0),o=this.pointCoordinate(new t.Point(this.width,this.height),0),a=this.pointCoordinate(new t.Point(0,this.height),0),s=Math.floor(Math.min(n.column,i.column,o.column,a.column)),l=Math.floor(Math.max(n.column,i.column,o.column,a.column)),u=s-1;u<=l+1;u++)0!==u&&r.push(new t.UnwrappedTileID(u,e));return r},Kr.prototype.coveringTiles=function(e){var r=this.coveringZoomLevel(e),n=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);var i=this.pointCoordinate(this.centerPoint,r),o=new t.Point(i.column-.5,i.row-.5);return function(e,r,n,i){void 0===i&&(i=!0);var o=1<<e,a={};function s(r,s,l){var u,c,h,p;if(l>=0&&l<=o)for(u=r;u<s;u++)c=Math.floor(u/o),h=(u%o+o)%o,0!==c&&!0!==i||(p=new t.OverscaledTileID(n,c,e,h,l),a[p.key]=p)}return Yr(r[0],r[1],r[2],0,o,s),Yr(r[2],r[3],r[0],0,o,s),Object.keys(a).map(function(t){return a[t]})}(r,[this.pointCoordinate(new t.Point(0,0),r),this.pointCoordinate(new t.Point(this.width,0),r),this.pointCoordinate(new t.Point(this.width,this.height),r),this.pointCoordinate(new t.Point(0,this.height),r)],e.reparseOverscaled?n:r,this._renderWorldCopies).sort(function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)})},Kr.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Jr.unmodified.get=function(){return this._unmodified},Kr.prototype.zoomScale=function(t){return Math.pow(2,t)},Kr.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Kr.prototype.project=function(e){return new t.Point(this.lngX(e.lng),this.latY(e.lat))},Kr.prototype.unproject=function(t){return new F(this.xLng(t.x),this.yLat(t.y))},Jr.x.get=function(){return this.lngX(this.center.lng)},Jr.y.get=function(){return this.latY(this.center.lat)},Jr.point.get=function(){return new t.Point(this.x,this.y)},Kr.prototype.lngX=function(t){return(180+t)*this.worldSize/360},Kr.prototype.latY=function(e){return e=t.clamp(e,-this.maxValidLatitude,this.maxValidLatitude),(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))*this.worldSize/360},Kr.prototype.xLng=function(t){return 360*t/this.worldSize-180},Kr.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},Kr.prototype.setLocationAtPoint=function(t,e){var r=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(r)),this._renderWorldCopies&&(this.center=this.center.wrap())},Kr.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Kr.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Kr.prototype.locationCoordinate=function(e){return new t.Coordinate(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},Kr.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new F(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},Kr.prototype.pointCoordinate=function(e,r){void 0===r&&(r=this.tileZoom);var n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var o=n[3],a=i[3],s=n[0]/o,l=i[0]/a,u=n[1]/o,c=i[1]/a,h=n[2]/o,p=i[2]/a,d=h===p?0:(0-h)/(p-h);return new t.Coordinate(t.number(s,l,d)/this.tileSize,t.number(u,c,d)/this.tileSize,this.zoom)._zoomTo(r)},Kr.prototype.coordinatePoint=function(e){var r=e.zoomTo(this.zoom),n=[r.column*this.tileSize,r.row*this.tileSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},Kr.prototype.getBounds=function(){return(new N).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Kr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new N([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Kr.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Kr.prototype.calculatePosMatrix=function(e,r){void 0===r&&(r=!1);var n=e.key,i=r?this._alignedPosMatrixCache:this._posMatrixCache;if(i[n])return i[n];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),i[n]=new Float32Array(l),i[n]},Kr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Kr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,r,n,i,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=this.latY(h[1]),e=(a=this.latY(h[0]))-o<u.y?u.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=this.lngX(p[0]),r=(l=this.lngX(p[1]))-s<u.x?u.x/(l-s):0}var d=Math.max(r||0,e||0);if(d)return this.center=this.unproject(new t.Point(r?(l+s)/2:this.x,e?(a+o)/2:this.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var f=this.y,m=u.y/2;f-m<o&&(i=o+m),f+m>a&&(i=a-m)}if(this.lngRange){var _=this.x,y=u.x/2;_-y<s&&(n=s+y),_+y>l&&(n=l-y)}void 0===n&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==n?n:this.x,void 0!==i?i:this.y))),this._unmodified=c,this._constraining=!1}},Kr.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,r=Math.PI/2+this._pitch,n=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-r-e),i=this.x,o=this.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance),s=new Float64Array(16);t.perspective(s,this._fov,this.width/this.height,1,a),t.scale(s,s,[1,-1,1]),t.translate(s,s,[0,0,-this.cameraToCenterDistance]),t.rotateX(s,s,this._pitch),t.rotateZ(s,s,this.angle),t.translate(s,s,[-i,-o,0]),this.mercatorMatrix=t.scale([],s,[this.worldSize,this.worldSize,this.worldSize]);var l=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));t.scale(s,s,[1,1,l,1]),this.projMatrix=s;var u=this.width%2/2,c=this.height%2/2,h=Math.cos(this.angle),p=Math.sin(this.angle),d=i-Math.round(i)+h*u+p*c,f=o-Math.round(o)+h*c+p*u,m=new Float64Array(s);if(t.translate(m,m,[d>.5?d-1:d,f>.5?f-1:f,0]),this.alignedProjMatrix=m,s=t.create(),t.scale(s,s,[this.width/2,-this.height/2,1]),t.translate(s,s,[1,-1,0]),this.pixelMatrix=t.multiply(new Float64Array(16),s,this.projMatrix),!(s=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=s,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Kr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)).zoomTo(this.zoom),r=[e.column*this.tileSize,e.row*this.tileSize,0,1];return t.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(Kr.prototype,Jr);var Qr=function(){var e,r,n,i;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),r=!1,n=0,i=function(){n=0,r&&(e(),n=setTimeout(i,300),r=!1)},function(){return r=!0,n||i(),n})};Qr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Qr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Qr.prototype.getHashString=function(t){var e=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+o+"/"+a+"/"+r:"#"+r+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},Qr.prototype._onHashChange=function(){var e=t.window.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},Qr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.window.history.replaceState(t.window.history.state,"",e)};var $r=function(e){function n(n,i,o,a){void 0===a&&(a={});var s=r.mousePos(i.getCanvasContainer(),o),l=i.unproject(s);e.call(this,n,t.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),tn=function(e){function n(n,i,o){var a=r.touchPos(i.getCanvasContainer(),o),s=a.map(function(t){return i.unproject(t)}),l=a.reduce(function(t,e,r,n){return t.add(e.div(n.length))},new t.Point(0,0)),u=i.unproject(l);e.call(this,n,{points:a,point:l,lngLats:s,lngLat:u,originalEvent:o}),this._defaultPrevented=!1}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),en=function(t){function e(e,r,n){t.call(this,e,{originalEvent:n}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,r),e}(t.Event),rn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};rn.prototype.isEnabled=function(){return!!this._enabled},rn.prototype.isActive=function(){return!!this._active},rn.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},rn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rn.prototype.onWheel=function(e){if(this.isEnabled()){var r=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,n=t.browser.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this.isActive()||this._start(e)),e.preventDefault()}},rn.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},rn.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var n=r.mousePos(this._el,e);this._around=F.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},rn.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:r.zoom,s=this._startZoom,l=this._easing,u=!1;if("wheel"===this._type&&s&&l){var c=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),h=l(c);r.zoom=t.number(s,a,h),c<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):u=!0}else r.zoom=a,u=!0;r.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),u&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},rn.prototype._smoothOutEasing=function(e){var r=t.ease;if(this._prevEase){var n=this._prevEase,i=(t.browser.now()-n.start)/n.duration,o=n.easing(i+.01)-n.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:r},r};var nn=function(e,r){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1,t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};nn.prototype.isEnabled=function(){return!!this._enabled},nn.prototype.isActive=function(){return!!this._active},nn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},nn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},nn.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.window.document.addEventListener("mousemove",this._onMouseMove,!1),t.window.document.addEventListener("keydown",this._onKeyDown,!1),t.window.document.addEventListener("mouseup",this._onMouseUp,!1),r.disableDrag(),this._startPos=this._lastPos=r.mousePos(this._el,e),this._active=!0)},nn.prototype._onMouseMove=function(t){var e=r.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var n=this._startPos;this._lastPos=e,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(n.x,e.x),o=Math.max(n.x,e.x),a=Math.min(n.y,e.y),s=Math.max(n.y,e.y);r.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},nn.prototype._onMouseUp=function(e){if(0===e.button){var n=this._startPos,i=r.mousePos(this._el,e);this._finish(),r.suppressClick(),n.x===i.x&&n.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitScreenCoordinates(n,i,this._map.getBearing(),{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e}))}},nn.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},nn.prototype._finish=function(){this._active=!1,t.window.document.removeEventListener("mousemove",this._onMouseMove,!1),t.window.document.removeEventListener("keydown",this._onKeyDown,!1),t.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},nn.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,{originalEvent:r}))};var on=t.bezier(0,0,.25,1),an=function(e,r){this._map=e,this._el=r.element||e.getCanvasContainer(),this._state="disabled",this._button=r.button||"right",this._bearingSnap=r.bearingSnap||0,this._pitchWithRotate=!1!==r.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};an.prototype.isEnabled=function(){return"disabled"!==this._state},an.prototype.isActive=function(){return"active"===this._state},an.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},an.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},an.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=r.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==r.mouseButton(e))return;this._eventButton=0}r.disableDrag(),t.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("mouseup",this._onMouseUp),t.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=r.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},an.prototype._onMouseMove=function(t){var e=r.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},an.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var r=this._map.transform,n=this._startPos,i=this._lastPos,o=.8*(n.x-i.x),a=-.5*(n.y-i.y),s=r.bearing-o,l=r.pitch-a,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([t.browser.now(),this._map._normalizeBearing(s,c[1])]),r.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),r.pitch=l),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._startPos=this._lastPos}},an.prototype._onMouseUp=function(t){if(r.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",r.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},an.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},an.prototype._unbind=function(){t.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("mouseup",this._onMouseUp),t.window.removeEventListener("blur",this._onBlur),r.enableDrag()},an.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},an.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var r=this._map,n=r.getBearing(),i=this._inertia,o=function(){Math.abs(n)<e._bearingSnap?r.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],l=i[i.length-2],u=r._normalizeBearing(n,l[1]),c=s[1]-a[1],h=c<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==c&&0!==p){var d=Math.abs(c*(.25/p));d>180&&(d=180);var f=d/180;u+=h*d*(f/2),Math.abs(r._normalizeBearing(u,0))<this._bearingSnap&&(u=r._normalizeBearing(0,u)),r.rotateTo(u,{duration:1e3*f,easing:on,noMoveStart:!0},{originalEvent:t})}else o()}},an.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},an.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>0&&r-e[0][0]>160;)e.shift()};var sn=t.bezier(0,0,.3,1),ln=function(e,r){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",this._clickTolerance=r.clickTolerance||1,t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};ln.prototype.isEnabled=function(){return"disabled"!==this._state},ln.prototype.isActive=function(){return"active"===this._state},ln.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},ln.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},ln.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==r.mouseButton(e)||(r.addEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),r.addEventListener(t.window.document,"mouseup",this._onMouseUp),this._start(e)))},ln.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(r.addEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),r.addEventListener(t.window.document,"touchend",this._onTouchEnd),this._start(e)))},ln.prototype._start=function(e){t.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=r.mousePos(this._el,e),this._inertia=[[t.browser.now(),this._startPos]]},ln.prototype._onMove=function(e){e.preventDefault();var n=r.mousePos(this._el,e);this._lastPos.equals(n)||"pending"===this._state&&n.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=n,this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},ln.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._startPos=this._lastPos,delete this._lastMoveEvent}},ln.prototype._onMouseUp=function(t){if(0===r.mouseButton(t))switch(this._state){case"active":this._state="enabled",r.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},ln.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},ln.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},ln.prototype._unbind=function(){r.removeEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),r.removeEventListener(t.window.document,"touchend",this._onTouchEnd),r.removeEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),r.removeEventListener(t.window.document,"mouseup",this._onMouseUp),r.removeEventListener(t.window,"blur",this._onBlur)},ln.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},ln.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var r=e[e.length-1],n=e[0],i=r[1].sub(n[1]),o=(r[0]-n[0])/1e3;if(0===o||r[1].equals(n[1]))this._fireEvent("moveend",t);else{var a=i.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var l=s/750,u=a.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:sn,noMoveStart:!0},{originalEvent:t})}}},ln.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},ln.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>0&&r-e[0][0]>160;)e.shift()};var un=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function cn(t){return t*(2-t)}un.prototype.isEnabled=function(){return!!this._enabled},un.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},un.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},un.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,r=0,n=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?n=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),l={duration:300,delayEndEvents:500,easing:cn,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*r,pitch:a.getPitch()+10*n,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}};var hn=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};hn.prototype.isEnabled=function(){return!!this._enabled},hn.prototype.isActive=function(){return!!this._active},hn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},hn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},hn.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},hn.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},hn.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},hn.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var pn=t.bezier(0,0,.15,1),dn=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};dn.prototype.isEnabled=function(){return!!this._enabled},dn.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},dn.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},dn.prototype.disableRotation=function(){this._rotationDisabled=!0},dn.prototype.enableRotation=function(){this._rotationDisabled=!1},dn.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var n=r.mousePos(this._el,e.touches[0]),i=r.mousePos(this._el,e.touches[1]),o=n.add(i).div(2);this._startVec=n.sub(i),this._startAround=this._map.transform.pointLocation(o),this._gestureIntent=void 0,this._inertia=[],r.addEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),r.addEventListener(t.window.document,"touchend",this._onEnd)}},dn.prototype._getTouchEventData=function(t){var e=r.mousePos(this._el,t.touches[0]),n=r.mousePos(this._el,t.touches[1]),i=e.sub(n);return{vec:i,center:e.add(n).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},dn.prototype._onMove=function(e){if(2===e.touches.length){var r=this._getTouchEventData(e),n=r.vec,i=r.scale,o=r.bearing;if(!this._gestureIntent){var a=Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=n)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},dn.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var r=this._map.transform;this._startScale||(this._startScale=r.scale,this._startBearing=r.bearing);var n=this._getTouchEventData(this._lastTouchEvent),i=n.center,o=n.bearing,a=n.scale,s=r.pointLocation(i),l=r.locationPoint(s);"rotate"===e&&(r.bearing=this._startBearing+o),r.zoom=r.scaleZoom(this._startScale*a),r.setLocationAtPoint(this._startAround,l),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),a,i])}},dn.prototype._onEnd=function(e){r.removeEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),r.removeEventListener(t.window.document,"touchend",this._onEnd);var n=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,n){this._map.fire(new t.Event(n+"end",{originalEvent:e})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:e});else{var s=o[o.length-1],l=o[0],u=a.transform.scaleZoom(i*s[1]),c=a.transform.scaleZoom(i*l[1]),h=u-c,p=(s[0]-l[0])/1e3,d=s[2];if(0!==p&&u!==c){var f=.15*h/p;Math.abs(f)>2.5&&(f=f>0?2.5:-2.5);var m=1e3*Math.abs(f/(12*.15)),_=u+f*m/2e3;_<0&&(_=0),a.easeTo({zoom:_,duration:m,easing:pn,around:this._aroundCenter?a.getCenter():a.unproject(d),noMoveStart:!0},{originalEvent:e})}else a.snapToNorth({},{originalEvent:e})}}},dn.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,r=t.browser.now();e.length>2&&r-e[0][0]>160;)e.shift()};var fn={scrollZoom:rn,boxZoom:nn,dragRotate:an,dragPan:ln,keyboard:un,doubleClickZoom:hn,touchZoomRotate:dn},mn=function(e){function r(r,n){e.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getCenter=function(){return this.transform.center},r.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},r.prototype.panBy=function(e,r,n){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},r),n)},r.prototype.panTo=function(e,r,n){return this.easeTo(t.extend({center:e},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},r.prototype.zoomTo=function(e,r,n){return this.easeTo(t.extend({zoom:e},r),n)},r.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},r.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},r.prototype.rotateTo=function(e,r,n){return this.easeTo(t.extend({bearing:e},r),n)},r.prototype.resetNorth=function(e,r){return this.rotateTo(0,t.extend({duration:1e3},e),r),this},r.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},r.prototype.cameraForBounds=function(t,e){return t=N.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,e)},r.prototype._cameraForBoxAndBearing=function(e,r,n,i){if("number"==typeof(i=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var o=i.padding;i.padding={top:o,bottom:o,right:o,left:o}}if(t.isEqual(Object.keys(i.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){var a=[(i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2],s=Math.min(i.padding.right,i.padding.left),l=Math.min(i.padding.top,i.padding.bottom);i.offset=[i.offset[0]+a[0],i.offset[1]+a[1]];var u=this.transform,c=u.project(F.convert(e)),h=u.project(F.convert(r)),p=c.rotate(-n*Math.PI/180),d=h.rotate(-n*Math.PI/180),f=new t.Point(Math.max(p.x,d.x),Math.max(p.y,d.y)),m=new t.Point(Math.min(p.x,d.x),Math.min(p.y,d.y)),_=t.Point.convert(i.offset),y=f.sub(m),g=(u.width-2*s-2*Math.abs(_.x))/y.x,v=(u.height-2*l-2*Math.abs(_.y))/y.y;if(!(v<0||g<0))return i.center=u.unproject(c.add(h).div(2)),i.zoom=Math.min(u.scaleZoom(u.scale*Math.min(g,v)),i.maxZoom),i.bearing=n,i;t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},r.prototype.fitBounds=function(t,e,r){return this._fitInternal(this.cameraForBounds(t,e),e,r)},r.prototype.fitScreenCoordinates=function(e,r,n,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(r)),n,i),i,o)},r.prototype._fitInternal=function(e,r,n){return e?(r=t.extend(e,r)).linear?this.easeTo(r,n):this.flyTo(r,n):this},r.prototype.jumpTo=function(e,r){this.stop();var n=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(i=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=F.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(o=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.pitch=+e.pitch),this.fire(new t.Event("movestart",r)).fire(new t.Event("move",r)),i&&this.fire(new t.Event("zoomstart",r)).fire(new t.Event("zoom",r)).fire(new t.Event("zoomend",r)),o&&this.fire(new t.Event("rotatestart",r)).fire(new t.Event("rotate",r)).fire(new t.Event("rotateend",r)),a&&this.fire(new t.Event("pitchstart",r)).fire(new t.Event("pitch",r)).fire(new t.Event("pitchend",r)),this.fire(new t.Event("moveend",r))},r.prototype.easeTo=function(e,r){var n=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=i.centerPoint.add(t.Point.convert(e.offset)),p=i.pointLocation(h),d=F.convert(e.center||p);this._normalizeCenter(d);var f,m,_=i.project(p),y=i.project(d).sub(_),g=i.zoomScale(l-o);return e.around&&(f=F.convert(e.around),m=i.locationPoint(f)),this._zooming=l!==o,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(r,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(n._zooming&&(i.zoom=t.number(o,l,e)),n._rotating&&(i.bearing=t.number(a,u,e)),n._pitching&&(i.pitch=t.number(s,c,e)),f)i.setLocationAtPoint(f,m);else{var p=i.zoomScale(i.zoom-o),d=l>o?Math.min(2,g):Math.max(.5,g),v=Math.pow(d,1-e),b=i.unproject(_.add(y.mult(e*v)).mult(p));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,h)}n._fireMoveEvents(r)},function(){e.delayEndEvents?n._easeEndTimeoutID=setTimeout(function(){return n._afterEase(r)},e.delayEndEvents):n._afterEase(r)},e),this},r.prototype._prepareEase=function(e,r){this._moving=!0,r||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},r.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},r.prototype._afterEase=function(e){var r=this._zooming,n=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,r&&this.fire(new t.Event("zoomend",e)),n&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},r.prototype.flyTo=function(e,r){var n=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=i.zoomScale(l-o),p=i.centerPoint.add(t.Point.convert(e.offset)),d=i.pointLocation(p),f=F.convert(e.center||d);this._normalizeCenter(f);var m=i.project(d),_=i.project(f).sub(m),y=e.curve,g=Math.max(i.width,i.height),v=g/h,b=_.mag();if("minZoom"in e){var x=t.clamp(Math.min(e.minZoom,o,l),i.minZoom,i.maxZoom),w=g/i.zoomScale(x-o);y=Math.sqrt(w/b*2)}var k=y*y;function E(t){var e=(v*v-g*g+(t?-1:1)*k*k*b*b)/(2*(t?v:g)*k*b);return Math.log(Math.sqrt(e*e+1)-e)}function I(t){return(Math.exp(t)-Math.exp(-t))/2}function S(t){return(Math.exp(t)+Math.exp(-t))/2}var M=E(0),T=function(t){return S(M)/S(M+y*t)},A=function(t){return g*((S(M)*(I(e=M+y*t)/S(e))-I(M))/k)/b;var e},P=(E(1)-M)/y;if(Math.abs(b)<1e-6||!isFinite(P)){if(Math.abs(g-v)<1e-6)return this.easeTo(e,r);var C=v<g?-1:1;P=Math.abs(Math.log(v/g))/y,A=function(){return 0},T=function(t){return Math.exp(C*y*t)}}if("duration"in e)e.duration=+e.duration;else{var D="screenSpeed"in e?+e.screenSpeed/y:+e.speed;e.duration=1e3*P/D}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(r,!1),this._ease(function(e){var h=e*P,d=1/T(h);i.zoom=1===e?l:o+i.scaleZoom(d),n._rotating&&(i.bearing=t.number(a,u,e)),n._pitching&&(i.pitch=t.number(s,c,e));var y=1===e?f:i.unproject(m.add(_.mult(A(h))).mult(d));i.setLocationAtPoint(i.renderWorldCopies?y.wrap():y,p),n._fireMoveEvents(r)},function(){return n._afterEase(r)},e),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},r.prototype._ease=function(e,r,n){!1===n.animate||0===n.duration?(e(1),r()):(this._easeStart=t.browser.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(e,r){e=t.wrap(e,-180,180);var n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e},r.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}},r}(t.Evented),_n=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};_n.prototype.getDefaultPosition=function(){return"bottom-right"},_n.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_n.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},_n.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:h.ACCESS_TOKEN}];if(t){var r=e.reduce(function(t,r,n){return r.value&&(t+=r.key+"="+r.value+(n<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+r+(this._map._hash?this._map._hash.getHashString(!0):"")}},_n.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},_n.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var r=this._map.style.sourceCaches;for(var n in r){var i=r[n].getSource();i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution)}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,r){for(var n=r+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},_n.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var yn=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};yn.prototype.onAdd=function(t){this._map=t,this._container=r.create("div","mapboxgl-ctrl");var e=r.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},yn.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},yn.prototype.getDefaultPosition=function(){return"bottom-left"},yn.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},yn.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},yn.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var gn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};gn.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},gn.prototype.remove=function(t){for(var e=this._currentlyRunning,r=0,n=e?this._queue.concat(e):this._queue;r<n.length;r+=1){var i=n[r];if(i.id===t)return void(i.cancelled=!0)}},gn.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,r=t;e<r.length;e+=1){var n=r[e];if(!n.cancelled&&(n.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},gn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var vn=t.window.HTMLImageElement,bn=t.window.HTMLElement,xn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},wn=function(n){function i(e){var i=this;if(null!=(e=t.extend({},xn,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var o=new Kr(e.minZoom,e.maxZoom,e.renderWorldCopies);n.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new gn,this._controls=[];var a=e.transformRequest;if(this._transformRequest=a?function(t,e){return a(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof bn))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return i._update(!1)}),this.on("zoom",function(){return i._update(!0)}),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var n=t.getCanvasContainer(),i=null,o=!1,a=null;for(var s in fn)t[s]=new fn[s](t,e),e.interactive&&e[s]&&t[s].enable(e[s]);r.addEventListener(n,"mouseout",function(e){t.fire(new $r("mouseout",t,e))}),r.addEventListener(n,"mousedown",function(i){o=!0,a=r.mousePos(n,i);var s=new $r("mousedown",t,i);t.fire(s),s.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))}),r.addEventListener(n,"mouseup",function(e){var r=t.dragRotate.isActive();i&&!r&&t.fire(new $r("contextmenu",t,i)),i=null,o=!1,t.fire(new $r("mouseup",t,e))}),r.addEventListener(n,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var r=e.target;r&&r!==n;)r=r.parentNode;r===n&&t.fire(new $r("mousemove",t,e))}}),r.addEventListener(n,"mouseover",function(e){for(var r=e.target;r&&r!==n;)r=r.parentNode;r===n&&t.fire(new $r("mouseover",t,e))}),r.addEventListener(n,"touchstart",function(r){var n=new tn("touchstart",t,r);t.fire(n),n.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(r),t.touchZoomRotate.onStart(r),t.doubleClickZoom.onTouchStart(n))},{passive:!1}),r.addEventListener(n,"touchmove",function(e){t.fire(new tn("touchmove",t,e))},{passive:!1}),r.addEventListener(n,"touchend",function(e){t.fire(new tn("touchend",t,e))}),r.addEventListener(n,"touchcancel",function(e){t.fire(new tn("touchcancel",t,e))}),r.addEventListener(n,"click",function(i){var o=r.mousePos(n,i);(o.equals(a)||o.dist(a)<e.clickTolerance)&&t.fire(new $r("click",t,i))}),r.addEventListener(n,"dblclick",function(e){var r=new $r("dblclick",t,e);t.fire(r),r.defaultPrevented||t.doubleClickZoom.onDblClick(r)}),r.addEventListener(n,"contextmenu",function(e){var r=t.dragRotate.isActive();o||r?o&&(i=e):t.fire(new $r("contextmenu",t,e)),e.preventDefault()}),r.addEventListener(n,"wheel",function(r){e.interactive&&t.stop();var n=new en("wheel",t,r);t.fire(n),n.defaultPrevented||t.scrollZoom.onWheel(r)},{passive:!1})}(this,e),this._hash=e.hash&&(new Qr).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new _n({customAttribution:e.customAttribution})),this.addControl(new yn,e.logoPosition),this.on("style.load",function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)}),this.on("data",function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))}),this.on("dataloading",function(e){i.fire(new t.Event(e.dataType+"dataloading",e))})}n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i;var o={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return i.prototype.addControl=function(e,r){if(void 0===r&&e.getDefaultPosition&&(r=e.getDefaultPosition()),void 0===r&&(r="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this},i.prototype.resize=function(e){var r=this._containerDimensions(),n=r[0],i=r[1];return this._resizeCanvas(n,i),this.transform.resize(n,i),this.painter.resize(n,i),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(N.convert(t)),this._update()},i.prototype.setMinZoom=function(t){if((t=null===t||void 0===t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null===t||void 0===t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.project=function(t){return this.transform.locationPoint(F.convert(t))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,r){var i,o=this;if(void 0===r)return n.prototype.on.call(this,t,e);var a=function(){if("mouseenter"===t||"mouseover"===t){var n=!1;return{layer:e,listener:r,delegates:{mousemove:function(i){var a=o.getLayer(e)?o.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?n||(n=!0,r.call(o,new $r(t,o,i.originalEvent,{features:a}))):n=!1},mouseout:function(){n=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:r,delegates:{mousemove:function(n){(o.getLayer(e)?o.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,r.call(o,new $r(t,o,n.originalEvent)))},mouseout:function(e){a&&(a=!1,r.call(o,new $r(t,o,e.originalEvent)))}}}}return{layer:e,listener:r,delegates:(i={},i[t]=function(t){var n=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];n.length&&(t.features=n,r.call(o,t),delete t.features)},i)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},i.prototype.off=function(t,e,r){if(void 0===r)return n.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],o=0;o<i.length;o++){var a=i[o];if(a.layer===e&&a.listener===r){for(var s in a.delegates)this.off(s,a.delegates[s]);return i.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,r){if(!this.style)return[];var n;if(void 0!==r||void 0===e||e instanceof t.Point||Array.isArray(e)||(r=e,e=void 0),r=r||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])n=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);n=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(n,r,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,r){if((!r||!1!==r.diff&&!r.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new We(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var r=t[e]._tiles;for(var n in r){var i=r[n];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,r){return this.style.addSourceType(t,e,r)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,r,n){void 0===n&&(n={});var i=n.pixelRatio;void 0===i&&(i=1);var o=n.sdf;if(void 0===o&&(o=!1),r instanceof vn){var a=t.browser.getImageData(r),s=a.width,l=a.height,u=a.data;this.style.addImage(e,{data:new t.RGBAImage({width:s,height:l},u),pixelRatio:i,sdf:o})}else{if(void 0===r.width||void 0===r.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=r.width,h=r.height,p=r.data;this.style.addImage(e,{data:new t.RGBAImage({width:c,height:h},new Uint8Array(p)),pixelRatio:i,sdf:o})}},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,r){t.getImage(this._transformRequest(e,t.ResourceType.Image),r)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0)},i.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,r){return this.style.setPaintProperty(t,e,r),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,r){return this.style.setLayoutProperty(t,e,r),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=r.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var i=this._controlContainer=r.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=r.create("div","mapboxgl-ctrl-"+t,i)})},i.prototype._resizeCanvas=function(e,r){var n=t.window.devicePixelRatio||1;this._canvas.width=n*e,this._canvas.height=n*r,this._canvas.style.width=e+"px",this._canvas.style.height=r+"px"},i.prototype._setupPainter=function(){var r=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?this.painter=new Xr(n,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var r=this.transform.zoom,n=t.browser.now();this.style.zoomHistory.update(r,n);var i=new t.EvaluationParameters(r,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=i.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this.triggerRepaint(),this},i.prototype.remove=function(){this._hash&&this._hash.remove(),this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));for(var e=0,r=this._controls;e<r.length;e+=1)r[e].onRemove(this);this._controls=[];var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),kn(this._canvasContainer),kn(this._controlContainer),kn(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame(function(){e._frame=null,e._render()}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint=t,this._update()},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},Object.defineProperties(i.prototype,o),i}(mn);function kn(t){t.parentNode&&t.parentNode.removeChild(t)}var En={showCompass:!0,showZoom:!0},In=function(e){var n=this;this.options=t.extend({},En,e),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return n._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return n._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return n._map.resetNorth()}),this._compassArrow=r.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function Sn(t,e,r){if(t=new F(t.lng,t.lat),e){var n=new F(t.lng-360,t.lat),i=new F(t.lng+360,t.lat),o=r.locationPoint(t).distSqr(e);r.locationPoint(n).distSqr(e)<o?t=n:r.locationPoint(i).distSqr(e)<o&&(t=i)}for(;Math.abs(t.lng-r.center.lng)>180;){var a=r.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=r.width&&a.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}In.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},In.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new an(t,{button:"left",element:this._compass}),r.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},In.prototype.onRemove=function(){r.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),r.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},In.prototype._createButton=function(t,e,n){var i=r.create("button",t,this._container);return i.type="button",i.setAttribute("aria-label",e),i.addEventListener("click",n),i};var Mn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Tn(t,e,r){var n=t.classList;for(var i in Mn)n.remove("mapboxgl-"+r+"-anchor-"+i);n.add("mapboxgl-"+r+"-anchor-"+e)}var An,Pn=function(e){function n(n){if(e.call(this),(arguments[0]instanceof t.window.HTMLElement||2===arguments.length)&&(n=t.extend({element:n},arguments[1])),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._draggable=n&&n.draggable||!1,this._state="inactive",n&&n.element)this._element=n.element,this._offset=t.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div");var i=r.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var o=r.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var l=0,u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<u.length;l+=1){var c=u[l],h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",c.rx),h.setAttributeNS(null,"ry",c.ry),s.appendChild(h)}var p=r.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var d=r.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),p.appendChild(d);var f=r.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var m=r.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(m);var _=r.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_.setAttributeNS(null,"fill","#FFFFFF");var y=r.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=r.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var v=r.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),y.appendChild(g),y.appendChild(v),a.appendChild(s),a.appendChild(p),a.appendChild(f),a.appendChild(_),a.appendChild(y),i.appendChild(a),this._element.appendChild(i),this._offset=t.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},n.prototype.getElement=function(){return this._element},n.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},n.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},n.prototype.getPopup=function(){return this._popup},n.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},n.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=Sn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),r.setTransform(this._element,Mn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),Tn(this._element,this._anchor,"marker"))},n.prototype.getOffset=function(){return this._offset},n.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},n.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},n.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},n.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},n.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},n.prototype.isDraggable=function(){return this._draggable},n}(t.Evented),Cn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Dn=function(e){function n(r){e.call(this),this.options=t.extend({},Cn,r),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(e){var n;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==An?n(An):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(function(t){An="denied"!==t.state,n(An)}):(An=!!t.window.navigator.geolocation,n(An)),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),r.remove(this._container),this._map=void 0},n.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},n.prototype._updateCamera=function(t){var e=new F(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy;this._map.fitBounds(e.toBounds(r),this.options.fitBoundsOptions,{geolocateSource:!0})},n.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},n.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(e){var n=this;!1!==e?(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=r.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Pn(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==n._watchState||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new t.Event("trackuserlocationend")))})):t.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},n.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n}(t.Evented),zn={maxWidth:100,unit:"metric"},Bn=function(e){this.options=t.extend({},zn,e),t.bindAll(["_onMove","setUnit"],this)};function Ln(t,e,r){var n,i,o,a,s,l,u=r&&r.maxWidth||100,c=t._container.clientHeight/2,h=(n=t.unproject([0,c]),i=t.unproject([u,c]),o=Math.PI/180,a=n.lat*o,s=i.lat*o,l=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((i.lng-n.lng)*o),6371e3*Math.acos(Math.min(l,1)));if(r&&"imperial"===r.unit){var p=3.2808*h;p>5280?Rn(e,u,p/5280,"mi"):Rn(e,u,p,"ft")}else r&&"nautical"===r.unit?Rn(e,u,h/1852,"nm"):Rn(e,u,h,"m")}function Rn(t,e,r,n){var i,o,a,s=(i=r,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:1)),l=s/r;"m"===n&&s>=1e3&&(s/=1e3,n="km"),t.style.width=e*l+"px",t.innerHTML=s+n}Bn.prototype.getDefaultPosition=function(){return"bottom-left"},Bn.prototype._onMove=function(){Ln(this._map,this._container,this.options)},Bn.prototype.onAdd=function(t){return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Bn.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Bn.prototype.setUnit=function(t){this.options.unit=t,Ln(this._map,this._container,this.options)};var On=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};On.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=r.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},On.prototype.onRemove=function(){r.remove(this._container),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},On.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},On.prototype._setupUI=function(){var e=this._fullscreenButton=r.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},On.prototype._isFullscreen=function(){return this._fullscreen},On.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},On.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Fn={closeButton:!0,closeOnClick:!0,className:""},Nn=function(e){function n(r){e.call(this),this.options=t.extend(Object.create(Fn),r),t.bindAll(["_update","_onClickClose"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._update(),this},n.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},n.prototype.setHTML=function(e){var r,n=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;r=i.firstChild;)n.appendChild(r);return this.setDOMContent(n)},n.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},n.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},n.prototype._update=function(){var e=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)})),this._map.transform.renderWorldCopies&&(this._lngLat=Sn(this._lngLat,this._pos,this._map.transform));var n=this._pos=this._map.project(this._lngLat),i=this.options.anchor,o=function e(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new t.Point(0,0),top:new t.Point(0,r),"top-left":new t.Point(n,n),"top-right":new t.Point(-n,n),bottom:new t.Point(0,-r),"bottom-left":new t.Point(n,-n),"bottom-right":new t.Point(-n,-n),left:new t.Point(r,0),right:new t.Point(-r,0)}}if(r instanceof t.Point||Array.isArray(r)){var i=t.Point.convert(r);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(r.center||[0,0]),top:t.Point.convert(r.top||[0,0]),"top-left":t.Point.convert(r["top-left"]||[0,0]),"top-right":t.Point.convert(r["top-right"]||[0,0]),bottom:t.Point.convert(r.bottom||[0,0]),"bottom-left":t.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(r["bottom-right"]||[0,0]),left:t.Point.convert(r.left||[0,0]),right:t.Point.convert(r.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!i){var a,s=this._container.offsetWidth,l=this._container.offsetHeight;a=n.y+o.bottom.y<l?["top"]:n.y>this._map.transform.height-l?["bottom"]:[],n.x<s/2?a.push("left"):n.x>this._map.transform.width-s/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}var u=n.add(o[i]).round();r.setTransform(this._container,Mn[i]+" translate("+u.x+"px,"+u.y+"px)"),Tn(this._container,i,"popup")}},n.prototype._onClickClose=function(){this.remove()},n}(t.Evented),Vn={version:"0.50.0-beta.1",supported:e,setRTLTextPlugin:t.setRTLTextPlugin,Map:wn,NavigationControl:In,GeolocateControl:Dn,AttributionControl:_n,ScaleControl:Bn,FullscreenControl:On,Popup:Nn,Marker:Pn,Style:We,LngLat:F,LngLatBounds:N,Point:t.Point,Evented:t.Evented,config:h,get accessToken(){return h.ACCESS_TOKEN},set accessToken(t){h.ACCESS_TOKEN=t},get workerCount(){return Ht.workerCount},set workerCount(t){Ht.workerCount=t},workerUrl:""};return Vn}),r}()},function(t,e,r){var n=r(3),i=r(2).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){var n=r(8),i=r(2),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(32)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){e.f=r(5)},function(t,e,r){var n=r(62)("keys"),i=r(31);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var n=r(23);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(2).document;t.exports=n&&n.documentElement},function(t,e,r){var n=r(3),i=r(4),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=r(21)(Function.call,r(18).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,r){var n=r(3),i=r(68).set;t.exports=function(t,e,r){var o,a=e.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&n(o)&&i&&i(t,o),t}},function(t,e,r){"use strict";var n=r(25),i=r(24);t.exports=function(t){var e=String(i(this)),r="",o=n(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(r+=e);return r}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,e,r){"use strict";var n=r(32),i=r(0),o=r(11),a=r(14),s=r(40),l=r(102),u=r(39),c=r(37),h=r(5)("iterator"),p=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,r,f,m,_,y){l(r,e,f);var g,v,b,x=function(t){if(!p&&t in I)return I[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},w=e+" Iterator",k="values"==m,E=!1,I=t.prototype,S=I[h]||I["@@iterator"]||m&&I[m],M=S||x(m),T=m?k?x("entries"):M:void 0,A="Array"==e&&I.entries||S;if(A&&(b=c(A.call(new t)))!==Object.prototype&&b.next&&(u(b,w,!0),n||"function"==typeof b[h]||a(b,h,d)),k&&S&&"values"!==S.name&&(E=!0,M=function(){return S.call(this)}),n&&!y||!p&&!E&&I[h]||a(I,h,M),s[e]=M,s[w]=d,m)if(g={values:k?M:x("values"),keys:_?M:x("keys"),entries:T},y)for(v in g)v in I||o(I,v,g[v]);else i(i.P+i.F*(p||E),e,g);return g}},function(t,e,r){var n=r(76),i=r(24);t.exports=function(t,e,r){if(n(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,e,r){var n=r(3),i=r(23),o=r(5)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,r){var n=r(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,r){var n=r(40),i=r(5)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[i]===t)}},function(t,e,r){"use strict";var n=r(6),i=r(30);t.exports=function(t,e,r){e in t?n.f(t,e,i(0,r)):t[e]=r}},function(t,e,r){var n=r(51),i=r(5)("iterator"),o=r(40);t.exports=r(8).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[n(t)]}},function(t,e,r){"use strict";var n=r(16),i=r(34),o=r(9);t.exports=function(t){for(var e=n(this),r=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),l=a>2?arguments[2]:void 0,u=void 0===l?r:i(l,r);u>s;)e[s++]=t;return e}},function(t,e,r){"use strict";var n=r(41),i=r(106),o=r(40),a=r(15);t.exports=r(74)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,r){"use strict";var n=r(4);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,r){var n,i,o,a=r(21),s=r(95),l=r(67),u=r(61),c=r(2),h=c.process,p=c.setImmediate,d=c.clearImmediate,f=c.MessageChannel,m=c.Dispatch,_=0,y={},g=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},v=function(t){g.call(t.data)};p&&d||(p=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return y[++_]=function(){s("function"==typeof t?t:Function(t),e)},n(_),_},d=function(t){delete y[t]},"process"==r(23)(h)?n=function(t){h.nextTick(a(g,t,1))}:m&&m.now?n=function(t){m.now(a(g,t,1))}:f?(o=(i=new f).port2,i.port1.onmessage=v,n=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",v,!1)):n="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),g.call(t)}}:function(t){setTimeout(a(g,t,1),0)}),t.exports={set:p,clear:d}},function(t,e,r){"use strict";var n=r(2),i=r(7),o=r(32),a=r(59),s=r(14),l=r(44),u=r(1),c=r(43),h=r(25),p=r(9),d=r(113),f=r(36).f,m=r(6).f,_=r(81),y=r(39),g="prototype",v="Wrong index!",b=n.ArrayBuffer,x=n.DataView,w=n.Math,k=n.RangeError,E=n.Infinity,I=b,S=w.abs,M=w.pow,T=w.floor,A=w.log,P=w.LN2,C=i?"_b":"buffer",D=i?"_l":"byteLength",z=i?"_o":"byteOffset";function B(t,e,r){var n,i,o,a=new Array(r),s=8*r-e-1,l=(1<<s)-1,u=l>>1,c=23===e?M(2,-24)-M(2,-77):0,h=0,p=t<0||0===t&&1/t<0?1:0;for((t=S(t))!=t||t===E?(i=t!=t?1:0,n=l):(n=T(A(t)/P),t*(o=M(2,-n))<1&&(n--,o*=2),(t+=n+u>=1?c/o:c*M(2,1-u))*o>=2&&(n++,o/=2),n+u>=l?(i=0,n=l):n+u>=1?(i=(t*o-1)*M(2,e),n+=u):(i=t*M(2,u-1)*M(2,e),n=0));e>=8;a[h++]=255&i,i/=256,e-=8);for(n=n<<e|i,s+=e;s>0;a[h++]=255&n,n/=256,s-=8);return a[--h]|=128*p,a}function L(t,e,r){var n,i=8*r-e-1,o=(1<<i)-1,a=o>>1,s=i-7,l=r-1,u=t[l--],c=127&u;for(u>>=7;s>0;c=256*c+t[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=e;s>0;n=256*n+t[l],l--,s-=8);if(0===c)c=1-a;else{if(c===o)return n?NaN:u?-E:E;n+=M(2,e),c-=a}return(u?-1:1)*n*M(2,c-e)}function R(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function O(t){return[255&t]}function F(t){return[255&t,t>>8&255]}function N(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function V(t){return B(t,52,8)}function j(t){return B(t,23,4)}function U(t,e,r){m(t[g],e,{get:function(){return this[r]}})}function q(t,e,r,n){var i=d(+r);if(i+e>t[D])throw k(v);var o=t[C]._b,a=i+t[z],s=o.slice(a,a+e);return n?s:s.reverse()}function G(t,e,r,n,i,o){var a=d(+r);if(a+e>t[D])throw k(v);for(var s=t[C]._b,l=a+t[z],u=n(+i),c=0;c<e;c++)s[l+c]=u[o?c:e-c-1]}if(a.ABV){if(!u(function(){b(1)})||!u(function(){new b(-1)})||u(function(){return new b,new b(1.5),new b(NaN),"ArrayBuffer"!=b.name})){for(var Z,X=(b=function(t){return c(this,b),new I(d(t))})[g]=I[g],W=f(I),H=0;W.length>H;)(Z=W[H++])in b||s(b,Z,I[Z]);o||(X.constructor=b)}var Y=new x(new b(2)),K=x[g].setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||l(x[g],{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else b=function(t){c(this,b,"ArrayBuffer");var e=d(t);this._b=_.call(new Array(e),0),this[D]=e},x=function(t,e,r){c(this,x,"DataView"),c(t,b,"DataView");var n=t[D],i=h(e);if(i<0||i>n)throw k("Wrong offset!");if(i+(r=void 0===r?n-i:p(r))>n)throw k("Wrong length!");this[C]=t,this[z]=i,this[D]=r},i&&(U(b,"byteLength","_l"),U(x,"buffer","_b"),U(x,"byteLength","_l"),U(x,"byteOffset","_o")),l(x[g],{getInt8:function(t){return q(this,1,t)[0]<<24>>24},getUint8:function(t){return q(this,1,t)[0]},getInt16:function(t){var e=q(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=q(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return R(q(this,4,t,arguments[1]))},getUint32:function(t){return R(q(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return L(q(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return L(q(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){G(this,1,t,O,e)},setUint8:function(t,e){G(this,1,t,O,e)},setInt16:function(t,e){G(this,2,t,F,e,arguments[2])},setUint16:function(t,e){G(this,2,t,F,e,arguments[2])},setInt32:function(t,e){G(this,4,t,N,e,arguments[2])},setUint32:function(t,e){G(this,4,t,N,e,arguments[2])},setFloat32:function(t,e){G(this,4,t,j,e,arguments[2])},setFloat64:function(t,e){G(this,8,t,V,e,arguments[2])}});y(b,"ArrayBuffer"),y(x,"DataView"),s(x[g],a.VIEW,!0),e.ArrayBuffer=b,e.DataView=x},function(t){t.exports=[{resource:{display_name:"from_1495_to_1500 test_clean3 Polygon",id:3668}},{resource:{display_name:"from_1503_to_1504 test_clean3 Polygon",id:3674}},{resource:{display_name:"from_1649_to_1650 test_clean3 Polygon",id:3871}},{resource:{display_name:"from_1873_to_1874 test_clean3 Polygon",id:3732}},{resource:{display_name:"from_1847_to_1849 test_clean3 Polygon",id:3688}},{resource:{display_name:"from_1818_to_1819 test_clean3 Polygon",id:4029}},{resource:{display_name:"from_1673_to_1678 test_clean3 Polygon",id:3903}},{resource:{display_name:"from_1596_to_1597 test_clean3 Polygon",id:3805}},{resource:{display_name:"from_1933_to_1939 test_clean3 Polygon",id:3612}},{resource:{display_name:"from_1584_to_1586 test_clean3 Polygon",id:3795}},{resource:{display_name:"from_1992_to_2004 test_clean3 Polygon",id:3638}},{resource:{display_name:"from_1864_to_1865 test_clean3 Polygon",id:3714}},{resource:{display_name:"from_1800_to_1801 test_clean3 Polygon",id:3995}},{resource:{display_name:"from_1742_to_1743 test_clean3 Polygon",id:3953}},{resource:{display_name:"from_1637_to_1638 test_clean3 Polygon",id:3851}},{resource:{display_name:"from_2014_to_2018 test_clean3 Polygon",id:3644}},{resource:{display_name:"from_1842_to_1844 test_clean3 Polygon",id:4059}},{resource:{display_name:"from_1605_to_1607 test_clean3 Polygon",id:3817}},{resource:{display_name:"from_1472_to_1478 test_clean3 Polygon",id:3652}},{resource:{display_name:"from_1727_to_1728 test_clean3 Polygon",id:3937}},{resource:{display_name:"from_1740_to_1741 test_clean3 Polygon",id:3949}},{resource:{display_name:"from_1831_to_1832 test_clean3 Polygon",id:4053}},{resource:{display_name:"from_1858_to_1859 test_clean3 Polygon",id:3704}},{resource:{display_name:"from_1509_to_1510 test_clean3 Polygon",id:3682}},{resource:{display_name:"from_2004_to_2005 test_clean3 Polygon",id:3640}},{resource:{display_name:"from_1918_to_1919 test_clean3 Polygon",id:3590}},{resource:{display_name:"from_1796_to_1797 test_clean3 Polygon",id:3989}},{resource:{display_name:"from_1914_to_1915 test_clean3 Polygon",id:3586}},{resource:{display_name:"from_1667_to_1668 test_clean3 Polygon",id:3895}},{resource:{display_name:"from_1945_to_1946 test_clean3 Polygon",id:3622}},{resource:{display_name:"from_1595_to_1596 test_clean3 Polygon",id:3803}},{resource:{display_name:"from_1494_to_1495 test_clean3 Polygon",id:3666}},{resource:{display_name:"from_1697_to_1698 test_clean3 Polygon",id:3911}},{resource:{display_name:"from_1822_to_1823 test_clean3 Polygon",id:4037}},{resource:{display_name:"from_1833_to_1842 test_clean3 Polygon",id:4057}},{resource:{display_name:"from_1923_to_1924 test_clean3 Polygon",id:3600}},{resource:{display_name:"from_1610_to_1617 test_clean3 Polygon",id:3823}},{resource:{display_name:"from_1656_to_1657 test_clean3 Polygon",id:3883}},{resource:{display_name:"from_1925_to_1926 test_clean3 Polygon",id:3604}},{resource:{display_name:"from_1629_to_1630 test_clean3 Polygon",id:3835}},{resource:{display_name:"from_1812_to_1813 test_clean3 Polygon",id:4019}},{resource:{display_name:"from_1594_to_1595 test_clean3 Polygon",id:3801}},{resource:{display_name:"from_1641_to_1642 test_clean3 Polygon",id:3859}},{resource:{display_name:"from_1867_to_1868 test_clean3 Polygon",id:3720}},{resource:{display_name:"from_1859_to_1860 test_clean3 Polygon",id:3706}},{resource:{display_name:"from_1671_to_1672 test_clean3 Polygon",id:3899}},{resource:{display_name:"from_1471_to_1472 test_clean3 Polygon",id:3650}},{resource:{display_name:"from_1809_to_1810 test_clean3 Polygon",id:4013}},{resource:{display_name:"from_1832_to_1833 test_clean3 Polygon",id:4055}},{resource:{display_name:"from_1640_to_1641 test_clean3 Polygon",id:3857}},{resource:{display_name:"from_1821_to_1822 test_clean3 Polygon",id:4035}},{resource:{display_name:"from_1898_to_1905 test_clean3 Polygon",id:3758}},{resource:{display_name:"from_1711_to_1712 test_clean3 Polygon",id:3925}},{resource:{display_name:"from_1636_to_1637 test_clean3 Polygon",id:3849}},{resource:{display_name:"from_1521_to_1522 test_clean3 Polygon",id:3760}},{resource:{display_name:"from_1952_to_1955 test_clean3 Polygon",id:3632}},{resource:{display_name:"from_1703_to_1709 test_clean3 Polygon",id:3919}},{resource:{display_name:"from_1947_to_1949 test_clean3 Polygon",id:3626}},{resource:{display_name:"from_1849_to_1850 test_clean3 Polygon",id:3690}},{resource:{display_name:"from_1807_to_1808 test_clean3 Polygon",id:4009}},{resource:{display_name:"from_1856_to_1857 test_clean3 Polygon",id:3700}},{resource:{display_name:"from_1599_to_1600 test_clean3 Polygon",id:3809}},{resource:{display_name:"from_1915_to_1918 test_clean3 Polygon",id:3588}},{resource:{display_name:"from_1483_to_1484 test_clean3 Polygon",id:3656}},{resource:{display_name:"from_1930_to_1932 test_clean3 Polygon",id:3608}},{resource:{display_name:"from_1779_to_1783 test_clean3 Polygon",id:3973}},{resource:{display_name:"from_1854_to_1855 test_clean3 Polygon",id:3696}},{resource:{display_name:"from_1926_to_1930 test_clean3 Polygon",id:3606}},{resource:{display_name:"from_1538_to_1551 test_clean3 Polygon",id:3768}},{resource:{display_name:"from_1607_to_1608 test_clean3 Polygon",id:3819}},{resource:{display_name:"from_1678_to_1679 test_clean3 Polygon",id:3905}},{resource:{display_name:"from_1642_to_1643 test_clean3 Polygon",id:3861}},{resource:{display_name:"from_1601_to_1604 test_clean3 Polygon",id:3813}},{resource:{display_name:"from_1597_to_1599 test_clean3 Polygon",id:3807}},{resource:{display_name:"from_1484_to_1485 test_clean3 Polygon",id:3658}},{resource:{display_name:"from_1922_to_1923 test_clean3 Polygon",id:3598}},{resource:{display_name:"from_1869_to_1870 test_clean3 Polygon",id:3724}},{resource:{display_name:"from_1652_to_1653 test_clean3 Polygon",id:3875}},{resource:{display_name:"from_1820_to_1821 test_clean3 Polygon",id:4033}},{resource:{display_name:"from_1630_to_1631 test_clean3 Polygon",id:3837}},{resource:{display_name:"from_1791_to_1792 test_clean3 Polygon",id:3979}},{resource:{display_name:"from_1638_to_1639 test_clean3 Polygon",id:3853}},{resource:{display_name:"from_1617_to_1618 test_clean3 Polygon",id:3825}},{resource:{display_name:"from_1920_to_1921 test_clean3 Polygon",id:3594}},{resource:{display_name:"from_1657_to_1661 test_clean3 Polygon",id:3885}},{resource:{display_name:"from_1793_to_1794 test_clean3 Polygon",id:3983}},{resource:{display_name:"from_1801_to_1802 test_clean3 Polygon",id:3997}},{resource:{display_name:"from_1743_to_1744 test_clean3 Polygon",id:3955}},{resource:{display_name:"from_1761_to_1771 test_clean3 Polygon",id:3959}},{resource:{display_name:"from_1731_to_1732 test_clean3 Polygon",id:3941}},{resource:{display_name:"from_1709_to_1710 test_clean3 Polygon",id:3921}},{resource:{display_name:"from_1647_to_1648 test_clean3 Polygon",id:3867}},{resource:{display_name:"from_1872_to_1873 test_clean3 Polygon",id:3730}},{resource:{display_name:"from_1583_to_1584 test_clean3 Polygon",id:3793}},{resource:{display_name:"from_1672_to_1673 test_clean3 Polygon",id:3901}},{resource:{display_name:"from_1722_to_1723 test_clean3 Polygon",id:3931}},{resource:{display_name:"from_1564_to_1572 test_clean3 Polygon",id:3784}},{resource:{display_name:"from_1844_to_1845 test_clean3 Polygon",id:4061}},{resource:{display_name:"from_1876_to_1877 test_clean3 Polygon",id:3738}},{resource:{display_name:"from_1635_to_1636 test_clean3 Polygon",id:3847}},{resource:{display_name:"from_1808_to_1809 test_clean3 Polygon",id:4011}},{resource:{display_name:"from_1911_to_1913 test_clean3 Polygon",id:3582}},{resource:{display_name:"from_1846_to_1847 test_clean3 Polygon",id:3686}},{resource:{display_name:"from_1563_to_1564 test_clean3 Polygon",id:3782}},{resource:{display_name:"from_1866_to_1867 test_clean3 Polygon",id:3718}},{resource:{display_name:"from_1816_to_1818 test_clean3 Polygon",id:4027}},{resource:{display_name:"from_1555_to_1556 test_clean3 Polygon",id:3776}},{resource:{display_name:"from_1939_to_1940 test_clean3 Polygon",id:3614}},{resource:{display_name:"from_1783_to_1784 test_clean3 Polygon",id:3975}},{resource:{display_name:"from_1700_to_1701 test_clean3 Polygon",id:3915}},{resource:{display_name:"from_1631_to_1632 test_clean3 Polygon",id:3839}},{resource:{display_name:"from_1895_to_1896 test_clean3 Polygon",id:3754}},{resource:{display_name:"from_1723_to_1725 test_clean3 Polygon",id:3933}},{resource:{display_name:"from_1881_to_1882 test_clean3 Polygon",id:3746}},{resource:{display_name:"from_1921_to_1922 test_clean3 Polygon",id:3596}},{resource:{display_name:"from_1478_to_1483 test_clean3 Polygon",id:3654}},{resource:{display_name:"from_1792_to_1793 test_clean3 Polygon",id:3981}},{resource:{display_name:"from_1507_to_1508 test_clean3 Polygon",id:3678}},{resource:{display_name:"from_1721_to_1722 test_clean3 Polygon",id:3929}},{resource:{display_name:"from_1878_to_1879 test_clean3 Polygon",id:3742}},{resource:{display_name:"from_1845_to_1846 test_clean3 Polygon",id:4063}},{resource:{display_name:"from_1668_to_1671 test_clean3 Polygon",id:3897}},{resource:{display_name:"from_1728_to_1731 test_clean3 Polygon",id:3939}},{resource:{display_name:"from_1712_to_1721 test_clean3 Polygon",id:3927}},{resource:{display_name:"from_1487_to_1489 test_clean3 Polygon",id:3662}},{resource:{display_name:"from_1825_to_1826 test_clean3 Polygon",id:4041}},{resource:{display_name:"from_1628_to_1629 test_clean3 Polygon",id:3833}},{resource:{display_name:"from_1861_to_1862 test_clean3 Polygon",id:3710}},{resource:{display_name:"from_1744_to_1761 test_clean3 Polygon",id:3957}},{resource:{display_name:"from_1814_to_1815 test_clean3 Polygon",id:4023}},{resource:{display_name:"from_1632_to_1633 test_clean3 Polygon",id:3841}},{resource:{display_name:"from_1604_to_1605 test_clean3 Polygon",id:3815}},{resource:{display_name:"from_1666_to_1667 test_clean3 Polygon",id:3893}},{resource:{display_name:"from_1905_to_1906 test_clean3 Polygon",id:3576}},{resource:{display_name:"from_1896_to_1898 test_clean3 Polygon",id:3756}},{resource:{display_name:"from_1774_to_1775 test_clean3 Polygon",id:3967}},{resource:{display_name:"from_1655_to_1656 test_clean3 Polygon",id:3881}},{resource:{display_name:"from_1826_to_1827 test_clean3 Polygon",id:4043}},{resource:{display_name:"from_1772_to_1773 test_clean3 Polygon",id:3963}},{resource:{display_name:"from_1874_to_1875 test_clean3 Polygon",id:3734}},{resource:{display_name:"from_1732_to_1735 test_clean3 Polygon",id:3943}},{resource:{display_name:"from_1577_to_1582 test_clean3 Polygon",id:3788}},{resource:{display_name:"from_1650_to_1652 test_clean3 Polygon",id:3873}},{resource:{display_name:"from_1870_to_1871 test_clean3 Polygon",id:3726}},{resource:{display_name:"from_1643_to_1644 test_clean3 Polygon",id:3863}},{resource:{display_name:"from_1865_to_1866 test_clean3 Polygon",id:3716}},{resource:{display_name:"from_1810_to_1811 test_clean3 Polygon",id:4015}},{resource:{display_name:"from_1906_to_1908 test_clean3 Polygon",id:3578}},{resource:{display_name:"from_1827_to_1828 test_clean3 Polygon",id:4045}},{resource:{display_name:"from_1857_to_1858 test_clean3 Polygon",id:3702}},{resource:{display_name:"from_1582_to_1583 test_clean3 Polygon",id:3790}},{resource:{display_name:"from_1815_to_1816 test_clean3 Polygon",id:4025}},{resource:{display_name:"from_1828_to_1829 test_clean3 Polygon",id:4047}},{resource:{display_name:"from_1462_to_1464 test_clean3 Polygon",id:3646}},{resource:{display_name:"from_1591_to_1594 test_clean3 Polygon",id:3799}},{resource:{display_name:"from_1773_to_1774 test_clean3 Polygon",id:3965}},{resource:{display_name:"from_1951_to_1952 test_clean3 Polygon",id:3630}},{resource:{display_name:"from_1806_to_1807 test_clean3 Polygon",id:4007}},{resource:{display_name:"from_1775_to_1777 test_clean3 Polygon",id:3969}},{resource:{display_name:"from_1502_to_1503 test_clean3 Polygon",id:3672}},{resource:{display_name:"from_1932_to_1933 test_clean3 Polygon",id:3610}},{resource:{display_name:"from_1799_to_1800 test_clean3 Polygon",id:3993}},{resource:{display_name:"from_1664_to_1666 test_clean3 Polygon",id:3891}},{resource:{display_name:"from_1639_to_1640 test_clean3 Polygon",id:3855}},{resource:{display_name:"from_1803_to_1804 test_clean3 Polygon",id:4001}},{resource:{display_name:"from_1508_to_1509 test_clean3 Polygon",id:3680}},{resource:{display_name:"from_1946_to_1947 test_clean3 Polygon",id:3624}},{resource:{display_name:"from_1710_to_1711 test_clean3 Polygon",id:3923}},{resource:{display_name:"from_1510_to_1521 test_clean3 Polygon",id:3684}},{resource:{display_name:"from_1944_to_1945 test_clean3 Polygon",id:3620}},{resource:{display_name:"from_1771_to_1772 test_clean3 Polygon",id:3961}},{resource:{display_name:"from_1485_to_1487 test_clean3 Polygon",id:3660}},{resource:{display_name:"from_1813_to_1814 test_clean3 Polygon",id:4021}},{resource:{display_name:"from_1804_to_1805 test_clean3 Polygon",id:4003}},{resource:{display_name:"from_1504_to_1507 test_clean3 Polygon",id:3676}},{resource:{display_name:"from_1829_to_1830 test_clean3 Polygon",id:4049}},{resource:{display_name:"from_1557_to_1563 test_clean3 Polygon",id:3780}},{resource:{display_name:"from_1619_to_1620 test_clean3 Polygon",id:3829}},{resource:{display_name:"from_1940_to_1941 test_clean3 Polygon",id:3616}},{resource:{display_name:"from_1908_to_1911 test_clean3 Polygon",id:3580}},{resource:{display_name:"from_1662_to_1664 test_clean3 Polygon",id:3889}},{resource:{display_name:"from_1654_to_1655 test_clean3 Polygon",id:3879}},{resource:{display_name:"from_1811_to_1812 test_clean3 Polygon",id:4017}},{resource:{display_name:"from_1875_to_1876 test_clean3 Polygon",id:3736}},{resource:{display_name:"from_1805_to_1806 test_clean3 Polygon",id:4005}},{resource:{display_name:"from_1879_to_1881 test_clean3 Polygon",id:3744}},{resource:{display_name:"from_1886_to_1895 test_clean3 Polygon",id:3752}},{resource:{display_name:"from_1551_to_1552 test_clean3 Polygon",id:3770}},{resource:{display_name:"from_1862_to_1864 test_clean3 Polygon",id:3712}},{resource:{display_name:"from_1648_to_1649 test_clean3 Polygon",id:3869}},{resource:{display_name:"from_1955_to_1991 test_clean3 Polygon",id:3634}},{resource:{display_name:"from_1794_to_1795 test_clean3 Polygon",id:3985}},{resource:{display_name:"from_1553_to_1555 test_clean3 Polygon",id:3774}},{resource:{display_name:"from_1661_to_1662 test_clean3 Polygon",id:3887}},{resource:{display_name:"from_1701_to_1703 test_clean3 Polygon",id:3917}},{resource:{display_name:"from_1860_to_1861 test_clean3 Polygon",id:3708}},{resource:{display_name:"from_1653_to_1654 test_clean3 Polygon",id:3877}},{resource:{display_name:"from_1679_to_1689 test_clean3 Polygon",id:3907}},{resource:{display_name:"from_1949_to_1951 test_clean3 Polygon",id:3628}},{resource:{display_name:"from_1739_to_1740 test_clean3 Polygon",id:3947}},{resource:{display_name:"from_1991_to_1992 test_clean3 Polygon",id:3636}},{resource:{display_name:"from_1523_to_1537 test_clean3 Polygon",id:3764}},{resource:{display_name:"from_1689_to_1697 test_clean3 Polygon",id:3909}},{resource:{display_name:"from_1633_to_1634 test_clean3 Polygon",id:3843}},{resource:{display_name:"from_1868_to_1869 test_clean3 Polygon",id:3722}},{resource:{display_name:"from_1777_to_1779 test_clean3 Polygon",id:3971}},{resource:{display_name:"from_1941_to_1944 test_clean3 Polygon",id:3618}},{resource:{display_name:"from_1582_to_1583 test_clean3 Polygon(1)",id:3791}},{resource:{display_name:"from_1608_to_1610 test_clean3 Polygon",id:3821}},{resource:{display_name:"from_1913_to_1914 test_clean3 Polygon",id:3584}},{resource:{display_name:"from_1877_to_1878 test_clean3 Polygon",id:3740}},{resource:{display_name:"from_1823_to_1825 test_clean3 Polygon",id:4039}},{resource:{display_name:"from_1644_to_1647 test_clean3 Polygon",id:3865}},{resource:{display_name:"from_1556_to_1557 test_clean3 Polygon",id:3778}},{resource:{display_name:"from_1924_to_1925 test_clean3 Polygon",id:3602}},{resource:{display_name:"from_1871_to_1872 test_clean3 Polygon",id:3728}},{resource:{display_name:"from_1855_to_1856 test_clean3 Polygon",id:3698}},{resource:{display_name:"from_1618_to_1619 test_clean3 Polygon",id:3827}},{resource:{display_name:"from_1797_to_1799 test_clean3 Polygon",id:3991}},{resource:{display_name:"from_1552_to_1553 test_clean3 Polygon",id:3772}},{resource:{display_name:"from_1802_to_1803 test_clean3 Polygon",id:3999}},{resource:{display_name:"from_1795_to_1796 test_clean3 Polygon",id:3987}},{resource:{display_name:"from_1919_to_1920 test_clean3 Polygon",id:3592}},{resource:{display_name:"from_1819_to_1820 test_clean3 Polygon",id:4031}},{resource:{display_name:"from_1500_to_1502 test_clean3 Polygon",id:3670}},{resource:{display_name:"from_1882_to_1885 test_clean3 Polygon",id:3748}},{resource:{display_name:"from_1735_to_1739 test_clean3 Polygon",id:3945}},{resource:{display_name:"from_1784_to_1791 test_clean3 Polygon",id:3977}},{resource:{display_name:"from_1537_to_1538 test_clean3 Polygon",id:3766}},{resource:{display_name:"from_1853_to_1854 test_clean3 Polygon",id:3694}},{resource:{display_name:"from_1698_to_1700 test_clean3 Polygon",id:3913}},{resource:{display_name:"from_1489_to_1494 test_clean3 Polygon",id:3664}},{resource:{display_name:"from_1830_to_1831 test_clean3 Polygon",id:4051}},{resource:{display_name:"from_1620_to_1628 test_clean3 Polygon",id:3831}},{resource:{display_name:"from_1572_to_1577 test_clean3 Polygon",id:3786}},{resource:{display_name:"from_1885_to_1886 test_clean3 Polygon",id:3750}},{resource:{display_name:"from_1741_to_1742 test_clean3 Polygon",id:3951}},{resource:{display_name:"from_1600_to_1601 test_clean3 Polygon",id:3811}},{resource:{display_name:"from_1725_to_1727 test_clean3 Polygon",id:3935}},{resource:{display_name:"from_1464_to_1471 test_clean3 Polygon",id:3648}},{resource:{display_name:"from_1850_to_1853 test_clean3 Polygon",id:3692}},{resource:{display_name:"from_1586_to_1591 test_clean3 Polygon",id:3797}},{resource:{display_name:"from_1522_to_1523 test_clean3 Polygon",id:3762}},{resource:{display_name:"from_2005_to_2014 test_clean3 Polygon",id:3642}},{resource:{display_name:"from_1634_to_1635 test_clean3 Polygon",id:3845}}]},function(t){t.exports={a:"1.2.9"}},function(t,e,r){t.exports=!r(7)&&!r(1)(function(){return 7!=Object.defineProperty(r(61)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(2),i=r(8),o=r(32),a=r(63),s=r(6).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,r){var n=r(13),i=r(15),o=r(49)(!1),a=r(64)("IE_PROTO");t.exports=function(t,e){var r,s=i(t),l=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;e.length>l;)n(s,r=e[l++])&&(~o(u,r)||u.push(r));return u}},function(t,e,r){var n=r(6),i=r(4),o=r(33);t.exports=r(7)?Object.defineProperties:function(t,e){i(t);for(var r,a=o(e),s=a.length,l=0;s>l;)n.f(t,r=a[l++],e[r]);return t}},function(t,e,r){var n=r(15),i=r(36).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(n(t))}},function(t,e,r){"use strict";var n=r(33),i=r(50),o=r(47),a=r(16),s=r(46),l=Object.assign;t.exports=!l||r(1)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=l({},t)[r]||Object.keys(l({},e)).join("")!=n})?function(t,e){for(var r=a(t),l=arguments.length,u=1,c=i.f,h=o.f;l>u;)for(var p,d=s(arguments[u++]),f=c?n(d).concat(c(d)):n(d),m=f.length,_=0;m>_;)h.call(d,p=f[_++])&&(r[p]=d[p]);return r}:l},function(t,e,r){"use strict";var n=r(22),i=r(3),o=r(95),a=[].slice,s={};t.exports=Function.bind||function(t){var e=n(this),r=a.call(arguments,1),l=function(){var n=r.concat(a.call(arguments));return this instanceof l?function(t,e,r){if(!(e in s)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";s[e]=Function("F,a","return new F("+n.join(",")+")")}return s[e](t,r)}(e,n.length,n):o(e,n,t)};return i(e.prototype)&&(l.prototype=e.prototype),l}},function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var n=r(2).parseInt,i=r(52).trim,o=r(69),a=/^[-+]?0[xX]/;t.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(t,e){var r=i(String(t),3);return n(r,e>>>0||(a.test(r)?16:10))}:n},function(t,e,r){var n=r(2).parseFloat,i=r(52).trim;t.exports=1/n(r(69)+"-0")!=-1/0?function(t){var e=i(String(t),3),r=n(e);return 0===r&&"-"==e.charAt(0)?-0:r}:n},function(t,e,r){var n=r(23);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},function(t,e,r){var n=r(3),i=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,r){var n=r(25),i=r(24);t.exports=function(t){return function(e,r){var o,a,s=String(i(e)),l=n(r),u=s.length;return l<0||l>=u?t?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(t,e,r){"use strict";var n=r(35),i=r(30),o=r(39),a={};r(14)(a,r(5)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(a,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e,r){var n=r(4);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,r){var n=r(22),i=r(16),o=r(46),a=r(9);t.exports=function(t,e,r,s,l){n(e);var u=i(t),c=o(u),h=a(u.length),p=l?h-1:0,d=l?-1:1;if(r<2)for(;;){if(p in c){s=c[p],p+=d;break}if(p+=d,l?p<0:h<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:h>p;p+=d)p in c&&(s=e(s,c[p],p,u));return s}},function(t,e,r){"use strict";var n=r(16),i=r(34),o=r(9);t.exports=[].copyWithin||function(t,e){var r=n(this),a=o(r.length),s=i(t,a),l=i(e,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:i(u,a))-l,a-s),h=1;for(l<s&&s<l+c&&(h=-1,l+=c-1,s+=c-1);c-- >0;)l in r?r[s]=r[l]:delete r[s],s+=h,l+=h;return r}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){r(7)&&"g"!=/./g.flags&&r(6).f(RegExp.prototype,"flags",{configurable:!0,get:r(83)})},function(t,e,r){"use strict";var n,i,o,a,s=r(32),l=r(2),u=r(21),c=r(51),h=r(0),p=r(3),d=r(22),f=r(43),m=r(55),_=r(56),y=r(84).set,g=r(239)(),v=r(109),b=r(240),x=r(57),w=r(110),k=l.TypeError,E=l.process,I=E&&E.versions,S=I&&I.v8||"",M=l.Promise,T="process"==c(E),A=function(){},P=i=v.f,C=!!function(){try{var t=M.resolve(1),e=(t.constructor={})[r(5)("species")]=function(t){t(A,A)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(A)instanceof e&&0!==S.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),D=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},z=function(t,e){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var n=t._v,i=1==t._s,o=0,a=function(e){var r,o,a,s=i?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(i||(2==t._h&&R(t),t._h=1),!0===s?r=n:(c&&c.enter(),r=s(n),c&&(c.exit(),a=!0)),r===e.promise?u(k("Promise-chain cycle")):(o=D(r))?o.call(r,l,u):l(r)):u(n)}catch(t){c&&!a&&c.exit(),u(t)}};r.length>o;)a(r[o++]);t._c=[],t._n=!1,e&&!t._h&&B(t)})}},B=function(t){y.call(l,function(){var e,r,n,i=t._v,o=L(t);if(o&&(e=b(function(){T?E.emit("unhandledRejection",i,t):(r=l.onunhandledrejection)?r({promise:t,reason:i}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",i)}),t._h=T||L(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},R=function(t){y.call(l,function(){var e;T?E.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},O=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),z(e,!0))},F=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw k("Promise can't be resolved itself");(e=D(t))?g(function(){var n={_w:r,_d:!1};try{e.call(t,u(F,n,1),u(O,n,1))}catch(t){O.call(n,t)}}):(r._v=t,r._s=1,z(r,!1))}catch(t){O.call({_w:r,_d:!1},t)}}};C||(M=function(t){f(this,M,"Promise","_h"),d(t),n.call(this);try{t(u(F,this,1),u(O,this,1))}catch(t){O.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(M.prototype,{then:function(t,e){var r=P(_(this,M));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=T?E.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&z(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=u(F,t,1),this.reject=u(O,t,1)},v.f=P=function(t){return t===M||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!C,{Promise:M}),r(39)(M,"Promise"),r(42)("Promise"),a=r(8).Promise,h(h.S+h.F*!C,"Promise",{reject:function(t){var e=P(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!C),"Promise",{resolve:function(t){return w(s&&this===a?M:this,t)}}),h(h.S+h.F*!(C&&r(53)(function(t){M.all(t).catch(A)})),"Promise",{all:function(t){var e=this,r=P(e),n=r.resolve,i=r.reject,o=b(function(){var r=[],o=0,a=1;m(t,!1,function(t){var s=o++,l=!1;r.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,r[s]=t,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=P(e),n=r.reject,i=b(function(){m(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(t,e,r){"use strict";var n=r(22);t.exports.f=function(t){return new function(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=n(e),this.reject=n(r)}(t)}},function(t,e,r){var n=r(4),i=r(3),o=r(109);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var r=o.f(t);return(0,r.resolve)(e),r.promise}},function(t,e,r){"use strict";var n=r(6).f,i=r(35),o=r(44),a=r(21),s=r(43),l=r(55),u=r(74),c=r(106),h=r(42),p=r(7),d=r(28).fastKey,f=r(45),m=p?"_s":"size",_=function(t,e){var r,n=d(e);if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,u){var c=t(function(t,n){s(t,c,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=n&&l(n,r,t[u],t)});return o(c.prototype,{clear:function(){for(var t=f(this,e),r=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var r=f(this,e),n=_(r,t);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[m]--}return!!n},forEach:function(t){f(this,e);for(var r,n=a(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!_(f(this,e),t)}}),p&&n(c.prototype,"size",{get:function(){return f(this,e)[m]}}),c},def:function(t,e,r){var n,i,o=_(t,e);return o?o.v=r:(t._l=o={i:i=d(e,!0),k:e,v:r,p:n=t._l,n:void 0,r:!1},t._f||(t._f=o),n&&(n.n=o),t[m]++,"F"!==i&&(t._i[i]=o)),t},getEntry:_,setStrong:function(t,e,r){u(t,e,function(t,r){this._t=f(t,e),this._k=r,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},r?"entries":"values",!r,!0),h(e)}}},function(t,e,r){"use strict";var n=r(44),i=r(28).getWeak,o=r(4),a=r(3),s=r(43),l=r(55),u=r(20),c=r(13),h=r(45),p=u(5),d=u(6),f=0,m=function(t){return t._l||(t._l=new _)},_=function(){this.a=[]},y=function(t,e){return p(t.a,function(t){return t[0]===e})};_.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var r=y(this,t);r?r[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,r,o){var u=t(function(t,n){s(t,u,e,"_i"),t._t=e,t._i=f++,t._l=void 0,void 0!=n&&l(n,r,t[o],t)});return n(u.prototype,{delete:function(t){if(!a(t))return!1;var r=i(t);return!0===r?m(h(this,e)).delete(t):r&&c(r,this._i)&&delete r[this._i]},has:function(t){if(!a(t))return!1;var r=i(t);return!0===r?m(h(this,e)).has(t):r&&c(r,this._i)}}),u},def:function(t,e,r){var n=i(o(e),!0);return!0===n?m(t).set(e,r):n[t._i]=r,t},ufstore:m}},function(t,e,r){var n=r(25),i=r(9);t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length!");return r}},function(t,e,r){var n=r(36),i=r(50),o=r(4),a=r(2).Reflect;t.exports=a&&a.ownKeys||function(t){var e=n.f(o(t)),r=i.f;return r?e.concat(r(t)):e}},function(t,e,r){var n=r(9),i=r(71),o=r(24);t.exports=function(t,e,r,a){var s=String(o(t)),l=s.length,u=void 0===r?" ":String(r),c=n(e);if(c<=l||""==u)return s;var h=c-l,p=i.call(u,Math.ceil(h/u.length));return p.length>h&&(p=p.slice(0,h)),a?p+s:s+p}},function(t,e,r){var n=r(33),i=r(15),o=r(47).f;t.exports=function(t){return function(e){for(var r,a=i(e),s=n(a),l=s.length,u=0,c=[];l>u;)o.call(a,r=s[u++])&&c.push(t?[r,a[r]]:a[r]);return c}}},function(t){t.exports={a:"2.5.0"}},function(t,e,r){var n,i,o;/*! nouislider - 12.0.0 - 9/14/2018 */i=[],void 0===(o="function"==typeof(n=function(){"use strict";var t="12.0.0";function e(t){return null!==t&&void 0!==t}function r(t){t.preventDefault()}function n(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function i(t,e,r){r>0&&(l(t,e),setTimeout(function(){u(t,e)},r))}function o(t){return Math.max(Math.min(t,100),0)}function a(t){return Array.isArray(t)?t:[t]}function s(t){var e=(t=String(t)).split(".");return e.length>1?e[1].length:0}function l(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function u(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function c(t){var e=void 0!==window.pageXOffset,r="CSS1Compat"===(t.compatMode||""),n=e?window.pageXOffset:r?t.documentElement.scrollLeft:t.body.scrollLeft,i=e?window.pageYOffset:r?t.documentElement.scrollTop:t.body.scrollTop;return{x:n,y:i}}function h(t,e){return 100/(e-t)}function p(t,e){return 100*e/(t[1]-t[0])}function d(t,e){for(var r=1;t>=e[r];)r+=1;return r}function f(t,e,r){if(r>=t.slice(-1)[0])return 100;var n=d(r,t),i=t[n-1],o=t[n],a=e[n-1],s=e[n];return a+function(t,e){return p(t,t[0]<0?e+Math.abs(t[0]):e-t[0])}([i,o],r)/h(a,s)}function m(t,e,r,n){if(100===n)return n;var i=d(n,t),o=t[i-1],a=t[i];return r?n-o>(a-o)/2?a:o:e[i-1]?t[i-1]+function(t,e){return Math.round(t/e)*e}(n-t[i-1],e[i-1]):n}function _(e,r,i){var o;if("number"==typeof r&&(r=[r]),!Array.isArray(r))throw new Error("noUiSlider ("+t+"): 'range' contains invalid value.");if(!n(o="min"===e?0:"max"===e?100:parseFloat(e))||!n(r[0]))throw new Error("noUiSlider ("+t+"): 'range' value isn't numeric.");i.xPct.push(o),i.xVal.push(r[0]),o?i.xSteps.push(!isNaN(r[1])&&r[1]):isNaN(r[1])||(i.xSteps[0]=r[1]),i.xHighestCompleteStep.push(0)}function y(t,e,r){if(!e)return!0;r.xSteps[t]=p([r.xVal[t],r.xVal[t+1]],e)/h(r.xPct[t],r.xPct[t+1]);var n=(r.xVal[t+1]-r.xVal[t])/r.xNumSteps[t],i=Math.ceil(Number(n.toFixed(3))-1),o=r.xVal[t]+r.xNumSteps[t]*i;r.xHighestCompleteStep[t]=o}function g(t,e,r){var n;this.xPct=[],this.xVal=[],this.xSteps=[r||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e;var i=[];for(n in t)t.hasOwnProperty(n)&&i.push([t[n],n]);for(i.length&&"object"==typeof i[0][0]?i.sort(function(t,e){return t[0][0]-e[0][0]}):i.sort(function(t,e){return t[0]-e[0]}),n=0;n<i.length;n++)_(i[n][1],i[n][0],this);for(this.xNumSteps=this.xSteps.slice(0),n=0;n<this.xNumSteps.length;n++)y(n,this.xNumSteps[n],this)}g.prototype.getMargin=function(e){var r=this.xNumSteps[0];if(r&&e/r%1!=0)throw new Error("noUiSlider ("+t+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length&&p(this.xVal,e)},g.prototype.toStepping=function(t){return t=f(this.xVal,this.xPct,t)},g.prototype.fromStepping=function(t){return function(t,e,r){if(r>=100)return t.slice(-1)[0];var n=d(r,e),i=t[n-1],o=t[n],a=e[n-1],s=e[n];return function(t,e){return e*(t[1]-t[0])/100+t[0]}([i,o],(r-a)*h(a,s))}(this.xVal,this.xPct,t)},g.prototype.getStep=function(t){return t=m(this.xPct,this.xSteps,this.snap,t)},g.prototype.getNearbySteps=function(t){var e=d(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},g.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(s);return Math.max.apply(null,t)},g.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var v={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};function b(e){if(function(t){return"object"==typeof t&&"function"==typeof t.to&&"function"==typeof t.from}(e))return!0;throw new Error("noUiSlider ("+t+"): 'format' requires 'to' and 'from' methods.")}function x(e,r){if(!n(r))throw new Error("noUiSlider ("+t+"): 'step' is not numeric.");e.singleStep=r}function w(e,r){if("object"!=typeof r||Array.isArray(r))throw new Error("noUiSlider ("+t+"): 'range' is not an object.");if(void 0===r.min||void 0===r.max)throw new Error("noUiSlider ("+t+"): Missing 'min' or 'max' in 'range'.");if(r.min===r.max)throw new Error("noUiSlider ("+t+"): 'range' 'min' and 'max' cannot be equal.");e.spectrum=new g(r,e.snap,e.singleStep)}function k(e,r){if(r=a(r),!Array.isArray(r)||!r.length)throw new Error("noUiSlider ("+t+"): 'start' option is incorrect.");e.handles=r.length,e.start=r}function E(e,r){if(e.snap=r,"boolean"!=typeof r)throw new Error("noUiSlider ("+t+"): 'snap' option must be a boolean.")}function I(e,r){if(e.animate=r,"boolean"!=typeof r)throw new Error("noUiSlider ("+t+"): 'animate' option must be a boolean.")}function S(e,r){if(e.animationDuration=r,"number"!=typeof r)throw new Error("noUiSlider ("+t+"): 'animationDuration' option must be a number.")}function M(e,r){var n,i=[!1];if("lower"===r?r=[!0,!1]:"upper"===r&&(r=[!1,!0]),!0===r||!1===r){for(n=1;n<e.handles;n++)i.push(r);i.push(!1)}else{if(!Array.isArray(r)||!r.length||r.length!==e.handles+1)throw new Error("noUiSlider ("+t+"): 'connect' option doesn't match handle count.");i=r}e.connect=i}function T(e,r){switch(r){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider ("+t+"): 'orientation' option is invalid.")}}function A(e,r){if(!n(r))throw new Error("noUiSlider ("+t+"): 'margin' option must be numeric.");if(0!==r&&(e.margin=e.spectrum.getMargin(r),!e.margin))throw new Error("noUiSlider ("+t+"): 'margin' option is only supported on linear sliders.")}function P(e,r){if(!n(r))throw new Error("noUiSlider ("+t+"): 'limit' option must be numeric.");if(e.limit=e.spectrum.getMargin(r),!e.limit||e.handles<2)throw new Error("noUiSlider ("+t+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function C(e,r){if(!n(r)&&!Array.isArray(r))throw new Error("noUiSlider ("+t+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(r)&&2!==r.length&&!n(r[0])&&!n(r[1]))throw new Error("noUiSlider ("+t+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==r){if(Array.isArray(r)||(r=[r,r]),e.padding=[e.spectrum.getMargin(r[0]),e.spectrum.getMargin(r[1])],!1===e.padding[0]||!1===e.padding[1])throw new Error("noUiSlider ("+t+"): 'padding' option is only supported on linear sliders.");if(e.padding[0]<0||e.padding[1]<0)throw new Error("noUiSlider ("+t+"): 'padding' option must be a positive number(s).");if(e.padding[0]+e.padding[1]>=100)throw new Error("noUiSlider ("+t+"): 'padding' option must not exceed 100% of the range.")}}function D(e,r){switch(r){case"ltr":e.dir=0;break;case"rtl":e.dir=1;break;default:throw new Error("noUiSlider ("+t+"): 'direction' option was not recognized.")}}function z(e,r){if("string"!=typeof r)throw new Error("noUiSlider ("+t+"): 'behaviour' must be a string containing options.");var n=r.indexOf("tap")>=0,i=r.indexOf("drag")>=0,o=r.indexOf("fixed")>=0,a=r.indexOf("snap")>=0,s=r.indexOf("hover")>=0;if(o){if(2!==e.handles)throw new Error("noUiSlider ("+t+"): 'fixed' behaviour must be used with 2 handles");A(e,e.start[1]-e.start[0])}e.events={tap:n||a,drag:i,fixed:o,snap:a,hover:s}}function B(e,r){if(!1!==r)if(!0===r){e.tooltips=[];for(var n=0;n<e.handles;n++)e.tooltips.push(!0)}else{if(e.tooltips=a(r),e.tooltips.length!==e.handles)throw new Error("noUiSlider ("+t+"): must pass a formatter for all handles.");e.tooltips.forEach(function(e){if("boolean"!=typeof e&&("object"!=typeof e||"function"!=typeof e.to))throw new Error("noUiSlider ("+t+"): 'tooltips' must be passed a formatter or 'false'.")})}}function L(t,e){t.ariaFormat=e,b(e)}function R(t,e){t.format=e,b(e)}function O(e,r){if(e.keyboardSupport=r,"boolean"!=typeof r)throw new Error("noUiSlider ("+t+"): 'keyboardSupport' option must be a boolean.")}function F(t,e){t.documentElement=e}function N(e,r){if("string"!=typeof r&&!1!==r)throw new Error("noUiSlider ("+t+"): 'cssPrefix' must be a string or `false`.");e.cssPrefix=r}function V(e,r){if("object"!=typeof r)throw new Error("noUiSlider ("+t+"): 'cssClasses' must be an object.");if("string"==typeof e.cssPrefix)for(var n in e.cssClasses={},r)r.hasOwnProperty(n)&&(e.cssClasses[n]=e.cssPrefix+r[n]);else e.cssClasses=r}function j(r){var n={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:v,format:v},i={step:{r:!1,t:x},start:{r:!0,t:k},connect:{r:!0,t:M},direction:{r:!0,t:D},snap:{r:!1,t:E},animate:{r:!1,t:I},animationDuration:{r:!1,t:S},range:{r:!0,t:w},orientation:{r:!1,t:T},margin:{r:!1,t:A},limit:{r:!1,t:P},padding:{r:!1,t:C},behaviour:{r:!0,t:z},ariaFormat:{r:!1,t:L},format:{r:!1,t:R},tooltips:{r:!1,t:B},keyboardSupport:{r:!0,t:O},documentElement:{r:!1,t:F},cssPrefix:{r:!0,t:N},cssClasses:{r:!0,t:V}},o={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}};r.format&&!r.ariaFormat&&(r.ariaFormat=r.format),Object.keys(i).forEach(function(a){if(!e(r[a])&&void 0===o[a]){if(i[a].r)throw new Error("noUiSlider ("+t+"): '"+a+"' is required.");return!0}i[a].t(n,e(r[a])?r[a]:o[a])}),n.pips=r.pips;var a=document.createElement("div"),s=void 0!==a.style.msTransform,l=void 0!==a.style.transform;return n.transformRule=l?"transform":s?"msTransform":"webkitTransform",n.style=[["left","top"],["right","bottom"]][n.dir][n.ort],n}function U(e,n,s){var h,p,d,f,m,_=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},y=window.CSS&&CSS.supports&&CSS.supports("touch-action","none"),g=y&&function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),v=e,b=[],x=[],w=0,k=n.spectrum,E=[],I={},S=e.ownerDocument,M=n.documentElement||S.documentElement,T=S.body,A=-1,P=0,C=1,D=2,z="rtl"===S.dir||1===n.ort?0:100;function B(t,e){var r=S.createElement("div");return e&&l(r,e),t.appendChild(r),r}function L(t,e){var r=B(t,n.cssClasses.origin),i=B(r,n.cssClasses.handle);return i.setAttribute("data-handle",e),n.keyboardSupport&&i.setAttribute("tabindex","0"),i.setAttribute("role","slider"),i.setAttribute("aria-orientation",n.ort?"vertical":"horizontal"),0===e?l(i,n.cssClasses.handleLower):e===n.handles-1&&l(i,n.cssClasses.handleUpper),r}function R(t,e){return!!e&&B(t,n.cssClasses.connect)}function O(t,e){return!!n.tooltips[e]&&B(t.firstChild,n.cssClasses.tooltip)}function F(t,e,r){var i=S.createElement("div"),o=[];o[P]=n.cssClasses.valueNormal,o[C]=n.cssClasses.valueLarge,o[D]=n.cssClasses.valueSub;var a=[];a[P]=n.cssClasses.markerNormal,a[C]=n.cssClasses.markerLarge,a[D]=n.cssClasses.markerSub;var s=[n.cssClasses.valueHorizontal,n.cssClasses.valueVertical],u=[n.cssClasses.markerHorizontal,n.cssClasses.markerVertical];function c(t,e){var r=e===n.cssClasses.value,i=r?s:u,l=r?o:a;return e+" "+i[n.ort]+" "+l[t]}return l(i,n.cssClasses.pips),l(i,0===n.ort?n.cssClasses.pipsHorizontal:n.cssClasses.pipsVertical),Object.keys(t).forEach(function(o){!function(t,o,a){if((a=e?e(o,a):a)!==A){var s=B(i,!1);s.className=c(a,n.cssClasses.marker),s.style[n.style]=t+"%",a>P&&((s=B(i,!1)).className=c(a,n.cssClasses.value),s.setAttribute("data-value",o),s.style[n.style]=t+"%",s.innerHTML=r.to(o))}}(o,t[o][0],t[o][1])}),i}function N(){m&&(function(t){t.parentElement.removeChild(t)}(m),m=null)}function V(e){N();var r=e.mode,n=e.density||1,i=e.filter||!1,o=e.values||!1,a=e.stepped||!1,s=function(e,r,n){if("range"===e||"steps"===e)return k.xVal;if("count"===e){if(r<2)throw new Error("noUiSlider ("+t+"): 'values' (>= 2) required for mode 'count'.");var i=r-1,o=100/i;for(r=[];i--;)r[i]=i*o;r.push(100),e="positions"}return"positions"===e?r.map(function(t){return k.fromStepping(n?k.getStep(t):t)}):"values"===e?n?r.map(function(t){return k.fromStepping(k.getStep(k.toStepping(t)))}):r:void 0}(r,o,a),l=function(t,e,r){function n(t,e){return(t+e).toFixed(7)/1}var i={},o=k.xVal[0],a=k.xVal[k.xVal.length-1],s=!1,l=!1,u=0;return(r=function(t){return t.filter(function(t){return!this[t]&&(this[t]=!0)},{})}(r.slice().sort(function(t,e){return t-e})))[0]!==o&&(r.unshift(o),s=!0),r[r.length-1]!==a&&(r.push(a),l=!0),r.forEach(function(o,a){var c,h,p,d,f,m,_,y,g,v,b=o,x=r[a+1],w="steps"===e;if(w&&(c=k.xNumSteps[a]),c||(c=x-b),!1!==b&&void 0!==x)for(c=Math.max(c,1e-7),h=b;h<=x;h=n(h,c)){for(y=(f=(d=k.toStepping(h))-u)/t,v=f/(g=Math.round(y)),p=1;p<=g;p+=1)i[(m=u+p*v).toFixed(5)]=[k.fromStepping(m),0];_=r.indexOf(h)>-1?C:w?D:P,!a&&s&&(_=0),h===x&&l||(i[d.toFixed(5)]=[h,_]),u=d}}),i}(n,r,s),u=e.format||{to:Math.round};return m=v.appendChild(F(l,i,u))}function U(){var t=h.getBoundingClientRect(),e="offset"+["Width","Height"][n.ort];return 0===n.ort?t.width||h[e]:t.height||h[e]}function q(t,e,r,i){var o=function(o){return!!(o=function(t,e,r){var n,i,o=0===t.type.indexOf("touch"),a=0===t.type.indexOf("mouse"),s=0===t.type.indexOf("pointer");if(0===t.type.indexOf("MSPointer")&&(s=!0),o){var l=function(t){return t.target===r||r.contains(t.target)};if("touchstart"===t.type){var u=Array.prototype.filter.call(t.touches,l);if(u.length>1)return!1;n=u[0].pageX,i=u[0].pageY}else{var h=Array.prototype.find.call(t.changedTouches,l);if(!h)return!1;n=h.pageX,i=h.pageY}}return e=e||c(S),(a||s)&&(n=t.clientX+e.x,i=t.clientY+e.y),t.pageOffset=e,t.points=[n,i],t.cursor=a||s,t}(o,i.pageOffset,i.target||e))&&!(v.hasAttribute("disabled")&&!i.doNotReject)&&!(function(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}(v,n.cssClasses.tap)&&!i.doNotReject)&&!(t===_.start&&void 0!==o.buttons&&o.buttons>1)&&(!i.hover||!o.buttons)&&(g||o.preventDefault(),o.calcPoint=o.points[n.ort],void r(o,i))},a=[];return t.split(" ").forEach(function(t){e.addEventListener(t,o,!!g&&{passive:!0}),a.push([t,o])}),a}function G(t){var e=t-function(t,e){var r=t.getBoundingClientRect(),n=t.ownerDocument,i=n.documentElement,o=c(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(o.x=0),e?r.top+o.y-i.clientTop:r.left+o.x-i.clientLeft}(h,n.ort),r=100*e/U();return r=o(r),n.dir?100-r:r}function Z(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&W(t,e)}function X(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return W(t,e);var r=(n.dir?-1:1)*(t.calcPoint-e.startCalcPoint),i=100*r/e.baseSize;rt(r>0,i,e.locations,e.handleNumbers)}function W(t,e){e.handle&&(u(e.handle,n.cssClasses.active),w-=1),e.listeners.forEach(function(t){M.removeEventListener(t[0],t[1])}),0===w&&(u(v,n.cssClasses.drag),it(),t.cursor&&(T.style.cursor="",T.removeEventListener("selectstart",r))),e.handleNumbers.forEach(function(t){Q("change",t),Q("set",t),Q("end",t)})}function H(t,e){var i;if(1===e.handleNumbers.length){var o=p[e.handleNumbers[0]];if(o.hasAttribute("disabled"))return!1;i=o.children[0],w+=1,l(i,n.cssClasses.active)}t.stopPropagation();var a=[],s=q(_.move,M,X,{target:t.target,handle:i,listeners:a,startCalcPoint:t.calcPoint,baseSize:U(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:b.slice()}),u=q(_.end,M,W,{target:t.target,handle:i,listeners:a,doNotReject:!0,handleNumbers:e.handleNumbers}),c=q("mouseout",M,Z,{target:t.target,handle:i,listeners:a,doNotReject:!0,handleNumbers:e.handleNumbers});a.push.apply(a,s.concat(u,c)),t.cursor&&(T.style.cursor=getComputedStyle(t.target).cursor,p.length>1&&l(v,n.cssClasses.drag),T.addEventListener("selectstart",r,!1)),e.handleNumbers.forEach(function(t){Q("start",t)})}function Y(t){t.stopPropagation();var e=G(t.calcPoint),r=function(t){var e=100,r=!1;return p.forEach(function(n,i){if(!n.hasAttribute("disabled")){var o=Math.abs(b[i]-t);(o<e||100===o&&100===e)&&(r=i,e=o)}}),r}(e);if(!1===r)return!1;n.events.snap||i(v,n.cssClasses.tap,n.animationDuration),ot(r,e,!0,!0),it(),Q("slide",r,!0),Q("update",r,!0),Q("change",r,!0),Q("set",r,!0),n.events.snap&&H(t,{handleNumbers:[r]})}function K(t){var e=G(t.calcPoint),r=k.getStep(e),n=k.fromStepping(r);Object.keys(I).forEach(function(t){"hover"===t.split(".")[0]&&I[t].forEach(function(t){t.call(f,n)})})}function J(t,e){I[t]=I[t]||[],I[t].push(e),"update"===t.split(".")[0]&&p.forEach(function(t,e){Q("update",e)})}function Q(t,e,r){Object.keys(I).forEach(function(i){var o=i.split(".")[0];t===o&&I[i].forEach(function(t){t.call(f,E.map(n.format.to),e,E.slice(),r||!1,b.slice())})})}function $(t){return t+"%"}function tt(t,e,r,i,a,s){return p.length>1&&(i&&e>0&&(r=Math.max(r,t[e-1]+n.margin)),a&&e<p.length-1&&(r=Math.min(r,t[e+1]-n.margin))),p.length>1&&n.limit&&(i&&e>0&&(r=Math.min(r,t[e-1]+n.limit)),a&&e<p.length-1&&(r=Math.max(r,t[e+1]-n.limit))),n.padding&&(0===e&&(r=Math.max(r,n.padding[0])),e===p.length-1&&(r=Math.min(r,100-n.padding[1]))),!((r=o(r=k.getStep(r)))===t[e]&&!s)&&r}function et(t,e){var r=n.ort;return(r?e:t)+", "+(r?t:e)}function rt(t,e,r,n){var i=r.slice(),o=[!t,t],a=[t,!t];n=n.slice(),t&&n.reverse(),n.length>1?n.forEach(function(t,r){var n=tt(i,t,i[t]+e,o[r],a[r],!1);!1===n?e=0:(e=n-i[t],i[t]=n)}):o=a=[!0];var s=!1;n.forEach(function(t,n){s=ot(t,r[t]+e,o[n],a[n])||s}),s&&n.forEach(function(t){Q("update",t),Q("slide",t)})}function nt(t,e){return n.dir?100-t-e:t}function it(){x.forEach(function(t){var e=b[t]>50?-1:1,r=3+(p.length+e*t);p[t].style.zIndex=r})}function ot(t,e,r,i){return!1!==(e=tt(b,t,e,r,i,!1))&&(function(t,e){b[t]=e,E[t]=k.fromStepping(e);var r="translate("+et($(nt(e,0)-z),"0")+")";p[t].style[n.transformRule]=r,at(t),at(t+1)}(t,e),!0)}function at(t){if(d[t]){var e=0,r=100;0!==t&&(e=b[t-1]),t!==d.length-1&&(r=b[t]);var i=r-e,o="translate("+et($(nt(e,i)),"0")+")",a="scale("+et(i/100,"1")+")";d[t].style[n.transformRule]=o+" "+a}}function st(t,e){var r=a(t),o=void 0===b[0];e=void 0===e||!!e,n.animate&&!o&&i(v,n.cssClasses.tap,n.animationDuration),x.forEach(function(t){ot(t,function(t,e){return null===t||!1===t||void 0===t?b[e]:("number"==typeof t&&(t=String(t)),t=n.format.from(t),!1===(t=k.toStepping(t))||isNaN(t)?b[e]:t)}(r[t],t),!0,!1)}),x.forEach(function(t){ot(t,b[t],!0,!0)}),it(),x.forEach(function(t){Q("update",t),null!==r[t]&&e&&Q("set",t)})}function lt(){var t=E.map(n.format.to);return 1===t.length?t[0]:t}return h=function(t){return l(t,n.cssClasses.target),0===n.dir?l(t,n.cssClasses.ltr):l(t,n.cssClasses.rtl),0===n.ort?l(t,n.cssClasses.horizontal):l(t,n.cssClasses.vertical),B(t,n.cssClasses.base)}(v),function(t,e){var r=B(e,n.cssClasses.connects);p=[],(d=[]).push(R(r,t[0]));for(var i=0;i<n.handles;i++)p.push(L(e,i)),x[i]=i,d.push(R(r,t[i+1]))}(n.connect,h),function(t){t.fixed||p.forEach(function(t,e){q(_.start,t.children[0],H,{handleNumbers:[e]})}),t.tap&&q(_.start,h,Y,{}),t.hover&&q(_.move,h,K,{hover:!0}),t.drag&&d.forEach(function(e,r){if(!1!==e&&0!==r&&r!==d.length-1){var i=p[r-1],o=p[r],a=[e];l(e,n.cssClasses.draggable),t.fixed&&(a.push(i.children[0]),a.push(o.children[0])),a.forEach(function(t){q(_.start,t,H,{handles:[i,o],handleNumbers:[r-1,r]})})}})}(n.events),st(n.start),f={destroy:function(){for(var t in n.cssClasses)n.cssClasses.hasOwnProperty(t)&&u(v,n.cssClasses[t]);for(;v.firstChild;)v.removeChild(v.firstChild);delete v.noUiSlider},steps:function(){return b.map(function(t,e){var r=k.getNearbySteps(t),n=E[e],i=r.thisStep.step,o=null;!1!==i&&n+i>r.stepAfter.startValue&&(i=r.stepAfter.startValue-n),o=n>r.thisStep.startValue?r.thisStep.step:!1!==r.stepBefore.step&&n-r.stepBefore.highestStep,100===t?i=null:0===t&&(o=null);var a=k.countStepDecimals();return null!==i&&!1!==i&&(i=Number(i.toFixed(a))),null!==o&&!1!==o&&(o=Number(o.toFixed(a))),[o,i]})},on:J,off:function(t){var e=t&&t.split(".")[0],r=e&&t.substring(e.length);Object.keys(I).forEach(function(t){var n=t.split(".")[0],i=t.substring(n.length);e&&e!==n||r&&r!==i||delete I[t]})},get:lt,set:st,reset:function(t){st(n.start,t)},__moveHandles:function(t,e,r){rt(t,e,b,r)},options:s,updateOptions:function(t,e){var r=lt(),i=["margin","limit","padding","range","animate","snap","step","format"];i.forEach(function(e){void 0!==t[e]&&(s[e]=t[e])});var o=j(s);i.forEach(function(e){void 0!==t[e]&&(n[e]=o[e])}),k=o.spectrum,n.margin=o.margin,n.limit=o.limit,n.padding=o.padding,n.pips&&V(n.pips),b=[],st(t.start||r,e)},target:v,removePips:N,pips:V},n.pips&&V(n.pips),n.tooltips&&function(){var t=p.map(O);J("update",function(e,r,i){if(t[r]){var o=e[r];!0!==n.tooltips[r]&&(o=n.tooltips[r].to(i[r])),t[r].innerHTML=o}})}(),J("update",function(t,e,r,i,o){x.forEach(function(t){var e=p[t],i=tt(b,t,0,!0,!0,!0),a=tt(b,t,100,!0,!0,!0),s=o[t],l=n.ariaFormat.to(r[t]);i=k.fromStepping(i).toFixed(1),a=k.fromStepping(a).toFixed(1),s=k.fromStepping(s).toFixed(1),e.children[0].setAttribute("aria-valuemin",i),e.children[0].setAttribute("aria-valuemax",a),e.children[0].setAttribute("aria-valuenow",s),e.children[0].setAttribute("aria-valuetext",l)})}),f}return{__spectrum:g,version:t,create:function(e,r){if(!e||!e.nodeName)throw new Error("noUiSlider ("+t+"): create requires a single element, got: "+e);if(e.noUiSlider)throw new Error("noUiSlider ("+t+"): Slider was already initialized.");var n=j(r),i=U(e,n,r);return e.noUiSlider=i,i}}})?n.apply(e,i):n)||(t.exports=o)},function(t,e,r){var n,i,o;i=[],void 0===(o="function"==typeof(n=function(){"use strict";var t=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function e(t){return t.split("").reverse().join("")}function r(t,e){return t.substring(0,e.length)===e}function n(t,e,r){if((t[e]||t[r])&&t[e]===t[r])throw new Error(e)}function i(t){return"number"==typeof t&&isFinite(t)}function o(t,r,n,o,a,s,l,u,c,h,p,d){var f,m,_,y=d,g="",v="";return s&&(d=s(d)),!!i(d)&&(!1!==t&&0===parseFloat(d.toFixed(t))&&(d=0),d<0&&(f=!0,d=Math.abs(d)),!1!==t&&(d=function(t,e){return t=t.toString().split("e"),(+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]+e:e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]-e:-e))).toFixed(e)}(d,t)),-1!==(d=d.toString()).indexOf(".")?(m=d.split("."),_=m[0],n&&(g=n+m[1])):_=d,r&&(_=e((_=e(_).match(/.{1,3}/g)).join(e(r)))),f&&u&&(v+=u),o&&(v+=o),f&&c&&(v+=c),v+=_,v+=g,a&&(v+=a),h&&(v=h(v,y)),v)}function a(t,e,n,o,a,s,l,u,c,h,p,d){var f,m="";return p&&(d=p(d)),!(!d||"string"!=typeof d)&&(u&&r(d,u)&&(d=d.replace(u,""),f=!0),o&&r(d,o)&&(d=d.replace(o,"")),c&&r(d,c)&&(d=d.replace(c,""),f=!0),a&&function(t,e){return t.slice(-1*e.length)===e}(d,a)&&(d=d.slice(0,-1*a.length)),e&&(d=d.split(e).join("")),n&&(d=d.replace(n,".")),f&&(m+="-"),""!==(m=(m+=d).replace(/[^0-9\.\-.]/g,""))&&(m=Number(m),l&&(m=l(m)),!!i(m)&&m))}function s(e,r,n){var i,o=[];for(i=0;i<t.length;i+=1)o.push(e[t[i]]);return o.push(n),r.apply("",o)}return function e(r){if(!(this instanceof e))return new e(r);"object"==typeof r&&(r=function(e){var r,i,o,a={};for(void 0===e.suffix&&(e.suffix=e.postfix),r=0;r<t.length;r+=1)if(i=t[r],void 0===(o=e[i]))"negative"!==i||a.negativeBefore?"mark"===i&&"."!==a.thousand?a[i]=".":a[i]=!1:a[i]="-";else if("decimals"===i){if(!(o>=0&&o<8))throw new Error(i);a[i]=o}else if("encoder"===i||"decoder"===i||"edit"===i||"undo"===i){if("function"!=typeof o)throw new Error(i);a[i]=o}else{if("string"!=typeof o)throw new Error(i);a[i]=o}return n(a,"mark","thousand"),n(a,"prefix","negative"),n(a,"prefix","negativeBefore"),a}(r),this.to=function(t){return s(r,o,t)},this.from=function(t){return s(r,a,t)})}})?n.apply(e,i):n)||(t.exports=o)},function(e,r,n){(function(e,n){!function(t,e){e(r)}(0,function(r){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function i(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var o="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};!function(t,e){t(e={exports:{}},e.exports)}(function(e,r){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r){if(null==e)throw new TypeError("Cannot convert first argument to object");for(let t=Object(e),r=1;r<arguments.length;r++){let e=arguments[r];if(null!=e)for(let r=Object.keys(Object(e)),n=0,i=r.length;n<i;n++){let i=r[n],o=Object.getOwnPropertyDescriptor(e,i);void 0!==o&&o.enumerable&&(t[i]=e[i])}}return t}}),function(){function t(t){var e=this.constructor;return this.then(function(r){return e.resolve(t()).then(function(){return r})},function(r){return e.resolve(t()).then(function(){return e.reject(r)})})}function e(){}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){var n;try{n=r(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,n)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void u(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;n>e;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e){var r=!1;try{t(function(t){r||(r=!0,a(e,t))},function(t){r||(r=!0,s(e,t))})}catch(t){if(r)return;r=!0,s(e,t)}}var c=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,r){var n=new this.constructor(e);return i(this,new function(t,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=r}(t,r,n)),n},r.prototype.finally=t,r.all=function(t){return new r(function(e,r){function n(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){n(t,e)},r)}i[t]=a,0==--o&&e(i)}catch(t){r(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;i.length>a;a++)n(a,i[a])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,r){r(t)})},r.race=function(t){return new r(function(e,r){for(var n=0,i=t.length;i>n;n++)t[n].then(e,r)})},r._immediateFn="function"==typeof n&&function(t){n(t)}||function(t){c(t,0)},r._unhandledRejectionFn=function(t){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var h=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==o)return o;throw Error("unable to locate global object")}();"Promise"in h?h.Promise.prototype.finally||(h.Promise.prototype.finally=t):h.Promise=r}()});var a={route:"/api/component/pyramid/route"},s=function(){function t(t){this.options={},this._loadingQueue={},this._loadingStatus={},this.options=Object.assign({},a,t||{})}return t.prototype.connect=function(){return function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,s)}l((n=n.apply(t,e||[])).next())})}(this,void 0,void 0,function(){var t,e,r,n=this;return i(this,function(i){switch(i.label){case 0:return this.route?[2,Promise.resolve(this.route)]:[3,1];case 1:return this.options.auth?(console.log(1234),t=this.options.auth,e=t.login,r=t.password,e&&r?[4,this.getUserInfo()]:[3,3]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.makeQuery(this.options.route,{},{}).then(function(t){return n.route=t,t})];case 4:return[2,i.sent()]}})})},t.prototype.getUserInfo=function(){var t=this,e=this.makeClientId();return this.makeQuery("/api/component/auth/current_user",{},{headers:{Authorization:"Basic "+e,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"*"},mode:"cors"}).then(function(e){console.log(e),"guest"!==e.keyname&&(e.clientId=t.makeClientId(),localStorage&&localStorage.setItem("nguser",JSON.stringify(e)))})},t.prototype.makeClientId=function(){var t=this.options.auth,e=t.login,r=t.password;return window.btoa(unescape(encodeURIComponent(e+":"+r)))},t.prototype.request=function(t,e,r){var n=this;return this.connect().then(function(i){for(var o in i)if(i.hasOwnProperty(o)&&o===t){var a=i[o].slice(),s=a.shift();if(a.length){e=e||{};for(var l={},c=0;c<a.length;c++){var h=a[c];if(l[c]="{"+h+"}",void 0===e[h])throw new Error("`"+h+"` url api argument is not specified")}s=u(s,l)}return n.makeQuery(s,e,r)}})},t.prototype.post=function(t,e,r){return(e=e||{}).method="POST",this.request(t,r,e)},t.prototype.makeQuery=function(t,e,r){var n=this;if(t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=u(t,e)),t=t.replace(/([^:]\/)\/+/g,"$1"),this._loadingStatus[t]?(this._loadingStatus[t]=!1,new Promise(function(e,r){n._setLoadingQueue(t,e,r)})):(this._loadingStatus[t]=!0,this._getJson(t,r).then(function(e){return n._loadingStatus[t]=!1,n._exequteLoadingQueue(t,e),e}).catch(function(e){n._loadingStatus[t]=!1,n._exequteLoadingQueue(t,e,!0)}));throw new Error("No `url` parameter set for option "+name)},t.prototype._setLoadingQueue=function(t,e,r){this._loadingQueue[t]=this._loadingQueue[t]||{name:t,waiting:[]},this._loadingQueue[t].waiting.push({resolve:e,reject:r,timestamp:new Date})},t.prototype._exequteLoadingQueue=function(t,e,r){var n=this._loadingQueue[t];if(n){for(var i=0;i<n.waiting.length;i++){var o=n.waiting[i];r?o.reject&&o.reject():o.resolve(e)}n.waiting=[]}},t.prototype._getJson=function(t,e){return new Promise(function(r,n){!function(t,e,r,n){void 0===r&&(r={});var i;r.method=r.method||"GET","cors"===r.mode?i=function(t,e){var r=new XMLHttpRequest;if("withCredentials"in r)r.open(t,e,!0);else{var n=XDomainRequest;void 0!==n?(r=new n).open(t,e):r=null}return r}(r.method,t):(i=new XMLHttpRequest).open(r.method||"GET",t,!0);i.onreadystatechange=function(){if(4===i.readyState&&200===i.status&&i.responseText)try{e(JSON.parse(i.responseText))}catch(t){n(t)}};var o=r.headers;if(o)for(var a in o)o.hasOwnProperty(a)&&i.setRequestHeader(a,o[a]);i.withCredentials=r.withCredentials,i.send(r.data?JSON.stringify(r.data):null)}(t,r,e,n)})},t}();var l=/\{ *([\w_-]+) *\}/g;function u(t,e){return t.replace(l,function(t,r){var n=e[r];if(void 0===n)throw new Error("No value provided for letiable "+t);return"function"==typeof n&&(n=n(e)),n})}r.NgwConnector=s,Object.defineProperty(r,"__esModule",{value:!0})})}).call(this,n(48),n(295).setImmediate)},function(t,e,r){!function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(){return(e=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},r=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t){!function(){var e=window.CustomEvent;function r(t){for(;t;){if("dialog"===t.localName)return t;t=t.parentElement}return null}function n(t){t&&t.blur&&t!==document.body&&t.blur()}function i(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1}function o(t){return!(!t||!t.hasAttribute("method"))&&"dialog"===t.getAttribute("method").toLowerCase()}function a(t){if(this.dialog_=t,this.replacedStyleTop_=!1,this.openAsModal_=!1,t.hasAttribute("role")||t.setAttribute("role","dialog"),t.show=this.show.bind(this),t.showModal=this.showModal.bind(this),t.close=this.close.bind(this),"returnValue"in t||(t.returnValue=""),"MutationObserver"in window){var e=new MutationObserver(this.maybeHideModal.bind(this));e.observe(t,{attributes:!0,attributeFilter:["open"]})}else{var r,n=!1,i=function(){n?this.downgradeModal():this.maybeHideModal(),n=!1}.bind(this),o=function(e){if(e.target===t){var o="DOMNodeRemoved";n|=e.type.substr(0,o.length)===o,window.clearTimeout(r),r=window.setTimeout(i,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(e){t.addEventListener(e,o)})}Object.defineProperty(t,"open",{set:this.setOpen.bind(this),get:t.hasAttribute.bind(t,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}e&&"object"!=typeof e||((e=function(t,e){e=e||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,!!e.bubbles,!!e.cancelable,e.detail||null),r}).prototype=window.Event.prototype),a.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),s.dm.removeDialog(this))},setOpen:function(t){t?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(t){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var e=document.createElement("div");this.dialog_.insertBefore(e,this.dialog_.firstChild),e.tabIndex=-1,e.focus(),this.dialog_.removeChild(e)}var r=document.createEvent("MouseEvents");r.initMouseEvent(t.type,t.bubbles,t.cancelable,window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),this.dialog_.dispatchEvent(r),t.stopPropagation()},focus_:function(){var t=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!t&&this.dialog_.tabIndex>=0&&(t=this.dialog_),!t){var e=["button","input","keygen","select","textarea"].map(function(t){return t+":not([disabled])"});e.push('[tabindex]:not([disabled]):not([tabindex=""])'),t=this.dialog_.querySelector(e.join(", "))}n(document.activeElement),t&&t.focus()},updateZIndex:function(t,e){if(t<e)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=t,this.backdrop_.style.zIndex=e},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!s.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(t){for(;t&&t!==document.body;){var e=window.getComputedStyle(t),r=function(t,r){return!(void 0===e[t]||e[t]===r)};if(e.opacity<1||r("zIndex","auto")||r("transform","none")||r("mixBlendMode","normal")||r("filter","none")||r("perspective","none")||"isolate"===e.isolation||"fixed"===e.position||"touch"===e.webkitOverflowScrolling)return!0;t=t.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,s.needsCentering(this.dialog_)?(s.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==t&&(this.dialog_.returnValue=t);var r=new e("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(r)}};var s={reposition:function(t){var e=document.body.scrollTop||document.documentElement.scrollTop,r=e+(window.innerHeight-t.offsetHeight)/2;t.style.top=Math.max(e,r)+"px"},isInlinePositionSetByStylesheet:function(t){for(var e=0;e<document.styleSheets.length;++e){var r=document.styleSheets[e],n=null;try{n=r.cssRules}catch(t){}if(n)for(var o=0;o<n.length;++o){var a=n[o],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(t){}if(s&&i(s,t)){var l=a.style.getPropertyValue("top"),u=a.style.getPropertyValue("bottom");if(l&&"auto"!==l||u&&"auto"!==u)return!0}}}return!1},needsCentering:function(t){var e=window.getComputedStyle(t);return!("absolute"!==e.position||"auto"!==t.style.top&&""!==t.style.top||"auto"!==t.style.bottom&&""!==t.style.bottom||s.isInlinePositionSetByStylesheet(t))},forceRegisterDialog:function(t){if((window.HTMLDialogElement||t.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",t),"dialog"!==t.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new a(t)},registerDialog:function(t){t.showModal||s.forceRegisterDialog(t)},DialogManager:function(){this.pendingDialogStack=[];var t=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(e){this.forwardTab_=void 0,e.stopPropagation(),t([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(e){var r=[];e.forEach(function(t){for(var e,n=0;e=t.removedNodes[n];++n)e instanceof Element&&("dialog"===e.localName&&r.push(e),r=r.concat(e.querySelectorAll("dialog")))}),r.length&&t(r)}))}};if(s.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},s.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},s.DialogManager.prototype.updateStacking=function(){for(var t,e=this.zIndexHigh_,r=0;t=this.pendingDialogStack[r];++r)t.updateZIndex(--e,--e),0===r&&(this.overlay.style.zIndex=--e);var n=this.pendingDialogStack[0];if(n){var i=n.dialog.parentNode||document.body;i.appendChild(this.overlay)}else this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},s.DialogManager.prototype.containedByTopDialog_=function(t){for(;t=r(t);){for(var e,n=0;e=this.pendingDialogStack[n];++n)if(e.dialog===t)return 0===n;t=t.parentElement}return!1},s.DialogManager.prototype.handleFocus_=function(t){if(!this.containedByTopDialog_(t.target)&&(t.preventDefault(),t.stopPropagation(),n(t.target),void 0!==this.forwardTab_)){var e=this.pendingDialogStack[0],r=e.dialog,i=r.compareDocumentPosition(t.target);return i&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?e.focus_():document.documentElement.focus()),!1}},s.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,27===t.keyCode){t.preventDefault(),t.stopPropagation();var r=new e("cancel",{bubbles:!1,cancelable:!0}),n=this.pendingDialogStack[0];n&&n.dialog.dispatchEvent(r)&&n.dialog.close()}else 9===t.keyCode&&(this.forwardTab_=!t.shiftKey)},s.DialogManager.prototype.checkDOM_=function(t){var e=this.pendingDialogStack.slice();e.forEach(function(e){-1!==t.indexOf(e.dialog)?e.downgradeModal():e.maybeHideModal()})},s.DialogManager.prototype.pushDialog=function(t){var e=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=e||(1===this.pendingDialogStack.unshift(t)&&this.blockDocument(),this.updateStacking(),0))},s.DialogManager.prototype.removeDialog=function(t){var e=this.pendingDialogStack.indexOf(t);-1!==e&&(this.pendingDialogStack.splice(e,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},s.dm=new s.DialogManager,s.formSubmitter=null,s.useValue=null,void 0===window.HTMLDialogElement){var l=document.createElement("form");if(l.setAttribute("method","dialog"),"dialog"!==l.method){var u=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(u){var c=u.get;u.get=function(){return o(this)?"dialog":c.call(this)};var h=u.set;u.set=function(t){return"string"==typeof t&&"dialog"===t.toLowerCase()?this.setAttribute("method",t):h.call(this,t)},Object.defineProperty(HTMLFormElement.prototype,"method",u)}}document.addEventListener("click",function(t){if(s.formSubmitter=null,s.useValue=null,!t.defaultPrevented){var e=t.target;if(e&&o(e.form)){var n="submit"===e.type&&["button","input"].indexOf(e.localName)>-1;if(!n){if("input"!==e.localName||"image"!==e.type)return;s.useValue=t.offsetX+","+t.offsetY}var i=r(e);i&&(s.formSubmitter=e)}}},!1);var p=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!o(this))return p.call(this);var t=r(this);t&&t.close()},document.addEventListener("submit",function(t){var e=t.target;if(o(e)){t.preventDefault();var n=r(e);if(n){var i=s.formSubmitter;i&&i.form===e?n.close(s.useValue||i.value):n.close(),s.formSubmitter=null}}},!0)}s.forceRegisterDialog=s.forceRegisterDialog,s.registerDialog=s.registerDialog,"object"==typeof t.exports?t.exports=s:window.dialogPolyfill=s}()});function n(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===r&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}n("dialog {\n  position: absolute;\n  left: 0; right: 0;\n  width: -moz-fit-content;\n  width: -webkit-fit-content;\n  width: fit-content;\n  height: -moz-fit-content;\n  height: -webkit-fit-content;\n  height: fit-content;\n  margin: auto;\n  border: solid;\n  padding: 1em;\n  background: white;\n  color: black;\n  display: block;\n}\n\ndialog:not([open]) {\n  display: none;\n}\n\ndialog + .backdrop {\n  position: fixed;\n  top: 0; right: 0; bottom: 0; left: 0;\n  background: rgba(0,0,0,0.1);\n}\n\n._dialog_overlay {\n  position: fixed;\n  top: 0; right: 0; bottom: 0; left: 0;\n}\n\ndialog.fixed {\n  position: fixed;\n  top: 50%;\n  transform: translate(0, -50%);\n}"),n(".dialog-component {\r\n  border: 1px solid rgba(0, 0, 0, 0.3);\r\n  box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);\r\n  text-align: center;\r\n}\r\n\r\n.dialog-component::backdrop {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.dialog-component__close {\r\n  margin-top: -2px;\r\n  float: right;\r\n  line-height: 1;\r\n  color: #000;\r\n  text-shadow: 0 1px 0 #fff;\r\n  filter: alpha(opacity=20);\r\n  opacity: .2;\r\n}\r\n\r\n");var i='\n  <a href="#">\n    <svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">\n      </path>\n      <path d="M0 0h24v24H0z" fill="none"></path>\n    </svg>\n  </a>\n',o=function(){function t(t){this.options={template:"\n      <p>This is dialog!</p>\n    ",closeBtn:!0,closeBtnTemplate:i},this._dialog=document.createElement("dialog"),this._dialog.className="dialog-component",this.options=e({},this.options,t),this._parent=this.options.parent||document.body,this._isNativeDialog=!!this._dialog.showModal,this._isNativeDialog||(r.registerDialog(this._dialog),this._dialog.classList.add("polifilled")),this.options.closeBtn&&this._addCloseBtn(),this._content=document.createElement("div"),this._dialog.appendChild(this._content),this.updateContent(),this._parent&&this._parent.appendChild(this._dialog),this._addEventsListeners()}return t.prototype.show=function(){this._dialog.showModal()},t.prototype.close=function(){this._dialog.close()},t.prototype.updateContent=function(t){void 0===t&&(t=this.options.template),this._addContent(t,this._content)},t.prototype._addCloseBtn=function(){var t=this,e=this.options.closeBtnTemplate;this._closeBtn=document.createElement("div"),this._closeBtn.className="dialog-component__close",this._dialog.appendChild(this._closeBtn),this._addContent(e,this._closeBtn),this._closeBtn.addEventListener("click",function(e){e.stopPropagation(),t.close()})},t.prototype._addContent=function(t,e){return"string"==typeof t?e.innerHTML=t:t instanceof HTMLElement&&(e.innerHTML="",e.appendChild(t)),e.firstChild},t.prototype._addEventsListeners=function(){var t=this;this._closeBtn&&this._closeBtn.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.close()}),this.options.openers&&[].forEach.call(this.options.openers,function(e){e.onclick=function(e){e.preventDefault(),t.show()}}),this._dialog.addEventListener("close",function(){}),this._dialog.addEventListener("cancel",function(){})},t.dialogs=[],t}();t.Dialog=o,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e){t.exports=[{tech_number:1,number:1,name:"Рюрик",years_life:"? - 879",years_from:862,years_to:879,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:2,number:2,name:"Олег",years_life:"? - 912",years_from:879,years_to:912,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:3,number:3,name:"Игорь Рюрикович",years_life:"? - 945",years_from:913,years_to:945,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:4,number:4,name:"Ольга",years_life:"? - 969",years_from:945,years_to:960,description:"Княгиня русская.",detail_link:null,img_link:null,"":null},{tech_number:5,number:5,name:"Святослав Игоревич",years_life:"? - 972",years_from:960,years_to:972,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:6,number:6,name:"Ярополк Святославич",years_life:"? - 980",years_from:972,years_to:980,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:7,number:7,name:"Владимир Святославич",years_life:"? - 1015",years_from:980,years_to:1015,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:8,number:8,name:"Святополк Владимирович",years_life:"? - 1019",years_from:1015,years_to:1016,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:9,number:9,name:"Ярослав Владимирович",years_life:"? - 1054",years_from:1016,years_to:1018,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:10,number:8,name:"Святополк Владимирович",years_life:"? - 1019",years_from:1018,years_to:1019,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:11,number:9,name:"Ярослав Владимирович",years_life:"? - 1054",years_from:1019,years_to:1054,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:12,number:10,name:"Изяслав Ярославич",years_life:"1024 - 1078",years_from:1054,years_to:1068,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:13,number:11,name:"Всеслав Брячиславич",years_life:"? - 1101",years_from:1068,years_to:1069,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:14,number:10,name:"Изяслав Ярославич",years_life:"1024 - 1078",years_from:1069,years_to:1073,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:15,number:12,name:"Святослав Ярославич",years_life:"1027 - 1076",years_from:1073,years_to:1076,description:"Князь русский.",detail_link:null,img_link:null,"":null},{tech_number:16,number:13,name:"Всеволод Ярославич ",years_life:"1030 - 1093",years_from:1077,years_to:1077,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:17,number:10,name:"Изяслав Ярославич",years_life:"1024 - 1078",years_from:1077,years_to:1078,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:18,number:13,name:"Всеволод Ярославич ",years_life:"1030 - 1093",years_from:1078,years_to:1093,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:19,number:14,name:"Святополк Изяславич",years_life:"1050 - 1113",years_from:1093,years_to:1113,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:20,number:15,name:"Владимир Всеволодович Мономах",years_life:"1053-1125",years_from:1113,years_to:1125,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:21,number:16,name:"Мстислав Владимирович",years_life:"1076 - 1132",years_from:1125,years_to:1132,description:"Князь всея Руси.",detail_link:null,img_link:null,"":null},{tech_number:22,number:17,name:"Ярополк Владимирович",years_life:"? -1139",years_from:1132,years_to:1139,description:"Князь всея Руси, князь переяславский.\n",detail_link:null,img_link:null,"":null},{tech_number:23,number:18,name:"Всеволод Ольгович",years_life:"? -1146",years_from:1139,years_to:1146,description:"Князь всея Руси, князь черниговский.",detail_link:null,img_link:null,"":null},{tech_number:24,number:19,name:"Изяслав Мстиславич",years_life:"? -1154",years_from:1146,years_to:1149,description:"Князь всея Руси, князь переяславский, князь волынский.",detail_link:null,img_link:null,"":null},{tech_number:25,number:20,name:"Юрий (Георгий) Владимирович Долгорукий",years_life:"? -1157",years_from:1149,years_to:1150,description:"Князь всея Руси, князь суздальский.",detail_link:null,img_link:null,"":null},{tech_number:26,number:19,name:"Изяслав Мстиславич",years_life:"? -1154",years_from:1150,years_to:1150,description:"Князь всея Руси, князь переяславский, князь волынский.\n",detail_link:null,img_link:null,"":null},{tech_number:27,number:20,name:"Юрий (Георгий) Владимирович Долгорукий",years_life:"? -1157",years_from:1150,years_to:1151,description:"Князь всея Руси, князь суздальский.",detail_link:null,img_link:null,"":null},{tech_number:28,number:21,name:"Изяслав Мстиславич",years_life:"? -1154",years_from:1151,years_to:1154,description:"Князь всея Руси, князь переяславский, князь волынский\n",detail_link:null,img_link:null,"":null},{tech_number:29,number:22,name:"Ростислав Мстиславич",years_life:"? - 1167",years_from:1154,years_to:1155,description:"Князь всея Руси, князь смоленский.",detail_link:null,img_link:null,"":null},{tech_number:30,number:23,name:"Изяслав Давыдович",years_life:"? -1162",years_from:1155,years_to:1155,description:"Князь всея Руси, князь черниговский.",detail_link:null,img_link:null,"":null},{tech_number:31,number:20,name:"Юрий (Георгий) Владимирович Долгорукий",years_life:"? -1157",years_from:1155,years_to:1157,description:"Князь всея Руси, князь суздальский.",detail_link:null,img_link:null,"":null},{tech_number:32,number:23,name:"Изяслав Давыдович",years_life:"? -1162",years_from:1157,years_to:1159,description:"Князь всея Руси, князь черниговский.",detail_link:null,img_link:null,"":null},{tech_number:33,number:22,name:"Ростислав Мстиславич",years_life:"? - 1167",years_from:1159,years_to:1167,description:"Князь всея Руси, князь смоленский.",detail_link:null,img_link:null,"":null},{tech_number:34,number:24,name:"Мстислав Изяславич",years_life:"? - 1170",years_from:1167,years_to:1169,description:"Князь всея Руси, князь волынский.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/595036/",img_link:null,"":null},{tech_number:35,number:25,name:"Глеб Юрьевич",years_life:"? - 1171",years_from:1169,years_to:1171,description:"Князь всея Руси, князь переяславский.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/576970/",img_link:null,"":null},{tech_number:36,number:26,name:"Владимир Мстиславич",years_life:"? -1171",years_from:1171,years_to:1171,description:"Князь всея Руси, князь дорогобужский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/595101/",img_link:null,"":null},{tech_number:37,number:27,name:"Роман Ростиславич",years_life:"? -1180",years_from:1171,years_to:1172,description:"Князь всея Руси, князь смоленский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/576995/",img_link:null,"":null},{tech_number:38,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1172,years_to:1173,description:"Князь всея Руси.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:39,number:29,name:"Всеволод Юрьевич Великое Гнездо",years_life:"1154-1212",years_from:1173,years_to:1173,description:"Князь всея Руси, великий князь владимирский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577064/",img_link:null,"":null},{tech_number:40,number:30,name:"Ярослав Изяславич",years_life:"? -1180",years_from:1173,years_to:1174,description:"Князь всея Руси, князь луцкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577074/",img_link:null,"":null},{tech_number:41,number:27,name:"Роман Ростиславич",years_life:"? -1180",years_from:1174,years_to:1176,description:"Князь всея Руси, князь смоленский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/576995/",img_link:null,"":null},{tech_number:42,number:31,name:"Святослав Всеволодович",years_life:"? -1194",years_from:1176,years_to:1180,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577822/",img_link:null,"":null},{tech_number:43,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1180,years_to:1181,description:"Князь всея Руси.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:44,number:31,name:"Святослав Всеволодович",years_life:"? -1194",years_from:1181,years_to:1194,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577822/",img_link:null,"":null},{tech_number:45,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1194,years_to:1202,description:"Князь всея Руси.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:46,number:32,name:"Ингварь Ярославич",years_life:null,years_from:1202,years_to:1202,description:"Князь всея Руси, князь луцкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577115/",img_link:null,"":null},{tech_number:47,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1203,years_to:1205,description:"Князь всея Руси, великий князь Киевский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:48,number:32,name:"Ингварь Ярославич",years_life:null,years_from:1205,years_to:1205,description:"Князь всея Руси, князь луцкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577115/",img_link:null,"":null},{tech_number:49,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1205,years_to:1206,description:"Князь всея Руси, великий князь владимирский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:50,number:33,name:"Всеволод Святославич Чермный",years_life:"? -1212",years_from:1206,years_to:1206,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577125/",img_link:null,"":null},{tech_number:51,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1206,years_to:1207,description:"Князь всея Руси, великий князь владимирский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:52,number:33,name:"Всеволод Святославич Чермный",years_life:"? -1212",years_from:1207,years_to:1207,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577125/",img_link:null,"":null},{tech_number:53,number:28,name:"Рюрик Ростиславич",years_life:"? -1212",years_from:1207,years_to:1210,description:"Князь всея Руси, великий князь владимирский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577016/",img_link:null,"":null},{tech_number:54,number:33,name:"Всеволод Святославич Чермный",years_life:"? -1212",years_from:1210,years_to:1212,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577125/",img_link:null,"":null},{tech_number:55,number:32,name:"Ингварь Ярославич",years_life:null,years_from:1212,years_to:1212,description:"Князь всея Руси, князь луцкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577115/",img_link:null,"":null},{tech_number:56,number:34,name:"Мстислав Романович",years_life:"? -1223",years_from:1212,years_to:1223,description:"Князь всея Руси, князь смоленский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577145/",img_link:null,"":null},{tech_number:57,number:35,name:"Владимир Рюрикович",years_life:"? -1239",years_from:1223,years_to:1236,description:"Князь всея Руси, князь смоленский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577157/",img_link:null,"":null},{tech_number:58,number:36,name:"Ярослав Всеволодич",years_life:"1190 - 1246",years_from:1236,years_to:1238,description:"Князь всея Руси, великий князь суздальский\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577170/",img_link:null,"":null},{tech_number:59,number:37,name:"Михаил Всеволодич",years_life:"? - 1246",years_from:1238,years_to:1239,description:"Князь всея Руси, князь черниговский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577206/",img_link:null,"":null},{tech_number:60,number:38,name:"Даниил Романович",years_life:"1201-1264",years_from:1240,years_to:1240,description:"Князь всея Руси, князь волынский и галицкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577234/",img_link:null,"":null},{tech_number:61,number:36,name:"Ярослав Всеволодич",years_life:"1190 - 1246",years_from:1243,years_to:1246,description:"Князь всея Руси, великий князь владимирский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577170/",img_link:null,"":null},{tech_number:62,number:39,name:"Александр Ярославич Невский",years_life:"1221-1263",years_from:1249,years_to:1263,description:"Князь всея Руси, князь новгородский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577266/",img_link:null,"":null},{tech_number:63,number:40,name:"Ярослав Ярославич",years_life:"? -1271",years_from:1264,years_to:1271,description:"Князь всея Руси, великий князь владимирский, князь тверской.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577282/",img_link:null,"":null},{tech_number:64,number:41,name:"Василий Ярославич",years_life:"1241-1277",years_from:1272,years_to:1276,description:"Князь всея Руси, великий князь владимирский князь костромской",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577292/",img_link:null,"":null},{tech_number:65,number:42,name:"Дмитрий Александрович",years_life:"? -1294",years_from:1277,years_to:1281,description:"Князь всея Руси, великий князь владимирский, князь переяславский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577302/",img_link:null,"":null},{tech_number:66,number:43,name:"Андрей Александрович",years_life:"? -1304",years_from:1281,years_to:1283,description:"Князь всея Руси, великий князь суздальский, князь городецкий",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577324/",img_link:null,"":null},{tech_number:67,number:42,name:"Дмитрий Александрович",years_life:"? -1294",years_from:1283,years_to:1294,description:"Князь всея Руси, великий князь владимирский, князь переяславский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577302/",img_link:null,"":null},{tech_number:68,number:43,name:"Андрей Александрович",years_life:"? -1304",years_from:1294,years_to:1304,description:"Князь всея Руси, великий князь владимирский, князь городецкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577324/",img_link:null,"":null},{tech_number:69,number:44,name:"Михаил Ярославич",years_life:"1271-1320",years_from:1305,years_to:1317,description:"Великий князь всея Руси, князь тверской.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577343/",img_link:null,"":null},{tech_number:70,number:45,name:"Юрий (Георгий) Данилович",years_life:"? -1325",years_from:1317,years_to:1322,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577361/",img_link:null,"":null},{tech_number:71,number:46,name:"Дмитрий Михайлович",years_life:"1298-1326",years_from:1322,years_to:1326,description:"Великий князь всея Руси, князь тверской.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577380/",img_link:null,"":null},{tech_number:72,number:47,name:"Александр Михайлович",years_life:"1300-1339",years_from:1326,years_to:1327,description:"Великий князь всея Руси, князь тверской, князь псковский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577397/",img_link:null,"":null},{tech_number:73,number:48,name:"Иван I Данилович Калита (соправитель с Александром Васильевичем Суздальским в 1328-1331 гг.)",years_life:"? -1340",years_from:1328,years_to:1340,description:"Великий князь всея Руси, князь московский.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577421/",img_link:null,"":null},{tech_number:74,number:49,name:"Александр Васильевич Суздальский (соправитель с Иваном I Даниловичем Калитой)",years_life:"? -1331",years_from:1328,years_to:1331,description:"Князь суздальский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/579678/",img_link:null,"":null},{tech_number:75,number:50,name:"Семён Иванович Гордый",years_life:"1317-1353",years_from:1340,years_to:1353,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577434/",img_link:null,"":null},{tech_number:76,number:51,name:"Иван II Иванович Красный",years_life:"1326-1359",years_from:1353,years_to:1359,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577446/",img_link:null,"":null},{tech_number:77,number:52,name:"Дмитрий (Фома) Константинович",years_life:"1322-83",years_from:1360,years_to:1362,description:"Великий князь всея Руси, князь суздальский, великий князь нижегородский.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577457/",img_link:null,"":null},{tech_number:78,number:53,name:"Дмитрий Иванович Донской",years_life:"1350-1389",years_from:1362,years_to:1389,description:"Великий князь всея Руси, князь московский",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577467/",img_link:null,"":null},{tech_number:79,number:54,name:"Василий I Дмитриевич",years_life:"1371 - 1425",years_from:1389,years_to:1425,description:"Великий князь всея Руси, князь московский.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577523/",img_link:null,"":null},{tech_number:80,number:55,name:"Василий II Васильевич Тёмный",years_life:"1415-1462",years_from:1425,years_to:1433,description:"Великий князь всея Руси, князь московский",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577543/",img_link:null,"":null},{tech_number:81,number:56,name:"Юрий Дмитриевич",years_life:"1374-1434",years_from:1433,years_to:1433,description:"Великий князь всея Руси, князь звенигородский и галицкий.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577595/",img_link:null,"":null},{tech_number:82,number:55,name:"Василий II Васильевич Тёмный",years_life:"1415-1462",years_from:1433,years_to:1434,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577543/",img_link:null,"":null},{tech_number:83,number:56,name:"Юрий Дмитриевич",years_life:"1374-1434",years_from:1434,years_to:1434,description:"Великий князь всея Руси, князь звенигородский и галицкий",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577595/",img_link:null,"":null},{tech_number:84,number:55,name:"Василий II Васильевич Тёмный",years_life:"1415-1462",years_from:1434,years_to:1446,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577543/",img_link:null,"":null},{tech_number:85,number:57,name:"Дмитрий Юрьевич Шемяка",years_life:"? -1453",years_from:1446,years_to:1446,description:"Великий князь всея Руси, князь галицкий.\n",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577637/",img_link:null,"":null},{tech_number:86,number:55,name:"Василий II Васильевич Тёмный",years_life:"1415-1462",years_from:1447,years_to:1462,description:"Великий князь всея Руси, князь московский.",detail_link:"https://www.runivers.ru/doc/rusland/knyaz1/577543/",img_link:null,"":null},{tech_number:87,number:58,name:"Иван III Васильевич Великий",years_life:"1440-1505",years_from:1462,years_to:1505,description:"Государь и великий князь всея Руси. Создатель единого Русского государства; первым стал называться «царём» и титулом «государя всея Руси. ",detail_link:"https://www.runivers.ru/newenc/184800/",img_link:"https://www.runivers.ru/upload/iblock/5a2/72.jpg","":null},{tech_number:88,number:59,name:"Василий III Иванович (соправитель)",years_life:"1479-1533",years_from:1505,years_to:1533,description:"Государь и Великий князь всея Руси. Cтарший сын Ивана III и Софьи Палеолог.",detail_link:"https://www.runivers.ru/newenc/184796/",img_link:"https://www.runivers.ru/upload/iblock/8ed/12.jpg","":null},{tech_number:89,number:60,name:"Иван IV Васильевич Грозный",years_life:"1530-1584",years_from:1533,years_to:1584,description:"Государь, Царь и Великий Князь\nвсея Руси. Московский великий князь, сын Василия III и Елены Глинской.",detail_link:"https://www.runivers.ru/newenc/184805/",img_link:"https://www.runivers.ru/upload/iblock/223/73.jpg","":null},{tech_number:90,number:61,name:"Федор Иоаннович",years_life:"1557-1598",years_from:1584,years_to:1598,description:"Государь, Царь и Великий Князь всея Руси. Сын Ивана IV Грозного и Анастасии Романовой, последний из династии Рюриковичей. ",detail_link:"https://www.runivers.ru/newenc/184794/",img_link:"https://www.runivers.ru/upload/iblock/9a2/51.jpg","":null},{tech_number:91,number:62,name:"Борис Федорович Годунов",years_life:"1551 – 1605",years_from:1598,years_to:1605,description:"Государь, Царь и Великий Князь\nвсея Руси. Боярин, шурин царя Фёдора Иоанновича, из рода костромских бояр.",detail_link:"https://www.runivers.ru/newenc/184798/",img_link:"https://www.runivers.ru/upload/iblock/558/64.jpg","":null},{tech_number:92,number:63,name:"Лжедмитрий I",years_life:"? - 1606",years_from:1605,years_to:1606,description:"Государь, Царь и Великий Князь всея Руси. Самозванец, выдававший себя за сына Ивана IV Грозного царевича Дмитрия.",detail_link:"https://www.runivers.ru/newenc/184790/",img_link:"https://upload.wikimedia.org/wikipedia/commons/b/b8/Dymitr_Samozwaniec_Otrepiew.JPG","":null},{tech_number:93,number:64,name:"Василий IV Шуйский",years_life:"1553 - 1612",years_from:1606,years_to:1610,description:"Государь, Царь и Великий Князь всея Руси. Князь, московский боярин.",detail_link:"https://www.runivers.ru/newenc/471200/",img_link:"https://www.runivers.ru/upload/iblock/535/457px-Vasily_shuysky.jpg","":null},{tech_number:94,number:65,name:"Семибоярщина при формальном царствовании польского королевича Владислава",years_life:"-",years_from:1610,years_to:1612,description:"Семибоярщина – боярское правительство, созданное в Москве после свержения в июле 1610 г. царя Василия Шуйского.",detail_link:"https://www.runivers.ru/newenc/458241/",img_link:null,"":null},{tech_number:95,number:66,name:"Михаил Федорович Романов",years_life:"1596 - 1645",years_from:1613,years_to:1645,description:"Государь, Царь и Великий Князь всея Руси. Первый русский царь из династии Романовых; избран на царство Земским собором.",detail_link:"https://www.runivers.ru/house_of_romanov/michail/ru/",img_link:"https://www.runivers.ru/upload/iblock/fd5/01_Michael%20-%20dhbwa.jpg","":"https://www.runivers.ru/bookreader/books/452072/0008.gif"},{tech_number:96,number:67,name:"Алексей Михайлович",years_life:"1629 – 1676",years_from:1645,years_to:1676,description:"Государь, Царь и Великий Князь всея Руси. Сын царя Михаила Федоровича, второй русский царь (1645-1676 гг.) из династии Романовых.",detail_link:"https://www.runivers.ru/house_of_romanov/alexis/ru/",img_link:"https://www.runivers.ru/upload/iblock/d9c/image.jpg","":null},{tech_number:97,number:68,name:"Фёдор III Алексеевич",years_life:"1661 – 1682",years_from:1676,years_to:1682,description:"Государь, царь и великий князь всея Руси. Сын царя Алексея Михайловича.",detail_link:"https://www.runivers.ru/house_of_romanov/fedor_iii/ru/",img_link:"https://www.runivers.ru/upload/iblock/3f0/image%20r1r.jpg","":null},{tech_number:98,number:69,name:"Софья Алексеевна",years_life:"1657 – 1704",years_from:1682,years_to:1689,description:"Великая Государыня Царевна и Великая княжна. Правительница-регентша Российского царства. Дочь царя Алексея Михайловича.",detail_link:"https://www.runivers.ru/house_of_romanov/sophia/ru/",img_link:"https://www.runivers.ru/upload/iblock/74c/image%20k2a.jpg","":null},{tech_number:99,number:70,name:"Иван V Алексеевич",years_life:"1666 – 1696",years_from:1682,years_to:1696,description:"Государь, Царь и Великий Князь всея Руси. Сын царя Алексея Михайловича, старший брат и соправитель Петра I.",detail_link:"https://www.runivers.ru/house_of_romanov/ivan_v/ru/",img_link:"https://www.runivers.ru/upload/iblock/02a/image%20n3a.jpg","":null},{tech_number:100,number:71,name:"Петр I Алексеевич",years_life:"1672 – 1725",years_from:1682,years_to:1725,description:"Государь, Царь и Великий Князь всея Руси (с 1682 г.).\nИмператор и Самодержец Всероссийский (с 1721 г.). ",detail_link:"https://www.runivers.ru/house_of_romanov/peter_i/ru/",img_link:"https://www.runivers.ru/upload/iblock/256/image%20k4o.jpg","":null},{tech_number:101,number:72,name:"Екатерина I Алексеевна ",years_life:"1684 – 1727",years_from:1725,years_to:1727,description:"Императрица Всероссийская. Вторая жена и наследница Петра I.",detail_link:"https://www.runivers.ru/house_of_romanov/catherine_i/ru/",img_link:"https://www.runivers.ru/upload/iblock/18e/image%20z5f.jpg","":null},{tech_number:102,number:73,name:"Петр II Алексеевич ",years_life:"1715 – 1730",years_from:1727,years_to:1730,description:"Император Всероссийскийю Внук Петра I (сын царевича Алексея Петровича).",detail_link:"https://www.runivers.ru/house_of_romanov/peter_ii/ru/",img_link:"https://www.runivers.ru/upload/iblock/c98/image%20s6c.jpg","":null},{tech_number:103,number:74,name:"Анна Иоанновна",years_life:"1693 – 1740",years_from:1730,years_to:1740,description:"Императрица Всероссийская. Дочь царя Ивана V Алексеевича, вдова курляндского герцога.",detail_link:"https://www.runivers.ru/house_of_romanov/anna/ru/",img_link:"https://www.runivers.ru/upload/iblock/786/image%20s7z.jpg","":null},{tech_number:104,number:75,name:"Иван VI Антонович ",years_life:"1740 – 1764",years_from:1740,years_to:1741,description:"Император Всероссийский. Правнук Ивана V. ",detail_link:"https://www.runivers.ru/house_of_romanov/ivan_vi/ru/",img_link:"https://www.runivers.ru/upload/iblock/f9f/image%20v8r.jpg","":null},{tech_number:105,number:76,name:"Елизавета Петровна",years_life:"1709 – 1761",years_from:1741,years_to:1761,description:"Императрица Всероссийская. Дочь Петра I и Екатерины I. ",detail_link:"https://www.runivers.ru/house_of_romanov/elizabeth/ru/",img_link:"https://www.runivers.ru/upload/iblock/bee/image%20a9k.jpg","":null},{tech_number:106,number:77,name:"Петр III Федорович ",years_life:"1728 – 1762",years_from:1761,years_to:1762,description:"Император Всероссийский. ",detail_link:"https://www.runivers.ru/house_of_romanov/peter_iii/ru/",img_link:"https://www.runivers.ru/upload/iblock/715/image%20p11s.jpg","":null},{tech_number:107,number:78,name:"Екатерина II Великая",years_life:"1729 – 1796",years_from:1762,years_to:1796,description:"Императрица Всероссийская. Жена императора Петра III.",detail_link:"https://www.runivers.ru/house_of_romanov/catherine_ii/ru/",img_link:"https://www.runivers.ru/upload/iblock/5fe/12_Catherine%20II%20-%20minay.jpg","":null},{tech_number:108,number:79,name:"Павел I Петрович",years_life:"1754 – 1801 ",years_from:1796,years_to:1801,description:"Император Всероссийский. Сын Петра III и Екатерины II.",detail_link:"https://www.runivers.ru/house_of_romanov/paul_i/ru/",img_link:"https://www.runivers.ru/upload/iblock/05a/image%20p13e.jpg","":null},{tech_number:109,number:80,name:"Александр I Павлович",years_life:"1777 – 1825",years_from:1801,years_to:1825,description:"Император Всероссийский. Сын Павла I. ",detail_link:"https://www.runivers.ru/house_of_romanov/alexander_i/ru/",img_link:"https://www.runivers.ru/upload/iblock/1c1/image%20g14d.jpg","":null},{tech_number:110,number:81,name:"Николай I Павлович",years_life:"1796 – 1855",years_from:1825,years_to:1855,description:"Император Всероссийский. Сын Павла I, младший брат Александра I.",detail_link:"https://www.runivers.ru/house_of_romanov/nicholas_i/ru/",img_link:"https://www.runivers.ru/upload/iblock/b5f/image%20q15g.jpg","":null},{tech_number:111,number:82,name:"Александр II Николаевич",years_life:"1818 – 1881",years_from:1855,years_to:1881,description:"Император Всероссийский. Сын Николая I.",detail_link:"https://www.runivers.ru/house_of_romanov/alexander_ii/ru/",img_link:"https://www.runivers.ru/upload/iblock/e67/16_Alexander%20II%20-%20lvebh.jpg","":null},{tech_number:112,number:83,name:"Александр III Александрович",years_life:"1845 – 1894",years_from:1881,years_to:1894,description:"Император Всероссийский. Сын Александра II.",detail_link:"https://www.runivers.ru/house_of_romanov/alexander_iii/ru/",img_link:"https://www.runivers.ru/upload/iblock/6ea/image%20b17o.jpg","":null},{tech_number:113,number:84,name:"Николай II Александрович ",years_life:"1868 – 1918",years_from:1894,years_to:1917,description:"Император Всероссийский/ Сын Александра III, последний российский император.",detail_link:"https://www.runivers.ru/house_of_romanov/nicholas_ii/ru/",img_link:"https://www.runivers.ru/upload/iblock/08d/image%20a18f.jpg","":null},{tech_number:114,number:85,name:"Георгий Евгеньевич Львов",years_life:"1861 — 1925",years_from:1917,years_to:1917,description:"Министр-председатель Временного правительства 2 марта - 7 июля 1917 г.",detail_link:null,img_link:null,"":null},{tech_number:115,number:86,name:"Александр Федорович Керенский",years_life:"1881 — 1970 ",years_from:1917,years_to:1917,description:"Министр-председатель Всероссийского Временного Правительства  \n7 июля 1917 - 26 октября 1917 г.",detail_link:null,img_link:null,"":null},{tech_number:116,number:87,name:"Владимир Ильич Ленин (Ульянов), ",years_life:"1870 — 1924",years_from:1917,years_to:1924,description:"Председатель Совета Народных Комиссаров СССР",detail_link:null,img_link:null,"":null},{tech_number:117,number:88,name:"Иосиф Виссарионович Сталин (Джугашвили) ",years_life:"(1878 , 1879 ???) — 1953",years_from:1924,years_to:1953,description:"Генеральный секретарь ЦК ВКП(б) (1922-1934 гг.) \nСекретарь ЦК ВКП(б) (1934-1952 гг.\nСекретарь ЦК КПСС (1952-1953 гг.)",detail_link:null,img_link:null,"":null},{tech_number:118,number:89,name:"Никита Сергеевич Хрущев ",years_life:"1894 – 1971 ",years_from:1953,years_to:1964,description:"Генеральный секретарь ЦК КПСС",detail_link:null,img_link:null,"":null},{tech_number:119,number:90,name:"Леонид Ильич Брежнев",years_life:"1906 - 1982",years_from:1964,years_to:1982,description:"Генеральный секретарь ЦК КПСС",detail_link:null,img_link:null,"":null},{tech_number:120,number:91,name:"Юрий Владимирович Андропов",years_life:"1914 — 1984",years_from:1982,years_to:1984,description:"Генеральный секретарь ЦК КПСС",detail_link:null,img_link:null,"":null},{tech_number:121,number:92,name:"Константин Устинович Черненко",years_life:"1911 — 1985",years_from:1984,years_to:1985,description:"Генеральный секретарь ЦК КПСС",detail_link:null,img_link:null,"":null},{tech_number:122,number:93,name:"Михаил Сергеевич Горбачев ",years_life:"1931 —",years_from:1985,years_to:1991,description:"Генеральный секретарь ЦК КПСС\nПрезидент СССР",detail_link:null,img_link:null,"":null},{tech_number:123,number:94,name:"Борис Николаевич Ельцин",years_life:"1931 — 2007,",years_from:1991,years_to:1999,description:"Генеральный секретарь ЦК КПСС\nПрезидент СССР",detail_link:null,img_link:null,"":null},{tech_number:124,number:95,name:"Владимир Владимирович Путин",years_life:"1952 - ",years_from:2e3,years_to:2008,description:"Президент Российской Федерации",detail_link:null,img_link:null,"":null},{tech_number:125,number:96,name:"Дмитрий Анатольевич Медведев",years_life:"1965 -",years_from:2008,years_to:2012,description:"Президент Российской Федерации",detail_link:null,img_link:null,"":null},{tech_number:126,number:97,name:"Владимир Владимирович Путин ",years_life:"1952 - ",years_from:2012,years_to:2018,description:"Президент Российской Федерации",detail_link:null,img_link:null,"":null}]},function(t,e){t.exports=[{precision:0,comment:null,fid:1,ruler:null,date_from:"02.09.1829",date_to:"02.09.1829",reason:"Адрианопольский мирный договор с Турцией.",description_short:"По Адрианопольскому мирному договору Россия получала все черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами.",description_long:'Договор подписан между Россией и Турцией по итогам русско-турецкой войны 1828–1829 гг. в г. Адрианополе (Турция). Со стороны России договор подписали А. Ф. Орлов и Ф. П. Пален, со стороны Турции – Мехмед Садык-эфенди и Абдул Кадыр-бей. Согласно договору, Россия получала все черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами. Русские подданные могли вести свободную торговлю на территории Турции. Русские торговые суда получали право беспрепятственно проходить проливы Босфор и Дарданеллы. Русские подданные на турецкой территории не подлежали турецкой юрисдикции. На Турцию была наложена контрибуция в 1,5 млн гульденов, которые она обязана была выплатить России в течение 1,5 лет. Дунайские княжества (Молдавия, Валахия) формально оставались в составе Турции, но получали широкую автономию. Их зависимость от Турции фактически сводилась к выплате дани. Гарантом автономии объявлялась Россия. Широкую автономию получала также Греция. Договор подтверждал автономию Сербии, предоставленную ей Аккерманской конвенцией 1826 г.\n\nАдрианопольский мир стал крупной дипломатической победой России. В ее состав почти полностью вошло Закавказье. С ее помощью значительно продвинулось дело освобождения сербского, молдавского и греческого народов от турецкого ига.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=146928" target="_blank">Текст договора</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9867/#page/623/mode/1up" target="_blank">Оригинал договора</a><br />'},{precision:0,comment:null,fid:2,ruler:null,date_from:"01.07.1878",date_to:"01.07.1878",reason:"Берлинский трактат передал России Южную Бессарабию",description_short:"По Берлинскому трактату Румыния передала России Южную Бессарабию.",description_long:'Согласно Берлинскому трактату, подписанному 1 июля 1878 г., как итог Берлинского конгресса, завершившего Русско-турецкую войну 1877—1878 гг.,\n«княжество Румыния уступает обратно Е. В. императору всероссийскому часть Бессарабской территории, отошедшей от России по Парижскому трактату 1856 г., ограниченную с запада руслом Прута, с юга – руслом Килийского рукава и устьем Старого Стамбула».\n\n<a href="http://www.runivers.ru/bookreader/book10088/#page/665/mode/1up" target="_blank">Берлинский трактат</a><br />'},{precision:0,comment:null,fid:3,ruler:null,date_from:"16.05.1812",date_to:"16.05.1812",reason:"Бухарестский мир",description_short:"По Бухарестскому договору Россия получала Бессарабию (восточную Молдавию). Молдавские земли на правом берегу Прута и Валахия возвращались Турции.",description_long:'Бухарестский мирный договор - договор между Россией и Турцией подписан по итогам русско-турецкой войны 1806–1812 гг. 16/28 мая 1812 г. в Бухаресте. Со стороны России договор подписал М. И. Кутузов, со стороны Турции – Ахмед Паша. Договором определялась новая русско-турецкая границы по реке Прут (вместо прежней границы, проходящей по Днестру). Россия получала Бессарабию (восточную Молдавию). Молдавские земли на правом берегу Прута и Валахия возвращались Турции. При этом дунайские княжества получали привилегии. Сербии предоставлялось внутреннее самоуправление. Кроме того, Россия возвращала Турции все завоеванные у нее на Кавказе крепости. Земли, которые добровольно перешли к России, например Сухуми, оставались за Россией. Таким образом, Россия получила порт на кавказском побережье Черного моря. Однако главное значение Бухарестского мира заключалось в самом факте его подписания накануне войны против Наполеона. Турция не могла участвовать в войне на стороне Франции. Русская дипломатия таким образом обеспечила безопасность южных границ империи буквально за месяц до вторжения наполеоновской армии.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/77/mode/1up" target="_blank">Текст Бухарестского мирного договора</a><br />'},{precision:0,comment:null,fid:4,ruler:null,date_from:"4/4/1914",date_to:"8/14/1921",reason:"Установление протектората России над Тувой",description_short:"Установление протектората России над Тувой",description_long:"29 марта министр иностранных дел России С. Д. Сазонов подал на имя Николая II докладную записку, в которой обосновывалось предложение об удовлетворении просьбы правителей тувинских кожуунов о принятии Тувы «под русское покровительство».\n\nДОКЛАДНАЯ ЗАПИСКА МИНИСТРА ИНОСТРАННЫХ ДЕЛ НИКОЛАЮ II\n29 марта 1914 г.\nПри личном всеподданнейшем докладе 25 сего марта, повергая на благовоззрение Вашего Императорского Величества письмо иркутского генерал-губернатора с приложенными к оному прошениями урянхов хошунов Дав и Бейсе, я почел долгом высказать мои соображения о возможности удовлетворить эти прошения принятием населения Урянхайского края под русское покровительство. Этим путем, не отступая от высочайше одобренной программы мирного проникновения в сказанный край, мы положили бы конец колебаниям урянхов между присоединением к автономной Монголии и отдачею себя под русскую власть. Вашему Императорскому Величеству благоугодно было одобрить эти мои предположения.\nВо исполнение таковой высочайшей воли приемлю смелость испрашивать, не благоугодно ли будет Вашему Императорскому Величеству повелеть объявить через командированного в Урянхайский край чиновника управления иркутского генерал-губернатора населению пяти хошунов, на которые разделяется этот край, что отныне оно принято под покровительство российского правительства. По общепринятому порядку из факта установления протектората России над урянхами должно вытекать для них обязательство не иметь никаких отношений с иностранными властями иначе, как через посредство лица, представляющего на месте российское правительство. Равным образом все споры или столкновения между отдельными урянхайскими хошунами должны быть повергаемы на решение того же представителя в крае российского правительства.\nСазонов.\nСогласен. Ливадия, 4 апреля 1914 г.\nМеждународные отношения в эпоху империализма: Документы из архивов царского и Временного правительств. 1878—1917. Серия 3: 1914—1917; Т. 2: 14 марта — 13 мая 1914 г.: Гос. соц.-экон. изд-во, 1933. — С. 281—282.\n\n4 апреля 1914 г. Николай II на докладной записке министра иностранных дел С. Д. Сазонова отметил «согласен». Резолюция царя Николая II от 4 апреля 1914 г. стала отправной точкой в осуществлении комплекса мероприятий и процедур, связанных с практической реализацией установления протектората России над Тувой.\nВ секретной телеграмме С. Д. Сазонова иркутскому генерал-губернатору от 5 апреля 1914 г. указывалось, что из факта установления русского протектората «вытекает обязательство не иметь никаких сношений с иностранными, в том числе монгольскими, властями».\n\nУрянхайские правители выдали письменные заверения о строгом соблюдении этих обязательств.\nРУЧАТЕЛЬСТВО АМБЫН-НОЙОНАКОМБУ-ДОРЖУ\n4 июля 1914 г.\nКопия\nПеревод с монгольского\nГлавнозаведующего Танну-урянхами Ойнарского, Сальчжакского и Точжинского хошунов Амбаня Гомбодорчжи, имеющего награды от Великого Российского Государства: орден Святого Станислава 2-й степени и золотую медаль, для ношения на шее, и от Великого Дайцинского Государства звание и печать корпусного командира и павлинье перо\nРУЧАТЕЛЬСТВО\nС получением письменного объявления через Заведующего пограничными делами Сайта Церерина о воспоследовавшем Всемилостивейшем соизволении ЕГО ИМПЕРАТОРСКОГО ВЕЛИЧЕСТВА Государя ИМПЕРАТОРА Николая Александровича о принятии пяти урянхайских хошунов под покровительство России я, Амбань Гомбодочжи, преисполненный чувством радости и благоговения, вознес молитвы и, как верный и покорный слуга, отныне не буду иметь никаких самостоятельных непосредственных сношений с Монголией и прочими иностранными Государствами. Если таковые сношения и потребуются, то обязуюсь вести через проживающего в Урянхае представителя Российского правительства, а все споры и недоразумения, какие могут возникнуть между отдельными урянхайскими хошунами, буду повергать на его решение. В то же время всепокорнейше прошу оставить нашему урянхайскому населению свои обычаи, исповедуемую ими буддийскую религию, уклад жизни, самоуправление, должности и родные кочевья, не допуская особых изменений, клонящихся к потери власти.\n1914 года июля 4 дня\nГод Барса, 5 луны, 25 числа\nПеревел классный переводчик Самойлов.\nАрхив внешней политики Российской империи, ф. Китайский стол, №143, оп. 491, д. 3113, л. 239 (копия).\n\nПроцедура установления протектората России над Урянхайским краем была завершена 14 ноября 1914 г. начертанием царя Николая II «Успешно» на представленном министром иностранных дел Российской империи С. Д. Сазоновым докладе Иркутского генерал-губернатора от 29 октября 1914 г.\n\nИРКУТСКИЙ ГЕНЕРАЛ-ГУБЕРНАТОР\nг. Иркутск №181 29 октября 1914 г.\nЕго Высокопревосходительству С. Д. Сазонову.\nПолучено: Царское Село 14 ноября 1914 г.\n\nМилостивый Государь Сергей Дмитриевич,\nтелеграммой от 5 апреля с. г. за №721 Ваше Высокопревосходительство сообщили мне о ВЫСОЧАЙШЕМ соизволении на объявление, через командированного мною в Урянхайский край чиновника, населению всех пяти хошунов названного края о принятии их под покровительство Российского Правительства.\nЗаведующий Пограничными Делами Усинского округа Кол[лежский] Асс[есор] Церерин, на которого, согласно упомянутой телеграмме, было возложено исполнение ВЫСОЧАЙШЕГО повеления, находился в указанное время по делам службы в Иркутске и мог, как мною и было сообщено Вам телеграммою от 11 апреля с. г. за №3616, выехать в Урянхайский край лишь с открытием вьючного летнего пути во второй половине мая месяца. Прибыв в начале июня в Урянхайский край, он, ознакомившись с настроением урянхов, приступил к исполнению своей миссии и ныне представил мне донесение об объявлении им Урянхайским Правителям ВЫСОЧАЙШЕГО соизволения на принятие их под покровительство России.\nСогласно этому донесению, Заведующим Пограничными Делами ВЫСОЧАЙШАЯ воля была объявлена, во-первых, Амбань-Нойону как представителю Ойнарского, Точжинского и Сальчжакского хошунов, а затем Кемчикгольскому нойону и урянхам бывшего хошуна монгольского князя Бейлэ-Сандыкдорчжи, ныне хошуна 17 отоков. Объявление это Кол[лежский] Асс[есор] Церерин старался обставить возможной торжественностью и сделал его в присутствии всех оказавшихся в данное время на лицо урянхайских чиновников по заранее выработанным текстам, в копиях при сем прилагаемым, которые в монгольском переводе были переданы урянхайским правителям. Последние со своей стороны передали Заведующему Пограничными Делами препровождаемые при сем письменные обязательства о строгом соблюдении ими тех двух пунктов, которыми было обусловлено принятие урянхов под покровительство России, то есть, во-первых, не иметь никаких самостоятельных сношений с иностранными государствами, в том числе и с Монголией и, во-вторых, все споры и недоразумения повергать на решение представителя русской власти в Урянхайском крае.\nВ объявлении, переданном Амбань-Нойону упомянуто также, что он принят под покровительство России с подчиненными ему урянхами Ойнарского, Сальчжакского и Точжинского хошунов. Дело в том, что, когда два года тому назад Амбань-Нойон подал прошение о принятии его с подчиненными ему урянхами в подданство России, все три названные хошуны были ему подчинены. Но затем правители Сальчжакского и Точжинского хошунов, дабы выйти из-под опеки Амбань-Нойона, приняли подданство Ургинского хутухты и объявили себя от него независимыми. При этом правители Точжинского и Сальчжакского хошунов неизменно уклонялись от личных свиданий с Заведующим Пограничными Делами и при его посещениях из кочевий удалялись в Монголию. Что касается населения этих двух хошунов, то, тяготясь монгольскими поборами, оно все более и более склоняется на сторону России, и препятствием к признанию ими русского покровительства служило лишь честолюбие их правителей и нежелание последних подчиниться Амбань-Нойону.\nДабы устранить это препятствие, пришлось хошуны эти пока лишь формально подчинить Амбань-Нойону, и нет сомнения, что при умелом дальнейшем руководительстве деятельностью последнего со стороны представителя русской власти эти два хошуна в скором времени фактически подчинятся власти Амбань-Нойона и так же, как остальные урянхи, признают покровительство России, тем более что население их достигает цифры всего 8000 человек против 50 000 всего туземного населения Урянхая.\nКроме того, ВЫСОЧАЙШАЯ воля была также объявлена населению отдельных сумонов Мади и Чжодо, бывших до сего данниками монгольского князя Вана Намхайчжанцана. Управление этих хошунов передано Заведующим Пограничными Делами выборному чиновнику Тэригун-Цзайсану.\nТочно так же и урянхи упомянутого уже выше Бейсэ хошуна, бывшие данниками монгольского Сандыкдорчжи, по предложению Кол[лежского] Асс[есора] Церерина, выбрали себе правителя Бугдэ-Даргу и четырех помощников, к которым с утверждения Заведующего Пограничными Делами и перешло управление хошуном.\nПри этом Кол[лежским] Асс[есором] Церериным возбужден вопрос о желательности выдать всем урянхайским правителям печати, как это практиковалось китайскими, а затем монгольскими властями. По понятиям и строго установившемуся обычаю как монголов, так и урянхов должностная печать имеет у них громадное значение и фактом получения печати хошунным правителем устанавливается полная подчиненность последнего лицу, выдавшему печать. Такие печати можно было бы выдать Кемчикскому нойону, Бугдэ-Дарге «17 отоков» и Амбань-Нойону с упоминанием в тесте печати последнего, что под его управлением находятся хошуны Ойнарский, Сальчжакский и Точжинский.\nПроектируемый текст надписей на печатях будет мною сообщен Вашему Высокопревосходительству дополнительно по получении такового от Кол[лежского] Асс[есора] Церерина.\nЖелательно также сохранить награждение урянхайских правителей и чиновников монгольскими титулами и чинами с правом ношения на шапках шариков соответствующих цветов, чему они придают большое значение и пожалованием которых старалось привлечь их к себе Монгольское Правительство.\nПримите уверение в отличном моем уважении и совершенной преданности.\nВаш покорный слуга: (подпись).\nАВПРИ. Ф. Китайский стол. Оп. 491. Д. 3113. ЛЛ. 276-278."},{precision:0,comment:"протекторат",fid:5,ruler:null,date_from:"12.08.1873",date_to:"9/13/1920",reason:"Гендемианский мирный договор, Хива под протекторатом России.",description_short:"Все земли по правому берегу р. Амударьи отошли к России. Эта территория вошла в состав Амударьинской области Туркестанского генерал-губернаторства.",description_long:'Согласно Гендемианскому мирному договору, определялось зависимое положение Хивинского ханства от Российской империи. Хан признал себя «покорным слугою императора всероссийского». К России отходили все земли по правому берегу Аму-Дарьи. Русские купцы освобождались от любых торговых сборов и пошлин на территории всего ханства. Кроме того, освобождались все пленники хана и уничтожались «на вечные времена рабство и торг людьми». На Хивинское ханство налагалась «пеня в размере 2 200 000 руб. для покрытия расходов русской казны на ведение последней войны, вызванной самим ханским правительством и хивинским народом». \n\n<a href="http://www.hist.msu.ru/ER/Etext/FOREIGN/hiva.htm" target="_blank">Текст Гендемианского мирного договора между Россией и Хивой</a><br />\n'},{precision:0,comment:null,fid:6,ruler:null,date_from:"05.09.1809",date_to:"12/6/1917",reason:"Фридрихсгамский мирный договор со Швецией",description_short:"По условиям Фридрихсгамского договора Россия получала Финляндию и Аландские острова. ",description_long:'Фридрихсгамский мирный договор 5/17 сентября 1809 г. подписан между Россией и Швецией по итогам русско-шведской войны 1808–1809 гг. в г. Фридрихсгам (Финляндия). Со стороны России договор подписали Н. П. Румянцев и Д. М. Алопеус, со стороны Швеции – Л. Стединг и А. Шёльдебранд. По условиям договора Россия получала Финляндию и Аландские острова. Граница между Россией и Швецией проводилась по рекам Торнио и Муонно. Швеция обязывалась подписать мирные договоры с Францией и Данией и закрыть порты для британских судов. Восстанавливалась русско-шведская торговля. Швеция получала право на ежегодную беспошлинную закупку в русских портах зерна и муки в количестве 50 тыс. четвертей. За Россией сохранялось право беспошлинного вывоза в течение трех лет из Швеции меди, железа, извести, камня, из Финляндии – скота, рыбы, хлеба, смолы, леса. Секвестрированное во время войны имущество возвращалось владельцам с обеих сторон. Ряд статей договора регулировал правовое и имущественное положение шведского населения на территории Финляндии и финского на территории Швеции. \n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147709" target="_blank">Текст Фридрихсгамского мирного договора</a><br />'},{precision:1,comment:null,fid:7,ruler:null,date_from:"30.08.1721",date_to:"7/28/1914",reason:"вопрос о переносе столицы в Санкт-Петербург дискуссионный, формально земли стали русскими по Ништадтскому договору.",description_short:"Перенос столицы России из Москвы в Санкт-Петербург состоялся до формального присоединения земель к России по Ништадтскому договору, таким образом, столица размещалась на территории, формально принадлежащей другому государству. ",description_long:'Ништадский мирный договор (30 августа (10 сентября) 1721)\nНиштадский мирный договор – договор между Россией и Швецией, завершивший Северную войну 1700–1721 гг. Был заключен в городе Ништадт (ныне Уусикаупунки, Финляндия) 30 августа (10 сентября 1721 г.). Со стороны России договор был подписан Я. В. Брюсом и А. И. Остерманом, со стороны Швеции – Ю. Лилльенстедтом и О. Стрёмфельдом.\nДо подписания этого договора граница между Россией и Швецией определялась Столбовским мирным договором 1617 г. Ништадским миром за Россией были закреплены обширные территории, ранее принадлежавшие Швеции: часть Карелии с Кексгольмом к северу от Ладожского озера, Ингерманладия (Ижорская земля), часть Эстляндии с Ревелем и Нарвой, часть Лифляндии с Ригой, острова Эзель и Даго. Россия за приобретенные земли должна была выплатить Швеции денежную компенсацию в размере около полутора млн рублей, а также вернуть бóльшую часть занятой русскими войсками Финляндии. Восстанавливались торговые отношения между двумя странами: Швеции получала право ежегодно вывозить из России на 50 000 руб. хлеба без уплаты пошлин. Договор предусматривал обмен пленными и амнистию преступникам и перебежчикам, кроме казаков И. Мазепы. Дворянство перешедших к России территорий сохраняло свои привилегии, самоуправление и вероисповедание.\nТаким образом, Россия закрепила выход в Балтийское море. В ознаменование заключения Ништадского мира 22 октября (2 ноября) 1721 г. Петр I по прошению Сената принял титул Отца Отечества, Императора Всероссийского, а также Петра Великого.\n\n<a href="http://www.runivers.ru/bookreader/book9814/#page/422/mode/1up" target="_blank">Текст Ништадского мирного договора</a><br />\n\n<a href="http://raritety.rusarchives.ru/dokumenty/relyaciya-o-zaklyuchenii-mira-so-shveciey-s-opisaniem-torzhestva-podneseniya-i-prinyatiya-gosudarem" target="_blank">Реляция о заключении мира со Швецией с описанием торжества поднесения и принятия государем титула «Отца Отечества, Императора Всероссийского Петра Великого»</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466744&SECTION_ID=" target="_blank">Территориальные изменения по Ништадскому мирному договору 30 августа 1721 г.</a><br />\n'},{precision:1,comment:null,fid:9,ruler:null,date_from:"1/1/1908",date_to:"1/1/2018",reason:"Открытие двух островов Н. А. Бегичевым (Большой и Малый Бегичевы о-ва).",description_short:"Открытие двух островов Н. А. Бегичевым (Большой и Малый Бегичевы о-ва)",description_long:"О. Большой Бегичев расположен у выхода из Хатангского залива. Известен русским с начала XVII в., но уже в XVIII в. о нем забыли.\nВ апреле 1908 г. Н. А. Бегичев, проверяя сведения местных жителей об о. Сизой на севере Хатангского залива, установил, что показываемый на имевшейся у него карте полуостров к северу от залива Нордвик в действительности является островом. Бегичев не только заснял его компасной съемкой, измеряя расстояния шагомером, но и составил карту открытого острова. Ее он передал в 1909 г. начальнику Главного гидрографическогo управления А. И. Вилькицкому.\nКарта о. Бегичева не сохранилась, но о съемке Бегичева можно судить по изображению о. Бегичева на карте «От устья Лены до реки Таймыра» составленной в 1912 г. (Эвальд, 1917, стр. 66, # 643).\nНастоящее название острову дано в 1908 г. ИРГО по предложению академика Ф. Н. Чернышева.\nО. Малый Бегичев находится недалеко от западного берега о. Большой Бегичев. Впервые обнаружен Х. П. Лаптевым в 1739 году, назвавшим его островом Святого Николая. Вторично открыт Бегичевым. Назван по ассоциации с о. Большой Бегичев в 1933 г. гидрографической экспедицией на шхуне «Пионер».\n\nКнига, скачать\nЭвальд Б. Указатель картографических материалов Северного Ледовитоro океана (от Нордкапа до мыса Дежнева) с 1734 по 1914 г., хранящихся в Депо морских карт и книг Главного гидрографического управления. <Записки по гидрографии>, 1917, вып. 2."},{precision:0,comment:null,fid:10,ruler:null,date_from:"15.03.1898",date_to:"8/23/1905",reason:"Русско-китайская конвенция об аренде Квантунской области (прекращена Портсмутским договором)",description_short:"Русско-китайская конвенция об аренде на 25 лет Квантунской области с портами Порт-Артур (Люйшунь) и Дальний (Далянь) ",description_long:'Согласно статьям I, II и III русско-китайской конвенции 1898 г. Россия получила в полное и исключительное арендное пользование на 25 лет порты Порт-Артур (Люйшунь) и Дальний (Далянь) с прилегающим водным и территориальным пространством при сохранении и ненарушении верховных прав империи Цин на данную территорию. Также было разрешено проложить к этим портам железную дорогу от одного из пунктов Китайско-Восточной железной дороги (КВЖД).\nСогласно статьям IV и V данной конвенции, на арендуемых территориях военное и высшее гражданское руководство передавалось российским властям. Севернее арендуемого участка устанавливалась нейтральная зона с сохранением цинского управления и допуском в эту зону китайских войск по согласованию с русскими властями.\nСогласно статье VI конвенции, Люйшунь, как чисто военный порт России и Цин, объявлялся закрытым для судов всех других держав. Все бухты Даляня, кроме одной, которая предназначалась только для России и Цин, объявлялись свободными для доступа торговых судов всех стран.\nНа территории, полученной Россией, была образована Квантунская область.\nРоссийско-китайская конвенция прекратила действовать в связи с подписанием Портсмутского мирного договора 1905 г.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147240" target="_blank">Текст Русско-китайской конвенции 1898 г.</a><br />'},{precision:0,comment:null,fid:11,ruler:null,date_from:"8/23/1905",date_to:"8/23/1905",reason:"Портсмутский мирный договор: юг Сахалина по 50-й параллели передан Японии",description_short:"Согласно Портсмутскому договору юг Сахалина по 50-й параллели был передан Японии.",description_long:'Портсмутский мирный договор был подписан 23.08.1905 по итогам русско-японской войны 1904–1905 гг. в г. Портсмут (США). С русской стороны его подписали С. Ю. Витте и Р. Р. Розен, с японской – Комура и Такахира. Посредниками выступили США. По условиям договора Россия признавала Корею зоной японского влияния. К Японии переходили арендные права на Ляодунский полуостров с Порт-Артуром и Дальним, а также на Южно-Маньчжурскую железную дорогу от Порт-Артура до Куань-Чен-Цзы. Сахалин был поделен на две части. Южная отходила к Японии, северная оставалась за Россией.\nС учетом того, что Россия была побежденной стороной, условия Портсмутского мирного договора были большой победой русской дипломатии. России удалось избежать уплаты контрибуции, а также ограничений на содержание российского морского флота на Дальнем Востоке. \n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147033" target="_blank">Портсмутский договор</a><br />\n\n<a href="https://dlib.rsl.ru/viewer/01008028878#?page=380" target="_blank">Оригинал Портсмутского договора</a><br />'},{precision:1,comment:null,fid:12,ruler:null,date_from:"29.08.1885",date_to:"01.12.1885",reason:"Русско-британская комиссия по разграничению",description_short:"Россия закрепила за собой Пендинский оазис, Афганистан сохранил за собой Зульфагарский проход, соединяющий Пендинский оазис и приграничные районы Афганистана и Персии.",description_long:'После столкновения российского отряда в 1885 г. с афганскими войсками у реки Кушки у Великобритании возникло опасение относительно дальнейшего продвижения России в Азию в южном направлении. Был подписан Лондонский протокол, который описывал границу от Зульфагара («Зульфагарская башня») на реке Герируд, по которой проходила граница Афганистана с Персией, на север и затем на северо-восток до реки Амударья. Протоколом предусматривалось, что каждая сторона назначит по одному комиссару, который начнет работу по демаркации через два месяца после подписания соглашения.\nЗаключительный Санкт-Петербургский протокол подписан 10.07.1887.\nСогласно этому протоколу Россия закрепила за собой Пендинский оазис, где в 1890 г. была основана крепость Кушка (ныне город Серхетабат, Туркмения); Афганистан сохранил за собой Зульфагарский проход, соединяющий Пендинский оазис и приграничные районы Афганистана и Персии. Впоследствии документы и карты российско-британской комиссии было решено использовать при редемаркации части границы между СССР и Афганистаном по соглашению между ними от 13.06.1946.\n\n<a href="http://www.runivers.ru/bookreader/book10091/#page/463/mode/1up" target="_blank">Лондонский протокол относительно определения границы от Ходжа-Салеха до Герируда</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book10091/#page/480/mode/1up" target="_blank">Санкт-Петербургский протокол относительно разграничения афганских владений на левом берегу Аму-Дарьи</a><br />'},{precision:1,comment:null,fid:14,ruler:null,date_from:"01.01.1881",date_to:"01.01.1881",reason:"Продвижение в Туркмении в результате Ахал-Текинской экспедиции",description_short:"Продвижение в Туркмении в результате Ахал-Текинской экспедиции, завоевание Ахалтекинского оазиса",description_long:null},{precision:0,comment:null,fid:15,ruler:null,date_from:"27.02.1895",date_to:"02.03.1895",reason:"Русско-британское соглашение о разделе Бадахшана.",description_short:"Оформление границы Бухарского эмирата под протекторатом России",description_long:'Согласно Русско-британскому соглашению, сферы влияния России и Англии на восток от озера Зор-Куль (Виктория) будут разделены пограничной чертой, которая, начинаясь от точки на этом озере близ его восточной оконечности, пойдет по гребню горной цепи, тянущейся несколько южнее параллели сего озера до перевалов Бендерского и Орта-Бель.\nОттуда пограничная черта пойдет по сказанной горной цепи, доколе эта цепь находится южнее параллели упомянутого озера. Достигнув этой параллели, пограничная черта спустится по откосу цепи к Кизиль-Рабату, лежащему на реке Аксу, если только эта местность не находится севернее параллели озера Виктории; от этого пункта пограничная черта пойдет по направлению на восток, дабы примкнуть к китайской границе.\n\n<a href="http://www.runivers.ru/bookreader/book10091/#page/513/mode/1up" target="_blank">Соглашение по предмету разграничения сфер влияния России и Великобритании в области Памиров</a><br />'},{precision:0,comment:"аренда",fid:16,ruler:null,date_from:"21.03.1800",date_to:"25.06.1807",reason:"Конвенция о создании Республики Семи Островов",description_short:"Создание Республики Семи островов под протекторатом России и Турции на протяжении 1800–1807 гг.",description_long:'21 марта 1800 г. в Константинополе Российская и Османская империи подписали конвенцию, согласно которой на территории трех бывших французских департаментов, за исключением городов Первеза, Воница, Бутринти и Парга, расположенных на континенте, была образована Республика Семи Островов под покровительством двух империй на островах Керкира, Паксос, Лефкас, Кефалиния, Итака, Закинф и Китира в Ионическом море.\n\n<a href="http://www.runivers.ru/bookreader/book9834/#page/87/mode/1up" target="_blank">Константинопольская конвенция 1800 г.</a><br />'},{precision:0,comment:"аренда",fid:17,ruler:null,date_from:"21.03.1800",date_to:"25.06.1807",reason:"Конвенция о создании Республики Семи Островов",description_short:"Создание Республики Семи островов под протекторатом России и Турции на протяжении 1800–1807 гг.",description_long:'21 марта 1800 г. в Константинополе Российская и Османская империи подписали конвенцию, согласно которой на территории трех бывших французских департаментов, за исключением городов Первеза, Воница, Бутринти и Парга, расположенных на континенте, была образована Республика Семи Островов под покровительством двух империй на островах Керкира, Паксос, Лефкас, Кефалиния, Итака, Закинф и Китира в Ионическом море.\n\n<a href="http://www.runivers.ru/bookreader/book9834/#page/87/mode/1up" target="_blank">Константинопольская конвенция 1800 г.</a><br />'},{precision:0,comment:"аренда",fid:18,ruler:null,date_from:"21.03.1800",date_to:"25.06.1807",reason:"Конвенция о создании Республики Семи Островов",description_short:"Создание Республики Семи островов под протекторатом России и Турции на протяжении 1800–1807 гг.",description_long:'21 марта 1800 г. в Константинополе Российская и Османская империи подписали конвенцию, согласно которой на территории трех бывших французских департаментов, за исключением городов Первеза, Воница, Бутринти и Парга, расположенных на континенте, была образована Республика Семи Островов под покровительством двух империй на островах Керкира, Паксос, Лефкас, Кефалиния, Итака, Закинф и Китира в Ионическом море.\n\n<a href="http://www.runivers.ru/bookreader/book9834/#page/87/mode/1up" target="_blank">Константинопольская конвенция 1800 г.</a><br />'},{precision:1,comment:null,fid:19,ruler:null,date_from:"01.01.1832",date_to:"8/10/1913",reason:null,description_short:"По Лондонской конвенции княжество Самос получило статус вассального княжества под сюзеренитетом Османской империи и защитой Российской империи, Британской империи и Королевства Франция",description_long:'<a href="http://www.runivers.ru/bookreader/book10090/#page/384/mode/1up" target="_blank">Лондонская конвенция 1827 г.</a><br />'},{precision:0,comment:"бухарский эмир признал вассалитет по отношению к Российской империи",fid:20,ruler:null,date_from:"01.07.1878",date_to:"01.07.1878",reason:"Батум, Ардаган и Карс отошли по Берлинскому трактату к России.",description_short:"Батум, Ардаган и Карс отошли по Берлинскому трактату к России.",description_long:'Согласно Берлинскому трактату, подписанному 1 июля 1878 г., как итог Берлинского конгресса, завершившего Русско-турецкую войну 1877—1878 гг., «долина Алашкерта и город Баязет, уступленные России статьей XIX Сан-Стефанского договора, возвращаются Турции».\n«Блистательная Порта (Османская империя) уступает Российской империи в Азии территории Ардагана, Карса и Батума, с портом последнего, равно как и все территории, заключающиеся между прежней русско-турецкой границей и следующей пограничной чертой».\n\n<a href="http://www.runivers.ru/bookreader/book10088/#page/665/mode/1up" target="_blank">Берлинский трактат</a><br />'},{precision:1,comment:"Бухара под протекторатом России",fid:21,ruler:null,date_from:"01.01.1877",date_to:null,reason:"Присоединение к Бухаре Дарваза и Каратегина",description_short:"Присоединение к Бухарскому эмирату, который был под протекторатом России, Дарваза и Каратегина",description_long:null},{precision:1,comment:null,fid:22,ruler:null,date_from:"01.01.1876",date_to:"01.01.1876",reason:"Расширение владений Бухары присоединением Гиссарского и Кулябского бекств",description_short:"При поддержке России Бухара возвратила бекства Гиссар и Куляб под протекторат России.",description_long:null},{precision:1,comment:null,fid:23,ruler:null,date_from:"01.02.1876",date_to:"01.02.1876",reason:"Ликвидация независимости Кокандского ханства",description_short:"Самостоятельность Кокандского ханства была ликвидирована. Его территория была включена в состав Туркестанского генерал-губернаторства в качестве Ферганской области. ",description_long:"В 1868 г. Кокандское ханство заключило с Россией торговый договор.\nЭтот договор сократил налоговые поступления в ханскую казну, которую попытались наполнить за счет увеличения поборов с местного населения. Последовали восстания, которые были подавлены русскими войсками.\n23 сентября 1875 г. был подписан мирный договор, который предусматривал отказ Кокандского хана от дипломатических соглашений с какой-либо державой, кроме России. Часть земель на правом берегу Сыр-Дарьи была включена в состав Туркестанского генерал-губернаторства.\nОднако восстания продолжались и после этого договора. 2 января 1876 г. Коканд был занят войсками генерала М. Д. Скобелева. Самостоятельность Кокандского ханства была ликвидирована полностью. Его территория была включена в состав Туркестанского генерал-губернаторства в качестве Ферганской области. Военным губернатором края стал М. Д. Скобелев."},{precision:0,comment:null,fid:24,ruler:null,date_from:"25.04.1875",date_to:"1/1/2018",reason:"Санкт-Петербургский договор с Японией о разделе территорий",description_short:"России в обмен на 18 Курильских островов (Шумшу, Алаид, Парамушир, Маканруши, Онекотан, Харимкотан, Экарма, Шиашкотан, Муссир, Райкоке, Матуа, Растуа, островки Среднева и Ушисир, Кетой, Симусир, Бротон, островки Черпой и Брат Черпоев, Уруп) был полностью передан остров Сахалин.",description_long:'В собственность Российской империи в обмен на 18 Курильских островов (Шумшу, Алаид, Парамушир, Маканруши, Онекотан, Харимкотан, Экарма, Шиашкотан, Муссир, Райкоке, Матуа, Растуа, островки Среднева и Ушисир, Кетой, Симусир, Бротон, островки Черпой и Брат Черпоев, Уруп) был полностью передан остров Сахалин.\nСанкт-Петербургский договор сохранял силу вплоть до 1905 г., когда по итогам русско-японской войны был подписан Портсмутский мирный договор, по которому Россия уступала победившей Японии все Куpилы и южный Сахалин.\n\n<a href="http://www.runivers.ru/bookreader/book9975/#page/195/mode/1up" target="_blank">Санкт-Петербургский договор 1875 г. Оригинальный текст</a><br />\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B0%D0%BD%D0%BA%D1%82-%D0%9F%D0%B5%D1%82%D0%B5%D1%80%D0%B1%D1%83%D1%80%D0%B3%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1875)" target="_blank">Текст в современной орфографии</a><br />'},{precision:0,comment:null,fid:25,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:26,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:null,fid:27,ruler:null,date_from:"01.01.1868",date_to:"01.02.1876",reason:"Торговый договор России и Коканда.",description_short:"Кокандское ханство стало экономически зависимым от России. В 1875–1876 гг. Россия оккупировала его и превратила в Ферганскую область Туркестанского генерал-губернаторства.",description_long:"После принятия Кокандским ханством в январе 1868 г. торгового договора оно стало зависимым от России государством. Договор фактически превращал Кокандское ханство в контролируемый царским правительством рынок сбыта русских товаров и источник сырьевых ресурсов.\nКокандское ханство существовало еще восемь лет. В 1875–1876 гг. Россия оккупировала его и превратила в Ферганскую область Туркестанского генерал-губернаторства."},{precision:0,comment:null,fid:28,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:29,ruler:null,date_from:"12.08.1873",date_to:"12.08.1873",reason:"Гендемианский мирный договор, Хива под протекторатом России; Бухарский эмират под протекторатом России",description_short:"По Гендемианскому мирному договору хивинский хан Сеид Мухаммед-Рахим II признавал себя вассалом России. ",description_long:'С 12 августа 1873 г. по Гендемианскому мирному договору хивинский хан отказывался от самостоятельной внешней политики, принял обязательство не предпринимать никаких военных действий без ведома и разрешения русских властей. Территория ханства на правом берегу реки Амударьи переходила к России. Русские купцы получили право беспошлинного провоза товаров и торговли на территории ханства. В ханстве уничтожались рабство и работорговля. На Хивинское ханство налагалась «пеня в размере 2 200 000 руб. для покрытия расходов русской казны на ведение последней войны, вызванной самим ханским правительством и хивинским народом».\n\n<a href="http://www.hist.msu.ru/ER/Etext/FOREIGN/hiva.htm" target="_blank">Текст Гендемианского мирного договора между Россией и Хивой</a><br />'},{precision:1,comment:null,fid:30,ruler:null,date_from:"01.01.1871",date_to:"01.01.1871",reason:"Расширение русскими войсками Самаркандской области.",description_short:"В 1868 г. Самарканд был занят русскими войсками, присоединен к Российской империи и стал центром Зеравшанского округа, преобразованного в 1887 г. в Самаркандскую область. В 1870–1871 гг. Самаркандская область была расширена за счет присоединения бекств в верховьях Зеравшана и Кашкадарьи.",description_long:null},{precision:1,comment:null,fid:30,ruler:null,date_from:"01.01.1871",date_to:"01.01.1871",reason:"расширение русскими войсками Самаркандской области",description_short:"В 1868 г. Самарканд был занят русскими войсками, присоединен к Российской империи и стал центром Зеравшанского округа, преобразованного в 1887 г. в Самаркандскую область. В 1870–1871 гг. Самаркандская область была расширена за счет присоединения бекств в верховьях Зеравшана и Кашкадарьи.",description_long:null},{precision:1,comment:null,fid:31,ruler:null,date_from:"01.01.1870",date_to:"01.01.1870",reason:"Искандер-Кульская экспедиция 1870 г.",description_short:"Искандер-Кульская экспедиция 1870 г. подготовила присоединение к России зависимых территорий Бухары – горных бекств: Матчинского, Фалгорского, Фарабского, Магианского и Кштутского.",description_long:null},{precision:1,comment:"очень условно и дата и граница",fid:32,ruler:null,date_from:"01.01.1870",date_to:"01.01.1870",reason:"Расширение владений России, образование Красноводского приставства.",description_short:"В 1869 г. основан форт Красноводск, который обозначил продвижение русского влияния в Закаспийской области. В 1870 г. было образовано Красноводское приставство.",description_long:null},{precision:0,comment:"Бухарский эмират - вассальное государство",fid:33,ruler:null,date_from:"23.06.1868",date_to:"23.06.1868",reason:"Занятие русскими войсками Самаркандской области",description_short:"Бухарский эмир признал вассалитет по отношению к России.",description_long:"После успешных Бухарских походов русских войск, 23 июня 1868 г. был заключен русско-бухарский договор, согласно которому Бухарский эмират переходил под протекторат России.\nБухарский эмир Музаффар ад-Дин признал вхождение в состав Российской империи части территории Бухарского эмирата с городами Джизак, Ура-Тюбе и Ходжент.\nИз этих территорий был образован Зеравшанский округ с двумя отделами: Самаркандским и Катта-Курганским. Главой округа и руководителем военно-народной администрации был назначен А. К. Абрамов, произведенный в генерал-майоры.\nДоговор не был ратифицирован Александром II."},{precision:0,comment:"условно обозначена территория мордвы, до Свияжской присяги находившаяся в некоторой зависимости от РГ",fid:33,ruler:null,date_from:"23.06.1868",date_to:"23.06.1868",reason:"Занятие русскими войсками Самаркандской области.",description_short:"Бухарский эмир признал вассалитет по отношению к России. ",description_long:"После успешных Бухарских походов русских войск, 23 июня 1868 г. был заключен русско-бухарский договор, согласно которому Бухарский эмират переходил под протекторат России.\nБухарский эмир Музаффар ад-Дин признал вхождение в состав Российской империи части территории Бухарского эмирата с городами Джизак, Ура-Тюбе и Ходжент.\nИз этих территорий был образован Зеравшанский округ с двумя отделами: Самаркандским и Катта-Курганским. Главой округа и руководителем военно-народной администрации был назначен А. К. Абрамов, произведенный в генерал-майоры.\nДоговор не был ратифицирован Александром II."},{precision:0,comment:null,fid:34,ruler:null,date_from:"17.08.1866",date_to:"17.08.1866",reason:"Включение в Туркестанскую область Ташкента и Ходжента",description_short:"Ташкент, Ходжент, Зачирчикский край были присоединены к Туркестанской области.",description_long:"Через 14 месяцев после захвата города русскими войсками, в августе 1866 г. был издан царский указ о присоединении Ташкента, и 27 августа 1866 г. его жители приняли русское подданство. Ташкент, Ходжент, Зачирчикский край были присоединены к Туркестанской области."},{precision:0,comment:"продвижение по Новой Сибирской линии",fid:35,ruler:null,date_from:"12.02.1865",date_to:"12.02.1865",reason:"Создание Туркестанской области",description_short:"Туркестанская область была образована из территорий Сыр-Дарьинской, Ново-Кокандской линий и завоеванных частей Кокандского ханства. ",description_long:"Туркестанская область была образована 12 февраля 1865 г. из территорий Сыр-Дарьинской, Ново-Кокандской линий и завоеванных частей Кокандского ханства. Туркестанскую область подчинили оренбургскому генерал-губернатору М. Г. Черняеву, одновременно являвшемуся командующим войсками Оренбургского военного округа."},{precision:1,comment:null,fid:36,ruler:null,date_from:"01.01.1797",date_to:"01.01.1867",reason:"Тарковский шамхал стал вассалом Российского императора",description_short:"Тарковское шамхальство стало вассалом Российской империи",description_long:null},{precision:1,comment:null,fid:37,ruler:null,date_from:"01.01.1859",date_to:"01.01.1867",reason:"Княжество в Нижней Сванетии",description_short:"Сванетия вошла в состав Кутаисского генерал-губернаторства",description_long:"В 1833–1840 гг. княжество Сванетия номинально вошло в состав Российской империи. К 1859 г. княжество было упразднено и район составил отдельное приставство Сванетия в составе Кутаисского генерал-губернаторства."},{precision:0,comment:"протекторат",fid:38,ruler:null,date_from:"17.02.1810",date_to:"01.01.1864",reason:"Манифест о присоединении Абхазского княжества к России.",description_short:"Манифест о присоединении Абхазского княжества к Российской империи",description_long:'В 1809 г. князь Георгий Шарвашидзе подписал «всеподданнейшие просительные пункты», в которых попросил российского императора Александра I взять Абхазию под свою защиту. Он отдавал себя и «все находящееся в Абхазии в наследственное подданство… монарха всероссийского» при условии, что он станет новым правителем княжества. Несмотря на то, что Шарвашидзе на момент просьбы находился в Мингрелии, а владетелем Абхазии был его брат Аслан-бей, в 1810 г. просьба была удовлетворена, и Абхазия получила покровительство Российской империи, а Георгий Шарвашидзе был утвержден в качестве нового правителя Абхазии. \n\n\n<a href="http://apsnyteka.org/images/i/ab_h_obl4-big.jpg" target="_blank">Грамота, данная 17 февр. 1810 г. императором Александром I владетелю Абхазии князю Георгию Шарвашидзе, с просительными пунктами стр.1</a><br />\n\n<a href="http://apsnyteka.org/images/i/ab_h_obl5-big.jpg" target="_blank">Грамота, данная 17 февр. 1810 г. императором Александром I владетелю Абхазии князю Георгию Шарвашидзе, с просительными пунктами стр.2</a><br />\n\n'},{precision:1,comment:null,fid:39,ruler:null,date_from:"01.01.1818",date_to:"01.01.1860",reason:"Начало экспансии генерала Ермолова.",description_short:"Начало экспансии генерала Ермолова и номинальное присутствие России на Северном Кавказе",description_long:'<a href="http://www.vostlit.info/Texts/Dokumenty/Kavkaz/XIX/1800-1820/Dvizenie/1-20/4.htm" target="_blank">Рапорт командира отдельного Грузинского корпуса генерала Ермолова Александру I о мерах покорения горцев Северного Кавказа</a><br />\n'},{precision:1,comment:"под военным управлением",fid:40,ruler:null,date_from:"01.01.1832",date_to:"01.01.1859",reason:"Установление военного управления регионом на Кавказе",description_short:"Установление военного управления регионом на Кавказе. Территория, охваченная Кавказской войной, обозначена отдельно как условно подконтрольная.",description_long:null},{precision:1,comment:null,fid:41,ruler:null,date_from:"01.01.1803",date_to:"01.01.1857",reason:"Мегрелия признала российское подданство.",description_short:"Мегрелия признала российское подданство.",description_long:"В 1803 г. правитель Мегрельского княжества Григорий Дадиани вступил в российское подданство. С 1857 г. введено российское управление. В 1867 г. княжество было упразднено и вошло в состав Российской империи (Кутаисская губерния)."},{precision:1,comment:null,fid:42,ruler:null,date_from:"01.01.1833",date_to:"01.01.1859",reason:"Автономное княжество в Сванетии.",description_short:"Княжество Сванетия вошло в состав России.",description_long:null},{precision:0,comment:"продвижение по Сырдарьинской оборонительной линии",fid:43,ruler:null,date_from:"23.09.1861",date_to:"01.01.1861",reason:"Занятие Яны-Кургана русскими войсками.",description_short:"Занятие Яны-Кургана русскими войсками привело к расширению территории российского государства",description_long:"23 сентября 1861 г. русские войска разрушили кокандскую крепость Яны-Курган на правобережье Сыр-Дарьи. Так постепенно были образованы Оренбургская и Западно-Сибирская, а впоследствии Сыр-Дарьинская пограничные линии."},{precision:1,comment:null,fid:44,ruler:null,date_from:"01.01.1732",date_to:"19.05.1854",reason:"Протекторат России над Средним жузом",description_short:"Протекторат России над Средним жузом",description_long:"В 1732 г. российской императрице Анне Иоанновне присягнул хан Среднего жуза Самеке. Средний жуз — группа казахских племенных объединений в Центральном, Северном и Восточном Казахстане."},{precision:0,comment:null,fid:45,ruler:null,date_from:"27.07.1853",date_to:"27.07.1853",reason:"Захват Ак-Мечети.",description_short:"Взятие укрепления Ак-Мечеть привело к дальнейшему завоеванию Кокандского ханства.",description_long:null},{precision:0,comment:null,fid:46,ruler:null,date_from:"02.11.1860",date_to:"02.11.1860",reason:"Пекинский трактат",description_short:"Согласно Пекинскому договору от 1860 г., Россия получила Приморский край.",description_long:'Согласно Пекинскому договору, заключенному 2 ноября 1860 г., «с сих пор восточная граница между двумя государствами, начиная от слияния рек Шилки и Аргуни, пойдет вниз по течению реки Амура до места слияния сей последней реки с рекой Усури. Земли, лежащие по левому берегу (на север) реки Амура, принадлежат российскому государству, а земли, лежащие на правом берегу (на юг), до устья реки Усури, принадлежат китайскому государству. Далее от устья реки Усури до озера Хинкай граничная линия идет по рекам Усури и Сунгача.\nЗемли, лежащие по восточному (правому) берегу сих рек, принадлежат российскому государству, а по западному (левому) – китайскому государству. Затем граничная между двумя государствами линия, от истока реки Сун\'гача, пересекает озеро Хинкай и идет к реке Бэлэн-хэ (Тур), от устья же сей последней, по горному хребту, к устью реки Хубиту (Хубту), а отсюда по горам, лежащим между рекой Хуньчунь и морем, до реки Ту-мынь-дзян. Здесь также земли, лежащие на востоке, принадлежат российскому государству, а на запад – китайскому. Граничная линия упирается в реку Ту-мынь-дзян на двадцать китайских верст (ли), выше впадения ее в море».\n\n<a href="https://ru.wikisource.org/wiki/%D0%9F%D0%B5%D0%BA%D0%B8%D0%BD%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_(1860)" target="_blank">Текст Пекинского договора</a><br />\n'},{precision:0,comment:null,fid:47,ruler:null,date_from:"16.05.1858",date_to:null,reason:"Айгунский договор",description_short:"Согласно Айгунскому договору, левый берег Амура, от реки Аргуни до устья, признавался собственностью России, а Уссурийский край, от впадения Уссури в Амур до моря, оставался в общем владении впредь до определения границы.",description_long:'Левый берег Амура, от реки Аргуни до устья, признавался собственностью России, а Уссурийский край, от впадения Уссури в Амур до моря, оставался в общем владении впредь до определения границы.\n\n<a href="http://istmat.info/node/27120" target="_blank">Текст Айгунского договора</a><br />\n'},{precision:1,comment:"Бухарский эмират - вассальное государство",fid:48,ruler:null,date_from:"23.06.1868",date_to:"9/13/1920",reason:"бухарский эмир признал вассалитет по отношению к РИ, с сентября 1873 г. - протекторат",description_short:"Бухарский эмир признал вассалитет по отношению к России.",description_long:"После успешных Бухарских походов русских войск 23 июня 1868 г. был заключен русско-бухарский договор, согласно которому Бухарский эмират переходил под протекторат России."},{precision:"П",comment:null,fid:49,ruler:null,date_from:"15.01.1478",date_to:"1/1/2018",reason:"очень условно соотнесено с моментом присоединения Новгорода к Москве",description_short:"Присоединение Новгорода к Москве",description_long:"Московско-новгородская война (1477–1478) между Великим княжеством Московским и Новгородской республикой, имевшая место с 9 октября 1477 г. по 15 января 1478 г. завершилась падением Новгорода и присоединением его к Москве."},{precision:1,comment:null,fid:50,ruler:null,date_from:"01.01.1712",date_to:"1/1/2018",reason:"открытие Я. Пермяковым и М. Вагиным",description_short:"Открытие Я. Пермяковым и М. Вагиным островов Большой и Малый Ляховский – первых открытых островов Новосибирского архипелага",description_long:null},{precision:1,comment:null,fid:51,ruler:null,date_from:"01.01.1805",date_to:"1/1/2018",reason:"Открытие Cтолбового острова Яковом Санниковым.",description_short:"Открытие Cтолбового острова Яковом Санниковым",description_long:"Впервые этот остров, названный о. Крестовый, появляется на чертеже С. Ремезова (1698)"},{precision:1,comment:null,fid:52,ruler:null,date_from:"01.01.1808",date_to:"1/1/2018",reason:"Открытие острова св. Иоанна Н. С. Бельковым.",description_short:"Открытие острова святого Иоанна промысловиком Н. С. Бельковым. Сейчас он носит имя первооткрывателя.",description_long:null},{precision:0,comment:null,fid:53,ruler:null,date_from:"9/30/1911",date_to:"1/1/2018",reason:"В сентябре 1911 г. российский флаг поднят на о. Врангеля членами гидрографической экспедиции.",description_short:"Российский флаг поднят на о. Врангеля членами гидрографической экспедиции.",description_long:'В ходе Гидрографической экспедиции Северного Ледовитого океана (1910–1915) впервые в истории был обойден северный берег о. Врангеля, и на острове в сентябре 1911 г. был понят российский флаг.\n20 августа 1924 г. экспедиция на ледоколе «Красный Октябрь» подняла на острове советский флаг.\n20 августа 2014 г. экспедиция Тихоокеанского флота на судне «Маршал Геловани» подняла над островом Военно-морской флаг России.\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65247&mode=view" target="_blank">Карта маршрутов Гидрографической экспедиции за 1912 год</a><br />\n'},{precision:1,comment:null,fid:54,ruler:null,date_from:"01.01.1741",date_to:"1/1/2018",reason:"Открытие Командорских островов экспедицией В. Беринга",description_short:"Открытие Командорских островов экспедицией В. Беринга",description_long:"4 июня 1741 г. пакетботы «Святой Петр» и «Святой Павел» Второй Камчатской экспедиции под командованием Витуса Беринга и Алексея Чирикова вышли в плавание к берегам Америки на поиски мифической земли Хуана де Гама. Выяснив, что ее не существует, «Святой Петр» совершил плавание к западным берегам Америки. На обратном пути 7 ноября 1741 г. экипаж судна высадился на необитаемый остров для зимовки, во время которой скончался Витус Беринг. Этот остров был назван островом Беринга. Остров Медный, второй из четырех Командорских островов, был открыт промышленником Емельяном Басовым в 1743 г."},{precision:1,comment:null,fid:55,ruler:null,date_from:"01.01.1741",date_to:"1/1/2018",reason:"Открытие Командорских островов экспедицией В. Беринга.",description_short:"Открытие Командорских островов экспедицией В. Беринга",description_long:'4 июня 1741 г. пакетботы «Святой Петр» и «Святой Павел» Второй Камчатской экспедиции под командованием Витуса Беринга и Алексея Чирикова вышли в плавание к берегам Америки на поиски мифической земли Хуана де Гама. Выяснив, что ее не существует, «Святой Петр» совершил плавание к западным берегам Америки. На обратном пути 7 ноября 1741 г. экипаж судна высадился на необитаемый остров для зимовки, во время которой скончался Витус Беринг. Этот остров был назван островом Беринга. Остров Медный, второй из четырех Командорских островов, был открыт промышленником Емельяном Басовым в 1743 г.\n\n<a href="http://www.runivers.ru/maps/russatlas/34/" target="_blank">Атлас Российский, состоящий из девятнадцати специальных карт, представляющих Всероссийскую империю с пограничными землями. 1745 г. Генеральная карта Российской империи</a><br />\n\n\n<a href="http://www.runivers.ru/bookreader/book9816/#page/735/mode/1up" target="_blank">Указ Анны Иоанновны №6023. Апреля 17, 1732 г. Именной, данный Сенату «Об отправлении капитан-командора Беринга в Камчатку»</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9816/#page/756/mode/1up" target="_blank">Указ Анны Иоанновны №6023. Апреля 17, 1732 г. Именной, данный Сенату «Об отправлении капитан-командора Беринга в Камчатку»</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9816/#page/759/mode/1up" target="_blank">Указ Анны Иоанновны №6042. Мая 2, 1732 г. Сенатский «Об отправлении капитан-командора Беринга на морских судах для проведывания новых земель, лежащих между Америкою и Камчаткою»</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9816/#page/988/mode/1up" target="_blank">Указ Анны Иоанновны №6291. Декабря 28, 1732 г. Высочайшее утверждение правила, данные капитан-командору Берингу, относительно плавания его в Восточном океане</a><br />\n'},{precision:0,comment:null,fid:56,ruler:null,date_from:"12.09.1801",date_to:"10.08.1829",reason:"Манифест о присоединении к России Восточногрузинского царства.",description_short:"Манифест о присоединении к России Восточногрузинского царства",description_long:'<a href="https://web.archive.org/web/20010108062900/\nhttp://www.tuad.nsk.ru/~history/Russia/Imperia/Alexandr_I/man12-9-1801.html" target="_blank">Высочайший манифест 12-го сентября 1801 года</a><br />\n\n<a href="https://upload.wikimedia.org/wikipedia/commons/4/4a/Treaty_of_Georgievsk_of_1783_%28Esadze%2C_1913%29.JPG" target="_blank">Оригинал Манифеста. Эсадзе Б. С. Летопись Грузии (Выпуск 1). тип. Канцелярии Наместника Е.И.В. на Кавказе. 1913</a><br />\n\n\n'},{precision:1,comment:"приблизительная территория, отображенная на карте 1840 г. как земля осетин - южная часть, включенная в Тифлисскую губернию",fid:57,ruler:null,date_from:"01.01.1784",date_to:"12.09.1801",reason:"Основание крепости Владикавказ — условная дата начала распространения влияния на северную часть Осетии.",description_short:"Основание крепости Владикавказ — условная дата начала распространения влияния на северную часть Осетии",description_long:null},{precision:0,comment:"граница великого княжества Финляндского",fid:58,ruler:null,date_from:"23.12.1811",date_to:"23.12.1811",reason:"Указ императора о присоединении к Великому княжеству Финляндскому Финляндской (Выборгской) губернии",description_short:"Указ о присоединении к Великому княжеству Финляндскому Финляндской губернии. При этом название губернии было изменено на Выборгскую. ",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"до перевода Малого жуза в управление российскими чиновниками Азиатским департаментом Министерства иностранных дел и Оренбургского воен�",fid:59,ruler:null,date_from:"01.01.1731",date_to:"01.01.1844",reason:"Протекторат России над Младшим жузом",description_short:"Протекторат России над Младшим жузом",description_long:"Младший жуз — группа казахских родов и племен, состоящая из трех племенных союзов: алимулы, байулы и жетыру."},{precision:0,comment:null,fid:60,ruler:null,date_from:"19.06.1810",date_to:"01.01.1828",reason:"Гурийский князь заключил с Россией договор о протекторате.",description_short:"По договору между Россией и гурийским князем Мамией Гурийское княжество переходило под российский протекторат.",description_long:null},{precision:1,comment:"протекторат",fid:61,ruler:null,date_from:"01.01.1804",date_to:"01.0.1.1811",reason:"Протекторат России над Имеретией",description_short:"Протекторат над Имеретинским царством",description_long:"В 1804 г. имеретинский царь Соломон II принял покровительство России. В 1811 г. Имеретинское царство было преобразовано в Имеретинскую область Российской империи."},{precision:0,comment:null,fid:62,ruler:null,date_from:"24.07.1783",date_to:"12.09.1801",reason:"По Георгиевскому трактату Картли-Кахетинское царство перешло под покровительство России.",description_short:"По Георгиевскому трактату Картли-Кахетинское царство перешло под покровительство России.",description_long:'Георгиевский трактат представляет собой договор между Россией и грузинским царством Картли-Кахети (Восточная Грузия) о признании грузинским царем Ираклием II покровительства России. С грузинской стороны договор подписали князя И. Багратион и Г. Чавчавадзе, с русской – П. С. Потемкин. Россия гарантировала целостность владений грузинского царя взамен на отказ последнего от самостоятельной внешней политики. Грузинский престол оставался наследственным, но каждый раз при восшествии на него нового правителя требовалось разрешения русского царя. Грузии предоставлялась внутренняя автономия. Грузинские привилегированные сословия уравнивались в правах с русскими. Россия не только обязывалась защищать Грузию в случае нападения на нее, но должна была дипломатическими путями настаивать на возвращение ей отторгнутых Турцией территорий.\n\nГеоргиевский трактат значительно укрепил позиции России в Закавказье и защитил Восточную Грузию от посягательств на ее территории со стороны Турции и Персии. Вместе с тем он открыл перспективу полного присоединения Грузии к России.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147497" target="_blank">Текст Георгиевского трактата</a><br />'},{precision:1,comment:null,fid:63,ruler:null,date_from:"01.01.1811",date_to:"01.01.1830",reason:"Земли осетин (южная часть), условная граница",description_short:"С ликвидацией независимости соседней Имеретии южная часть осетинских земель оказалась окружена со всех сторон территориями, подконтрольными России.",description_long:null},{precision:0,comment:"ханское правление",fid:64,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />'},{precision:0,comment:"ханское правление",fid:65,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />'},{precision:0,comment:"переход к России ханств Бакинского,Карабахского,Гянджинского, Ширванского, Шекинского,Дербентского,Кубинского",fid:66,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />'},{precision:0,comment:"ханское правление",fid:67,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />\n'},{precision:0,comment:"ханское правление",fid:68,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />'},{precision:0,comment:null,fid:69,ruler:null,date_from:"12.10.1813",date_to:"01.01.1822",reason:"Гюлистанский мирный договор с Персией",description_short:"По Гюлистанскому договору Персия признала присоединение к России Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств.",description_long:'Договор между Россией и Персией был подписан в местечке Гюлистан (в Карабахе) по итогам русско-персидской войны 1804–1813 гг. Персидский шах, поддерживаемый сначала наполеоновской Францией, а с 1809 г. Англией, старался не допустить присоединения Закавказья к России. Однако военные успехи русской армии в Закавказье и поражение Наполеона в России заставили персидское правительство согласиться на мирные условия, предложенные русской стороной. Персия признала присоединение Дагестана, Восточной Грузии, а также Карабахского, Ганджинского, Шекинского, Ширванского, Дербентского, Кубинского, Бакинского и Талышского ханств к России. Кроме того, Россия получила исключительное право иметь в Каспийском море военный флот. Русские и персидские купцы получали право свободной торговли.\n\nПерсидская сторона не считала для себя Гюлистанский договор окончательным. При поддержке Англии она, начиная с 1815 г., предпринимала попытки его пересмотра. В 1826 г. это привело к новой русско-персидской войне.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/236/mode/1up" target="_blank">Текст Гюлистанского мирного договора</a><br />\n'},{precision:0,comment:"международный протекторат Австрии, Пруссии и России над г. Краковым",fid:70,ruler:null,date_from:"09.06.1815",date_to:"06.11.1846",reason:"Подписан Генеральный акт Венского конгресса",description_short:"Согласно решениям Венского конгресса, Краков был сделан вольным городом (независимая нейтральная республика Вольный город Краков) под протекторатом Российской империи, Австрии и Пруссии.",description_long:'<a href="http://www.runivers.ru/bookreader/book10082/#page/371" target="_blank">Дополнительный трактат о Кракове, области его и конституции, заключенный в Вене между Россиею, Австриею и Пруссиею</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9735/#page/1/mode/1up" target="_blank">Вольный город Краков и его конституция</a><br />'},{precision:0,comment:"личная уния императора Александра 1",fid:71,ruler:null,date_from:"06.11.1815",date_to:"01.01.1832",reason:"Венский конгресс",description_short:"Согласно решениям Венского конгресса, Россия вернула Пруссии Торн и Австрии часть восточной Галиции, полученную по условиям венского мира 1809 г. К России отошла часть герцогства Варшавского под названием Царство Польское. ",description_long:'<a href="http://www.runivers.ru/newenc/474598/" target="_blank">Венский конгресс</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book10082/#page/220" target="_blank">Акт Венскаго Конгресса, подписанный 28 мая(9 июня) 1815 года, с приложениями</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book10082/#page/330" target="_blank">Трактат относительно Польши, заключенный в Вене между Россиею и Австриею</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book10082/#page/346" target="_blank">Трактат относительно Польши, заключенный в Вене между Россиею и Пруссиею</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466775&SECTION_ID=" target="_blank">Политическая карта Западной Европы после Венского конгресса 1815 г.</a><br />'},{precision:1,comment:null,fid:72,ruler:null,date_from:"01.01.1827",date_to:"01.01.1827",reason:"Балкария вошла в состав Российской империи.",description_short:"Балкария вошла в состав Российской империи.",description_long:'11 января 1827 г. в Ставрополе делегацией балкарских князей генералу Георгию Эммануэлю было подано прошение о принятии Балкарии в подданство России.\nГенерал Эммануэль привел балкарцев и дигорцев к присяге и письменно обещал ходатайствовать перед государем о сохранении за ними всего того, о чем они просили. Обо всем происшедшем генерал Эммануэль донес командующему Кавказской армией генерал-адъютанту Паскевичу, а тот довел до сведения императора Николая I. \n2 мая 1827 г. начальник главного штаба Дибич уведомил Паскевича о том, что государь с удовольствием узнал о подданстве горцев и приписал это событие «благоразумным мерам и кроткому с сими горцами обхождению генерал-лейтенанта Емануэля».\nУсловия присяги 1827 г. были подтверждены делегации балкарских князей во время их визита к российскому императору в 1852 г. В докладной записке канцелярии военного министра от 22 апреля 1852 г. министру о дозволении прибыть в Санкт-Петербург депутации от горских обществ Балкарии записано: «...Поименованные племена, по засвидетельствованию начальника Кавказской линии, отличаются постоянной преданностью правительству и примерным повиновением местным властям...»\n\n<a href="http://www.vostlit.info/Texts/Dokumenty/Kavkaz/XIX/1820-1840/Probl_kavk_vojny/1-20/1.htm" target="_blank">Текст прошения</a><br />\n'},{precision:0,comment:null,fid:73,ruler:null,date_from:"10.02.1828",date_to:"10.02.1828",reason:"Туркманчайский мир с Персией",description_short:"По Туркманчайскому мирному договору к России отошли территории Эриванского и Нахичеванского ханства.",description_long:'Договор был подписан между Россией и Персией в деревне Туркманчай (близ Тебриза) по итогам русско-персидской войны 1826–1828 гг. С русской стороны его подписали И. Ф. Паскевич и А. М. Обресков, с персидской – Аббас-Мирза и мирза Абуд-Хасан-Хан. Подготовкой текста договора и предварительными переговорами со стороны России занимался А. С. Грибоедов.\n\nПо условиям договора Россия получала Эриванское и Нахичеванское ханства (Восточная Армения). Персидские власти обязывались не препятствовать переселению армян в Россию. Персия должна была выплатить России контрибуцию в размере 20 млн руб. Подтверждалось исключительное право России иметь военный флот на Каспии. Русские торговые суда получали там права свободного плавания. России предоставлялся ряд торговых привилегий. К договору был приложен «Особый акт о торговле». Согласно ему, все дела и тяжбы между подданными России и подданными других держав на территории Персии подлежали юрисдикции русских дипломатических служб. Судебные дела между русскими и персами подлежали компетенции персидских властей, но должны были рассматриваться обязательно в присутствии драгоманов русской миссии. \nТуркманчайский мирный договор на долгие годы стал основой для русско-персидских отношений. Он значительно усилил положение России в Закавказье и открыл возможность для расширения политического и экономического продвижения России в Среднюю Азию.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/242/mode/1up" target="_blank">Текст Туркманчайского мирного договора</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466778&SECTION_ID=" target="_blank">Территориальные изменения по Туркманчайскому мирному договору (карта)</a><br />'},{precision:0,comment:"города Ахалцихе и Ахалкалаки Турция передала России",fid:74,ruler:null,date_from:"02.09.1829",date_to:"02.09.1829",reason:"Адрианопольский мирный договор с Турцией",description_short:"По Адрианопольскому мирному договору Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами.",description_long:'Договор подписан между Россией и Турцией по итогам русско-турецкой войны 1828–1829 гг. в г. Адрианополе (Турция). Со стороны России договор подписали А. Ф. Орлов и Ф. П. Пален, со стороны Турции – Мехмед Садык-эфенди и Абдул Кадыр-бей. Согласно договору, Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами. Русские подданные могли вести свободную торговлю на территории Турции. Русские торговые суда получали право беспрепятственно проходить проливы Босфор и Дарданеллы. Русские подданные на турецкой территории не подлежали турецкой юрисдикции. На Турцию была наложена контрибуция в 1,5 млн гульденов, которые она обязана была выплатить России в течение 1,5 лет. Дунайские княжества (Молдавия, Валахия) формально оставались в составе Турции, но получали широкую автономию. Их зависимость от Турции фактически сводилась к выплате дани. Гарантом автономии объявлялась Россия. Широкую автономию получала также Греция. Договор подтверждал автономию Сербии, предоставленную ей Аккерманской конвенцией 1826 г.\n\nАдрианопольский мир стал крупной дипломатической победой России. В ее состав почти полностью вошло Закавказье. С ее помощью значительно продвинулось дело освобождения сербского, молдавского и греческого народов от турецкого ига.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=146928" target="_blank">Текст договора</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9867/#page/623/mode/1up" target="_blank">Оригинал договора</a><br />'},{precision:0,comment:"города Ахалцихе и Ахалкалаки Турция передала России",fid:75,ruler:null,date_from:"10.08.1829",date_to:"01.01.1833",reason:"Адрианопольский мирный договор с Турцией",description_short:"По Адрианопольскому мирному договору Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами.",description_long:'Договор подписан между Россией и Турцией по итогам русско-турецкой войны 1828–1829 гг. в г. Адрианополе (Турция). Со стороны России договор подписали А. Ф. Орлов и Ф. П. Пален, со стороны Турции – Мехмед Садык-эфенди и Абдул Кадыр-бей. Согласно договору, Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами. Русские подданные могли вести свободную торговлю на территории Турции. Русские торговые суда получали право беспрепятственно проходить проливы Босфор и Дарданеллы. Русские подданные на турецкой территории не подлежали турецкой юрисдикции. На Турцию была наложена контрибуция в 1,5 млн гульденов, которые она обязана была выплатить России в течение 1,5 лет. Дунайские княжества (Молдавия, Валахия) формально оставались в составе Турции, но получали широкую автономию. Их зависимость от Турции фактически сводилась к выплате дани. Гарантом автономии объявлялась Россия. Широкую автономию получала также Греция. Договор подтверждал автономию Сербии, предоставленную ей Аккерманской конвенцией 1826 г.\n\nАдрианопольский мир стал крупной дипломатической победой России. В ее состав почти полностью вошло Закавказье. С ее помощью значительно продвинулось дело освобождения сербского, молдавского и греческого народов от турецкого ига.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=146928" target="_blank">Текст договора</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9867/#page/623/mode/1up" target="_blank">Оригинал договора</a><br />'},{precision:0,comment:null,fid:76,ruler:null,date_from:"10.08.1829",date_to:"10.08.1829",reason:"Адрианопольский мирный договор с Турцией",description_short:"По Адрианопольскому мирному договору Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами.",description_long:'Договор подписан между Россией и Турцией по итогам русско-турецкой войны 1828–1829 гг. в г. Адрианополе (Турция). Со стороны России договор подписали А. Ф. Орлов и Ф. П. Пален, со стороны Турции – Мехмед Садык-эфенди и Абдул Кадыр-бей. Согласно договору, Россия получала все Черноморское побережье Кавказа от устья Кубани до Аджарии, крепости Ахалцих и Ахалкалаки, а также устье Дуная с островами. Русские подданные могли вести свободную торговлю на территории Турции. Русские торговые суда получали право беспрепятственно проходить проливы Босфор и Дарданеллы. Русские подданные на турецкой территории не подлежали турецкой юрисдикции. На Турцию была наложена контрибуция в 1,5 млн гульденов, которые она обязана была выплатить России в течение 1,5 лет. Дунайские княжества (Молдавия, Валахия) формально оставались в составе Турции, но получали широкую автономию. Их зависимость от Турции фактически сводилась к выплате дани. Гарантом автономии объявлялась Россия. Широкую автономию получала также Греция. Договор подтверждал автономию Сербии, предоставленную ей Аккерманской конвенцией 1826 г.\n\nАдрианопольский мир стал крупной дипломатической победой России. В ее состав почти полностью вошло Закавказье. С ее помощью значительно продвинулось дело освобождения сербского, молдавского и греческого народов от турецкого ига.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=146928" target="_blank">Текст договора</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9867/#page/623/mode/1up" target="_blank">Оригинал договора</a><br />'},{precision:1,comment:'донское казачество до принесения присяги на верность "великому государю"',fid:77,ruler:null,date_from:"01.01.1849",date_to:"01.01.1849",reason:"В ходе реформы управления на Кавказе часть земель Абхазского княжества оказалась в составе Мингрелии.",description_short:"В ходе реформы управления на Кавказе произошло перераспределение территорий между зависимыми от Российской империи Абхазией и Мингрелией. Часть земель Абхазского княжества оказалась в составе Мингрелии.",description_long:null},{precision:0,comment:null,fid:78,ruler:null,date_from:"19.05.1854",date_to:"19.05.1854",reason:"Создана Область сибирских киргизов с центром в Омске.",description_short:"Создана область сибирских киргизов, которая включила не только прежние земли Омской области, но и территории к югу и западу.",description_long:'Создана административно-территориальная единица Российской империи Область сибирских киргизов, куда вошли Кокчетавский, Кушмурунский, Акмолинский, Барнаульский и Каркаралинский округа. Включила не только прежние земли Омской области, но и новые территории к югу и западу.\n\n<a href="http://www.runivers.ru/bookreader/book9917/#page/514/mode/1up" target="_blank">Область образована Высочайшим утверждением 19 мая 1854 г.\nТекст.</a><br />\n\n<a href="http://www.runivers.ru/lib/book3308/16866/" target="_blank">Материалы для географии и статистики России, собранные офицерами Генерального штаба. Область сибирских киргизов.</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:79,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:0,comment:null,fid:80,ruler:null,date_from:"13.10.1795\n",date_to:"13.10.1795",reason:"Третий раздел Польши",description_short:"В результате Третьего раздела Россия получила земли к востоку от Буга и линии Немиров – Гродно. ",description_long:'В результате Третьего раздела Польши Россия получила земли к востоку от Буга и линии Немиров – Гродно. Также Российская империя получила земли Великого Княжества Литовского, Западную Волынь и часть Холмской земли.\nТерритория, перешедшая под власть Российской империи, была разделена на губернии (Курляндскую, Виленскую и Гродненскую). Здесь были сохранены прежняя правовая система (Литовский статут), выборность судей и маршалков на сеймиках, а также крепостное право.\n\n<a href="http://www.runivers.ru/bookreader/book10081/#page/276/mode/1up" target="_blank">Конвенция относительно раздела Польши, заключенная между Россией и Пруссией, при участии Австрии</a><br />\n\n'},{precision:0,comment:null,fid:81,ruler:null,date_from:"12.01.1793",date_to:"12.01.1793",reason:"Второй раздел Польши – подписание конвенции",description_short:"После второго раздела Польши Россия получила белорусские земли до линии Динабург — Пинск — Збруч, восточную часть Полесья, украинские области Подолье и Волынь.",description_long:'12 (23) января 1793 г. Пруссия и Россия подписали конвенцию о втором разделе Польши, которая была утверждена на созванном тарговичанами Гродненском сейме (1793). Одним из главных представителей России при разделе Польши императрицей Екатериной II был назначен премьер-майор Генерального штаба Михаил Леонтьевич Булатов (1760–1825).\n\n<a href="http://www.runivers.ru/bookreader/book10086/#page/172/mode/1up" target="_blank">Конвенция между Россией и Пруссией относительно нового раздела Польши</a><br />'},{precision:0,comment:null,fid:82,ruler:null,date_from:"29.12.1791",date_to:"18.03.1856",reason:"Ясский мирный договор с Турцией",description_short:"По условиям Ясского договора с Турцией за Россией закрепилось все Северное Причерноморье, включая Крым, а также земли между Южным Бугом и Днестром.",description_long:'Договор подписан в г. Яссы по итогам русско-турецкой войны 1787–1791 гг. Со стороны России договор подписали А. Н. Самойлов, О. М. де Рибас, С. Л. Лашкарёв. Со стороны Турции – Абдулла эфенди, Ибрагим Исмет бей, Мехмед эфенди. По условиям договора восстановилось действие Кючук-Кайнарджийского мирного договора 1774 г. и Турция признавала Георгиевский трактат 1783 г. Россия получала территории между Южным Бугом и Днестром. Днестр объявлялся границей между державами. Молдавия и Валахия возвращались Турции. Однако на жителей этих областей распространялись льготы, предусмотренные Кючук-Кайнарджийским миром. На Кавказе восстанавливалась граница по реке Кубань. Турция обязывалась не нападать на Грузию и кубанские земли.\nБлагодаря Ясскому миру Россия получила возможность освоения южных территорий и развития черноморской торговли.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/69/mode/1up" target="_blank">Текст Ясского мирного договора с Турцией</a><br />\n\na href="https://ru.wikipedia.org/wiki/%D0%AF%D1%81%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B8%D1%80%D0%BD%D1%8B%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80#/media/File:%D0%9C%D0%B0%D0%BD%D0%B8%D1%84%D0%B5%D1%81%D1%82_%D0%BE_%D0%AF%D1%81%D1%81%D0%BA%D0%BE%D0%BC_%D0%BC%D0%B8%D1%80%D0%BD%D0%BE%D0%BC_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D0%B5_%D1%81_%D0%9E%D1%81%D0%BC%D0%B0%D0%BD%D1%81%D0%BA%D0%BE%D0%B9_%D0%98%D0%BC%D0%BF%D0%B5%D1%80%D0%B8%D0%B5%D0%B9,_25_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8F_1792_%D0%B3%D0%BE%D0%B4%D0%B0.JPG" target="_blank">Манифест о Ясском мирном договоре с Османской Империей, 25 февраля 1792 г.</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466762&SECTION_ID=" target="_blank">Карта "Русско-турецкая война 1787–1791 гг. Территориальное изменение по Ясскому мирному договору 29 декабря 1791 г."\n</a><br />\n\nПрисоединение Крыма к России стало логическим завершением продвижения России к Черноморскому побережью. В 1774 г. по условиям Кючук-Кайнарджийского мирного договора Крым получил автономию. Однако сохранить независимость крымскому ханству было сложно. С одной стороны, Турция не желала мириться с потерей полуострова. Султан явно надеялся на его возвращение под свой протекторат. С другой стороны, внешнеполитические интересы России также не предусматривали независимого государства на северном побережье Черного моря. Внутри самого ханства боролись две силы: протурецкая и прорусская. Зимой 1780 г. сторонники султана в Крыму подняли восстание против ориентированного на Россию хана Шахин-Гирея. Он был вынужден бежать, а его место занял сторонник султана Бахадыр-Гирей. Летом 1782 г. русские войска под командованием Г. А. Потемкина вступили в Крым под предлогом возвращения на престол Шахин-Гирея. В этом Россию поддержала Австрия. Однако в планы императрицы Екатерины II входило не восстановление на престоле изгнанного хана, а полное присоединение Крыма. Нужен был формальный повод со стороны Турции для оправдания захвата. Однако султан повода не давал. В результате было объявлено о нападении турок на Тамань. Этот сфабрикованный предлог позволил Екатерине II объявить о присоединении Крыма к России. Юридическим основанием стал Манифест «О принятии полуострова крымских жителей и прочих татарских народов в Российское подданство, острова Тамана и всей Кубанской стороны под Российскую державу» от 8 апреля 1783 г. В нем, в частности, говорилось, что императрица обязуется содержать крымских татар «наравне с природными Нашими подданными, охранять и защищать их лица, имущество, храмы и природную веру».\n\nЭта акция вызвала негативную реакцию у Англии и Франции. Возникла опасность войны. Однако очень скоро внутри Англии произошли изменения. На выборах премьер-министра победил Джемс Харисс. Сформированный им кабинет согласился с действиями Екатерины II в Крыму. Франция осталась в одиночестве. В этих условиях Турция вынуждена была де-факто (не де-юре) признать вхождение Крыма в состав России.\n\n<a href="http://www.runivers.ru/doc/d2.php?SECTION_ID=6362&CENTER_ELEMENT_ID=147028&PORTAL_ID=6362" target="_blank">Манифест о присоединении Крыма к России</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9829/#page/891/mode/1up" target="_blank">Оригинальный текст</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6358&PORTAL_ID=6358\n" target="_blank">Крым. История вхождения в Российскую Империю</a><br />'},{precision:0,comment:"прутско-днестровские земли не включены",fid:83,ruler:null,date_from:"08.04.1783",date_to:"08.04.1783",reason:"Манифест императрицы Екатерины II о присоединении Крыма к России",description_short:"Манифест императрицы Екатерины II о присоединении Крыма к России",description_long:'Присоединение Крыма к России стало логическим завершением продвижения России к Черноморскому побережью. В 1774 г. по условиям Кючук-Кайнарджийского мирного договора Крым получил автономию. Однако сохранить независимость крымскому ханству было сложно. С одной стороны, Турция не желала мириться с потерей полуострова. Султан явно надеялся на его возвращение под свой протекторат. С другой стороны, внешнеполитические интересы России также не предусматривали независимого государства на северном побережье Черного моря. Внутри самого ханства боролись две силы: протурецкая и прорусская. Зимой 1780 г. сторонники султана в Крыму подняли восстание против ориентированного на Россию хана Шахин-Гирея. Он был вынужден бежать, а его место занял сторонник султана Бахадыр-Гирей. Летом 1782 г. русские войска под командованием Г. А. Потемкина вступили в Крым под предлогом возвращения на престол Шахин-Гирея. В этом Россию поддержала Австрия. Однако в планы императрицы Екатерины II входило не восстановление на престоле изгнанного хана, а полное присоединение Крыма. Нужен был формальный повод со стороны Турции для оправдания захвата. Однако султан повода не давал. В результате было объявлено о нападении турок на Тамань. Этот сфабрикованный предлог позволил Екатерине II объявить о присоединении Крыма к России. Юридическим основанием стал Манифест «О принятии полуострова крымских жителей и прочих татарских народов в Российское подданство, острова Тамана и всей Кубанской стороны под Российскую державу» от 8 апреля 1783 г. В нем, в частности, говорилось, что императрица обязуется содержать крымских татар «наравне с природными Нашими подданными, охранять и защищать их лица, имущество, храмы и природную веру».\n\nЭта акция вызвала негативную реакцию у Англии и Франции. Возникла опасность войны. Однако очень скоро внутри Англии произошли изменения. На выборах премьер-министра победил Джемс Харисс. Сформированный им кабинет согласился с действиями Екатерины II в Крыму. Франция осталась в одиночестве. В этих условиях Турция вынуждена была де-факто (не де-юре) признать вхождение Крыма в состав России.\n\n<a href="http://www.runivers.ru/doc/d2.php?SECTION_ID=6362&CENTER_ELEMENT_ID=147028&PORTAL_ID=6362" target="_blank">Манифест о присоединении Крыма к России</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9829/#page/891/mode/1up" target="_blank">Оригинальный текст</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6358&PORTAL_ID=6358\n" target="_blank">Крым. История вхождения в Российскую Империю</a><br />'},{precision:0,comment:null,fid:84,ruler:null,date_from:"10.04.1774",date_to:"08.04.1783",reason:"Кючук-Кайнарджийский мир.",description_short:"Кючук-Кайнарджийский договор предусматривал выход Крыма из состава Османской империи. К России переходили Керчь, Ени-Кале, Азов и Кинбурн. ",description_long:'Договор был подписан в местечке Кючук-Кайнарджи на территории современной Болгарии по итогам русско-турецкой войны 1768–1772 гг. С русской стороны договор подписал А. П. Румянцев, с турецкой – Муссун Заде Мехмет Паша. Договор предусматривал выход Крыма из состава Османской империи. К России переходили Керчь, Ени-Кале, Азов и Кинбурн. Россия получала право иметь свой торговый флот на Черном море и право прохода через проливы Босфор и Дарданеллы. Русские купцы в турецких водах могли пользоваться теми же привилегиями, что и французское и английское купечество. Россия признавалась покровительницей христиан в дунайских княжествах.\n\nКючук-Кайнарджийский договор был большим успехом русской дипломатии. Он положил начало ослаблению Османской империи, обеспечивал безопасность южных границ России, открыл Черное море для русской торговли, а также усилил влияние России на Кавказе и Балканах.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147025" target="_blank">Кючук-Кайнарджийский мирный договор</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147025" target="_blank">Кючук-Кайнарджийский мирный договор</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=594011&SECTION_ID=8212" target="_blank">Территориальные изменения по Кючук-Кайнарджийскому миру</a><br />\n\n<a href="http://www.runivers.ru/lib/book8956/478692/" target="_blank">Дружинина Е. И. Кючук-Кайнарджийский мир 1774 года</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147051" target="_blank">Ратификационная грамота к Кючук-Кайнарджийскому мирному договору с личной подписью Екатерины II</a><br />'},{precision:0,comment:"международный протекторат Австрии, Пруссии и России над г. Краковым",fid:85,ruler:null,date_from:"25.07.1772",date_to:"25.07.1772",reason:"Петербургская конвенция между Россией и Австрией",description_short:"Согласно Петербургской конвенции, Россия получала от Польши Восточную Белоруссию (Гомель, Могилёв, Витебск, Полоцк) и польскую часть Ливонии.",description_long:'Петербургская трехсторонняя конвенция 25 июля/5 августа 1772 г. стала завершающим дипломатическим актом двусторонних переговоров между Россией Пруссией и Австрией о первом разделе Польши. Участие России в этом разделе было вынужденным. В ходе русско-турецкой войны 1768–1772 гг. возникла опасность, что Австрия выступит на стороне Турции. Пруссия, союзница России, не желая со своей стороны втягиваться в войну против Турции и Австрии, сговорилась с последней о разделе Польши. Россия не желала допустить сближения за своей спиной Пруссии и Австрии. Она также опасалась быть втянутой в войну на два фронта: против Турции и Австрии. Эти обстоятельства и заставили Екатерину II согласиться на раздел Польши. 6/17 февраля 1772 г. была подписана секретная русско-прусская конвенция о предварительных условиях раздела. 25 июля/5 августа 1772 г. к ней присоединилась Австрия. Согласно петербургской конвенции, Россия получала от Польши Восточную Белоруссию (Гомель, Могилёв, Витебск, Полоцк) и польскую часть Ливонии. К Пруссии отходили Вармия, Поморское (без Гданьска), Мальборкское, Хельминское (без Тороня) воеводства и частично Иновроцлавское, Гнезненское и Познанское воеводства. Всего 36 тыс. кв. км с 580 000 жителей. Австрия получила княжества Освенцимское и Заторское, а также южные части Краковского и Сандомирского воеводств. Кроме того, к ней отходили Русское воеводство без части Холмской земли, Белзское воеводство и часть Подольского воеводства. Всего около 83 тыс. кв. км с населением 2 650 000 чел.\n\nПруссия и Австрия взяли на себя обязательства дипломатической поддержки России на мирных переговорах с Турцией.\n\n<a href="http://www.runivers.ru/bookreader/book10081/#page/36/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге, относительно раздела Польши</a><br />'},{precision:0,comment:null,fid:86,ruler:null,date_from:"01.01.1772",date_to:"1/1/2018",reason:"Открытие острова Котельный Иваном Ляховым.",description_short:"Открытие острова Котельный Иваном Ляховым",description_long:"После открытия Ляховым острова на его обследование отправился землемер Хвойнов. На берегу острова он увидел медный котел, оставленный спутниками Ляхова. Хвойнов обмерил остров, описал его и назвал Котельным. С той поры и сохранилось это название.\nРанее Ляхов, в 1770 г., обнаружил Новосибирские острова. Сообщив о своем открытии в Петербург, он просил разрешить ему монопольный промысел на островах. Такое право ему было предоставлено указом Екатерины II, причем два острова императрица распорядилась называть Ляховскими (соответственно «Большим» и «Малым»)."},{precision:0,comment:null,fid:87,ruler:null,date_from:"01.01.1805\n",date_to:"1/1/2018",reason:"Вторичное открытие Фаддеевского острова Яковом Санниковым.",description_short:"Вторичное открытие Фаддеевского острова Яковом Санниковым",description_long:"Приказчик купца Сыроватского, начальник промышленной артели Яков Санников, желая расширить промыслы своего хозяина, отправился в 1805 г. на восток от Котельного острова и посетил и нанес на карту Фаддеевский остров. До него в конце XVIII в. промышленник Фаддеев открыл к востоку от Котельного другой большой (Фаддеевский) остров и устроил на нем первое русское зимовье."},{precision:0,comment:null,fid:88,ruler:null,date_from:"01.01.1806",date_to:"1/1/2018",reason:"Открытие острова Новая Сибирь.",description_short:"Открытие острова Новая Сибирь",description_long:"Остров Новая Сибирь открыта промышленником Яковом Сыроватским в 1806 г. В том же 1806 г. нижнеиндигирские охотники Чихачев, Рожин, Котевщиков и Портнягин видели эту землю. Сначала остров обозначался как «Земля, открытая купцом Сыроватским». Матвей Геденштром в 1810 г. посетил восточную часть острова, дав ему имя Новая Сибирь «по причине значительной величины острова и угрюмости». Позже от имени этого острова образовано название всего архипелага."},{precision:0,comment:null,fid:89,ruler:null,date_from:"01.01.1712",date_to:"1/1/2018",reason:"Открытие Я. Пермяковым и М. Вагиным островов Большой и Малый Ляховский.",description_short:"Открытие Я. Пермяковым и М. Вагиным островов Большой и Малый Ляховский – первых открытых островов Новосибирского архипелага.",description_long:null},{precision:0,comment:null,fid:90,ruler:null,date_from:"9/4/1913",date_to:"1/1/2018",reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:'Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20-го Сентября 1916 г.\n№15641/ Д 11\nГ. г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемом в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр Иностранных Дел Борис Штюрмер\nДиректор Нольде»\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg" target="_blank">Оригинал</a><br />\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg" target="_blank">Карта</a><br />\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65255&mode=view" target="_blank">Карта первого исследования Северной Земли</a><br />'},{precision:0,comment:null,fid:91,ruler:null,date_from:"9/4/1913",date_to:"1/1/2018",reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:"Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20 Сентября 1916 г.\n№15641/ Д 11\nГ.г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России, хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого, и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемой в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр иностранных дел Борис Штюрмер\nДиректор Нольде»\n\nОригинал:\nhttp://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg\nКарта:\nhttp://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\nКарта первого исследования Северной Земли:\nhttp://www.polarpost.ru/forum/download/file.php?id=65255&mode=view\n\nКниги, скачать\nhttp://www.polarpost.ru/forum/download/file.php?id=17395\nhttp://polarpost.ru/forum/download/file.php?id=17475\nhttps://archive.org/details/cherezledovityio008800\n"},{precision:0,comment:null,fid:92,ruler:null,date_from:"9/4/1913",date_to:"1/1/2018",reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:'Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20-го Сентября 1916 г.\n№15641/ Д 11\nГ. г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемом в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр Иностранных Дел Борис Штюрмер\nДиректор Нольде»\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg" target="_blank">Оригинал</a><br />\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg" target="_blank">Карта</a><br />\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65255&mode=view" target="_blank">Карта первого исследования Северной Земли</a><br />'},{precision:0,comment:null,fid:93,ruler:null,date_from:"9/4/1913",date_to:null,reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого.",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:'Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20-го Сентября 1916 г.\n№15641/ Д 11\nГ. г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемом в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр Иностранных Дел Борис Штюрмер\nДиректор Нольде»\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg" target="_blank">Оригинал</a><br />\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg" target="_blank">Карта</a><br />\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65255&mode=view" target="_blank">Карта первого исследования Северной Земли</a><br />'},{precision:0,comment:null,fid:94,ruler:null,date_from:"9/4/1913",date_to:"1/1/2018",reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:'Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20-го Сентября 1916 г.\n№15641/ Д 11\nГ. г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемом в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр Иностранных Дел Борис Штюрмер\nДиректор Нольде»\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg" target="_blank">Оригинал</a><br />\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg" target="_blank">Карта</a><br />\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65255&mode=view" target="_blank">Карта первого исследования Северной Земли</a><br />'},{precision:0,comment:null,fid:95,ruler:null,date_from:"9/4/1913",date_to:"1/1/2018",reason:"Открытие архипелага Северная Земля гидрографической экспедицией Б. Вилькицкого",description_short:"Открытие архипелага Земля Императора Николая II (ныне Северная Земля) гидрографической экспедицией Б. Вилькицкого",description_long:'Архипелаг открыт 4 сентября 1913 г. Гидрографической экспедицией Северного Ледовитого океана (1910–1915).\nСначала был назван словом «Тайвай» (по первым слогам экспедиционных ледоколов «Таймыр» и «Вайгач»).\nОфициальное название «Земля Императора Николая II» архипелаг получил 10 января 1914 г. согласно приказу №14 морского министра.\n20 сентября 1916 г. Россия заявила всему миру о своих правах на открытые острова.\n\nМинистерство иностранных дел\nВторой Департамент\n20-го Сентября 1916 г.\n№15641/ Д 11\nГ. г. императорским российским послам, посланникам и поверенным в делах\nМорской министр возбудил вопрос о необходимости оповещения иностранных правительств о присоединении к составу Российской империи земель и островов, открытых флигель-адъютантом кап. 2-го ранга Вилькицким во время его гидрографической экспедиции в Северном Ледовитом океане, имевшей место в 1913 и 1914 гг.\nСообщая о сем, генерал-адъютант Григорович выразил мнение о желательности воспользоваться случаем и уведомить иностранные правительства о принадлежности к российской державе других островов, находящихся у северного побережья Азиатской России хотя и открытых иностранцами, но по своему сопредельному к русскому материку положению, без сомнения, входящих в состав Российской империи.\nВполне разделяя означенные соображения морского министра, я почел долгом испросить Высочайшее его императорского величества соизволение на нотификацию правительством союзных и дружественных России стран о принадлежности к Империи земли Императора Николая II и островов цесаревича Алексея, Старокадомского, генерала Вилькицкого и Новопашенного, открытых экспедицией флигель-адъютанта Вилькицкого и островов Уединения, Беннета, Жаннета, Генриетта и Геральда, по географическому положению своему долженствующих входить в состав Империи.\nЭти предположения мои в 4-й день сего Сентября удостоились высочайшего одобрения. Соответственно таковой монаршей воле, обращаюсь к г.г. императорским российским послам, посланникам и поверенным в делах с покорнейшей просьбой сделать правительствам, при коих они аккредитованы, нотификацию, согласно препровождаемому при сем акту.\nИз прилагаемых равным образом при сем двух экземпляров карты, упоминаемом в нотификации, один предназначен для сообщения при последней, другой для оставления при делах посольства и миссии.\nО могущих последовать со стороны иностранных nравительств на сию нотификацию ответах прошу поставить меня в известность.\nПодписали:\nМинистр Иностранных Дел Борис Штюрмер\nДиректор Нольде»\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-1.jpg" target="_blank">Оригинал</a><br />\n\n<a href="http://expo2012.inconnect.ru/wp-content/themes/twentyten/i/article-big-2.jpg" target="_blank">Карта</a><br />\nОригинал хранится в РГА ВМФ ф. Р-1004, оп.2, д.2, лл 12, 12 об, ф.Р-1004, оп.2, д.2, л.13.\n\n11 января 1926 г. Президиум Всероссийского Центрального Исполнительного Комитета постановлением №186 переименовал остров «Земля Императора Николая II» в остров «Северная Земля».\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65255&mode=view" target="_blank">Карта первого исследования Северной Земли</a><br />'},{precision:0,comment:null,fid:96,ruler:null,date_from:"01.01.1872",date_to:"1/1/2018",reason:"Переселение на Новую Землю нескольких семей ненцев для постоянного местожительства.",description_short:"Переселение на Новую Землю нескольких семей ненцев для постоянного местожительства",description_long:"Первыми жителями Новой Земли стали в 1869 г. ненец Фома Вылка с женой Ариной, двумя сыновьями, двумя дочерьми и ненцем Самдеем. Самдей не пережил зимовку, а в 1872 г. на Новую Землю переселились еще несколько ненецких семей, в том числе семья Пырерки Максима Даниловича. В 1877 г. было основано становище Малые Кармакулы, куда по распоряжению администрации переселены шесть ненецких семей в количестве 24 человек.\nВ начальный период колонизации Новой Земли по высочайшему царскому указу каждому первопоселенцу – промышленнику мужского пола из государственной казны полагалось 350 рублей в качестве «подъемных» или компенсации. Одновременно поселенцы на 10 лет освобождались от всех казенных и земских сборов, а желающие через пять лет переселиться обратно на материк могли вернуться на прежнее местожительства без предварительного разрешения.\nВо второй половине XIX в. возникло желание присоединить Новую Землю как «ничейную территорию» к Норвегии. Постоянное проживание Фомы Вылки и колонистов-ненцев на Новой Земле сыграло решающую роль в закреплении архипелага за Россией."},{precision:0,comment:null,fid:97,ruler:null,date_from:"01.01.1872",date_to:"1/1/2018",reason:"Переселение на Новую Землю нескольких семей ненцев для постоянного местожительства",description_short:"Переселение на Новую Землю нескольких семей ненцев для постоянного местожительства",description_long:"Первыми жителями Новой Земли стали в 1869 г. ненец Фома Вылка с женой Ариной, двумя сыновьями, двумя дочерьми и ненцем Самдеем. Самдей не пережил зимовку, а в 1872 г. на Новую Землю переселились еще несколько ненецких семей, в том числе семья Пырерки Максима Даниловича. В 1877 г. было основано становище Малые Кармакулы, куда по распоряжению администрации переселены шесть ненецких семей в количестве 24 человек.\nВ начальный период колонизации Новой Земли по высочайшему царскому указу каждому первопоселенцу – промышленнику мужского пола из государственной казны полагалось 350 рублей в качестве «подъемных» или компенсации. Одновременно поселенцы на 10 лет освобождались от всех казенных и земских сборов, а желающие через пять лет переселиться обратно на материк могли вернуться на прежнее местожительство без предварительного разрешения.\nВо второй половине XIX в. возникло желание присоединить Новую Землю как «ничейную территорию» к Норвегии. Постоянное проживание Фомы Вылки и колонистов-ненцев на Новой Земле сыграло решающую роль в закреплении архипелага за Россией."},{precision:1,comment:null,fid:98,ruler:null,date_from:"15.01.1478",date_to:"1/1/2018",reason:"очень условно соотнесено с моментом присоединения Новгорода к Москве",description_short:"Присоединение Новгорода к Москве",description_long:"Московско-новгородская война (1477—1478) между Великим княжеством Московским и Новгородской республикой, имевшая место с 9 октября 1477 г. по 15 января 1478 г., завершилась падением Новгорода и присоединением его к Москве."},{precision:1,comment:null,fid:99,ruler:null,date_from:"01.01.1595",date_to:null,reason:"Продвижение на север в связи с организацией на территории Обдорского княжества Березовского уезда",description_short:"Продвижение России на север в связи с организацией на территории Обдорского княжества Березовского уезда",description_long:null},{precision:1,comment:null,fid:100,ruler:null,date_from:"01.01.1649",date_to:"1/1/2018",reason:"Основание Анадырского острога",description_short:"Дата основания Анадырского острога условна. С этого времени начинается процесс включения Чукотки в состав России.",description_long:'Анадырский острог был поставлен С. И. Дежневым летом 1649 г. Первоначально казаки поставили зимовье, не имевшее укреплений. О его точном местоположении есть разные предположения. По мнению И. С. Вдовина (Вдовин И. С. Анадырский острог // Краевед. записки. Магадан, 1959. Вып. 2. С. 20–27), специально исследовавшего эту проблему, поселение было основано примерно в 18 км выше современного села Марково, в районе сел Солдатово и Оселкино, на одном из островов р. Анадырь. Некоторые исследователи считали, что его заложили на левом берегу Анадыря при впадении в него протоки Прорвы, выходящей из правого притока Анадыря р. Майн, причем не выше, а ниже, в 10–15 км от с. Марково.\n\n<a href="http://geoman.ru/books/item/f00/s00/z0000088/pic/map010.jpg" target="_blank">«Чертеж вновь Камчадальские земли и моря». Служебная книга С. У. Ремезова (Гос. публичная библиотека им. М Е. Салтыкова Щедрина, Эрмитажное собрание, № 237, стр. 102)</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:101,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:102,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:0,comment:null,fid:103,ruler:null,date_from:"22.07.1822",date_to:"22.07.1822",reason:"Утверждение «Учреждения для управлений сибирских губерний», оформившее Омскую область",description_short:"По указу «О разделении Сибирских Губерний на Западное и Восточное Управления» из частей уездов Тобольской губернии и Томской губернии образована Омская область",description_long:'<a href="http://www.runivers.ru/bookreader/book9846/#page/36/mode/1up" target="_blank">Указ «О разделении Сибирских Губерний на Западное и Восточное Управления»</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book58819/#page/19/mode/1up" target="_blank">Карта Тобольской Губернии и Омской области. 1835 г.</a><br />'},{precision:0,comment:null,fid:104,ruler:null,date_from:"26.05.1826",date_to:"26.05.1826",reason:"Русско-норвежское соглашение",description_short:"По русско-норвежскому договору Шведско-норвежскому королевству переданы части Нявдемского и Пазрецкого погостов.",description_long:'<a href="https://upload.wikimedia.org/wikipedia/commons/2/21/Norway-Russia_1825.jpg" target="_blank">Карта норвежско-российской границы (1826)</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9864/#page/410/mode/1up" target="_blank">Текст «Трактата, заключенный между Его Величеством Императором Всероссийским и Его Величеством Королем Шведским и Норвежским. О границах между Россиею и Норвегиею в Лапландских погостах»</a><br />'},{precision:0,comment:"Шведско-норвежскому королевству переданы части Нявдемского и Пазрецкого погостов; автономное княжество",fid:105,ruler:null,date_from:"26.05.1826",date_to:"26.05.1826",reason:"Русско-норвежское соглашение",description_short:"По русско-норвежскому договору Шведско-норвежскому королевству переданы части Нявдемского и Пазрецкого погостов.",description_long:'<a href="https://upload.wikimedia.org/wikipedia/commons/2/21/Norway-Russia_1825.jpg\n" target="_blank">Карта норвежско-российской границы (1826 г.)</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9864/#page/410/mode/1up" target="_blank">«Трактат, заключенный между Его Величеством Императором Всероссийским и Его Величеством Королем Шведским и Норвежским. О границах между Россиею и Норвегиею в Лапландских погостах», текст.</a><br />'},{precision:1,comment:"Йевер достался имп. Екатерине II как сестре последнего принца Ангальт-Цербтского, она включила это владение в титул",fid:106,ruler:null,date_from:"01.01.1793",date_to:"01.01.1807",reason:"Смерть принца Фридриха Августа",description_short:"Удельное княжество Эверланд (Йевер) досталось Екатерине II после смерти ее брата Фридриха Августа.",description_long:"В 1793 г. скончался последний герцог в роду Фридрих Август. Удельное княжество Эверланд (Йевер) по «закону прялки» унаследовала его сестра – урожденная принцесса Ангальт-Цербстская, которая в то время была уже императрицей России Екатериной II. Она, хотя в Германии этого и ждали, не отказалась от этого фризского надела и к своим титулам прибавила титул Herrin von Jever.\nВ 1806 г. княжество было оккупировано Французской империей.\nВ 1807 г. император Александр I уступил Эверланд Голландии, а в 1814 г. он был присоединен к герцогству Ольденбург, которое управлялось герцогом Ольденбургским, дядей императора Александра I."},{precision:1,comment:null,fid:107,ruler:null,date_from:"01.01.1813",date_to:"01.01.1818",reason:"Падение Французской империи",description_short:"После падения Французской империи статус Йевера как удельного княжества Российской империи был восстановлен.",description_long:"Удельное княжество Эверланд (Йевер) досталось императрице Екатерине II после смерти ее брата Фридриха Августа. В 1807 г. его оккупировал Наполеон, однако в 1813 г. Йевер вернулся в руки царя. Пять лет спустя российский император Александр I уступил его своим родственникам — герцогам Ольденбурга."},{precision:0,comment:null,fid:108,ruler:null,date_from:"29.12.1791",date_to:"18.03.1856",reason:"Ясский мирный договор с Турцией",description_short:"По условиям Ясского договора с Турцией за Россией закрепилось все Северное Причерноморье, включая Крым, а также земли между Южным Бугом и Днестром.",description_long:'Договор подписан в г. Яссы по итогам русско-турецкой войны 1787–1791 гг. Со стороны России договор подписали А. Н. Самойлов, О. М. де Рибас, С. Л. Лашкарёв. Со стороны Турции – Абдулла эфенди, Ибрагим Исмет бей, Мехмед эфенди. По условиям договора восстановилось действие Кючук-Кайнарджийского мирного договора 1774 г. и Турция признавала Георгиевский трактат 1783 г. Россия получала территории между Южным Бугом и Днестром. Днестр объявлялся границей между державами. Молдавия и Валахия возвращались Турции. Однако на жителей этих областей распространялись льготы, предусмотренные Кючук-Кайнарджийским миром. На Кавказе восстанавливалась граница по реке Кубань. Турция обязывалась не нападать на Грузию и кубанские земли. \nБлагодаря Ясскому миру Россия получила возможность освоения южных территорий и развития черноморской торговли.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/69/mode/1up" target="_blank">Текст Ясского мирного договора с Турцией</a><br />\n\n<a href="https://ru.wikipedia.org/wiki/%D0%AF%D1%81%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B8%D1%80%D0%BD%D1%8B%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80#/media/File:%D0%9C%D0%B0%D0%BD%D0%B8%D1%84%D0%B5%D1%81%D1%82_%D0%BE_%D0%AF%D1%81%D1%81%D0%BA%D0%BE%D0%BC_%D0%BC%D0%B8%D1%80%D0%BD%D0%BE%D0%BC_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D0%B5_%D1%81_%D0%9E%D1%81%D0%BC%D0%B0%D0%BD%D1%81%D0%BA%D0%BE%D0%B9_%D0%98%D0%BC%D0%BF%D0%B5%D1%80%D0%B8%D0%B5%D0%B9,_25_%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8F_1792_%D0%B3%D0%BE%D0%B4%D0%B0.JPG" target="_blank">Манифест о Ясском мирном договоре с Османской Империей, 25 февраля 1792 г.</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466762&SECTION_ID=" target="_blank">Карта Русско-турецкая война 1787–1791 гг. Территориальное изменение по Ясскому мирному договору 29 декабря 1791 г.</a><br />'},{precision:0,comment:null,fid:109,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:110,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:111,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:112,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:113,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:114,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:115,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:116,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:117,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:118,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:119,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:120,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:121,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:122,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:1,comment:"очень условное обозначение ознакомления русских с Курильскими о-вами и распространения на них властных отношений",fid:123,ruler:null,date_from:"01.01.1779",date_to:"07.02.1855",reason:"Указ Екатерины II о подданстве населения Курил",description_short:"Указ Екатерины II об освобождении от податей населения Курильских островов, принявшего российское подданство",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147257" target="_blank">Указ императрицы Екатерины II Сенату об освобождении от податей населения Курильских островов, принявшего российское подданство</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9828/#page/816/mode/1up" target="_blank">Оригинал</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6770&PORTAL_ID=6770" target="_blank">Южные Курилы. История вопроса</a><br />'},{precision:0,comment:null,fid:124,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:125,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:126,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:127,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:128,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:129,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:130,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:131,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:132,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:133,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:134,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:null,fid:135,ruler:null,date_from:"07.02.1855",date_to:"25.04.1875",reason:"Симодский трактат признал северные острова Курильской гряды за Российской империей",description_short:"Согласно Симодскому трактату, остров Итуруп принадлежит Японии, а весь Уруп и другие Курильские острова к северу принадлежат России. Остров Сахалин в совместном владении.",description_long:'Согласно Симодскому трактату, «отныне границы между Россией и Японией будут проходить между островами Итурупом и Урупом. Весь остров Итуруп принадлежит Японии, а весь остров Уруп и прочие Курильские острова к северу составляют владение России. Что касается острова Крафто (Сахалина), то он остается не разделенным между Россией и Японией, как было до сего времени».\nОстров Итуруп был уступлен Японии в обмен на торговый договор, а Уруп стал самым южным островом России в Курильской гряде.\n\n<a href="https://ru.wikisource.org/wiki/%D0%A1%D0%B8%D0%BC%D0%BE%D0%B4%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80_%D1%81_%D0%AF%D0%BF%D0%BE%D0%BD%D0%B8%D0%B5%D0%B9_(1855)" target="_blank">Текст Симодского трактата</a><br />'},{precision:0,comment:"удельное княжество",fid:136,ruler:null,date_from:"16.11.1773",date_to:"22.03.1777",reason:"Герцогские земли Гольштейна императрица Екатерина II променяла датчанам на графство Ольденбург-Дельменхорст.",description_short:"Графство Ольденбург и город Дельменхорст получены от Дании в обмен на Шлезвиг-Гольштейн.",description_long:'В 1761 г. гольштейн-готторпский герцог Карл Петер Ульрих стал российским императором Петром III. Его наследственные владения, Гольштейн-Готторп, включая Штормарн и Дитмаршен, автоматически на правах личной унии были присоединены к Российской империи.\nВ 1767 г. Екатерина II, заинтересованная в союзничестве с Данией, заключила с Данией договор о союзе, подтвержденный трактатом 1773 г. По нему наследник российского престола Павел I отказывался в пользу Дании от Шлезвиг-Гольштейна в обмен на графства Ольденбург и город Дельменхорст в северо-западной Германии. \n\n<a href="http://www.runivers.ru/bookreader/book10086/#page/458/mode/1up" target="_blank">Акт об уступке Е.И.В. князем Павлом Петровичем своих прав на герцогство Ольденбургское и Дальменгортское младшей линии герцогского дома Гольштейн-Готторпского, в лице герцога и епископа Любекского Фридриха Августа </a><br />\n\n<a href="http://www.runivers.ru/newenc/474757/" target="_blank">Русско-Датский союзный договор (1/12 августа 1773)</a><br />'},{precision:0,comment:null,fid:137,ruler:null,date_from:"25.12.1761",date_to:"16.11.1773",reason:"Вступление на престол Петра III, голштинского герцога.",description_short:"Наследные владения Петра III герцогство Гольштейн-Готторп, включая Штормарн и Дитмаршен, уступлены Дании в обмен на Ольденбург и Дельменхорст.",description_long:null},{precision:1,comment:null,fid:138,ruler:null,date_from:"01.01.1709",date_to:null,reason:"Постройка на Алтае Бикатунской крепости. С этой условной даты начинается государственное освоение Алтая. ",description_short:"Государственное освоение Алтая начинается с постройки на этой территории Бикатунской крепости.",description_long:'Первая русская крепость на территории края была построена в июне 1709 г. на правом берегу Бии. В качестве гарнизона «в том остроге оставлено для оберегательства от приходу воинских людей служилых людей 100 человек». Однако летом следующего 1710 г. Бикатунский острог подвергся нападению джунгар и был сожжен.\n\n<a href="http://library.altspu.ru/althistory/documents/RU%5cASPA%5cALTHISTORY%5c341" target="_blank">1708 г. февраля 29. – Распоряжение князя М. П. Гагарина дьякам Сибирского приказа подготовить и послать кузнецкому стольнику и воеводе Михаилу Овцыну государеву грамоту с приказом о строительстве острога «на реках Бии и Катуни»</a><br />\nРоссийский государственный архив древних актов. Ф. 214 (Сибирский приказ). Оп. 5. Д. 1265. Л. 8–9.\n\n<a href="http://library.altspu.ru/althistory/documents/RU%5cASPA%5cALTHISTORY%5c342" target="_blank">1708 г. марта 5. – Государева грамота из Сибирского приказа кузнецкому воеводе М. Овцыну о строительстве острога на Бии и Катуни. </a><br />\nРоссийский государственный архив древних актов. Ф. 214 (Сибирский приказ). Оп. 5. Д. 1265. Л. 10–11.\n\n<a href="http://library.altspu.ru/althistory/documents/RU%5cASPA%5cALTHISTORY%5c344" target="_blank">1709 г. после 23 августа. – Сообщение из Кузнецкого острога о сооружении Бикатунского острога и отражении набега ойратских подданных на Кузнецк с указанием фамилий российских служилых, участвовавших в бою.</a><br />\n Российский государственный архив древних актов. Ф.214 (Сибирский приказ). Оп. 5. Д. 1660. Л. 1–9.'},{precision:0,comment:null,fid:139,ruler:null,date_from:"07.08.1743",date_to:null,reason:"Абоский мир",description_short:"Согласно Абоскому миру к России присоединена пограничная полоса земель с крепостью Нейшлот и городами Вильманстранд и Фридрихсгам. Территориальное приобретение России составило 226 кв. мили",description_long:'Абоский договор подписан между Россией и Швецией в г. Або (Финляндия) 18/30 августа 1812 г. С русской стороны договор подписал Н. П. Румянцев, со шведской – К. Левенгельм. Договор представляет собой секретное соглашение, дополняющее Петербургский союзный договор 34 марта / 5 апреля 1812 г. Стороны выражали желание «еще более укрепить счастливое согласие» в отношениях между ними. Александр I обещал оказать военную помощь Швеции против Дании и давал согласие на присоединение к Швеции датского острова Зеландии. Шведский принц Карл-Юхан (Бернадот) со своей стороны не возражал против присоединения к России части герцогства Варшавского (до Вислы). Россия предоставляла Швеции заем в 1,5 млн руб. Обе стороны приглашали Англию присоединиться к данному договору. Секретная статья содержала взаимные обязательства предоставить 12–15 тыс. человек в случае нападения на одну из сторон третьей стороны. Абоский договор значительно укрепил русско-шведские отношения. Швеция отказывалась от претензий на Финляндию и Аландские острова, а Россия способствовала укреплению на шведском престоле новой династии Бернадотов. \n\n<a href="http://www.runivers.ru/bookreader/book9819/#page/864/mode/1up" target="_blank">Текст Абоского мира</a><br />\n\n<a href="https://histdoc.net/nystad/abo1743.html" target="_blank">Текст Абоского мира (на шведском языке)</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=469520&SECTION_ID=8212\n" target="_blank">Карта Финляндии с указанием границ России и Швеции в разное время по договорам, а также по картам генерального штаба, Гермелина, Лоттера, Аф-Кнорринга и других</a><br />\n'},{precision:1,comment:"отношения протектората до указа Екатерины II о ликвидации ханства",fid:140,ruler:null,date_from:"01.01.1664",date_to:"01.10.1771",reason:"Калмыцкое ханство признано Россией.",description_short:"Калмыцкое ханство официально признано Россией. Отношения протектората сохранились до указа в октябре 1771 г. Екатерины II о ликвидации ханства.",description_long:"Тайше Мончаку от имени царя были вручены символы власти – позолоченная булава и знамя с изображением российского герба и полумесяца."},{precision:1,comment:"отношения протектората до указа Екатерины II о ликвидации ханства",fid:141,ruler:null,date_from:"01.01.1664",date_to:"01.10.1771",reason:"Калмыцкое ханство признано Россией.",description_short:"Калмыцкое ханство официально признано Россией. Отношения протектората сохранились до указа в октябре 1771 г. Екатерины II о ликвидации ханства.",description_long:"Тайше Мончаку от имени царя были вручены символы власти – позолоченная булава и знамя с изображением российского герба и полумесяца."},{precision:0,comment:"прутско-днестровские земли не включены",fid:142,ruler:null,date_from:"08.04.1783",date_to:"08.04.1783",reason:"Манифест императрицы Екатерины II о присоединении Крыма к России",description_short:"Манифест императрицы Екатерины II о присоединении Крыма к России",description_long:'Присоединение Крыма к России стало логическим завершением продвижения России к Черноморскому побережью. В 1774 г. по условиям Кючук-Кайнарджийского мирного договора Крым получил автономию. Однако сохранить независимость крымскому ханству было сложно. С одной стороны, Турция не желала мириться с потерей полуострова. Султан явно надеялся на его возвращение под свой протекторат. С другой стороны, внешнеполитические интересы России также не предусматривали независимого государства на северном побережье Черного моря. Внутри самого ханства боролись две силы: протурецкая и прорусская. Зимой 1780 г. сторонники султана в Крыму подняли восстание против ориентированного на Россию хана Шахин-Гирея. Он был вынужден бежать, а его место занял сторонник султана Бахадыр-Гирей. Летом 1782 г. русские войска под командованием Г. А. Потемкина вступили в Крым под предлогом возвращения на престол Шахин-Гирея. В этом Россию поддержала Австрия. Однако в планы императрицы Екатерины II входило не восстановление на престоле изгнанного хана, а полное присоединение Крыма. Нужен был формальный повод со стороны Турции для оправдания захвата. Однако султан повода не давал. В результате было объявлено о нападении турок на Тамань. Этот сфабрикованный предлог позволил Екатерине II объявить о присоединении Крыма к России. Юридическим основанием стал Манифест «О принятии полуострова крымских жителей и прочих татарских народов в Российское подданство, острова Тамана и всей Кубанской стороны под Российскую державу» от 8 апреля 1783 г. В нем, в частности, говорилось, что императрица обязуется содержать крымских татар «наравне с природными Нашими подданными, охранять и защищать их лица, имущество, храмы и природную веру».\n\nЭта акция вызвала негативную реакцию у Англии и Франции. Возникла опасность войны. Однако очень скоро внутри Англии произошли изменения. На выборах премьер-министра победил Джемс Харисс. Сформированный им кабинет согласился с действиями Екатерины II в Крыму. Франция осталась в одиночестве. В этих условиях Турция вынуждена была де-факто (не де-юре) признать вхождение Крыма в состав России.\n\n<a href="http://www.runivers.ru/doc/d2.php?SECTION_ID=6362&CENTER_ELEMENT_ID=147028&PORTAL_ID=6362" target="_blank">Манифест о присоединении Крыма к России</a><br />\n\n<a href="http://www.runivers.ru/bookreader/book9829/#page/891/mode/1up" target="_blank">Оригинальный текст</a><br />\n\n<a href="http://www.runivers.ru/doc/d2.php?CAT=Y&SECTION_ID=6358&PORTAL_ID=6358" target="_blank">Крым. История вхождения в Российскую Империю</a><br />\n'},{precision:0,comment:"земли запорожских казаков получили российское подданство",fid:144,ruler:null,date_from:"18.09.1739",date_to:null,reason:"Белградский мирный договор с Турцией",description_short:"По условиям Белградского договора России возвращался Азов без права его военного укрепления. Земли запорожских казаков получили российское подданство.",description_long:'Белградский мирный договор (18/29 сентября 1739 г.)\nДоговор между Россией и Турцией был подписан по итогам русско-турецкой войны 1735–1739 гг. Посредником на переговорах был французский посол в Константинополе маркиз де Вильнёв. По условиям договора России возвращался Азов без права его военного укрепления. Россия получала право строительства крепости на острове Черкаске на Дону, Турция – в устье Кубани. России запрещалось иметь флот на Черном и Азовском морях. Торговля на Черном море могла вестись только на турецких судах. Между Россий и Турцией устанавливалась буферная зона – Большая и Малая Кабарда.\nУсловия Белградского мира не отвечали ни интересам России, ни ее успехам в войне. Само подписание мира носило явно преждевременный характер и стало следствием подписания сепаратного мира между Австрией, союзницей России в этой войне, и Турцией 21 августа/1 сентября 1739 г. Кроме того, назревала война со Швецией. Эти обстоятельства и обусловили дипломатическое поражение России после победоносной войны.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/43/mode/1up" target="_blank">Текст Белградского мирного договора</a><br />'},{precision:1,comment:"лояльный Москве хан, форма зависимости от Москвы",fid:145,ruler:null,date_from:"03.10.1552",date_to:"01.01.1671",reason:"Очень условная дата – по результатам взаимоотношений во время Казанского взятия.",description_short:"Великим князем Иваном IV была пожалована в 1552 г. грамота донским казакам на владение Доном за их великую службу (они принимали участие в штурме Казани), то есть на вечные времена закреплялась фактически уже занятая казаками река. Грамота эта была отобрана Петром I в 1695 г. Донские казаки «в своей отписке царю Михаилу Федоровичу от 26-го мая 1632 г. говорят о 80-летней их службе России».",description_long:null},{precision:1,comment:"полузависимое состояние яицких казаков до присяги на верность в 1680-х гг.",fid:146,ruler:null,date_from:"01.01.1591",date_to:"01.01.1689",reason:"Впервые привлечены Россией к охране границ яицкие казаки. Территория яицких казаков становится условно зависимой от России.",description_short:"К охране границ Россией впервые привлечены к яицкие казаки. Территория яицких казаков становится условно зависимой от России. Полузависимое состояние яицких казаков сохраняется до присяги на верность в 1680-х гг.",description_long:null},{precision:1,comment:"полузависимое терское казачество в марте 1721 г. было подчинено Военной коллегии",fid:147,ruler:null,date_from:"01.01.1577",date_to:"01.03.1721",reason:"Возрождение Терской крепости, вокруг которой формируется терское казачество",description_short:"Возрождение Терской крепости, вокруг которой формируется терское казачество. Это положило начало формированию земель терского казачества к северу от р. Терек.",description_long:"В 1577 г. астраханским воеводой Лукьяном Новосильцевым было перестроено в мощную крепость Терки одно из первых гарнизонных укреплений Кавказа. В ней несли службу царские ратники и вольные казаки. В этом же году вольные гребенские казаки поступили на регулярную службу в гарнизон Терки, было установлено старшинство Терского казачьего войска, а уже на следующий год, после заявления о своем намерении охранять южные рубежи России, они получили от Ивана Грозного первую жалованную грамоту.\nТерское казачество в марте 1721 г. было подчинено Военной коллегии."},{precision:0,comment:null,fid:148,ruler:null,date_from:"08.01.1654",date_to:"16.05.1722",reason:"Переяславская рада",description_short:"По просьбе гетмана Запорожской Сечи Богдана Хмельницкого и в соответствии с народным волеизъявлением Украина вошла в состав Российского государства. ",description_long:'Переяславская рада (8(18) января 1654)\nПереяславская рада – представительное собрание запорожских казаков в Переяславле, на котором было принято решение о вхождении Украины в состав России. Инициатором рады был Богдан Хмельницкий. 7 (17) января 1654 г. он встретился с главой российского посольства В. В. Бутурлиным. На следующий день, утром 8 (18) января, собралась старшинская рада. Руководители казачества единогласно высказались за соединение Украины и России. Днем того же дня собралась открытая рада. Богдан Хмельницкий выступил с речью, доказывающей необходимость присоединения к России в целях безопасности украинского народа и защиты его от польского гнета. После этого рада присягнула на верность царю Алексею Михайловичу. Условия договора были оформлены в виде «челобития великому государю» и отправлены в Москву. Первоначально они включали в себя 11 статей. В Москве украинское посольство добавило еще 11 статей, и одну статью добавила русская сторона. В итоге на рассмотрение Алексея Михайловича поступило 23 пункта договора. Договор был утвержден царем 14 марта 1654 г. \n\n<a href="http://www.runivers.ru/doc/isl/index.php?SECTION_ID=5357&IBLOCK_ID=50&sphrase_id=50675" target="_blank">Объединение Украины с Россией, подборка документов</a><br />\n\n<a href="https://upload.wikimedia.org/wikipedia/commons/6/6e/Bogdan_Chmelnitskiy%27s_letter_to_Alexis_I_of_Russia_%288_June_1648%2C_RGADA%29.jpg" target="_blank">Письмо Гетмана Богдана Хмельницкого царю Алексею Михайловичу с сообщением о победах над польскими войсками и желании запорожских казаков вступить в русское подданство. Черкасы, 1648, 8 июня. РГАДА</a><br />'},{precision:0,comment:null,fid:149,ruler:null,date_from:"03.07.1700",date_to:null,reason:"Константинопольский мирный договор передал крепость Азов России.",description_short:"По условиям Константинопольского договора за Россией оставалась турецкая крепость Азов, а также ряд вновь основанных на завоеванных территориях крепостей:Таганрог, Павловск и Миус.",description_long:'Константинопольский мирный договор – договор между Россией и Турцией. Заключен 3 (13) июля 1700 г. в Константинополе. Договор закреплял русские завоевания в Азовских походах 1695–1696 гг. Русское посольство в Константинополь возглавил глава Посольского приказа Е. И. Украинцев.\nПо условиям договора за Россией оставалась турецкая крепость Азов, а также ряд вновь основанных на завоеванных территориях крепостей: Таганрог, Павловск и Миус. При этом Турции были возвращены некоторые занятые русскими войсками территории с мелкими крепостями. Они должны были быть уничтожены.\nТакже Россия и Турция брали на себя обязательство не строить в пограничной полосе никаких новых военный укреплений и не совершать вооруженных набегов на территории друг друга.\nТурция освобождала русских пленных. Россия получала право открыть в Константинополе дипломатическое представительство на равных правах с другими державами. Россия была освобождена от уплаты дани крымскому хану.\nКонстантинопольский мирный договор должен был обеспечить нейтралитет Турции в планируемой Россией войне со Швецией (см. Северная война).\nДоговор был заключен на 30 лет, однако в ноябре 1710 г. был нарушен турецким султаном, объявившим войну России\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/29/mode/1up" target="_blank">Текст Константинопольского мирного договора</a><br />\n\n<a href="http://www.runivers.org/gal/gallery-all.php?SECTION_ID=7092&ELEMENT_ID=577820" target="_blank">Настольная медаль «В память Константинопольского мирного договора»</a><br />'},{precision:0,comment:"Вероятно, вхождение в РИ было номинальным",fid:150,ruler:null,date_from:"12.09.1723",date_to:"21.01.1732",reason:"Петербургский мирный договор с Персией",description_short:"По условиям Петербургского договора Россия получала Дербент, Баку, провинции Ширван, Гилен, Мазедеран, Астарабад, а также западное и южное побережье Каспийского моря.",description_long:'Петербургский договор 1723 г. – мирный договор между Россией и Персией, подписанный 12 сентября 1723 г. по итогам Персидского похода 1722–1723 гг. По его условиям Россия получала Дербент, Баку, провинции Ширван, Гилен, Мазедеран, Астарабад, а также западное и южное побережье Каспийского моря. Особой статьей предусматривался оборонительный союз обеих сторон против Турции.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/213/mode/1up" target="_blank">Текст Петербургского договора</a><br />'},{precision:1,comment:null,fid:151,ruler:null,date_from:"21.01.1732",date_to:"21.03.1735",reason:"Рештский договор вернул Персии территории южнее",description_short:"По Рештскому договору Россия возвращала Персии провинции Гилян, Мазандеран и Астрабад/",description_long:'Рештский договор (21 января / 1 февраля 1732 г.)\nСоюзный договор между Россией и Персией против Турции был подписан в г. Реште 21 января/1 февраля 1732 г. Россия возвращала Персии провинции Гилян, Мазандеран и Астрабад, полученные ей в результате Персидского похода 1722 г. по условиям Петербургского мира 1723 г. Граница между Россией и Персией устанавливалась по реке Кура. За нее выводились русские войска. Россия получала право беспошлинной торговли с Персией. \n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/222/mode/1up" target="_blank">Текст Рештского договора</a><br />'},{precision:1,comment:null,fid:152,ruler:null,date_from:"01.01.1697",date_to:null,reason:"Камчатка экспедицией В. Атласова закреплена за Россией.",description_short:"После экспедиции В. Атласова Камчатка закреплена за Россией.",description_long:'Весной 1697 г. Атласов во главе отряда из 120 человек (60 казаков и 60 юкагиров) на оленях прошел от Анадырского острога через Корякский хребет до Камчатки. Было обследовано восточное и западное побережье Камчатки. В центральной части Камчатки захвачены четыре корякских острожка, на реке Кануч поставлен памятный крест и на реке Камчатке заложен Верхнекамчатский острог. Маршрут экспедиции закончился на южной оконечности полуострова.\nВ 1700 г. Атласов вернулся в Якутск, откуда в 1701 г. был отправлен воеводой в Москву для представления отчета о камчатском походе. По пути, в Тобольске, он показал свои материалы С. У. Ремезову, составившему с его помощью один из детальных чертежей полуострова Камчатка. В Москве Атласов прожил с конца января по февраль 1701 г. и представил ряд «скасок», полностью или частично опубликованных несколько раз. Они содержали первые сведения о рельефе и климате Камчатки, о ее флоре и фауне, о морях, омывающих полуостров, и об их ледовом режиме. В «скасках» Атласов сообщил некоторые данные о Курильских островах, довольно обстоятельные известия о Японии и краткую информацию о «Большой Земле» (Северо-Западной Америке).\n\n<a href="http://ostrog.ucoz.ru/publikacii_2/4_64.htm" target="_blank">«Скаски» Владимира Атласова</a><br />\n'},{precision:1,comment:null,fid:153,ruler:null,date_from:"01.01.1649\n",date_to:null,reason:"Основание Анадырского острога.",description_short:"Дата основания Анадырского острога условна. С этого времени начинается процесс включения Чукотки в состав России.",description_long:'Анадырский острог был поставлен С. И. Дежневым летом 1649 г. Первоначально казаки поставили зимовье, не имевшее укреплений. О его точном местоположении есть разные предположения. По мнению И. С. Вдовина (Вдовин И. С. Анадырский острог // Краевед. записки. Магадан, 1959. Вып. 2. С. 20–27), специально исследовавшего эту проблему, поселение было основано примерно в 18 км выше современного села Марково, в районе сел Солдатово и Оселкино, на одном из островов р. Анадырь. Некоторые исследователи считали, что его заложили на левом берегу Анадыря при впадении в него протоки Прорвы, выходящей из правого притока Анадыря р. Майн, причем не выше, а ниже, в 10–15 км от с. Марково.\n\n<a href="http://geoman.ru/books/item/f00/s00/z0000088/pic/map010.jpg" target="_blank">«Чертеж вновь Камчадальские земли и моря». Служебная книга С. У. Ремезова (Гос. публичная библиотека им. М Е. Салтыкова Щедрина, Эрмитажное собрание, № 237, стр. 102)</a><br />'},{precision:1,comment:null,fid:154,ruler:null,date_from:"01.01.1741",date_to:null,reason:"Обследование полуострова Таймыр экспедицией Х. Лаптева, составление карты.",description_short:"Обследование полуострова Таймыр экспедицией Х. Лаптева, составление его карты",description_long:'<a href="https://coollib.net/i/60/39960/zahalak3.png" target="_blank">Схема санных маршрутов отряда Х. Лаптева на Таймыре</a><br />\nИз книги В. А. Троицкий «Записки Харитона Лаптева»'},{precision:0,comment:null,fid:155,ruler:null,date_from:"20.08.1727",date_to:null,reason:"Буринский договор с Китаем",description_short:"В результате подписания Буринского договора площадь стран не изменилась, была определена линия границы.",description_long:'Российско-китайская граница была определена к западу от реки Аргунь до перевала Шабин-Дабат (Западные Саяны). Позднее эти границы были закреплены Кяхтинским договором 1727 г. на основании условий, выработанных в ходе переговоров по обсуждению Буринского договора.\n\n<a href="http://www.runivers.ru/bookreader/book456128/#page/265/mode/1up" target="_blank">Текст Буринского договора</a><br />\n\n'},{precision:1,comment:null,fid:156,ruler:null,date_from:"01.01.1263",date_to:"30.08.1721\n",reason:"Московское княжество",description_short:"По завещанию Александра Невского Московское княжество было выделено в 1263 г. в удел его младшему сыну Даниилу Александровичу, за потомками которого оно и закрепилось.",description_long:"Московское княжество было выделено из Великого княжества Владимирского по завещанию Александра Невского в удел его младшему сыну Даниилу Александровичу. В 1383 г. оно слилось с великим княжеством Владимирским, поскольку московские князья закрепили за собой великое княжение. При Иване III с присоединением Новгорода, Твери и других территорий Великое княжество Московское переросло в Российское государство. "},{precision:0,comment:null,fid:157,ruler:null,date_from:"24.07.1678",date_to:null,reason:"Перемирие с Речью Посполитой, подписанное в Москве",description_short:"Соглашение между Россией и Польшей о продлении Андрусовского перемирия. В обмен на Киев отданы Себеж, Невель и Велиж.",description_long:null},{precision:0,comment:null,fid:158,ruler:null,date_from:"24.07.1678",date_to:null,reason:"Перемирие с Речью Посполитой, подписанное в Москве",description_short:"Соглашение между Россией и Польшей о продлении Андрусовского перемирия. В обмен на Киев отданы Себеж, Невель и Велиж.",description_long:null},{precision:0,comment:null,fid:159,ruler:null,date_from:"24.07.1678",date_to:null,reason:"Перемирие с Речью Посполитой, подписанное в Москве",description_short:"Соглашение между Россией и Польшей о продлении Андрусовского перемирия. В обмен на Киев отданы Себеж, Невель и Велиж.",description_long:null},{precision:0,comment:"в Москве в 1678 г. продлено перемирие с Речью Посполитой, в обмен на Киев отданы Себеж, Невель и Велиж",fid:160,ruler:null,date_from:"30.01.1667",date_to:null,reason:"Андрусовское перемирие",description_short:"По условиям Андрусовского перемирия Россия возвращала Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России",description_long:'Андрусовское перемирие 30 января 1667 г.\nАндрусовское перемирие заключено между Россией и Польшей по итогам русско-польской войны 1654-1667 гг. в деревне Андрусово (близ Смоленска). Срок действия перемирия – 13, 5 лет. Русскую делегацию на переговорах возглавлял А.Л. Ордин-Нащокин, польскую – Ю. Глебович. По условиям перемирия Россия возвращала себе Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России. Киев должен был остаться за Россией до 1669 г. Фактически же так и остался за ней. Запорожская сечь переходила под совместное управление России и Польши.\nАндрусовское перемирие явилось крупным дипломатическим успехом России. Оно обеспечило вхождение в ее состав Украины и Белоруссии и ограничило польскую агрессию на Востоке \n\n<a href="http://www.runivers.ru/bookreader/book9809/#page/685/mode/1up" target="_blank">Текст Андрусовского перемирия</a><br />'},{precision:0,comment:null,fid:161,ruler:null,date_from:"30.08.1721",date_to:null,reason:"Вопрос о переносе столицы в Санкт-Петербург дискуссионный, формально земли стали русскими по Ништадтскому договору.",description_short:"Перенос столицы России из Москвы в Санкт-Петербург состоялся до формального присоединения земель к России по Ништадтскому договору. Таким образом, столица размещалась на территории, формально принадлежащей другому государству. ",description_long:'Ништадский мирный договор (30 августа (10 сентября) 1721)\nНиштадский мирный договор – договор между Россией и Швецией, завершивший Северную войну 1700–1721 гг. Был заключен в городе Ништадт (ныне Уусикаупунки, Финляндия) 30 августа (10 сентября 1721 г.). Со стороны России договор был подписан Я. В. Брюсом и А. И. Остерманом, со стороны Швеции – Ю. Лилльенстедтом и О. Стрёмфельдом.\nДо подписания этого договора граница между Россией и Швецией определялась Столбовским мирным договором 1617 г. Ништадским миром за Россией были закреплены обширные территории, ранее принадлежавшие Швеции: часть Карелии с Кексгольмом к северу от Ладожского озера, Ингерманладия (Ижорская земля), часть Эстляндии с Ревелем и Нарвой, часть Лифляндии с Ригой, острова Эзель и Даго. Россия за приобретенные земли должна была выплатить Швеции денежную компенсацию в размере около полутора млн рублей, а также вернуть бóльшую часть занятой русскими войсками Финляндии. Восстанавливались торговые отношения между двумя странами: Швеции получала право ежегодно вывозить из России на 50 000 руб. хлеба без уплаты пошлин. Договор предусматривал обмен пленными и амнистию преступникам и перебежчикам, кроме казаков И. Мазепы. Дворянство перешедших к России территорий сохраняло свои привилегии, самоуправление и вероисповедание.\nТаким образом, Россия закрепила выход в Балтийское море. В ознаменование заключения Ништадского мира 22 октября (2 ноября) 1721 г. Петр I по прошению Сената принял титул Отца Отечества, Императора Всероссийского, а также Петра Великого.\n\n<a href="http://www.runivers.ru/bookreader/book9814/#page/422/mode/1up" target="_blank">Текст Ништадского мирного договора</a><br />\n\n<a href="http://raritety.rusarchives.ru/dokumenty/relyaciya-o-zaklyuchenii-mira-so-shveciey-s-opisaniem-torzhestva-podneseniya-i-prinyatiya-gosudarem" target="_blank">Реляция о заключении мира со Швецией с описанием торжества поднесения и принятия государем титула «Отца Отечества, Императора Всероссийского Петра Великого»</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466744&SECTION_ID=" target="_blank">Территориальные изменения по Ништадскому мирному договору 30 августа 1721 г.</a><br />\n'},{precision:0,comment:null,fid:162,ruler:null,date_from:"30.08.1721",date_to:"3/3/1918",reason:"Ништадтский мирный договор.",description_short:"Ништадским миром за Россией были закреплены Лифляндия, Эстляндия, Ингерманландия, часть Карелии, ранее принадлежавшие Швеции. Таким образом Россия закрепила выход в Балтийское море. ",description_long:'Ништадский мирный договор (30 августа (10 сентября) 1721)\nНиштадский мирный договор – договор между Россией и Швецией, завершивший Северную войну 1700–1721 гг. Был заключен в городе Ништадт (ныне Уусикаупунки, Финляндия) 30 августа (10 сентября 1721 г.). Со стороны России договор был подписан Я. В. Брюсом и А. И. Остерманом, со стороны Швеции – Ю. Лилльенстедтом и О. Стрёмфельдом.\nДо подписания этого договора граница между Россией и Швецией определялась Столбовским мирным договором 1617 г. Ништадским миром за Россией были закреплены обширные территории, ранее принадлежавшие Швеции: часть Карелии с Кексгольмом к северу от Ладожского озера, Ингерманладия (Ижорская земля), часть Эстляндии с Ревелем и Нарвой, часть Лифляндии с Ригой, острова Эзель и Даго. Россия за приобретенные земли должна была выплатить Швеции денежную компенсацию в размере около полутора млн рублей, а также вернуть бóльшую часть занятой русскими войсками Финляндии. Восстанавливались торговые отношения между двумя странами: Швеции получала право ежегодно вывозить из России на 50 000 руб. хлеба без уплаты пошлин. Договор предусматривал обмен пленными и амнистию преступникам и перебежчикам, кроме казаков И. Мазепы. Дворянство перешедших к России территорий сохраняло свои привилегии, самоуправление и вероисповедание.\nТаким образом, Россия закрепила выход в Балтийское море. В ознаменование заключения Ништадского мира 22 октября (2 ноября) 1721 г. Петр I по прошению Сената принял титул Отца Отечества, Императора Всероссийского, а также Петра Великого.\n\n<a href="http://www.runivers.ru/bookreader/book9814/#page/422/mode/1up" target="_blank">Текст Ништадского мирного договора</a><br />\n\n<a href="http://raritety.rusarchives.ru/dokumenty/relyaciya-o-zaklyuchenii-mira-so-shveciey-s-opisaniem-torzhestva-podneseniya-i-prinyatiya-gosudarem" target="_blank">Реляция о заключении мира со Швецией с описанием торжества поднесения и принятия государем титула «Отца Отечества, Императора Всероссийского Петра Великого»</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466744&SECTION_ID=" target="_blank">Территориальные изменения по Ништадскому мирному договору 30 августа 1721 г.</a><br />\n'},{precision:0,comment:null,fid:163,ruler:null,date_from:"30.08.1721",date_to:"3/3/1918",reason:"Ништадтский мирный договор.",description_short:"Ништадским миром за Россией были закреплены Лифляндия, Эстляндия, Ингерманландия, часть Карелии, ранее принадлежавшие Швеции. Таким образом, Россия закрепила выход в Балтийское море. ",description_long:'Ништадский мирный договор (30 августа (10 сентября) 1721)\nНиштадский мирный договор – договор между Россией и Швецией, завершивший Северную войну 1700–1721 гг. Был заключен в городе Ништадт (ныне Уусикаупунки, Финляндия) 30 августа (10 сентября 1721 г.). Со стороны России договор был подписан Я. В. Брюсом и А. И. Остерманом, со стороны Швеции – Ю. Лилльенстедтом и О. Стрёмфельдом.\nДо подписания этого договора граница между Россией и Швецией определялась Столбовским мирным договором 1617 г. Ништадским миром за Россией были закреплены обширные территории, ранее принадлежавшие Швеции: часть Карелии с Кексгольмом к северу от Ладожского озера, Ингерманладия (Ижорская земля), часть Эстляндии с Ревелем и Нарвой, часть Лифляндии с Ригой, острова Эзель и Даго. Россия за приобретенные земли должна была выплатить Швеции денежную компенсацию в размере около полутора млн рублей, а также вернуть бóльшую часть занятой русскими войсками Финляндии. Восстанавливались торговые отношения между двумя странами: Швеции получала право ежегодно вывозить из России на 50 000 руб. хлеба без уплаты пошлин. Договор предусматривал обмен пленными и амнистию преступникам и перебежчикам, кроме казаков И. Мазепы. Дворянство перешедших к России территорий сохраняло свои привилегии, самоуправление и вероисповедание.\nТаким образом, Россия закрепила выход в Балтийское море. В ознаменование заключения Ништадского мира 22 октября (2 ноября) 1721 г. Петр I по прошению Сената принял титул Отца Отечества, Императора Всероссийского, а также Петра Великого.\n\n<a href="http://www.runivers.ru/bookreader/book9814/#page/422/mode/1up" target="_blank">Текст Ништадского мирного договора</a><br />\n\n<a href="http://raritety.rusarchives.ru/dokumenty/relyaciya-o-zaklyuchenii-mira-so-shveciey-s-opisaniem-torzhestva-podneseniya-i-prinyatiya-gosudarem" target="_blank">Реляция о заключении мира со Швецией с описанием торжества поднесения и принятия государем титула «Отца Отечества, Императора Всероссийского Петра Великого»</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466744&SECTION_ID=" target="_blank">Территориальные изменения по Ништадскому мирному договору 30 августа 1721 г.</a><br />\n'},{precision:1,comment:null,fid:164,ruler:null,date_from:"01.03.1721",date_to:"01.10.1771",reason:"Полузависимое терское казачество в марте 1721 г. было подчинено Военной коллегии",description_short:"Полузависимое терское казачество в марте 1721 г. было подчинено Военной коллегии.",description_long:null},{precision:0,comment:null,fid:165,ruler:null,date_from:"12.07.1711",date_to:"12.07.1711",reason:"Прутский мирный договор",description_short:"По Прутскому договору Россия отдавала Турции Азов.",description_long:"Мирный договор между Россией и Турцией, подписанный 12/23 июля 1711 г. на реке Прут, близ г. Яссы, по итогам Прутского похода 1711 г. Договор стал результатом поражения войск Петра I. Россия отдавала Турции Азов, обязывалась срыть построенные ею крепости Таганрог, Каменный затон и Богородицк. Кроме того, ей запрещалось вмешиваться в польские дела и иметь посла в Константинополе. Со своей стороны Турция должна была не препятствовать возвращению русских войск обратно в Россию и выслать за свои пределы шведского короля Карла XII. Однако условия договора не соблюдались, что в 1713 г. дало Турции повод начать войну против России. "},{precision:1,comment:"примерные границы обитания башкир в 17 в., дата оч. условная, с присяги на верность башкир после очередного восстания. К этому времени, при Петре I, на башкир распространены многие повинности, но только в 1754 г. отменен ясак, адм.реф. по ук10.04.1798 г.",fid:166,ruler:null,date_from:"01.01.1557",date_to:"01.01.1725",reason:"Выдача жалованных грамот Иваном Грозным башкирам после переговоров о вхождении в состав России.",description_short:"Выдача башкирам жалованных грамот Иваном Грозным после переговоров о вхождении в состав России. ",description_long:'Предводители башкирских племен были пожалованы в тарханы и князья, а некоторые произведены в старосты. Приведены примерные границы обитания башкир в XVII веке.\n\nПеревод «копии с копии» жалованной грамоты Ивана IV башкирам 4-х южных родов:\n«Великий наш шах и царь Иван Васильевич Грозный начиная с 1547 г. приходил вместе с русским войском [досл. обществом] брать город Казань; после многих сражений при татарском хане Ядкаре 2 октября 1552 г. [Иван Грозный] окончательно взял [город] в свои руки. И так же, как [сделали] в городе Казани, сделали в юртах. После этого башкиры четырех племен, [которые живут] к востоку от Казани, послали к этому царю Ивану одинаково знатных людей. Он сам желал их прибытия, из них: 1-й от родов Усерган князь Бикбау; 2-й от рода Бурзян князь Искэ-бий; 3-й от рода Кыпчак князь Мешвали Каракузяк; 4-й из Тамьяна князь Шагали Шакман.\nЭти четыре бия, прибыв в город Казань, стали известными Ивану Грозному. Башкир [досл. башкирское общество] приняли [в русское подданство] с [условием] верной службы [царю]; после принятия в подданство [царь], оказав милость, наградил их самих [т. е. послов] тарханским званием; [затем] обратились с нижайшей просьбой отмерить [башкирам] ихние земли, воды и выдать им [на владение этими землями] грамоту. По их [т. е. башкирских послов] просьбе, он, великий царь Иван Грозный, своим указом [повелел] эти земли отмерить, то есть определить их границы. Для этого в Ногайскую и Сибирскую дороги направил повелительные письма; опираясь на эти письма, народ ете ырыу, то есть “семи родов”, посоветовавшись [между собой] и согласившись [друг с другом], решили земли, которыми владели их рода, как то степи и леса, разделить. И в 1564 г. согласились [платить] ясак — положенный Грозным ясак [состоял] из лошадей, и куниц, и лисиц, и разного другого ясака, — который, посоветовавшись, разделили [между собой].\nО [границах] некоторых отмеренных земель ниже рассказывается. Сначала [земли] по течению реки Яик, нижняя граница от Сарымсака, верхняя граница до Бузсавыла, по рекам Кизил, Сакмара и Зилаир от истоков до устья и с горами, и по рекам Ачили, Учкалик, и двум Сурэмам от истоков до устья и с горами, и [далее] с верховья Саелмыша, с верховья рек Аяк, Мену, от брода [реки] Кираузэ, от реки Мену до Одинокой ивы, и через Ногайский брод от Иртубека до вершины Уксэр, и от истока Сулака, от леса [досл. лиственницы] Уткэш, горы Миазак, верховий Калмака и Башазилар с горами и водами, и от поля Айин луг, от истоков Элэмсэта, от горы Алти Тура [на берегу] Сакмары до вершины Лаембирде и от брода реки Таналык вместе с камышами, от Тюбы, небольшой горы, вниз по реке Четум — [все эти] земли стали владениями башкир родов Тунгэк и Усерган.\nЗатем [земли]: нижняя граница — от упомянутого Сарымсака, три [реки] Узени, до горы в степной стороне, три реки Чезми и Кэмэлек от истоков до устьев со всеми горами, верхняя граница — до глубокого озера, например [озеро] Дурткуль, все эти земли стали “особенным” владением рода Бурзян.\nУ Усерган с Бикбау-князем, у Тамьян с Шагали Шакман-князем, у Бурзян с Искэби-князем, у Кыпчак с Мешавле Каракузяк князем, у всех родов были [родовые] земельные владения. Те земли, которые, посоветовавшись и отмерив, отделили, в упомянутом городе Казани закрепили в книге.\nЕсли при уплате известного лисьего ясака, лис не могли добыть, то рассчитывались медью, от десяти копеек, пятидесяти копеек и до 55 копеек. Подтверждая это, великий царь вместе со знатными приближенными руки приложили».\n\n<a href="http://vatandash.ru/?article=1505" target="_blank">Жалованные грамоты Ивана Грозного башкирам</a><br />\n'},{precision:1,comment:"примерные границы обитания башкир в 17 в., дата оч. условная, с присяги на верность башкир после очередного восстания. К этому времени, при Петре I, на башкир распространены многие повинности, но только в 1754 г. отменен ясак, адм.реф. по ук10.04.1798 г.",fid:166,ruler:null,date_from:"01.01.1557",date_to:"01.01.1634",reason:"Выдача жалованных грамот Иваном Грозным башкирам после переговоров о вхождении в состав России",description_short:"Выдача Иваном Грозным башкирам жалованных грамот после переговоров о вхождении в состав России",description_long:null},{precision:0,comment:"в Москве в 1678 г. продлено перемирие с Речью Посполитой, в обмен на Киев отданы Себеж, Невель и Велиж",fid:167,ruler:null,date_from:"30.01.1667",date_to:null,reason:"Андрусовское перемирие",description_short:"По условиям Андрусовского перемирия Россия возвращала Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России.",description_long:'Андрусовское перемирие 30 января 1667 г.\nАндрусовское перемирие заключено между Россией и Польшей по итогам русско-польской войны 1654–1667 гг. в деревне Андрусово (близ Смоленска). Срок действия перемирия – 13, 5 лет. Русскую делегацию на переговорах возглавлял А. Л. Ордин-Нащокин, польскую – Ю. Глебович. По условиям перемирия Россия возвращала себе Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России. Киев должен был остаться за Россией до 1669 г. Фактически же так и остался за ней. Запорожская сечь переходила под совместное управление России и Польши.\nАндрусовское перемирие явилось крупным дипломатическим успехом России. Оно обеспечило вхождение в ее состав Украины и Белоруссии и ограничило польскую агрессию на Востоке.\n\n<a href="http://www.runivers.ru/bookreader/book9809/#page/685/mode/1up" target="_blank">Текст Андрусовского перемирия</a><br />'},{precision:0,comment:"в Москве в 1678 г. продлено перемирие с Речью Посполитой, в обмен на Киев отданы Себеж, Невель и Велиж",fid:168,ruler:null,date_from:"30.01.1667",date_to:"30.01.1667",reason:"Андрусовское перемирие",description_short:"По условиям Андрусовского перемирия Россия возвращала Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России.",description_long:'Андрусовское перемирие 30 января 1667 г.\nАндрусовское перемирие заключено между Россией и Польшей по итогам русско-польской войны 1654–1667 гг. в деревне Андрусово (близ Смоленска). Срок действия перемирия – 13, 5 лет. Русскую делегацию на переговорах возглавлял А. Л. Ордин-Нащокин, польскую – Ю. Глебович. По условиям перемирия Россия возвращала себе Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России. Киев должен был остаться за Россией до 1669 г. Фактически же так и остался за ней. Запорожская сечь переходила под совместное управление России и Польши.\nАндрусовское перемирие явилось крупным дипломатическим успехом России. Оно обеспечило вхождение в ее состав Украины и Белоруссии и ограничило польскую агрессию на Востоке.\n\n<a href="http://www.runivers.ru/bookreader/book9809/#page/685/mode/1up" target="_blank">Текст Андрусовского перемирия</a><br />'},{precision:0,comment:"в Москве в 1678 г. продлено перемирие с Речью Посполитой, в обмен на Киев отданы Себеж, Невель и Велиж",fid:169,ruler:null,date_from:"30.01.1667",date_to:"30.01.1667",reason:"Андрусовское перемирие",description_short:"По условиям Андрусовского перемирия Россия возвращала Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России.",description_long:'Андрусовское перемирие 30 января 1667 г.\nАндрусовское перемирие заключено между Россией и Польшей по итогам русско-польской войны 1654–1667 гг. в деревне Андрусово (близ Смоленска). Срок действия перемирия – 13, 5 лет. Русскую делегацию на переговорах возглавлял А. Л. Ордин-Нащокин, польскую – Ю. Глебович. По условиям перемирия Россия возвращала себе Смоленск, Дорогобуж, Белую, Невель, Красный, Велиж, Северскую землю с Черниговом и Стародубом. Польша признавала вхождение Левобережной Украины в состав России. Киев должен был остаться за Россией до 1669 г. Фактически же так и остался за ней. Запорожская сечь переходила под совместное управление России и Польши.\nАндрусовское перемирие явилось крупным дипломатическим успехом России. Оно обеспечило вхождение в ее состав Украины и Белоруссии и ограничило польскую агрессию на Востоке.\n\n<a href="http://www.runivers.ru/bookreader/book9809/#page/685/mode/1up" target="_blank">Текст Андрусовского перемирия</a><br />'},{precision:0,comment:null,fid:170,ruler:null,date_from:"04.06.1634",date_to:null,reason:"Поляновский мир",description_short:"Поляновский мирный договор заключен между Россией и Речью Посполитой, положил конец Смоленской войне 1632–1634 гг. Россия уступала Речи Посполитой свои территории, которые были захвачены поляками в ходе Смуты (за исключением Серпейска). Польская сторона должна была вывести свои войска с территории России. Польский король Владислав IV официально отказался от притязаний на русский престол.",description_long:null},{precision:0,comment:null,fid:171,ruler:null,date_from:"04.06.1634",date_to:null,reason:"Поляновский мир",description_short:"Поляновский мирный договор заключен между Россией и Речью Посполитой, положил конец Смоленской войне 1632–1634 гг. Россия уступала Речи Посполитой свои территории, которые были захвачены поляками в ходе Смуты (за исключением Серпейска). Польская сторона должна была вывести свои войска с территории России. Польский король Владислав IV официально отказался от притязаний на русский престол.",description_long:null},{precision:0,comment:null,fid:172,ruler:null,date_from:"04.06.1634",date_to:null,reason:"Поляновский мир",description_short:"Поляновский мирный договор заключен между Россией и Речью Посполитой, положил конец Смоленской войне 1632–1634 гг. Россия уступала Речи Посполитой свои территории, которые были захвачены поляками в ходе Смуты (за исключением Серпейска). Польская сторона должна была вывести свои войска с территории России. Польский король Владислав IV официально отказался от притязаний на русский престол.",description_long:null},{precision:0,comment:null,fid:173,ruler:null,date_from:"04.06.1634",date_to:null,reason:"Поляновский мир",description_short:"Поляновский мирный договор заключен между Россией и Речью Посполитой, положил конец Смоленской войне 1632–1634 гг. Россия уступала Речи Посполитой свои территории, которые были захвачены поляками в ходе Смуты (за исключением Серпейска). Польская сторона должна была вывести свои войска с территории России. Польский король Владислав IV официально отказался от притязаний на русский престол.",description_long:null},{precision:0,comment:null,fid:174,ruler:null,date_from:"04.06.1634",date_to:null,reason:"Поляновский мир",description_short:"Поляновский мирный договор заключен между Россией и Речью Посполитой, положил конец Смоленской войне 1632–1634 гг. Россия уступала Речи Посполитой свои территории, которые были захвачены поляками в ходе Смуты (за исключением Серпейска). Польская сторона должна была вывести свои войска с территории России. Польский король Владислав IV официально отказался от притязаний на русский престол.",description_long:null},{precision:1,comment:null,fid:175,ruler:null,date_from:"01.01.1649\n",date_to:"4/6/1920",reason:"Основание Анадырского острога.",description_short:"Дата основания Анадырского острога условна. С этого времени начинается процесс включения Чукотки в состав России.",description_long:'Анадырский острог был поставлен С. И. Дежневым летом 1649 г. Первоначально казаки поставили зимовье, не имевшее укреплений. О его точном местоположении есть разные предположения. По мнению И. С. Вдовина (Вдовин И. С. Анадырский острог // Краевед. записки. Магадан, 1959. Вып. 2. С. 20–27), специально исследовавшего эту проблему, поселение было основано примерно в 18 км выше современного села Марково, в районе сел Солдатово и Оселкино, на одном из островов р. Анадырь. Некоторые исследователи считали, что его заложили на левом берегу Анадыря при впадении в него протоки Прорвы, выходящей из правого притока Анадыря р. Майн, причем не выше, а ниже, в 10–15 км от с. Марково.\n\n<a href="http://geoman.ru/books/item/f00/s00/z0000088/pic/map010.jpg" target="_blank">«Чертеж вновь Камчадальские земли и моря». Служебная книга С. У. Ремезова (Гос. публичная библиотека им. М Е. Салтыкова Щедрина, Эрмитажное собрание, № 237, стр. 102)</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:176,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:"очень условно",fid:177,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:178,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"Обдорские князья признали над собой протекторат Московского княжества.",description_long:"В 1595 г., с основания Обдорского острога на месте главного города Обдорского княжества, территория включена в Березовский уезд."},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:179,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:180,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:181,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:182,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:183,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:184,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:185,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:186,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:187,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:188,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:189,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:190,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:191,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:192,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:193,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:194,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:195,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:196,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:197,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:198,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:199,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:200,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:201,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:202,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:203,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:204,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:205,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:206,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:207,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:208,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:209,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:210,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:211,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:212,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:213,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:214,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:215,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:216,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:217,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:218,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:219,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:220,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:221,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:222,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:223,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:224,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:225,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:226,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:227,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:null,fid:228,ruler:null,date_from:"01.01.1792",date_to:null,reason:"Основание торгового поселения на берегах озера Илиамна.",description_short:"Основание торгового поселения на берегах озера Илиамна",description_long:null},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:228,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:229,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:230,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:231,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:232,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:"первое посещение Аляски русскими",fid:232,ruler:null,date_from:"21.08.1732\n",date_to:"08.07.1799",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:233,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:234,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:235,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:236,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:237,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:238,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:239,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:240,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:241,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:242,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:243,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:244,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:245,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:246,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:247,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:248,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:249,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:250,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:251,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:252,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:253,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:254,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:255,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:256,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:257,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:258,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:259,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:260,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:261,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:262,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:null,fid:263,ruler:null,date_from:"01.01.1816",date_to:"01.01.1817",reason:"Основание колонии на острове Кауаи.",description_short:"Основана Елизаветинская крепость, построена под руководством сотрудника Российско-американской компании Георга Шеффера. ",description_long:"Строительство крепости являлось частью плана Шеффера по созданию на острове колонии и присоединению Гавайев к Российской империи, однако уже летом 1817 г. Кауаи были оставлены русскими под давлением гавайцев и американцев."},{precision:1,comment:"колония Российско-Американской компании.",fid:264,ruler:null,date_from:"01.03.1812",date_to:"01.01.1841",reason:"Российско-американская компания основала для промысла и торговли пушниной поселение Форт-Росс.\nОснование крепости весной 1812 г.",description_short:"В 1841 г. Форт Росс был продан Джону Саттеру за 42 857 рублей серебром. В 1850 г. вместе со всей Калифорнией был присоединен к США.",description_long:null},{precision:1,comment:"очень условно",fid:265,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:266,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:267,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:268,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:269,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:270,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:271,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:272,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:273,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:274,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:275,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:276,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:277,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:278,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:279,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:280,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:281,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:282,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:283,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:284,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:285,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:286,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:287,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:288,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:289,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:290,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:291,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:292,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:293,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:294,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:null,fid:295,ruler:null,date_from:"01.01.1772",date_to:"16.02.1825",reason:"Основание русского поселения на о. Уналашка.",description_short:"Основание русского поселения на о. Уналашка",description_long:null},{precision:1,comment:"очень условно",fid:296,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:297,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:298,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:299,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:300,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:301,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:302,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:303,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:304,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:305,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:306,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:307,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:308,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:309,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:310,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:311,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:null,fid:312,ruler:null,date_from:"03.08.1784",date_to:"16.02.1825",reason:"Основание поселения Павловская гавань на о. Кадьяк.",description_short:"Основание поселения Павловская гавань экспедицией под командованием Григория Ивановича Шелихова",description_long:null},{precision:1,comment:null,fid:313,ruler:null,date_from:"03.08.1784",date_to:"16.02.1825",reason:"Основание поселения Павловская гавань на о. Кадьяк.",description_short:"Основание поселения Павловская гавань экспедицией под командованием Григория Ивановича Шелихова",description_long:null},{precision:1,comment:null,fid:314,ruler:null,date_from:"03.08.1784",date_to:"16.02.1825",reason:"Основание поселения Павловская гавань на о. Кадьяк.",description_short:"Основание поселения Павловская гавань экспедицией под командованием Григория Ивановича Шелихова",description_long:null},{precision:1,comment:null,fid:315,ruler:null,date_from:"03.08.1784",date_to:"16.02.1825",reason:"Основание поселения Павловская гавань на о. Кадьяк.",description_short:"Основание поселения Павловская гавань экспедицией под командованием Григория Ивановича Шелихова",description_long:null},{precision:1,comment:"очень условно",fid:316,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:317,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:318,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:319,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:null,fid:320,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:321,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:322,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:323,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:324,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:325,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:326,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:327,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:328,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:329,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:330,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:331,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:332,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:333,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:334,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:335,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:336,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:337,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:338,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:339,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:340,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:341,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:342,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:343,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:344,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:345,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:346,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:347,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:348,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I ",description_long:null},{precision:1,comment:null,fid:349,ruler:null,date_from:"01.01.1791",date_to:"08.07.1799",reason:"Основание на полуострове Кенай форта св. Николая.",description_short:"Основание на полуострове Кенай форта святого Николая",description_long:null},{precision:0,comment:null,fid:350,ruler:null,date_from:"9/30/1911",date_to:null,reason:"В сентябре 1911 г. российский флаг поднят на о. Врангеля членами гидрографической экспедиции",description_short:"Российский флаг поднят на о. Врангеля членами гидрографической экспедиции.",description_long:'В ходе Гидрографической экспедиции Северного Ледовитого океана (1910–1915) впервые в истории был обойден северный берег о. Врангеля и на острове в сентябре 1911 года был понят российский флаг.\n20 августа 1924 г. экспедиция на ледоколе «Красный Октябрь» подняла на острове советский флаг.\n20 августа 2014 г. экспедиция Тихоокеанского флота на судне «Маршал Геловани» подняла над островом Военно-морской флаг России.\n\n<a href="http://www.polarpost.ru/forum/download/file.php?id=65247&mode=view" target="_blank">Карта маршрутов Гидрографической экспедиции за 1912 год</a><br />'},{precision:1,comment:"очень условно",fid:351,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:352,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I.",description_long:null},{precision:1,comment:"очень условно",fid:353,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:354,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:355,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:356,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:357,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:358,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:359,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:360,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:361,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:362,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:363,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:364,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:365,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:366,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:367,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:368,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:369,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:370,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:371,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:372,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:373,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"очень условно",fid:374,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:"торговая колония",fid:375,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:null,fid:376,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:null,fid:377,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:378,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:379,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:380,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:381,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:382,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:383,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:384,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:385,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:386,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:387,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:388,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:389,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:390,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:391,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:392,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:393,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:394,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:395,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:396,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:397,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:398,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:398,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:399,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:399,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:400,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:400,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:401,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция.",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:401,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:402,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:403,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:404,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:"первое посещение Аляски русскими",fid:405,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 году. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:406,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:407,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:408,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:409,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:410,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"первое посещение Аляски русскими",fid:411,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:"аренда на 25 лет",fid:412,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:1,comment:null,fid:413,ruler:null,date_from:"21.08.1732",date_to:"16.02.1825",reason:"Посещение Аляски моряками бота «Св. Гавриил»",description_short:"Русские моряки на боте «Св. Гавриил» под началом подштурмана Ивана Федорова, геодезиста Михаила Гвоздева, морехода Кондратия Мошкова первыми из европейцев высадились на Аляске.",description_long:"Первыми европейцами, увидевшими берега Аляски, были участники экспедиции Семена Дежнева в 1648 г. Для проверки информации Дежнева Петр I организовал экспедицию Витуса Беринга и Алексея Чирикова, чтобы окончательно удостовериться, соединена Азия с Америкой или нет. В 1741 г. вторая экспедиция Беринга и Чирикова подробно обследовала и нанесла на карту побережье Аляски и Алеутские острова."},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:414,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:415,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:416,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:"разграничение с Британией территорий для освоения",fid:417,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:418,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:419,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:420,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:421,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:422,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:0,comment:"разграничение с Британией территорий для освоения",fid:423,ruler:null,date_from:"16.02.1825",date_to:"18.10.1867",reason:"Англо-русская конвенция",description_short:"По англо-русской конвенции 1825 г. произошло разграничение владений России и Великобритании в Северной Америке.",description_long:'Устанавливалась пограничная черта, отделяющая владения Британии от русских владений на западном побережье Северной Америки, примыкающем к Аляске, так, что граница проходила на всем протяжении береговой полосы, принадлежащей России, от 54° с. ш. до 60° с. ш. по вершинам гор Берегового хребта, но не далее 10 морских миль от кромки океана, учитывая все изгибы побережья.\n<a href="https://www.runivers.ru/bookreader/book9848/#page/71/mode/1up" target="_blank">Конвенция, заключенная в Санкт-Петербурге между Императором Всероссийским и Королем Великобританским о взаимных выгодах, относящихся до торговли, мореплавания и рыбных промыслов на Тихом океане и до границ обоюдных владений их на северо-западном берегу Америки</a><br />'},{precision:1,comment:"очень условно",fid:424,ruler:null,date_from:"08.07.1799",date_to:"16.02.1825",reason:"Основание Российско-американской торговой компании, через которую велось управление Русской Америкой.",description_short:"Основание Российско-американской компании Григорием Шелиховым и Николаем Резановым, утвержденной императором Павлом I",description_long:null},{precision:1,comment:null,fid:425,ruler:null,date_from:"01.01.1799",date_to:"08.07.1799",reason:"Основание Михайловской крепости (Ново-Архангельск)",description_short:"Российско-американская компания впервые основала на острове Ситка постоянное поселение — Михайловскую крепость (Ново-Архангельск).",description_long:null},{precision:0,comment:null,fid:426,ruler:null,date_from:"01.12.1618",date_to:null,reason:"Деулинское перемирие",description_short:"Согласно условиям Деулинского перемирия, Россия уступала Польше Смоленск, Белый, Рославль, Монастыревск, Чернигов, Стародуб, Попову Гору, Новогород-Северский, Почеп, Трубчевск, Серпейск, Невель, Себеж, Красный и Вележ с уездами и волостями. В обмен на столь значительные территориальные уступки Польша возвращала России икону Св. Николая Можайского. Также она возвращала России захваченные ею города: Вязьму, Козельск, Мещевск, Мосальск. ",description_long:"Деулинское перемирие 1618 г.\nПеремирие, заключенное между Россией и Польшей в деревне Деулино 1 декабря 1618 г. сроком на 14 лет и 6 месяцев, начиная с 25 декабря 1618 г. \nСогласно условиям перемирия, Россия уступала Польше Смоленск, Белый, Рославль, Монастыревск, Чернигов, Стародуб, Попову Гору, Новогород-Северский, Почеп, Трубчевск, Серпейск, Невель, Себеж, Красный и Вележ с уездами и волостями. В обмен на столь значительные территориальные уступки Польша возвращала России захваченные ею города: Вязьму, Козельск, Мещевск, Мосальск. Договаривающиеся стороны брали на себя обязательства не помогать ни людьми, ни деньгами недругам другой стороны. Польские купцы при уплате пошлин получали право свободной торговли во всех русских городах, кроме Москвы. Русские купцы получали те же права на территории Польши. Договор предусматривал обмен пленными. Особо оговаривалось возвращение русских послов во главе с патриархом Филаретом и князем В. Голицыным. Королевич Владислав на период перемирия не должен был ни тайно, ни явно добиваться Московского престола. Все польские войска и запорожские казаки должны были немедленно по заключению перемирия очистить территорию Московского государства. \nДеулинское перемирие 1618 г. положило конец польской интервенции. В этом смысле его значение аналогично значению Столбовского мирного договора. Выйдя из многолетней войны с большими территориальными потерями, Россия получала необходимый мир для восстановления разрушенного государства."},{precision:0,comment:null,fid:427,ruler:null,date_from:"01.12.1618",date_to:null,reason:"Деулинское перемирие",description_short:"Согласно условиям Деулинского перемирия, Россия уступала Польше Смоленск, Белый, Рославль, Монастыревск, Чернигов, Стародуб, Попову Гору, Новогород-Северский, Почеп, Трубчевск, Серпейск, Невель, Себеж, Красный и Вележ с уездами и волостями. В обмен на столь значительные территориальные уступки Польша возвращала России икону Св. Николая Можайского. Также она возвращала России захваченные ею города: Вязьму, Козельск, Мещевск, Мосальск. ",description_long:"Деулинское перемирие 1618 г.\nПеремирие, заключенное между Россией и Польшей в деревне Деулино 1 декабря 1618 г. сроком на 14 лет и 6 месяцев, начиная с 25 декабря 1618 г. \nСогласно условиям перемирия, Россия уступала Польше Смоленск, Белый, Рославль, Монастыревск, Чернигов, Стародуб, Попову Гору, Новогород-Северский, Почеп, Трубчевск, Серпейск, Невель, Себеж, Красный и Вележ с уездами и волостями. В обмен на столь значительные территориальные уступки Польша возвращала России захваченные ею города: Вязьму, Козельск, Мещевск, Мосальск. Договаривающиеся стороны брали на себя обязательства не помогать ни людьми, ни деньгами недругам другой стороны. Польские купцы при уплате пошлин получали право свободной торговли во всех русских городах, кроме Москвы. Русские купцы получали те же права на территории Польши. Договор предусматривал обмен пленными. Особо оговаривалось возвращение русских послов во главе с патриархом Филаретом и князем В. Голицыным. Королевич Владислав на период перемирия не должен был ни тайно, ни явно добиваться Московского престола. Все польские войска и запорожские казаки должны были немедленно по заключению перемирия очистить территорию Московского государства. \nДеулинское перемирие 1618 г. положило конец польской интервенции. В этом смысле его значение аналогично значению Столбовского мирного договора. Выйдя из многолетней войны с большими территориальными потерями, Россия получала необходимый мир для восстановления разрушенного государства."},{precision:1,comment:"в 1595 г., с основания Обдорского острога на месте главного города Обдорского княжества, территория включена в Березовский уезд",fid:428,ruler:null,date_from:"01.01.1500",date_to:null,reason:"Обдорские князья перешли под протекторат Москвы.",description_short:"Обдорские князья признали над собой протекторат Московского княжества.",description_long:"В 1595 г., с основания Обдорского острога на месте главного города Обдорского княжества, территория включена в Березовский уезд."},{precision:1,comment:"в 1595 г., с основания Обдорского острога на месте главного города Обдорского княжества, территория включена в Березовский уезд",fid:428,ruler:null,date_from:"01.01.1500",date_to:null,reason:"Обдорские князья перешли под протекторат Москвы.",description_short:"Обдорские князья признали над собой протекторат Московского княжества.",description_long:"В 1595 г., с основания Обдорского острога на месте главного города Обдорского княжества, территория включена в Березовский уезд."},{precision:1,comment:null,fid:429,ruler:null,date_from:"01.01.1586",date_to:"01.01.1607",reason:"Признание зависимости Ляпинского княжества от Москвы",description_short:"Правитель Ляпинского княжества Лугуй добровольно признал власть Русского государства.",description_long:"В августе 1586 г. в Москву приехал князь Лугуй, представлявший шесть городков (Куноват, Илчма, Ляпин, Мункос, Юил и Сумгут-ваш), к царю Федору Ивановичу с изъявлением своей покорности и просьбой не трогать его городков. За это Лугуй обязывался платить ежегодную дань. \nЕго поездка была вызвана, по всей видимости, строительством в 1585 г. Обского (Мансуровского) городка напротив устья Иртыша.\nПосле определения размера ясака князь получил грамоту, подтверждающую его достоинство и статус. Царь удовлетворил просьбу ляпинского князя. В августе 1586 г. Лугуй получил грамоту, подтверждавшую его княжеское достоинство и определявшую размер ежегодной дани: семь сороков соболей «лутчих» с его владений и семь соболей с его семьи."},{precision:1,comment:"вассальные отношения Кодского княжества",fid:430,ruler:null,date_from:"01.01.1583",date_to:"01.01.1643",reason:"Договор с Москвой.",description_short:"В 1583 г., во время похода Ермака Тимофеевича в Сибирь, между казаками и правителем Кодского княжества князем Алачом (Алачеем) был заключен союз. В дальнейшем царская власть ратифицировала союзный договор, и между Кодским княжеством и Москвой возникли отношения вассалитета. Кодские князья имели право на выполнение судебных функций и сбор ясака в своих владениях, кроме того, «за службу в Сибирской земле» им были пожалованы новые волости (Емдырская, Ваховская, Вас-Пуколская и Кол-Пуколская).",description_long:null},{precision:1,comment:"до разгрома полузависимое состояние",fid:431,ruler:null,date_from:"31.12.1484",date_to:"01.01.1594",reason:"Договор пелымских и кондинских правителей с великим князем московским.",description_short:"Мирный договор пелымских и кондинских правителей с великим князем московским",description_long:"После успешного похода русских войск весной 1483 г. против пелымского князя Асыки 31 декабря 1484 г. в Усть-Выми был заключен мирный договор."},{precision:1,comment:"полузависимое состояние начиная с постройки Сургута до разгрома восстания населения Бардакова княжества",fid:432,ruler:null,date_from:"01.01.1594",date_to:null,reason:"Постройка Сургута на землях Бардакова княжества",description_short:"Постройка Сургута на землях Бардакова княжества зафиксировала его полузависимое состояние, которое продолжалось до разгрома восстания в 1617 г., когда княжество стало волостью.",description_long:null},{precision:1,comment:"со строительством крепости Тары Пегая Орда платит русскому царю ясак",fid:433,ruler:null,date_from:"01.01.1594",date_to:"01.01.1610",reason:"Строительство крепости Тары на землях Пегой Орды",description_short:"После строительства города Тары князем Андреем Елецким Пегая орда стала платить ясак русскому царю. ",description_long:'<a href="http://ostrog.ucoz.ru/publ/t/tataurov_s_f/gorod_tara_kak_voenno_administrativnyj_ehkonomicheskij_i_kulturnyj_centr_razvitija_priirtyshja_v_konce_xvi_pervoj_polovine_xviii_v/154-1-0-432" target="_blank">Город Тара как военно-административный, экономический и культурный центр развития Прииртышья в конце XVI – первой половине XVIII в.</a><br />'},{precision:1,comment:"со строительством крепости Тары Пегая Орда платит русскому царю ясак",fid:433,ruler:null,date_from:"01.01.1594",date_to:"01.01.1610",reason:"Строительство крепости Тары на землях Пегой Орды",description_short:"После строительства города Тары князем Андреем Елецким Пегая орда стала платить ясак русскому царю. ",description_long:'<a href="http://ostrog.ucoz.ru/publ/t/tataurov_s_f/gorod_tara_kak_voenno_administrativnyj_ehkonomicheskij_i_kulturnyj_centr_razvitija_priirtyshja_v_konce_xvi_pervoj_polovine_xviii_v/154-1-0-432" target="_blank">Город Тара как военно-административный, экономический и культурный центр развития Прииртышья в конце XVI – первой половине XVIII в.</a><br />'},{precision:0,comment:null,fid:434,ruler:null,date_from:"26.10.1582",date_to:null,reason:"Разгром Ермаком хана Кучума и занятие столицы Сибирского ханства Искера",description_short:"Разгром Ермаком хана Кучума и занятие столицы Сибирского ханства Искера. Дружина Ермака была организована на деньги Строгановых, которым в 1574 г. Иван Грозный дал «грамоту» на территорию, на тот момент принадлежавшую Сибирскому ханству.",description_long:null},{precision:1,comment:null,fid:435,ruler:null,date_from:"01.01.1672",date_to:null,reason:"Назначение в Албазин правительственного представителя.",description_short:"Албазинская казачья республика признала юрисдикцию русского царя.",description_long:null},{precision:1,comment:null,fid:436,ruler:null,date_from:"01.01.1596",date_to:null,reason:"Основание Кетского острога.",description_short:"Основание Кетского острога для сбора ясака. Сыграло немаловажную роль в занятии приенисейского края.",description_long:null},{precision:1,comment:null,fid:437,ruler:null,date_from:"01.01.1600",date_to:null,reason:"Основание Мангазеи.",description_short:"Мангазея основана в качестве опорного пункта для продвижения в глубь Сибири и укрепленного центра сбора ясака. ",description_long:null},{precision:0,comment:null,fid:438,ruler:null,date_from:"01.10.1604",date_to:null,reason:"Постройка Томска",description_short:"Постройка Томска",description_long:"4 апреля 1604 г. царем Борисом Годуновым дан наказ сургутскому голове Г. И. Писемскому и боярскому сыну В. Ф. Тыркову с повелением строить Томский город, завести вокруг него государеву пашню и привести в подданство российскому царю окрестные народы. Царь Борис благословил первостроителей Томского города иконою Святой Живоначальной Троицы.\n7 октября 1604 г. кетский воевода Постник Бельский послал в приказ Казанского и Мещерского дворца отписку, в которой указал, что к этому дню Томский «город сделали со всеми крепостцами». "},{precision:1,comment:null,fid:439,ruler:null,date_from:"01.01.1607",date_to:null,reason:"Основание Новой Мангазеи.",description_short:"В устье Нижней Тунгуски было срублено Туруханское зимовье. В 1672 г. здесь был заложен русский город Новая Мангазея. С 1780-х гг. Новая Мангазея называется Туруханском и числится в Томской губернии. Позднее поселение называется уже Старотуруханском.",description_long:null},{precision:1,comment:null,fid:440,ruler:null,date_from:"01.01.1618",date_to:null,reason:"Основание Кузнецкого острога.",description_short:"Основание Кузнецкого острога",description_long:'<a href="http://ostrog.ucoz.ru/publikacii_2/4_74.htm" target="_blank">Кузнецкий острог 1618 г. и его перестройка в 1620 г.</a><br />'},{precision:1,comment:null,fid:441,ruler:null,date_from:"01.01.1619",date_to:null,reason:"Основание Енисейского острога.",description_short:"Основание Енисейского острога отрядом тобольских казаков во главе с боярским сыном Петром Албычевым и стрелецким сотником Черкасом Рукиным",description_long:null},{precision:0,comment:null,fid:442,ruler:null,date_from:"18.08.1628",date_to:null,reason:"Постройка Красноярского острога",description_short:"Постройка Красноярского острога отрядом казаков под руководством Андрея Ануфриевича Дубенского.",description_long:null},{precision:1,comment:null,fid:443,ruler:null,date_from:"01.01.1631",date_to:null,reason:"Основание Братского острога.",description_short:"Основание Братского острога для сбора ясака и в поисках залежей серебряных руд",description_long:null},{precision:1,comment:null,fid:444,ruler:null,date_from:"01.01.1632",date_to:null,reason:"Основание Ленского острога и Жиганского зимовья",description_short:"В 1632 г. отряд енисейского казака сотника Петра Бекетова основал Ленский острог, и в этом же году летом группа казаков из этого отряда под руководством Алексея Архипова и Луки Яковлева спустилась вниз по реке Лене и в 770 км от Ленского острога на левом берегу Лены построила Жиганское зимовье.",description_long:'<a href="http://ostrog.ucoz.ru/publ/s/safronov_f_g/osnovanie_goroda_jakutska/147-1-0-232" target="_blank">Основание города Якутска</a><br />'},{precision:1,comment:null,fid:445,ruler:null,date_from:"01.01.1634",date_to:null,reason:"Основание Вилюйского острога и Янского зимовья.",description_short:"Основание Вилюйского острога енисейскими казаками во главе с Посником Ивановыми и землепроходцами Ребровым и Перфирьевым, а также Янского зимовья для ясачного сбора",description_long:null},{precision:1,comment:null,fid:446,ruler:null,date_from:"01.01.1636",date_to:null,reason:"Постройка Канского острога",description_short:"Постройка Канского острога казаками под руководством атамана Ермака Остафьева для сбора ясака",description_long:null},{precision:1,comment:null,fid:447,ruler:null,date_from:"01.01.1638",date_to:null,reason:"Основание Верхоянского зимовья.",description_short:"Основание Верхоянского зимовья как казачьего зимовья Посником Ивановым",description_long:null},{precision:1,comment:null,fid:448,ruler:null,date_from:"01.01.1639",date_to:null,reason:"Основание Зашиверского зимовья.",description_short:"Основание Зашиверского зимовья отрядом енисейского казака Посника Иванова для сбора ясака. Зашивенск стал центром территории от реки Яны на западе до Колымы на востоке.",description_long:null},{precision:1,comment:null,fid:449,ruler:null,date_from:"01.01.1640",date_to:null,reason:"Основание Майского зимовья.",description_short:"Основано Майское зимовье.",description_long:null},{precision:1,comment:null,fid:450,ruler:null,date_from:"01.01.1641",date_to:null,reason:"Основание Верхоленского острога.",description_short:"Основание Верхоленского острога пятидесятником Мартыном Васильевым. ",description_long:'<a href="http://ostrog.ucoz.ru/publikacii/4_47_36.htm" target="_blank">Челобитная тобольских, березовских и енисейских служилых людей в Сибирский приказ об основании Верхоленского острога, сборе ясака с тунгусов и бурят, столкновениях с ними и лишениях, которым подвергались служилые люди</a><br />'},{precision:1,comment:null,fid:451,ruler:null,date_from:"01.01.1641",date_to:null,reason:"Основание Ачинского острога.",description_short:"Основание Ачинского острога тарским воеводой Я. О. Тухачевским",description_long:'<a href="http://ostrog.ucoz.ru/publ/s/skobelev_s_g_churikov_r_s/k_voprosu_o_meste_raspolozhenija_pervogo_achinskogo_ostroga/194-1-0-345" target="_blank">К вопросу о месте расположения первого Ачинского острога</a><br />'},{precision:1,comment:null,fid:452,ruler:null,date_from:"01.01.1643",date_to:null,reason:"Основание Верхнеангарского острога.",description_short:"Основание Верхнеангарского острога отрядом енисейских казаков во главе с десятником С. Скороходовым для сбора ясака с северо-байкальских тунгусов",description_long:null},{precision:1,comment:null,fid:453,ruler:null,date_from:"01.01.1643",date_to:null,reason:"Перенос Ленского острога на место Якутска.",description_short:"Ленский острог перенесен на место Якутска.",description_long:null},{precision:1,comment:null,fid:454,ruler:null,date_from:"01.01.1643",date_to:null,reason:"Основание Среднеколымского острога и Нижнеколымского зимовья.",description_short:"Основание Среднеколымского острога и Нижнеколымского зимовья русским землепроходцем Михаилом Стадухиным и казаком Дмитрием Зыряном ",description_long:'<a href="http://ostrog.ucoz.ru/publ/s/sergeev_o_i_chernavskaja_v_n_kazak_m_v/stadukhin_issledovatel_severo_vostoka_azii/160-1-0-270" target="_blank">Казак М. В. Стадухин — исследователь северо-востока Азии</a><br />'},{precision:1,comment:null,fid:455,ruler:null,date_from:"01.01.1631",date_to:null,reason:"Основание Чечуйского острога.",description_short:"Основание Чечуйского острога. По данным Герарда Фридриха Миллера, основал острог промышленник Пенда (или Пянда).",description_long:null},{precision:1,comment:null,fid:456,ruler:null,date_from:"01.01.1630",date_to:null,reason:"Основано Илимское зимовье.",description_short:"Основание Илимского зимовья енисейскими служивыми людьми под руководством атамана Ивана Галкина",description_long:null},{precision:1,comment:null,fid:457,ruler:null,date_from:"01.01.1647",date_to:null,reason:"Зимовье на месте Охотска и Верхнеколымское зимовье.",description_short:"Основание зимовья на месте Охотска казаками под предводительством атамана Семена Шелковникова и Верхнеколымского зимовья",description_long:null},{precision:1,comment:null,fid:458,ruler:null,date_from:"01.01.1648",date_to:null,reason:"Основание Удинского острожка.",description_short:"Основание Удинского острожка",description_long:null},{precision:1,comment:null,fid:459,ruler:null,date_from:"01.01.1648",date_to:null,reason:"Основание Баргузинского острога.",description_short:"Основание Баргузинского острога енисейскими казаками атамана Ивана Галкина",description_long:'<a href="http://ostrog.ucoz.ru/publ/e/16-1-0-28" target="_blank">Основание и развитие Баргузинского и Селенгинского острогов в ХVII—ХVIII вв.</a><br />'},{precision:1,comment:null,fid:460,ruler:null,date_from:"01.01.1652",date_to:null,reason:"Основан Тугурский острог.",description_short:"Основание Тугурского острога командой казаков под начальством И. А. Нагибы",description_long:null},{precision:2,comment:null,fid:461,ruler:null,date_from:"01.01.1653",date_to:null,reason:"Основание Тауйска.",description_short:"Основание Тауйска русским землепроходцем Михаилом Стадухиным",description_long:null},{precision:1,comment:null,fid:462,ruler:null,date_from:"01.01.1654",date_to:null,reason:"Основан Балаганский острог.",description_short:"В 1653 г. енисейский воевода Афанасий Пашков поручает боярскому сыну Дмитрию Фирсову перенести Братский острог на левый берег Оки и, следуя вверх по Ангаре, поставить острог между «немирными балаганскими людьми». Там в 1654 году был построен Балаганский острог.",description_long:'<a href="http://ostrog.ucoz.ru/ist_doc_2/1_51.htm" target="_blank">Отписка енисейского воеводы Афанасия Пашкова в Сибирский приказ о постройке Балаганского острога и о поселении пашенных крестьян и служилых людей</a><br />'},{precision:1,comment:null,fid:463,ruler:null,date_from:"01.01.1656",date_to:null,reason:"Перенос Ачинского острога",description_short:"Томский сын боярский Ю. Трапезунский перенес острог на новое место — в Басагарскую волость, где-то между р. Урюп и озером Белое. ",description_long:null},{precision:1,comment:null,fid:464,ruler:null,date_from:"06.07.1661\n",date_to:null,reason:"Основание Иркутского острога.",description_short:"Основание Иркутского острога",description_long:"1661 г., после 1 июля. Отписка Енисейскому воеводе Ивану Ржевскому сына боярского Якова Похабова о строении Иркутского острога:\n\n«Государя царя и великого князя Алексея Михайловича, всеа Великия и Малыя и Белы России самодержца, воеводе Ивану Ивановичю Енисейской сын боярской Якунка Похабов челом бьет. В нынешнем во 169 году июля в 6 день против Иркута реки на Верхоленской стороне государев новый острог служилыми людьми ставлю, и башни и потолок срублены и государев житной анбар служилые люди рубят, а на анбаре будет башня, а острог не ставлен, потому что слег не достает, лесу близко нет, лес удалел от реки. А инде стало острогу поставить негде, а где ныне Бог позволил острог ставить, и тут место самое лутчее, угожее для пашни, и скотинной выпуск и сенные покосы и рыбные ловли все близко, а опроче того места острогу ставить негде, близ реки лесу нет, стали места степные и неугожие. А как Бог свершит наготово острог, и о том будет писано в Енисейской острог к воеводе Ивану Ивановичю».\n\nИсточник:\n\nДополнения к актам историческим, собранные и изданные Археографическою комиссиею. – СПб., 1851. Т. 4. С. 249–250. "},{precision:1,comment:null,fid:466,ruler:null,date_from:"01.01.1666",date_to:null,reason:"основание зимовья в Улан-Удэ",description_short:"Улан-Удэ был основан в 1666 г. как казачье зимовье Удинское на правом берегу реки Селенги при впадении в нее реки Уды.",description_long:'<a href="http://www.vostlit.info/Texts/Dokumenty/Mongol/Rus_mong_3/61-80/61.phtml?id=13632" target="_blank">Первое упоминание «на усть Уды-реки ясачного зимовья» в отписке десятника енисейских казаков О. Васильева с товарищами в Сибирский приказ о постройке Селенгинского острога, о монгольских послах и Китайском государстве.</a><br />'},{precision:1,comment:null,fid:467,ruler:null,date_from:"01.01.1653",date_to:null,reason:"Постройка Читинского, Иргенского и Нелюцкого острогов",description_short:"Постройка Читинского, Иргенского и Нелюцкого острогов",description_long:'<a href="http://ostrog.ucoz.ru/ostrogy/2_2.htm" target="_blank">Иргенский острог</a><br />\n\n<a href="http://ostrog.ucoz.ru/ostrogy/2_16.htm" target="_blank">Основание города Якутска</a><br />'},{precision:1,comment:"до вхождения в состав Великого княжества Владимирского",fid:468,ruler:null,date_from:"01.01.1238",date_to:"01.01.1363",reason:"образование Стародубского княжества",description_short:"В 1238 г. Стародуб был отдан великим князем Ярославом Всеволодовичем своему брату Ивану. Образовалось Стародубское княжество.",description_long:"В 1363 г. Стародубское княжество по ханскому ярлыку присоединено к Великому княжеству Владимирскому."},{precision:1,comment:"территория сначала меньше",fid:469,ruler:null,date_from:"01.01.1445",date_to:"01.01.1552",reason:"Образование Касимовского ханства (по Б. Рахимзянову).",description_short:"Касимовское ханство возникло в силу условий мирного договора между первым казанским ханом Улуг-Мухаммадом и московским великим князем Василием II, заключенного в 1445 г. после поражения русских войск под Суздалем, в результате которого московский великий князь Василий II оказался в татарском плену и был отпущен в Москву через три месяца, в октябре 1445 г.\n(по Б. Рахимзянову).",description_long:null},{precision:1,comment:null,fid:470,ruler:null,date_from:"01.01.1374",date_to:"01.01.1489",reason:"первое упоминание Вятской земли",description_short:"Первое упоминание Вятской земли в летописях в 1374 г. в связи с походом новгородских ушкуйников на Волжскую Болгарию, входившую в то время в состав Золотой Орды.",description_long:"В 70-е гг. XIV в. Вятская земля входила в состав Нижегородско-Суздальского княжества. В 1393 г. это княжество было присоединено к Москве. В 1402 или 1403 г. Вятскую землю приобрел московский великий князь Василий I Дмитриевич, отдавший ее в удел брату Юрию Галицкому. С 1412 до 1459 г. Вятка была третьей свободной вечевой землей после Новгорода и Пскова. В 1459 г.Василий Темный покоряет Вятку, Хлынов облагается данью и приводится на верность Москве. В 1489 г. Вятская земля присоединена к Московскому княжеству."},{precision:1,comment:null,fid:471,ruler:null,date_from:"01.01.1451",date_to:"01.01.1472",reason:"Первое упоминание Чердыни.",description_short:"В 1451 г. Василий Темный назначил в Чердынь своего ставленника — князя Михаила Ермолаевича. Окончательно подчинилась Московскому княжеству после похода в 1472 г. под командой воеводы стародубского князя Федора Давыдовича Пёстрого.",description_long:null},{precision:1,comment:null,fid:473,ruler:null,date_from:"01.01.1404",date_to:"15.01.1478",reason:null,description_short:"Воспользовавшись отсутствием смоленского князя Юрия Святославича, великий князь литовский Витовт взял Смоленск.\nВ 1654 г., после начала русско-польской войны, Смоленск и Смоленщина были окончательно присоединены к России, что было закреплено Андрусовским перемирием 1667 г. и Вечным миром 1686 г. ",description_long:null},{precision:0,comment:"полоса земель, формально относящихся к Московии, но фактически не контролируемое в полной мере Дикое Поле. Ситуация поменялась к концу 16 века, когда строительство серии городов привело к укреплению контроля над территорией",fid:474,ruler:null,date_from:"25.03.1503",date_to:"01.01.1551",reason:"Благовещенское перемирие",description_short:"По итогам Благовещенского перемирия к Великому княжеству Московскому от Великого княжества Литовского перешли 70 волостей, 22 городища и 13 сел – около трети территории последнего.",description_long:null},{precision:0,comment:"полоса земель, формально относящихся к Московии, но фактически не контролируемое в полной мере Дикое Поле. Ситуация поменялась к концу 16 века, когда строительство серии городов привело к укреплению контроля над территорией",fid:475,ruler:null,date_from:"25.03.1503",date_to:"01.01.1551",reason:"Благовещенское перемирие",description_short:"По итогам Благовещенского перемирия к Великому княжеству Московскому от Великого княжества Литовского перешли 70 волостей, 22 городища и 13 сел – около трети территории последнего.",description_long:null},{precision:0,comment:null,fid:476,ruler:null,date_from:"07.02.1494",date_to:null,reason:"Московско-литовский мирный договор по результатам войны 1487–1494 гг.",description_short:"Согласно московско-литовскому мирному договору, по результатам войны 1487–1494 гг. Великое княжество Литовское отказывалось от претензий на Новгород, Тверь, Псков, Рязань и лишалось большей части земель верховских княжеств. Москва возвращала Литве Любутск, Серпейск, Мосальск, Опаков и отказывалась от претензий на Смоленск и Брянск.",description_long:null},{precision:0,comment:null,fid:477,ruler:null,date_from:"02.07.1494",date_to:null,reason:"Московско-литовский мирный договор по результатам войны 1487–1494 гг.",description_short:"Согласно московско-литовскому мирному договору, по результатам войны 1487–1494 гг. Великое княжество Литовское отказывалось от претензий на Новгород, Тверь, Псков, Рязань и лишалось большей части земель верховских княжеств. Москва возвращала Литве Любутск, Серпейск, Мосальск, Опаков и отказывалась от претензий на Смоленск и Брянск.",description_long:null},{precision:0,comment:null,fid:478,ruler:null,date_from:"07.02.1494",date_to:"25.03.1503",reason:"Московско-литовский мирный договор по результатам войны 1487–1494 гг.",description_short:"Согласно московско-литовскому мирному договору, по результатам войны 1487–1494 гг. Великое княжество Литовское отказывалось от претензий на Новгород, Тверь, Псков, Рязань и лишалось большей части земель верховских княжеств. Москва возвращала Литве Любутск, Серпейск, Мосальск, Опаков и отказывалась от претензий на Смоленск и Брянск.",description_long:null},{precision:0,comment:"полоса земель, формально относящихся к Московии, но фактически не контролируемое в полной мере Дикое Поле. Ситуация поменялась к концу 16 века, когда строительство серии городов привело к укреплению контроля над территорией",fid:479,ruler:null,date_from:"25.03.1503",date_to:"01.01.1551",reason:"Благовещенское перемирие",description_short:"По итогам Благовещенского перемирия к Великому княжеству Московскому от Великого княжества Литовского перешли 70 волостей, 22 городища и 13 сел – около трети территории последнего.",description_long:null},{precision:0,comment:null,fid:480,ruler:null,date_from:"18.02.1537",date_to:null,reason:"Московское перемирие",description_short:"Согласно Московскому перемирию, по результатам Стародубской войны 1534–1537 гг. Гомель и гомельские области отошли Великому княжеству Литовскому. Москве отошел Себеж (Ивангород), Заволочье и Долысская волость. ",description_long:null},{precision:0,comment:null,fid:481,ruler:null,date_from:"08.10.1508",date_to:null,reason:"Мирный договор по результатам войны 1507–1508 гг.",description_short:"Согласно мирному договору, по результатам русско-литовской войны 1507–1508 гг. Великому княжеству Литовскому возвращался Любеч с окрестностями. ",description_long:'<a href="https://books.google.ru/books?id=GEhKAAAAYAAJ&pg=PA53&redir_esc=y#v=onepage&q&f=false" target="_blank">Договорная грамота 8 октября 1508</a><br />\nАкты, относящиеся к истории Западной России. СПб., 1848. Т. II. 1506—1544. С. 53—56.'},{precision:0,comment:null,fid:482,ruler:null,date_from:"14.09.1522",date_to:null,reason:"Московско-литовское перемирие",description_short:"Согласно московско-литовскому перемирию, смоленские земли оставались у России, но она отказывалась от притязаний на Киев, Полоцк и Витебск.",description_long:null},{precision:1,comment:"удачный поход нижегородских и московских сил на мордву, условная отправная точка",fid:483,ruler:null,date_from:"01.01.1378",date_to:"01.01.1484",reason:"Условная отправная точка вовлечения мордвы в орбиту влияния русских княжеств.",description_short:"Городецкий князь Борис Константинович с суздальской и московской помощью предпринял удачный поход в земли мордвы.",description_long:null},{precision:0,comment:"полоса земель, формально относящихся к Московии, но фактически не контролируемое в полной мере Дикое Поле",fid:484,ruler:null,date_from:"07.02.1494",date_to:"25.03.1503",reason:"Московско-литовский мирный договор по результатам войны 1487–1494 гг.",description_short:"Согласно московско-литовскому мирному договору, по результатам войны 1487–1494 гг. Великое княжество Литовское отказывалось от претензий на Новгород, Тверь, Псков, Рязань и лишалось большей части земель верховских княжеств. Москва возвращала Литве Любутск, Серпейск, Мосальск, Опаков и отказывалась от претензий на Смоленск и Брянск.",description_long:null},{precision:1,comment:"продвижение по Сырдарьинской оборонительной линии",fid:486,ruler:null,date_from:"01.01.1487",date_to:"01.01.1507",reason:"Взятие Казани московскими войсками.",description_short:"Взятие Казани московскими войсками. В истории Казанского ханства началась эпоха русского протектората.",description_long:null},{precision:1,comment:"условно обозначена территория мордвы, до Свияжской присяги находившаяся в некоторой зависимости от РГ",fid:487,ruler:null,date_from:"01.01.1485",date_to:"01.01.1551",reason:null,description_short:"Территории мордвы, зависимые от Российского государства, до Свияжской присяги.",description_long:null},{precision:0,comment:null,fid:488,ruler:null,date_from:"02.10.1552",date_to:null,reason:"Взятие Казани",description_short:"После взятия Казани все Среднее Поволжье было присоединено к России, включен ряд народов (татары, чуваши, удмурты, марийцы, башкиры). ",description_long:null},{precision:1,comment:null,fid:489,ruler:null,date_from:"01.01.1555",date_to:"01.01.1572",reason:"Вассалитет Сибирского ханства",description_short:"Хан Единер (из рода Тайбугинов) принес вассальную присягу царю Ивану IV и признал власть Москвы.",description_long:"В 1563 г. власть в сибирском ханстве захватил чингисид Кучум, который сразу прекратил прежние вассальные отношения с Россией. Окончательно захватив Сибирское ханство, Кучум согласился в 1571 г. на вассальную зависимость и выплату ясака Москве. Однако уже в 1573 г. он разорвал даннические отношения с Москвой. Его племянник Маметкул и сын Алей, пользуясь трудностями Москвы, связанными с Ливонской войной, подошли к Перми и вторглись во владения Строгановых. Это вызвало попытку ногайских татар отделиться от Москвы и черемисский бунт. В ответ организуется в сентябре 1581 г. поход Ермака в Сибирь. 1 октября 1581 г. Кучум выдержал натиск Ермака под Чувашской горой, но 26 октября был разбит Ермаком на правом берегу Иртыша у Чувашского мыса. Ермак беспрепятственно вступил в Искер, столицу Сибири. Сибирское ханство было разгромлено."},{precision:0,comment:null,fid:490,ruler:null,date_from:"02.07.1556",date_to:"01.01.1599",reason:"Взятие Астрахани.",description_short:"Вслед за Казанью к Московскому государству было присоединено Астраханское ханство. Астраханский хан Дервиш-Али признал себя вассалом московского царя.",description_long:"В 1554 г. астраханский хан Дервиш-Али признал себя вассалом московского царя. Одновременно астраханский хан вел переговоры о союзе с Крымом, надеясь с его помощью противостоять Москве. Узнав об этом, московские власти отправили на юг войска. В 1556 г. при приближении к Астрахани русских полков Дервиш-Али бежал. Астрахань сдалась без боя. Все владения Астраханского ханства, включая часть Башкирии и Прикаспийские районы до нижнего течения реки Яик (ныне река Урал), вошли в состав России."},{precision:1,comment:"признание ногайским беем вассальной зависимости от Москвы, до разгрома Орды калмыками",fid:491,ruler:null,date_from:"01.01.1557",date_to:"01.01.1634",reason:"Выдача жалованных грамот Иваном Грозным башкирам после переговоров о вхождении в состав России.",description_short:"Выдача башкирам жалованных грамот Иваном Грозным после переговоров о вхождении в состав России",description_long:null},{precision:0,comment:null,fid:492,ruler:null,date_from:"05.02.1563",date_to:null,reason:"Взятие Полоцка",description_short:"После взятия Полоцка началось освоение этих земель Русским государством. Полоцк и его окрестности находились в составе Русского государства до 1579 г., когда были отвоеваны войсками польского короля Стефана Батория.",description_long:null},{precision:0,comment:null,fid:493,ruler:null,date_from:"05.01.1582",date_to:null,reason:"Ям-Запольский мир",description_short:"Согласно Ям-Запольскому миру, Иван Грозный отказывался в пользу Речи Посполитой от 29 городов Ливонии со всем имуществом, также терял города Полоцк с уездом и Велиж с округой. \nРечь Посполитая возвращала Московскому государству со всем имуществом и волостями города Великие Луки, Невель, Заволочье, Холм, а также псковские пригороды Воронеч, Велью, Остров, Красное, Врев, Дубков, Выборец, Вышеград, Изборск, Опочку, Гдов, Кобылье городище и Себеж.",description_long:"Ям-Запольский мирный договор был подписан между Россией и Речью Посполитой 6 (15) января 1582 г. в дер. Киверова Гора, близ Запольского Яма (южнее Пскова), и стал юридическим документом, прекратившим Ливонскую войну. Переговоры между русской и польской сторонами велись с 13 декабря 1581 г. по 6 января 1582 г. Россию представляли окольничий князь Д. П. Елецкий, думный дворянин и печатник Р. В. Олферьев-Безнин, дьяк Н. Верещагин, подьячий З. Свиязев; Польшу – воевода Брацлавский князь Я. Збаражский, воевода Виленский великий гетман Литовский князь Х. Радзивилл, писарь Великого княжества Литовского М. Гарабурда. Посредником при переговорах был нунций Святого престола, папский легат, императорский посланник Антонио Поссевино.\n\nСогласно условиям договора, Россия отказывалась в пользу Польши от всех владений в Прибалтике. Польша, в свою очередь, возвращала России псковские (Опочку, Порхов и др.) и новгородские (Великие Луки, Невель, Холм, Себеж) земли, захваченные в ходе боевых действий. Требование польской стороной большой денежной контрибуции и возмещения других убытков, нанесенных войной, было отвергнуто русской стороной. По настоянию русских послов из текста договора было исключено упоминание ливонских городов, захваченных Швецией. Вопрос об их будущей принадлежности, таким образом, оставался открытым. Компромиссно решался вопрос о царском титуле Ивана IV Васильевича Грозного. В русском экземпляре договора он именовался «царем», а в польском этот титул не упоминался.\n\nДоговор был ратифицирован в Москве в июне 1582 г. Срок его действия определялся в 10 лет. Таким образом, это было фактическое перемирие, не снимавшее противоречий между Московским государством и Речью Посполитой. "},{precision:0,comment:null,fid:494,ruler:null,date_from:"26.05.1583",date_to:null,reason:"Плюсское перемирие",description_short:"По условиям Плюсского перемирия Россия была вынуждена отдать Швеции города Нарву, Ивангород, Ям, Копорье и Корелу с их уездами; Россия сохранила лишь узкий выход к морю в устье Невы (от р. Стрелки до р. Сестры).",description_long:null},{precision:0,comment:null,fid:495,ruler:null,date_from:"18.05.1595",date_to:null,reason:"Тявзинский мир",description_short:"Согласно условиям Тявзинского договора, Россия уступала Швеции княжество Эстляндское со всеми замками. Швеция возвращала России замок Кексгольм (Корелу) с уездом, а также признавала ее права на владение Иван-городом, Ямом, Копорьем, Нотебургом, Ладогой.",description_long:'Тявзинский мирный договор был подписан между Россией и Швецией 18/27 мая 1595 г. в местечке Тявзин (ныне деревня Извоз Волховский р-н, Ленинградская обл.) к северу от Нарвы на реке Нарове. Договор имел бессрочный характер («вечный мир»). От русской стороны договор подписали окольничий и наместник князь Иван Самсонович Туренин, стольник и наместник Елатомский боярин Остафий (Евстафий) Михайлович Пушкин, дьяк Григорий Иванович Клобуков, дьяк Посник Димитриевич Лодыгин. От шведской стороны – член Риксрода Стен Баннер, барон Кристер Классон Горн, лагман, наместник Колыванский Бран Бойе, наместник Нарвский Арвид Эрикссон, секретари Никлас Раек и Ханс Кранк.\n\nСогласно условиям договора, Россия уступала Швеции княжество Эстляндское со всеми замками (Нарва, Ревель, Вайсенштейн, Везенберг, Падис, Тольсборг, Нейшлот, Боркгольм, Гапсаль, Лоде, Леаль, Фикал). Швеция возвращала России замок Кексгольм (Корелу) с уездом, а также признавала ее права на владение Ивангородом, Ямом, Копорьем, Нотебургом, Ладогой. При этом брала на себя обязательства не нападать на Псков, Холмогоры, Кольский острог, Сумск (Сум-посад), Каргополь и Соловецкий монастырь.\n\nРоссия со своей стороны обязывалась не причинять вреда Финляндии, Выборгу, Нейшлоту, Каянской земле, всему княжеству Эстляндскому, а также Лапландии.\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=469520&SECTION_ID=8212" target="_blank">Карта Финляндии с указанием границ России и Швеции в разное время по договорам, а также по картам генерального штаба, Гермелина, Лоттера, Аф-Кнорринга и друг.</a><br />'},{precision:0,comment:null,fid:496,ruler:null,date_from:"18.02.1537",date_to:null,reason:"Московское перемирие",description_short:"Согласно Московскому перемирию, по результатам Стародубской войны 1534–1537 гг. Гомель и гомельские области отошли Великому княжеству Литовскому. Москве отошел Себеж (Ивангород), Заволочье и Долысская волость. ",description_long:null},{precision:1,comment:null,fid:498,ruler:null,date_from:"01.01.1462",date_to:null,reason:null,description_short:"Условная дата начала постепенного установления некоторого контроля над окраиной Дикого Поля. ",description_long:null},{precision:0,comment:null,fid:499,ruler:null,date_from:"18.02.1537",date_to:null,reason:"Московское перемирие",description_short:"Согласно Московскому перемирию, по результатам Стародубской войны 1534–1537 гг. Гомель и гомельские области отошли Великому княжеству Литовскому. Москве отошел Себеж (Ивангород), Заволочье и Долысская волость. ",description_long:null},{precision:1,comment:"до постройки белгородской засечной черты",fid:500,ruler:null,date_from:"01.01.1551",date_to:"02.07.1556",reason:"Свияжская присяга мордвы.",description_short:"Мордва вместе с другими народами Поволжья принимает присягу на верность русскому царю. «Чувашу, и черемису, и мордву, мажаров и тарханов привели к правде на том, что им государю и великому князю служить и хотети во всем добра, и от города Свияжского неотступным бытии...».",description_long:"Процесс вхождения мордовского народа в состав Российского государства был довольно длительным. У историков нет единого мнения относительно сроков окончания этого процесса. Одни историки (Г. Я. Меркушкин, Н. Ф. Мокшин, В. К. Абрамов) связывают завершение процесса с событиями 1551—1552 гг. и ликвидацией Казанского ханства; др. (А. В. Клеянкин, М. Ф. Жиганов) называют середину 80-х гг. 15 в., третьи (Н. В. Заварюхин) — 1392—1393 гг., время присоединения к Москве Нижегородского княжества и Мещеры."},{precision:0,comment:null,fid:501,ruler:null,date_from:"02.07.1556",date_to:"01.01.1599",reason:"Взятие Астрахани.",description_short:"Вслед за Казанью к Московскому государству было присоединено Астраханское ханство. Астраханский хан Дервиш-Али признал себя вассалом московского царя.",description_long:"В 1554 г. астраханский хан Дервиш-Али признал себя вассалом московского царя. Одновременно астраханский хан вел переговоры о союзе с Крымом, надеясь с его помощью противостоять Москве. Узнав об этом, московские власти отправили на юг войска. В 1556 г. при приближении к Астрахани русских полков Дервиш-Али бежал. Астрахань сдалась без боя. Все владения Астраханского ханства, включая часть Башкирии и Прикаспийские районы до нижнего течения реки Яик (ныне река Урал), вошли в состав России."},{precision:0,comment:null,fid:502,ruler:null,date_from:"05.01.1582",date_to:null,reason:"Ям-Запольский мир",description_short:"Согласно Ям-Запольскому миру, Иван Грозный отказывался в пользу Речи Посполитой от 29 городов Ливонии со всем имуществом, также терял города Полоцк с уездом и Велиж с округой. \nРечь Посполитая возвращала Московскому государству со всем имуществом и волостями города Великие Луки, Невель, Заволочье, Холм, а также псковские пригороды Воронеч, Велью, Остров, Красное, Врев, Дубков, Выборец, Вышеград, Изборск, Опочку, Гдов, Кобылье городище и Себеж.",description_long:"Ям-Запольский мирный договор был подписан между Россией и Речью Посполитой 6 (15) января 1582 г. в дер. Киверова Гора, близ Запольского Яма (южнее Пскова), и стал юридическим документом, прекратившим Ливонскую войну. Переговоры между русской и польской сторонами велись с 13 декабря 1581 г. по 6 января 1582 г. Россию представляли окольничий князь Д. П. Елецкий, думный дворянин и печатник Р. В. Олферьев-Безнин, дьяк Н. Верещагин, подьячий З. Свиязев; Польшу – воевода Брацлавский князь Я. Збаражский, воевода Виленский великий гетман Литовский князь Х. Радзивилл, писарь Великого княжества Литовского М. Гарабурда. Посредником при переговорах был нунций Святого престола, папский легат, императорский посланник Антонио Поссевино.\n\nСогласно условиям договора, Россия отказывалась в пользу Польши от всех владений в Прибалтике. Польша, в свою очередь, возвращала России псковские (Опочку, Порхов и др.) и новгородские (Великие Луки, Невель, Холм, Себеж) земли, захваченные в ходе боевых действий. Требование польской стороной большой денежной контрибуции и возмещения других убытков, нанесенных войной, было отвергнуто русской стороной. По настоянию русских послов из текста договора было исключено упоминание ливонских городов, захваченных Швецией. Вопрос об их будущей принадлежности, таким образом, оставался открытым. Компромиссно решался вопрос о царском титуле Ивана IV Васильевича Грозного. В русском экземпляре договора он именовался «царем», а в польском этот титул не упоминался.\n\nДоговор был ратифицирован в Москве в июне 1582 г. Срок его действия определялся в 10 лет. Таким образом, это было фактическое перемирие, не снимавшее противоречий между Московским государством и Речью Посполитой. "},{precision:0,comment:null,fid:503,ruler:null,date_from:"05.01.1582",date_to:null,reason:"Ям-Запольский мир",description_short:"Согласно Ям-Запольскому миру, Иван Грозный отказывался в пользу Речи Посполитой от 29 городов Ливонии со всем имуществом, также терял города Полоцк с уездом и Велиж с округой. \nРечь Посполитая возвращала Московскому государству со всем имуществом и волостями города Великие Луки, Невель, Заволочье, Холм. А также псковские пригороды Воронеч, Велью, Остров, Красное, Врев, Дубков, Выборец, Вышеград, Изборск, Опочку, Гдов, Кобылье городище и Себеж.",description_long:"Ям-Запольский мирный договор был подписан между Россией и Речью Посполитой 6 (15) января 1582 г. в дер. Киверова Гора, близ Запольского Яма (южнее Пскова), и стал юридическим документом, прекратившим Ливонскую войну. Переговоры между русской и польской сторонами велись с 13 декабря 1581 г. по 6 января 1582 г. Россию представляли окольничий князь Д. П. Елецкий, думный дворянин и печатник Р. В. Олферьев-Безнин, дьяк Н. Верещагин, подьячий З. Свиязев; Польшу – воевода Брацлавский князь Я. Збаражский, воевода Виленский великий гетман Литовский князь Х. Радзивилл, писарь Великого княжества Литовского М. Гарабурда. Посредником при переговорах был нунций Святого престола, папский легат, императорский посланник Антонио Поссевино.\n\nСогласно условиям договора, Россия отказывалась в пользу Польши от всех владений в Прибалтике. Польша, в свою очередь, возвращала России псковские (Опочку, Порхов и др.) и новгородские (Великие Луки, Невель, Холм, Себеж) земли, захваченные в ходе боевых действий. Требование польской стороны большой денежной контрибуции и возмещения других убытков, нанесенных войной, было отвергнуто русской стороной. По настоянию русских послов из текста договора было исключено упоминание ливонских городов, захваченных Швецией. Вопрос об их будущей принадлежности, таким образом, оставался открытым. Компромиссно решался вопрос о царском титуле Ивана IV Васильевича Грозного. В русском экземпляре договора он именовался «царем», а в польском этот титул не упоминался.\n\nДоговор был ратифицирован в Москве в июне 1582 г. Срок его действия определялся в 10 лет. Таким образом, это было фактическое перемирие, не снимавшее противоречий между Московским государством и Речью Посполитой. "},{precision:0,comment:null,fid:504,ruler:null,date_from:"05.01.1582",date_to:null,reason:"Ям-Запольский мир",description_short:"Согласно Ям-Запольскому миру, Иван Грозный отказывался в пользу Речи Посполитой от 29 городов Ливонии со всем имуществом, также терял города Полоцк с уездом и Велиж с округой. \nРечь Посполитая возвращала Московскому государству со всем имуществом и волостями города Великие Луки, Невель, Заволочье, Холм. А также псковские пригороды Воронеч, Велью, Остров, Красное, Врев, Дубков, Выборец, Вышеград, Изборск, Опочку, Гдов, Кобылье городище и Себеж.",description_long:"Ям-Запольский мирный договор был подписан между Россией и Речью Посполитой 6 (15) января 1582 г. в дер. Киверова Гора, близ Запольского Яма (южнее Пскова), и стал юридическим документом, прекратившим Ливонскую войну. Переговоры между русской и польской сторонами велись с 13 декабря 1581 г. по 6 января 1582. Россию представляли окольничий князь Д. П. Елецкий, думный дворянин и печатник Р. В. Олферьев-Безнин, дьяк Н. Верещагин, подьячий З. Свиязев; Польшу – воевода Брацлавский князь Я. Збаражский, воевода Виленский великий гетман Литовский князь Х. Радзивилл, писарь Великого княжества Литовского М. Гарабурда. Посредником при переговорах был нунций Святого престола, папский легат, императорский посланник Антонио Поссевино.\n\nСогласно условиям договора, Россия отказывалась в пользу Польши от всех владений в Прибалтике. Польша, в свою очередь, возвращала России псковские (Опочку, Порхов и др.) и новгородские (Великие Луки, Невель, Холм, Себеж) земли, захваченные в ходе боевых действий. Требование польской стороной большой денежной контрибуции и возмещения других убытков, нанесенных войной, было отвергнуто русской стороной. По настоянию русских послов из текста договора было исключено упоминание ливонских городов, захваченных Швецией. Вопрос об их будущей принадлежности, таким образом, оставался открытым. Компромиссно решался вопрос о царском титуле Ивана IV Васильевича Грозного. В русском экземпляре договора он именовался «царем», а в польском этот титул не упоминался.\n\nДоговор был ратифицирован в Москве в июне 1582 г. Срок его действия определялся в 10 лет. Таким образом, это было фактическое перемирие, не снимавшее противоречий между Московским государством и Речью Посполитой. "},{precision:0,comment:null,fid:505,ruler:null,date_from:"05.01.1582",date_to:null,reason:"Ям-Запольский мир",description_short:"Согласно Ям-Запольскому миру, Иван Грозный отказывался в пользу Речи Посполитой от 29 городов Ливонии со всем имуществом, также терял города Полоцк с уездом и Велиж с округой. \nРечь Посполитая возвращала Московскому государству со всем имуществом и волостями города Великие Луки, Невель, Заволочье, Холм. А также псковские пригороды Воронеч, Велью, Остров, Красное, Врев, Дубков, Выборец, Вышеград, Изборск, Опочку, Гдов, Кобылье городище и Себеж.",description_long:"Ям-Запольский мирный договор был подписан между Россией и Речью Посполитой 6 (15) января 1582 г. в дер. Киверова Гора, близ Запольского Яма (южнее Пскова), и стал юридическим документом, прекратившим Ливонскую войну. Переговоры между русской и польской сторонами велись с 13 декабря 1581 г. по 6 января 1582 г. Россию представляли окольничий князь Д. П. Елецкий, думный дворянин и печатник Р. В. Олферьев-Безнин, дьяк Н. Верещагин, подьячий З. Свиязев; Польшу – воевода Брацлавский князь Я. Збаражский, воевода Виленский великий гетман Литовский князь Х. Радзивилл, писарь Великого княжества Литовского М. Гарабурда. Посредником при переговорах был нунций Святого престола, папский легат, императорский посланник Антонио Поссевино.\n\nСогласно условиям договора, Россия отказывалась в пользу Польши от всех владений в Прибалтике. Польша, в свою очередь, возвращала России псковские (Опочку, Порхов и др.) и новгородские (Великие Луки, Невель, Холм, Себеж) земли, захваченные в ходе боевых действий. Требование польской стороной большой денежной контрибуции и возмещения других убытков, нанесенных войной, было отвергнуто русской стороной. По настоянию русских послов из текста договора было исключено упоминание ливонских городов, захваченных Швецией. Вопрос об их будущей принадлежности, таким образом, оставался открытым. Компромиссно решался вопрос о царском титуле Ивана IV Васильевича Грозного. В русском экземпляре договора он именовался «царем», а в польском этот титул не упоминался.\n\nДоговор был ратифицирован в Москве в июне 1582 г. Срок его действия определялся в 10 лет. Таким образом, это было фактическое перемирие, не снимавшее противоречий между Московским государством и Речью Посполитой. "},{precision:0,comment:null,fid:506,ruler:null,date_from:"26.05.1583",date_to:null,reason:"Плюсское перемирие",description_short:"По условиям Плюсского перемирия Россия была вынуждена отдать Швеции города Нарву, Ивангород, Ям, Копорье и Корелу с их уездами; Россия сохранила лишь узкий выход к морю в устье Невы (от р. Стрелки до р. Сестры).",description_long:null},{precision:1,comment:null,fid:507,ruler:null,date_from:"01.01.1586",date_to:null,reason:"Постройка крепостей Воронеж и Ливны",description_short:"Постройка крепостей Воронеж и Ливны, которые стали частью южных рубежей, позднее входивших в Большую засечную черту. Крепости защищали от набегов из придонских степей.",description_long:"Царский указ об основании Воронежа не сохранился. Сохранилась лишь выдержка из этого указа, в которой не называется дата основания Воронежа и которая помещена в распоряжении боярина Н. Р. Юрьева о реорганизации сторожевой службы на южной окраине России от 1 марта 1586 г.\nРаспоряжение боярина Н.Р. Юрьева о реорганизации сторожевой службы на южной окраине России:\n1 марта 1586 г.\n«И 94-го году марта в 1 день боярин Никита Романович Юрьев сей росписи слушал и приговорил: на Осколе усть Убли и на Дону на Богатом затоне стоялым головам не стояти. По государеву цареву и великого князя Федора Ивановича всея Руси и указу и по приговору бояр князя Федора Ивановича Мстиславского с товарыщи на Сосне, не доезжая Оскола два днища, поставить велено город Ливны, а на Дону на Воронеже, не доезжая Богатово затону два днища, велено поставить город Воронеж. А быти на Ливнах и город ставити воеводе князю Володимеру Васильевичю Кольцову-Мосальскому да Лукьяну Хрущеву, на Воронеже – воеводе Семену Федоровичу Сабурову, да Ивану Судакову, да Василью Биркину. И каковы будут вести на Ливнах про приход воинских людей на государевы украйны, и с Ливен посылати с вестьми на Воронеж, а с Воронежа по тому ж на Ливны с вестьми посылати. А ехати которыми дорогами поближе и бережнее, а сторожи воеводам поставити, присмотря в которых местех пригоже, и станицы по тому ж посылати присмотря. Да о том же отписати к государю. И воеводы с Воронежа и с Ливен к государю писали и сторожевые росписи прислали. А куды с Ливен на Воронеж и с Воронежа на Ливны для вестей и станицы посылати к которым урочищем не прислали...»"},{precision:0,comment:null,fid:508,ruler:null,date_from:"27.02.1617",date_to:null,reason:"Столбовский мир",description_short:"По Столбовскому мирному договору Швеция вернула России Новгород, Порхов, Старую Руссу, Ладогу, Гдов и Сумерскую волость. Россия уступала Швеции Ивангород, Ям, Копорье, Орешек, Корелу. Россия оказалась отрезанной от Балтийского моря.",description_long:'Столбовский мирный договор – договор между Россией и Швецией, положивший конец русско-шведской войне 1613–1617 гг., был подписан 27 февраля 1617 г. в селе Столбово.\n\nПо условиям договора Швеция возвращала России захваченные у нее во время Смуты земли: Новгород, Старую Руссу, Порхов, Ладогу, Гдов с уездами и Сумерскую волость. Россия, в свою очередь, передавала Швеции Ижорской землю с Иван-городом, Ямом, Копорьем, а также все Поневье и Орешек с уездом. За шведами оставался г. Корела с уездом. Сверх этого Россия должна была выплатить Швеции контрибуцию в размере 20 000 руб. серебром. Кроме того, Россия отказывалась от притязаний на Лифляндию, а русский царь должен был исключить из своего титула это название. Особой статьей оговаривались взаимный отказ от помощи Польши и необходимость заключения союза против нее.\n\nНесмотря на значительные территориальные потери и денежную контрибуцию, Столбовский мирный договор в значительной степени снимал напряжение на северо-западных рубежах России и способствовал медленному восстановлению страны после Смуты. \n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=469520&SECTION_ID=8212" target="_blank">Карта Финляндии с указанием границ России и Швеции в разное время по договорам, а также по картам генерального штаба, Гермелина, Лоттера, Аф-Кнорринга и друг.</a><br />\n'},{precision:0,comment:null,fid:509,ruler:null,date_from:"18.05.1595\n",date_to:null,reason:"Тявзинский мир",description_short:"Согласно условиям Тявзинского договора, Россия уступала Швеции княжество Эстляндское со всеми замками. Швеция возвращала России замок Кексгольм (Корелу) с уездом, а также признавала ее права на владение Иван-городом, Ямом, Копорьем, Нотебургом, Ладогой.",description_long:'Тявзинский мирный договор был подписан между Россией и Швецией 18/27 мая 1595 г. в местечке Тявзин (ныне деревня Извоз Волховский р-н, Ленинградская обл.) к северу от Нарвы на реке Нарова. Договор имел бессрочный характер («вечный мир»). От русской стороны договор подписали окольничий и наместник князь Иван Самсонович Туренин, стольник и наместник Елатомский боярин Остафий (Евстафий) Михайлович Пушкин, дьяк Григорий Иванович Клобуков, дьяк Посник Димитриевич Лодыгин. От шведской стороны – член Риксрода Стен Баннер, барон Кристер Классон Горн, лагман, наместник Колыванский Бран Бойе, наместник Нарвский Арвид Эрикссон, секретари Никлас Раек и Ханс Кранк.\n\nСогласно условиям договора, Россия уступала Швеции княжество Эстляндское со всеми замками (Нарва, Ревель, Вайсенштейн, Везенберг, Падис, Тольсборг, Нейшлот, Боркгольм, Гапсаль, Лоде, Леаль, Фикал). Швеция возвращала России замок Кексгольм (Корелу) с уездом, а также признавала ее права на владение Ивангородом, Ямом, Копорьем, Нотебургом, Ладогой. При этом брала на себя обязательства не нападать на Псков, Холмогоры, Кольский острог, Сумск (Сум-посад), Каргополь и Соловецкий монастырь.\n\nРоссия со своей стороны обязывалась не причинять вреда Финляндии, Выборгу, Нейшлоту, Каянской земле, всему княжеству Эстляндскому, а также Лапландии. \n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=469520&SECTION_ID=8212" target="_blank">Карта Финляндии с указанием границ России и Швеции в разное время по договорам, а также по картам генерального штаба, Гермелина, Лоттера, Аф-Кнорринга и друг.</a><br />'},{precision:0,comment:"Финляндия вернула СССР район Петсамо (Печенга)",fid:510,ruler:null,date_from:"9/19/1944",date_to:"9/19/1945",reason:"Московское перемирие",description_short:"Согласно Московскому перемирию СССР возвращалась область Петсамо (Печенга). ",description_long:null},{precision:0,comment:"Финляндия вернула СССР район Петсамо (Печенга)",fid:511,ruler:null,date_from:"14.03.1940\n",date_to:"14.03.1940\n",reason:"Советско-финский Московский мирный договор",description_short:"Согласно Московскому мирному договору между СССР и Финляндией, Финляндия передала СССР в аренду полуостров Ханко. Официальный отказ от прав на его аренду произошел в обмен на аренду полуострова Порккала-удд.",description_long:null},{precision:0,comment:null,fid:512,ruler:null,date_from:"9/19/1944",date_to:"12/7/1991",reason:"Московское перемирие",description_short:"Согласно Московскому перемирию СССР возвращались Айновские острова в Финском заливе.",description_long:null},{precision:0,comment:null,fid:513,ruler:null,date_from:"9/19/1944",date_to:"12/7/1991",reason:"Московское перемирие",description_short:"Согласно Московскому перемирию СССР возвращались Айновские острова в Финском заливе. ",description_long:null},{precision:1,comment:"Айновские острова - очень условно в качестве нижней даты присоединение Новгорода к Москве",fid:514,ruler:null,date_from:"15.01.1478",date_to:"10/14/1920",reason:null,description_short:"Айновские острова вместе с Новгородом были присоединены к Москве.",description_long:"В результате похода великого князя московского Ивана III на Новгород новгородская самостоятельность в 1478 г. была ликвидирована: вече было уничтожено как политический институт, а вечевой колокол увезен в Москву."},{precision:1,comment:"Айновские острова - очень условно в качестве нижней даты присоединение Новгорода к Москве",fid:515,ruler:null,date_from:"15.01.1478",date_to:"10/14/1920",reason:null,description_short:"Айновские острова вместе с Новгородом были присоединены к Москве.",description_long:"В результате похода великого князя московского Ивана III на Новгород новгородская самостоятельность в 1478 г. была ликвидирована: вече было уничтожено как политический институт, а вечевой колокол увезен в Москву."},{precision:0,comment:null,fid:516,ruler:null,date_from:"10/14/1920",date_to:null,reason:"Тартуский мирный договор",description_short:"Согласно Тартускому мирному договору к Финляндии отошла часть полуострова Рыбачий, часть полуострова Средний и область Петсамо (Печенга), Айновы острова.",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=150940" target="_blank">Текст Тартуского мирного договора</a><br />\n\n<a href="https://upload.wikimedia.org/wikipedia/commons/d/d5/Tartu_rahu_kaart_1920.jpg" target="_blank">Российско-эстонская граница по договору</a><br />\n\n<a href="https://www.riigiteataja.ee/failid/tartu_rahu.pdf" target="_blank">Оригинал Тартуского мирного договора</a><br />'},{precision:1,comment:"Финляндия вернула СССР Айновские острова",fid:517,ruler:null,date_from:"9/19/1944",date_to:"14.03.1940\n",reason:"Советско-финское Московское перемирие",description_short:"Согласно Московскому перемирию советское правительство отказалось от аренды базы на п-ове Ханка. Финское правительство предоставило в аренду район Порккала.",description_long:null},{precision:0,comment:null,fid:518,ruler:null,date_from:"8/6/1940",date_to:"11/16/1991",reason:"Эстонская ССР принята в состав СССР постановлением Верховного Совета",description_short:"Эстонская ССР принята в состав СССР постановлением Верховного Совета СССР",description_long:'<a href="https://ru.wikisource.org/wiki/%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0:Sbornik_zakonov_1938-1956.djvu/57" target="_blank">Закон от 6 августа 1940 г. «О принятии Эстонской Советской Социалистической Республики в Союз Советских Социалистических Республик»</a><br />'},{precision:0,comment:null,fid:519,ruler:null,date_from:"8/6/1940",date_to:"11/16/1991",reason:"Эстонская ССР принята в состав СССР постановлением Верховного Совета",description_short:"Эстонская ССР принята в состав СССР постановлением Верховного Совета СССР",description_long:'<a href="https://ru.wikisource.org/wiki/%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0:Sbornik_zakonov_1938-1956.djvu/57" target="_blank">Закон от 6 августа 1940 г. «О принятии Эстонской Советской Социалистической Республики в Союз Советских Социалистических Республик»</a><br />'},{precision:0,comment:null,fid:520,ruler:null,date_from:"3/5/1918",date_to:"1/1/2018",reason:"Переезд правительства в Москву.",description_short:"Перенос столицы России из Петрограда в Москву",description_long:null},{precision:0,comment:null,fid:521,ruler:null,date_from:"3/18/2014",date_to:"1/1/2018",reason:"Договор о вхождении республики Крым в состав РФ.",description_short:"Договор о вхождении республики Крым в состав РФ",description_long:"Согласно договору, независимое и суверенное государство Республика Крым, в которой город Севастополь имеет особый статус, на основании результатов общекрымского референдума входит в состав Российской Федерации, в которой со дня принятия образуются новые субъекты — Республика Крым и город федерального значения Севастополь. Договор вступил в силу с 1 апреля 2014 г."},{precision:0,comment:null,fid:522,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:523,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:524,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса/a><br />'},{precision:0,comment:null,fid:525,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:526,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:527,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса/a><br />'},{precision:0,comment:null,fid:528,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:529,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:530,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:531,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:532,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:533,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:534,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:535,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:536,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:537,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:538,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:539,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:540,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:541,ruler:null,date_from:"9/2/1945",date_to:"12/7/1991",reason:"Завершение Второй мировой войны.",description_short:"Курильские острова стали вновь российскими.",description_long:'2 сентября 1945 г. был подписан Акт о капитуляции Японии. Тогда же вступили в законную силу решения Ялтинской конференции 1945 г., согласно которым Советскому Союзу возвращались территории, ранее принадлежавшие России и затем присоединенные к Японии. Южный Сахалин и Курильские острова вновь стали российскими.\nКурилы.\n\n<a href="https://www.runivers.ru/doc/d2.php?SECTION_ID=7194&PORTAL_ID=7149" target="_blank">История вопроса</a><br />'},{precision:0,comment:null,fid:542,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно «Соглашению о создании Содружества Независимых Государств», подписанного Республикой Беларусь, Российской Федерацией и Украиной как государствами, учредителями Союза ССР, подписавшими Договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:543,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно «Соглашению о создании Содружества Независимых Государств», подписанного Республикой Беларусь, Российской Федерацией и Украиной как государствами, учредителями Союза ССР, подписавшими Договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:544,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно «Соглашению о создании Содружества Независимых Государств», подписанного Республикой Беларусь, Российской Федерацией и Украиной как государствами, учредителями Союза ССР, подписавшими Договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:"советское правительство отказалось от аренды базы на п-ове Ханка, финское правительство предоставило в аренду район Порккала",fid:545,ruler:null,date_from:"12.03.1940\n",date_to:null,reason:"Советско-финский Московский мирный договор",description_short:"Согласно Московскому мирному договору между СССР и Финляндией СССР отошла северная часть Карельского перешейка с городами Выборг и Сортавала, ряд островов в Финском заливе, часть финской территории с городом Куолаярви, часть полуостровов Рыбачий и Средний.",description_long:null},{precision:0,comment:null,fid:545,ruler:null,date_from:"9/19/1944",date_to:"9/19/1955",reason:"Московское перемирие",description_short:"Согласно Московскому перемирию советское правительство отказалось от аренды базы на п-ове Ханка. Финское правительство предоставило в аренду район Порккала.",description_long:null},{precision:0,comment:null,fid:546,ruler:null,date_from:"8/2/1945",date_to:null,reason:"Завершение Потсдамской конференции.",description_short:"На Потсдамской конференции было принято решение о передаче Кенигсберга СССР.",description_long:"В статье VI Потсдамского соглашения «О городе Кенигсберге и прилегающем к нему районе» говорится о том, что прилегающая к Балтийскому морю часть западной границы СССР проходит от пункта на восточном берегу Данцигской бухты, обозначенного на прилагаемой карте к востоку — севернее Браунсберга—Гольдапа, к стыку границ Литвы, Польской Республики и бывшей Восточной Пруссии."},{precision:0,comment:null,fid:547,ruler:null,date_from:"6/29/1945",date_to:null,reason:"По договору СССР с Чехословакией Украинской ССР передана Закарпатская область.",description_short:"По договору СССР с Чехословакией Украинской ССР передана Закарпатская Украина (носящая, согласно Чехословацкой Конституции, принятой 29 февраля 1920 г., название Подкарпатская Русь). ",description_long:null},{precision:0,comment:null,fid:548,ruler:null,date_from:"8/16/1945",date_to:null,reason:"Передача Польше Перемышля.",description_short:"В состав Польши были возвращены районы Санока и Перемышля, присоединенные к СССР в 1939 г.",description_long:null},{precision:0,comment:null,fid:549,ruler:null,date_from:"8/16/1945",date_to:null,reason:"Советско-польский договор «О советско-польской государственной границе».",description_short:"На основании договора о государственной границе между Польшей и СССР от 16 августа 1945 г. город Белосток с прилегающими районами был передан Польше.",description_long:null},{precision:0,comment:"переход Южного Сахалина в состав СССР",fid:550,ruler:null,date_from:"02.09.1945\n",date_to:null,reason:"Завершение Второй мировой войны",description_short:"Указом Президиума Верховного Совета СССР земля, недра, леса, воды Южного Сахалина и Курильских островов 2 февраля 1946 г. объявляются собственностью Советского государства.",description_long:"В Каирской Декларации от 27 ноября 1943 г. указывалось, что цель союзных держав состоит в том, чтобы лишить Японию территорий, захваченных ею в результате военной интервенции: Корея, Тайвань, группа островов в Тихом Океане и южный Сахалин с островами Курильской гряды, которые Япония захватила в результате русско-японской войны в 1905 г.\nВпоследствии, 11 февраля 1945 г., на ялтинской конференции союзники достигли договоренности о вступлении СССР в войну против Японии при обязательном условии — возвращение в состав СССР Южного Сахалина и Курильских островов.\n2 сентября 1945 г. был подписан Акт о капитуляции Японии.\nОтсоединение Курильских островов от Японии и присоединение их к территории СССР произошло 29 января 1946 г. Меморандумом №677 Главнокомандующего Союзных Держав.\n2 февраля 1946 г. на этих территориях была образована Южно-Сахалинская область в составе Хабаровского края РСФСР. "},{precision:0,comment:null,fid:551,ruler:null,date_from:"2/15/1951",date_to:null,reason:"Договор между СССР и ПНР об обмене территориями.",description_short:"В соответствии с договором между СССР и Польской Республикой от 15 февраля 1951 г. об обмене участками государственных территорий, Польская Республика и Союз Советских Социалистических Республик обменялись участками государственных территорий ",description_long:"Польша получала участок в Дрогобычской области общей площадью в 480 км², передавая Советскому Союзу равный по размеру участок в Люблинском воеводстве."},{precision:0,comment:null,fid:552,ruler:null,date_from:"2/15/1951",date_to:null,reason:"Договор между СССР и ПНР об обмене территориями.",description_short:"В соответствии с договором между СССР и Польской Республикой от 15 февраля 1951 г. об обмене участками государственных территорий, Польская Республика и Союз Советских Социалистических Республик обменялись участками государственных территорий ",description_long:"Польша получала участок в Дрогобычской области общей площадью в 480 км², передавая Советскому Союзу равный по размеру участок в Люблинском воеводстве."},{precision:0,comment:"Финляндия передала СССР в аренду полуостров Ханка, официальный отказ от прав на аренду произошел в обмен на аренду полуострова Порккала-удд",fid:553,ruler:null,date_from:"12.03.1940\n",date_to:"9/19/1944",reason:"Советско-финский Московский мирный договор",description_short:"Согласно Московскому мирному договору между СССР и Финляндией СССР отошла северная часть Карельского перешейка с городами Выборг и Сортавала, ряд островов в Финском заливе, часть финской территории с городом Куолаярви, часть полуостровов Рыбачий и Средний.",description_long:null},{precision:0,comment:null,fid:554,ruler:null,date_from:"8/5/1940",date_to:null,reason:"Латвийская ССР принята в состав СССР постановлением Верховного Совета.",description_short:"Латвийская ССР принята в состав СССР постановлением Верховного Совета СССР",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/09-18-deklaraciya-latviya.shtml" target="_blank">«Декларация о вхождении Латвии в состав СССР»</a><br />\n\n4 мая 1990 года Верховным Советом Латвийской ССР была принята «Декларация о восстановлении государственной независимости Латвийской Республики». 6 сентября 1991 года независимость Латвии была признана Государственным Советом СССР. '},{precision:0,comment:null,fid:554,ruler:null,date_from:"8/5/1940",date_to:null,reason:"Латвийская ССР принята в состав СССР постановлением Верховного Совета",description_short:"Латвийская ССР принята в состав СССР постановлением Верховного Совета СССР.",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/09-18-deklaraciya-latviya.shtml" target="_blank">«Декларация о вхождении Латвии в состав СССР»</a><br />\n\n4 мая 1990 г. Верховным Советом Латвийской ССР была принята «Декларация о восстановлении государственной независимости Латвийской Республики». 6 сентября 1991 г. независимость Латвии была признана Государственным Советом СССР. \n\n'},{precision:0,comment:null,fid:555,ruler:null,date_from:"12/30/1922",date_to:"6/28/1940",reason:"Образование Союза ССР",description_short:"Спорные территории: Бессарабия, Северная Буковина и область Герца, принадлежность которой Румынии отказывался признавать СССР. Вошли в состав СССР в 1940 г.",description_long:null},{precision:0,comment:null,fid:556,ruler:null,date_from:"6/28/1940",date_to:null,reason:"Румыния передала СССР Бессарабию и Северную Буковину",description_short:"Присоединение Бессарабии, Северной Буковины и области Герца к СССР",description_long:'<a href="https://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=147435" target="_blank">Телеграмма наркома иностранных дел CCCР В. М. Молотова полномочному представителю CCCР в королевстве Румыния А. И. Лаврентьеву</a><br />'},{precision:0,comment:null,fid:557,ruler:null,date_from:"11/2/1939",date_to:null,reason:"Законом СССР присоединены Западная Белоруссия и Западная Украина",description_short:"Включение в состав СССР территорий Западной Украины и Западной Белоруссии с принятием на внеочередной V сессии Верховного Совета СССР Закона СССР «О включении Западной Украины в состав Союза ССР с воссоединением ее с Украинской ССР» (1 ноября 1939 г.) и Закона СССР «О включении Западной Белоруссии в состав Союза ССР с воссоединением ее с Белорусской ССР» (2 ноября 1939 г.) на основании ходатайств Полномочных Комиссий Народного Собрания Западной Украины и Народного Собрания Западной Белоруссии.",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/09-44-deklaraciya-ukraine.shtml" target="_blank">Декларация «О вхождении Западной Украины в состав Украинской Советской Социалистической Республики»</a><br />\n\n<a href="http://www.rusarchives.ru/projects/statehood/09-15-deklaraciya-zapadnaya-belarus.shtml" target="_blank">Декларация «О вхождении Западной Белоруссии в состав Белорусской Советской Социалистической республики»</a><br />\n\n'},{precision:0,comment:"по сути до 1944 г. республика находилась в сфере влияния России, хотя как самостоятельное государство была признана только Россией и, позднее, Монголией, а большинство стран считали ее частью Китая",fid:558,ruler:null,date_from:"8/14/1921",date_to:"10/14/1944",reason:"Провозглашение независимой республики Танну-Тува",description_short:"Провозглашение независимой республики Танну-Тува на территории бывшего протектората Российской империи Урянхайского края. ",description_long:"До 1944 г. республика находилась в сфере влияния России, хотя как самостоятельное государство была признана только Россией и, позднее, Монголией, большинство стран считали ее частью Китая. В 1944 г. вошла в состав СССР как Тувинская автономная область в составе РСФСР."},{precision:1,comment:null,fid:559,ruler:null,date_from:"1/1/1932",date_to:null,reason:"Изменения на отдельных участках границы с Монгольской республикой.",description_short:"Изменения на отдельных участках границы с Монгольской республикой",description_long:null},{precision:1,comment:null,fid:560,ruler:null,date_from:"1/1/1932",date_to:null,reason:"Передача Тувинской республике населенных тувинцами земель приграничной зоны",description_short:"Согласно соглашению между Монгольской Народной Республикой и Тувинской Народной Республикой северная часть Убсунурской котловины передавалась Туве.",description_long:null},{precision:0,comment:null,fid:561,ruler:null,date_from:"4/6/1920",date_to:"11/15/1922",reason:"Создание буферной Дальневосточной республики",description_short:"Создание буферной Дальневосточной республики",description_long:"Провозглашение Дальневосточной республики способствовало предотвращению прямого военного конфликта между Советской Россией и Японией и выводу иностранных войск с территории Дальневосточного края и создало возможность для Советской России с помощью НРА разгромить несоветские республики Забайкалья, Приамурья и Зеленый Клин."},{precision:0,comment:null,fid:562,ruler:null,date_from:"4/6/1920",date_to:"11/15/1922",reason:"Создание буферной Дальневосточной республики",description_short:"Создание буферной Дальневосточной республики",description_long:"Провозглашение Дальневосточной республики способствовало предотвращению прямого военного конфликта между Советской Россией и Японией и выводу иностранных войск с территории Дальневосточного края и создало возможность для Советской России с помощью НРА разгромить несоветские республики Забайкалья, Приамурья и Зеленый Клин."},{precision:0,comment:null,fid:563,ruler:null,date_from:"11/15/1922",date_to:"1/1/2018",reason:"Упразднение Дальневосточной республики",description_short:"Упразднение Дальневосточной республики и включение ее в состав РСФСР как Дальневосточной области",description_long:null},{precision:1,comment:null,fid:564,ruler:null,date_from:"10/27/1924",date_to:null,reason:"Ликвидация Бухарской народной республики, вхождение территории в СССР.",description_short:"Ликвидация Бухарской народной республики и вхождение территории в состав СССР",description_long:"19 сентября 1924 г. 5-й Всебухарский курултай Советов принял решение о вхождении Бухарской народной советской республики в Советский Союз, которая в результате национально-государственного размежевания в Средней Азии 27 октября 1924 г. была упразднена; ее территория вошла в состав вновь образованных Узбекской ССР, Туркменской ССР и Таджикской АССР (с 1929 — Таджикской ССР). "},{precision:0,comment:null,fid:565,ruler:null,date_from:"12/30/1922",date_to:null,reason:"Образование СССР.",description_short:"Договор об образовании СССР объединял РСФСР, УССР, БССР и ЗСФСР в единое союзное государство — Союз Советских Социалистических Республик. 20 мая 1925 г. III съезд Советов СССР постановил указать в союзном договоре Туркменскую ССР и Узбекскую ССР. 5 декабря 1929 г. ЦИК СССР постановил указать в договоре Таджикскую ССР. В России договор был денонсирован 12 декабря 1991 г. постановлением Верховного Совета РСФСР №2015-I.",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/09-02-deklaraciya-obrazovanie-sssr-1922.shtml" target="_blank">Декларация и Договор об образовании СССР</a><br />'},{precision:0,comment:null,fid:566,ruler:null,date_from:"12/30/1922",date_to:null,reason:"Образование СССР.",description_short:"Договор об образовании СССР объединял РСФСР, УССР, БССР и ЗСФСР в единое союзное государство — Союз Советских Социалистических Республик. 20 мая 1925 г. III съезд Советов СССР постановил указать в союзном договоре Туркменскую ССР и Узбекскую ССР. 5 декабря 1929 г. ЦИК СССР постановил указать в договоре Таджикскую ССР. В России договор был денонсирован 12 декабря 1991 г. постановлением Верховного Совета РСФСР №2015-I.",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/09-02-deklaraciya-obrazovanie-sssr-1922.shtml" target="_blank">Декларация и Договор об образовании СССР</a><br />'},{precision:0,comment:null,fid:567,ruler:null,date_from:"10/14/1920",date_to:null,reason:"Тартуский мирный договор",description_short:"Согласно Тартускому мирному договору к Финляндии отошла часть полуострова Рыбачий, часть полуострова Средний и область Петсамо (Печенга), Айновы острова.",description_long:'<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=150940" target="_blank">Текст Тартуского мирного договора</a><br />\n\n<a href="https://upload.wikimedia.org/wikipedia/commons/d/d5/Tartu_rahu_kaart_1920.jpg" target="_blank">Российско-эстонская граница по договору</a><br />\n\n<a href="https://www.riigiteataja.ee/failid/tartu_rahu.pdf" target="_blank">Оригинал Тартуского мирного договора</a><br />'},{precision:1,comment:null,fid:568,ruler:null,date_from:"01.03.1932\n",date_to:null,reason:"Подписано дополнение к Соглашению о российско-китайской государственной границе. Точная дата не установлена.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на Амуре.",description_long:null},{precision:1,comment:null,fid:569,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:570,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:571,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:572,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:573,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:574,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:0,comment:null,fid:575,ruler:null,date_from:"3/1/1932",date_to:null,reason:"Точная дата не установлена. В связи с образованием подконтрольного Японии государства Маньчжоу-го (или ранее в связи с японской экспансией) СССР взял под контроль ряд островов на р. Амур.",description_short:"В связи с образованием подконтрольного Японии государства Маньчжоу-го СССР взял под контроль ряд островов на р. Амур.",description_long:null},{precision:1,comment:null,fid:576,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:577,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья р. Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:0,comment:null,fid:578,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:578,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:579,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья р. Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:580,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:581,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:582,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:1,comment:null,fid:583,ruler:null,date_from:"10/14/2004",date_to:null,reason:"Подписано дополнение к соглашению о российско-китайской государственной границе",description_short:"Согласно дополнению к соглашению о российско-китайской государственной границе Китай получил ряд территорий общей площадью 337 квадратных километров.",description_long:'В результате проведения межгосударственной границы по центру р. Амур Китай получил ряд территорий общей площадью 337 квадратных километров: участок земли в районе острова Большой (верховья р. Аргунь в Читинской области) и два участка в районе островов Тарабаров и Большой Уссурийский в районе слияния рек Амур и Уссури. Основную часть этих территорий составила западная оконечность Большого Уссурийского острова на р. Амур напротив устья реки Уссури. Остров имеет территорию от 327 до 350 км² в зависимости от сезона. \n\n<a href="https://www.kommersant.ru/doc/521958" target="_blank">Текст дополнения к соглашению. О границе между Российской Федерацией и Китайской Народной Республикой в ее восточной части</a><br />'},{precision:0,comment:null,fid:584,ruler:null,date_from:"5/19/1991",date_to:null,reason:"Передача Китаю острова Даманский на основе соглашения",description_short:"По соглашению между СССР и КНР граница проведена по фарватеру реки Уссури и остров Даманский отошел Китаю. ",description_long:null},{precision:1,comment:"аренда",fid:586,ruler:null,date_from:"9/2/1945",date_to:"5/1/1955",reason:"после прекращения Второй мировой войны СССР возобновил аренду у Китая",description_short:"После Второй мировой войны СССР возобновил аренду Квантунской области. ",description_long:"14 февраля 1950 г. было заключено соглашение с Китаем о выводе советских войск из Порт-Артура и передаче сооружений в этом районе Китаю после подписания договора с Японией, но не позже конца 1952 г. 15 сентября 1952 г. после обмена нотами между Китаем и СССР срок вывода советских войск был продлен до заключения мирных договоров между Китаем и Японией и СССР и Японией. Вывод советских войск и передача территории под китайскую юрисдикцию завершены в мае 1955 г. "},{precision:0,comment:"до создания ГДР",fid:587,ruler:null,date_from:"05.06.1945\n",date_to:"10/7/1949",reason:"Соглашение союзников о четырех зонах оккупации",description_short:"По соглашению четырех союзных держав территория Германии была разделена на четыре зоны оккупации.",description_long:'<a href="http://istorik.ucoz.com/publ/dopolnitelnyj_material/istochniki/deklaracija_o_porazhenii_germanii_1945_god/20-1-0-1305" target="_blank">Декларация о поражении Германии и взятии на себя верховной власти в отношении Германии правительствами Союза Советских Социалистических Республик, Соединенного Королевства и Соединенных Штатов Америки и Временным правительством Французской республики</a><br />'},{precision:0,comment:"до создания ГДР",fid:588,ruler:null,date_from:"05.06.1945\n",date_to:"10/7/1949",reason:"Соглашение союзников о четырех зонах оккупации",description_short:"По соглашению четырех союзных держав территория Германии была разделена на четыре зоны оккупации.",description_long:'<a href="http://istorik.ucoz.com/publ/dopolnitelnyj_material/istochniki/deklaracija_o_porazhenii_germanii_1945_god/20-1-0-1305" target="_blank">Декларация о поражении Германии и взятии на себя верховной власти в отношении Германии правительствами Союза Советских Социалистических Республик, Соединенного Королевства и Соединенных Штатов Америки и Временным правительством Французской республики</a><br />'},{precision:0,comment:"до создания ГДР",fid:589,ruler:null,date_from:"05.06.1945\n",date_to:"10/7/1949",reason:"Соглашение союзников о четырех зонах оккупации",description_short:"По соглашению четырех союзных держав территория Германии была разделена на четыре зоны оккупации.",description_long:'<a href="http://istorik.ucoz.com/publ/dopolnitelnyj_material/istochniki/deklaracija_o_porazhenii_germanii_1945_god/20-1-0-1305" target="_blank">Декларация о поражении Германии и взятии на себя верховной власти в отношении Германии правительствами Союза Советских Социалистических Республик, Соединенного Королевства и Соединенных Штатов Америки и Временным правительством Французской республики</a><br />'},{precision:0,comment:"до создания ГДР",fid:590,ruler:null,date_from:"05.06.1945\n",date_to:"10/7/1949",reason:"Соглашение союзников о четырех зонах оккупации",description_short:"По соглашению четырех союзных держав территория Германии была разделена на четыре зоны оккупации.",description_long:'<a href="http://istorik.ucoz.com/publ/dopolnitelnyj_material/istochniki/deklaracija_o_porazhenii_germanii_1945_god/20-1-0-1305" target="_blank">Декларация о поражении Германии и взятии на себя верховной власти в отношении Германии правительствами Союза Советских Социалистических Республик, Соединенного Королевства и Соединенных Штатов Америки и Временным правительством Французской республики</a><br />'},{precision:0,comment:null,fid:591,ruler:null,date_from:"7/4/1945",date_to:"5/15/1955",reason:"Союзниками подписано соглашение о системе контроля над Австрией.",description_short:"Первым Соглашением о системе контроля над Австрией от 4 июля 1945 г. четыре державы-победительницы учредили Союзническую комиссию по Австрии.",description_long:"Советские власти в Вене приняли решение о создании нового австрийского правительства без предварительной консультации с лидерами других союзных государств, и 27 апреля 1945 г. австрийский лидер социалистов Карл Реннер сформировали правительство в Вене. В течение июня 1945 г. переговоры по соглашению о разделе Австрии на зоны оккупации были проведены в Лондоне в рамках Европейской консультативной комиссии, и соглашение было заключено 4 июля 1945 г. для последующего его утверждения. Соглашение затем был утверждено правительствами четырех стран-союзников. Австрия была разделена на четыре зоны: американскую, британскую, французскую и советскую. Вена, будучи столицей, также была разделена, но в ее центре была международная зона, управление которой осуществлялось поочередно четырьмя державами. Декларация о независимости Австрии провозгласила Австрию суверенным государством. Была подписана 15 мая 1955 г. в Вене, во дворце Бельведер, между союзными оккупационными силами (Франция, Великобритания, Соединенные Штаты и СССР) и австрийским правительством. Официально вступила в силу 15 мая 1955 г. "},{precision:0,comment:null,fid:592,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:593,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:594,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:595,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:596,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:597,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:598,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:599,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:600,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:601,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:602,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:603,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:604,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:605,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:606,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:607,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:608,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:609,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:610,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:611,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:612,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:613,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:614,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:615,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:616,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:617,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:618,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:619,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:620,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:621,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:622,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:623,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:624,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"Декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:"В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.»."},{precision:0,comment:null,fid:625,ruler:null,date_from:"4/15/1926",date_to:"12/7/1991",reason:"декрет Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане»",description_short:"Согласно декрету Президиума ЦИК «Об объявлении территорией Союза ССР земель и островов, расположенных в Северном Ледовитом океане» территорией СССР объявлялись «расположенные в Северном Ледовитом океане, к северу от побережья Союза ССР до северного полюса в пределах между меридианом тридцать два градуса четыре минуты тридцать пять секунд восточной долготы от Гринвича, проходящим по восточной стороне Вайда-губы через триангуляционный знак на мысу Кекурском, и меридианом сто шестьдесят восемь градусов сорок девять минут тридцать секунд западной долготы от Гринвича, проходящим по середине пролива, разделяющего острова Ратманова и Крузенштерна группы островов Диомида в Беринговом проливе».\nПостановление делало исключение для земель и островов, принадлежность которых иностранным государствам была ранее признана советским правительством (имелись в виду архипелаг Шпицберген и о. Медвежий, владение которыми Норвегией закреплено Парижским договором от 9 февраля 1920 г.).",description_long:'В 1979 г. СССР уточнил восточные границы своих полярных владений с «168 градусов 49 мин. 30 сек.» на «168 градусов 58 мин. 49,4 сек.".'},{precision:1,comment:null,fid:626,ruler:null,date_from:"1/1/1930",date_to:"12/7/1991",reason:"Открытие острова Шмидта.",description_short:"Открытие острова Шмидта экспедицией на ледокольном пароходе «Георгий Седов» под руководством О. Ю. Шмидта и В. Ю. Визе",description_long:null},{precision:1,comment:null,fid:627,ruler:null,date_from:"8/14/1930",date_to:"12/7/1991",reason:"Открытие острова Визе советской экспедицией.",description_short:"Открытие острова Визе экспедицией на ледокольном пароходе «Георгий Седов» под руководством О. Ю. Шмидта и В. Ю. Визе.",description_long:null},{precision:0,comment:null,fid:628,ruler:null,date_from:"3/3/1918",date_to:"3/3/1918",reason:"Брестский мир",description_short:"По Брестскому миру Россия теряла Царство Польское, Украину, Эстляндскую, Курляндскую и Лифляндскую губернии, Великое княжество Финляндское. На Кавказе Россия уступала Карсскую область и Батумскую область. От России была отторгнута территория площадью 780 тыс. кв. км.",description_long:'По заключенному дополнительному договору Россия признавала независимость Украины и Грузии, отказывалась от Эстонии и Ливонии, которые по первоначальному договору формально признавались частью Российского государства, получила право доступа в балтийские порты (Ревель, Рига и Виндау) и удержала за собой Крым и контроль над Баку.\n\n<a href="http://www.runivers.ru/doc/d2.php?CENTER_ELEMENT_ID=146945" target="_blank">Текст Брестского договора</a><br />\n\n<a href="http://www.1000dokumente.de/index.html?c=dokument_ru&dokument=0011_bre&object=facsimile&pimage=1&v=100&nav=&l=ru" target="_blank">Мирный Договор между Германией, Австро-Венгрией, Болгарией и Турцией с одной стороны и Россией с другой, оригинал</a><br />\n\n<a href="https://hdl.handle.net/2027/loc.ark:/13960/t1tf09j4t" target="_blank">Полный список и тексты договоров, подписанных Россией в Брест-Литовске с Германией и ее союзниками на английском и немецком языках, включая тексты более поздних финансовых соглашений.</a><br />'},{precision:0,comment:null,fid:629,ruler:null,date_from:"4/22/1918",date_to:null,reason:"Создание Закавказской демократической федеративной республики",description_short:"Создание Закавказской демократической федеративной республики в пределах территории Бакинской, Елизаветпольской, Эриванской, Тифлисской, Кутаисской губерний, Батумской и Карсской областей, Закатальского и Сухумского округов бывшей Российской империи",description_long:"26 мая 1918 г. Закавказская республика распалась на три государства: 26 мая была провозглашена Грузинская Демократическая Республика, 28 мая — Азербайджанская Демократическая Республика, 30 мая — Республика Армения."},{precision:1,comment:"Псков фактически независим от Новгорода",fid:630,ruler:null,date_from:"01.01.1137",date_to:"01.01.1399",reason:null,description_short:"Независимость Пскова от Новгорода",description_long:"Псковская земля выделилась из Новгородской волости в середине XII в. В процессе обособления земель в средневековой Руси ни одной из княжеских ветвей рода Рюриковичей не удалось закрепиться в Пскове. При этом Псков вплоть до середины XIV в. сохранял некоторую зависимость от Новгорода. Во второй половине XIII – XIV в. в Пскове сложилась феодальная республика, по форме правления сходная с Новгородской."},{precision:1,comment:null,fid:631,ruler:null,date_from:"01.01.1399",date_to:"13.01.1510",reason:"псковский князь получают статус московского наместника",description_short:"В 1399 г. великий князь московский Василий II добивается того, что отныне псковские князья приносят присягу не только своему городу, но и московскому престолу. С этого момента они стали называться московскими наместниками.",description_long:"В 1510 г. в результате похода московского великого князя Василия III самостоятельность Пскова была ликвидирована. Вече было распущено. Псковская земля вошла в состав Московского великого княжества."},{precision:0,comment:null,fid:632,ruler:null,date_from:"15.01.1478",date_to:"1/1/2018",reason:"присоединение Новгорода к Москве",description_short:"Присоединение Новгорода к Москве",description_long:"Московско-новгородская война (1477–1478) между Великим княжеством Московским и Новгородской республикой, имевшая место с 9 октября 1477 г. по 15 января 1478 г., завершилась падением Новгорода и присоединением его к Москве."},{precision:1,comment:null,fid:633,ruler:null,date_from:"01.01.1000",date_to:"15.01.1478",reason:null,description_short:null,description_long:null},{precision:1,comment:"независимое Новгородское государство",fid:634,ruler:null,date_from:"01.01.1136",date_to:"15.01.1478",reason:null,description_short:null,description_long:"В процессе разделения средневековой Руси на фактически самостоятельные земли новгородский «стол» был «общерусским»: в X–XI вв. его занимал, как правило, сын киевского князя. Но в XII в. произошло усиление новгородского боярства, и ни одной из княжеских ветвей рода Рюриковичей не удалось закрепиться в Новгороде. После изгнания в 1136 г. князя Всеволода Мстиславича (старшего внука Владимира Мономаха) в Новгородской земле сложилась республиканская форма правления, реальная власть принадлежала местному боярству, которое приглашало князей по своему усмотрению. В середине XIII в. Новгород стал признавать своим князем очередного великого князя владимирского. С конца XIII в. в Новгороде доминирует республиканская форма правления, а сюзеренитет великих князей владимирских становится номинальным. "},{precision:1,comment:'новгородский пригород Торжок; очень условная дата начала "сместного" порядка управления с владимиро-суздальскими князьями, 80-90-е гг. XII в.',fid:635,ruler:null,date_from:"01.01.1190",date_to:"15.01.1478",reason:null,description_short:"Новгородский пригород Торжок",description_long:"1190 г. очень условная дата начала «сместного» порядка управления с владимиро-суздальскими князьями. В 1478 г. Торжок, как и вся Новгородская земля, был присоединен войском князя Ивана III к Московскому княжеству."},{precision:1,comment:'новгородская волость Бежичи; очень условны даты - от примерного времени возникновения "сместного" управления с князьями Владимирскими до окончательного перехода Бежецкого Верха под контроль Москвы (условно - с началом княжения Василия Васильевича)',fid:636,ruler:null,date_from:"01.01.1240",date_to:"01.01.1425",reason:null,description_short:"Новгородская волость Бежичи",description_long:"1240–1425 гг. очень условные даты – от примерного времени возникновения «сместного» управления с князьями Владимирскими до окончательного перехода Бежецкого Верха под контроль Московского княжества. (условно – с началом княжения Василия Васильевича)."},{precision:1,comment:'очень условная нижняя дата - от примерного времени возникновения системы "сместного" управления с князьями Владимирскими, новгородское Заволочье',fid:637,ruler:null,date_from:"01.01.1240",date_to:"11.08.1471",reason:null,description_short:"Новгородская волость Заволочье",description_long:"1240 г. очень условная дата – от примерного времени возникновения системы «сместного» управления с князьями Владимирскими. В 1471 г. по Коростынскому миру к Московскому княжеству отошла большая часть Заволочья."},{precision:1,comment:'новгородская волость Вологда, очень условная дата - от примерного времени возникновения "сместного" управления с князьями Владимирскими',fid:638,ruler:null,date_from:"01.01.1240",date_to:"01.02.1456 ",reason:null,description_short:"Новгородская волость Вологда",description_long:"1240–1456 гг. очень условные даты – от примерного времени возникновения «сместного» управления с князьями Владимирскими до окончательного перехода Вологды под контроль Московского княжества по Яжелбицкому миру."},{precision:1,comment:"впервые зафиксирован совместной порядок управления Новгородом и Великим княжеством Владимирским в Волоке",fid:639,ruler:null,date_from:"01.01.1264",date_to:"01.01.1462",reason:"Договорная грамота Новгорода с тверским великим князем Ярославом Ярославичем",description_short:"В 1264 г. впервые зафиксирован совместный порядок управления Новгородом и Великим княжеством Владимирским в Волоке.",description_long:'<a href="https://history.wikireading.ru/300245" target="_blank">Договорная грамота Новгорода с тверским великим князем Ярославом Ярославичем</a><br />\n\n<a href="http://www.rusarchives.ru/projects/statehood/02-02-dogovornaya-gramota-novgorod-yaroslav.shtml" target="_blank">Договорная грамота Новгорода с тверским великим князем Ярославом Ярославичем. Оригинал.</a><br />\n\n<a href="http://rgada.info/kueh/index2.php?str=135_I-3_2&name=%D0%94%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D0%BD%D0%B0%D1%8F%20(%D0%B4%D0%BE%D0%BA%D0%BE%D0%BD%D1%87%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F)%20%D0%B3%D1%80%D0%B0%D0%BC%D0%BE%D1%82%D0%B0%20%D0%9D%D0%BE%D0%B2%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D0%B0%20%D0%92%D0%B5%D0%BB%D0%B8%D0%BA%D0%BE%D0%B3%D0%BE%20%D1%81%20%D0%B2%D0%B5%D0%BB%D0%B8%D0%BA%D0%B8%D0%BC%20%D0%BA%D0%BD%D1%8F%D0%B7%D0%B5%D0%BC%20%D0%B2%D0%BB%D0%B0%D0%B4%D0%B8%D0%BC%D0%B8%D1%80%D1%81%D0%BA%D0%B8%D0%BC%20%D0%B8%20%D1%82%D0%B2%D0%B5%D1%80%D1%81%D0%BA%D0%B8%D0%BC%20%D0%AF%D1%80%D0%BE%D1%81%D0%BB%D0%B0%D0%B2%D0%BE%D0%BC%20%D0%AF%D1%80%D0%BE%D1%81%D0%BB%D0%B0%D0%B2%D0%B8%D1%87%D0%B5%D0%BC%20(%D0%BF%D0%B5%D1%80%D0%B2%D0%B0%D1%8F)." target="_blank">Договорная грамота Новгорода с тверским великим князем Ярославом Ярославичем. Оригинал в РГАДА.</a><br />\n'},{precision:1,comment:"новгородская волость Печера, примерная дата, к которой относится летописный рассказ Гюряты Роговича о сборе дани на Печере",fid:640,ruler:null,date_from:"01.01.1114",date_to:"15.01.1478",reason:null,description_short:"Новгородская волость Печера",description_long:"1114 г. – примерная дата, к которой относится летописный рассказ Гюряты Роговича о сборе дани на Печере. В 1478 г. Печера, как и вся Новгородская земля, была присоединена войском князя Ивана III к Московскому княжеству."},{precision:1,comment:"образование Тверского княжества",fid:641,ruler:null,date_from:"01.01.1247",date_to:"12.09.1485",reason:null,description_short:"В 1247 г. образовано Тверское княжество. В 1485 г. территория Тверского княжества входит в состав Московского великого княжества. ",description_long:"Тверское княжество выделилось в 1247 г. по смерти великого князя Ярослава Всеволодовича. С 1383 г. оно стало именоваться великим княжеством. В 1485 г. Великое княжество Тверское было присоединено к Московскому великому княжеству в результате объединительной политики Ивана III, стремившегося подчинить своей власти всю Русь. Поводом для подчинения Твери Москве стали сношения тверского князя с польским королем Казимиром IV, запрещенные согласно московско-тверскому договору."},{precision:1,comment:"Ржевская земля принадлежит Московскому княжеству",fid:642,ruler:null,date_from:"01.01.1449",date_to:"15.01.1478",reason:null,description_short:"Ржевская земля принадлежит Московскому великому княжеству.",description_long:null},{precision:1,comment:null,fid:643,ruler:null,date_from:"01.01.1455",date_to:null,reason:"передача Воротынским князьям Людимска и округи из Серпуховско-Боровского удела",description_short:"Передача Воротынским князьям г. Людимска и округи из Серпуховско-Боровского удела",description_long:null},{precision:1,comment:null,fid:644,ruler:null,date_from:"01.01.1146",date_to:null,reason:"к концу правления вел.кн. Василия II часть земель Великого княжества Рязанского перешла к Москве",description_short:"К концу правления великого князя Василия II часть земель Великого княжества Рязанского перешла к Московскому княжеству.",description_long:"Рязанская земля возникла во второй половине XII в. в результате разделения Муромской земли (которая, в свою очередь, ранее обособилась от Черниговской). В 1127 г. Ярослав Святославич (внук Ярослава Мудрого), изгнанный племянником Всеволодом Ольговичем из Чернигова, вокняжился в Муроме. В 1140-е гг. во владениях его потомков появился второй «стол» – в Рязани. В третьей четверти XII в. потомки Ярослава делятся на рязанскую и муромскую ветви; это определило формирование Рязанской и Муромской земель. В Рязани стали княжить потомки Ростислава Ярославича. Во второй половине XIII в. столица княжества переместилась из разоренной татаро-монголами Старой Рязани выше по Оке в Переяславль-Рязанский (ныне г. Рязань). Некоторые рязанские князья носили титул «великий». Но в конце XIV – начале XV в. признавали великих князей московских «старейшими братьями». В 1521 г. великий князь всея Руси Василий III присоединил Рязанскую землю к своим владениям. Последний рязанский князь Иван Иванович бежал в Литву. "},{precision:1,comment:null,fid:645,ruler:null,date_from:"01.01.1140",date_to:"01.01.1521",reason:"Рязанская земля",description_short:"Рязанская земля",description_long:"Рязанская земля возникла во второй половине XII в. в результате разделения Муромской земли (которая, в свою очередь, ранее обособилась от Черниговской). В 1127 г. Ярослав Святославич (внук Ярослава Мудрого), изгнанный племянником Всеволодом Ольговичем из Чернигова, вокняжился в Муроме. В 1140-е гг. во владениях его потомков появился второй «стол» – в Рязани. В третьей четверти XII в. потомки Ярослава делятся на рязанскую и муромскую ветви; это определило формирование Рязанской и Муромской земель. В Рязани стали княжить потомки Ростислава Ярославича. Во второй половине XIII в. столица княжества переместилась из разоренной татаро-монголами Старой Рязани выше по Оке в Переяславль-Рязанский (ныне г. Рязань). Некоторые рязанские князья носили титул «великий». Но в конце XIV – начале XV в. признавали великих князей московских «старейшими братьями». В 1521 г. великий князь всея Руси Василий III присоединил Рязанскую землю к своим владениям. Последний рязанский князь Иван Иванович бежал в Литву. "},{precision:1,comment:"до вхождения в состав ВКЛ (по А.А. Горскому)",fid:646,ruler:null,date_from:"01.01.1246",date_to:"01.01.1442",reason:"образование Глуховско-Новосильского княжества",description_short:"Из Черниговской земли в 1246 г. выделилось Новосильское княжество. В 1442 г. Новосильское княжество вошло в состав Великого княжества Литовского.",description_long:"Новосильское княжество выделилось из Черниговской земли после гибели в 1246 г. Михаила Всеволодовича. В конце XIV в. столицей вместо Новосиля стал Одоев. В середине XV в. новосильско-одоевские князья стали вассалами великого князя литовского. В конце XV столетия их владения вошли в состав Московского государства."},{precision:1,comment:null,fid:647,ruler:null,date_from:"01.01.1370",date_to:"01.01.1415",reason:"разделение княжества Тита Козельского",description_short:"Разделение Козельского княжества",description_long:"Козельское княжество выделилось из Карачевского княжества к XIV столетию. Около 1400 г. оно вошло в состав Московского великого княжества, затем на какое-то время захватывалось Литвой. Затем (не позже начала 1430-х гг.) вновь вернулось под московскую власть, в 1448 г. опять оказалось в составе Великого княжества Литовского. Вернулось к великим князьям московским в конце XV в."},{precision:1,comment:null,fid:648,ruler:null,date_from:"01.01.1341",date_to:"01.01.1392",reason:"Нижегородско-Суздальское княжество",description_short:"Нижегородско-Суздальское княжество возникло при объединении Суздальского и Нижегородских княжеств в 1341 г. В 1392 г. вошло в состав Московского великого княжества.",description_long:"Суздальское княжество выделилось в 1250-е гг., когда его получил вернувшийся из изгнания князь Андрей Ярославич. В 1341 г. оно было объединено с восстановленным ханом Узбеком Нижегородским княжеством. В 1392 г. княжество отошло к московскому и великому владимирскому князю Василию Дмитриевичу по ярлыку хана Тохтамыша."},{precision:1,comment:"зона русской колонизации в Заволжье",fid:649,ruler:null,date_from:"01.01.1212",date_to:"01.01.1383",reason:null,description_short:"Зона русской колонизации в Заволжье",description_long:null},{precision:"Н",comment:"новгородская волость Пермь; очень условная нижняя дата - от примерного времени возникновения сместного управления",fid:776,ruler:null,date_from:"01.01.1240",date_to:"15.01.1478",reason:null,description_short:"Новгородская волость Пермь",description_long:"1240 г. – примерная дата возникновения «сместного» управления с князьями Владимирскими. В 1478 г. Пермь, как и вся Новгородская земля, была присоединена войском князя Ивана III к Московскому княжеству."},{precision:1,comment:"земли мещеры в орбите влияния русских княжеств",fid:777,ruler:null,date_from:"01.01.1381",date_to:"01.01.1392",reason:"ранее 1381 г. кн. Дмитрий Иванович приобрел часть мещерских земель у местных князей",description_short:"Мещерская земля во владении князя Дмитрия Ивановича.",description_long:"Впервые как московское владение Мещера упоминается в договоре Дмитрия Донского с Олегом Ивановичем Рязанским лета 1381 г.: «А что купля князя великого Мещера, как было при Александре Уковичѣ, то князю великому Дмитрию, а князю великому Олгу не вступатися по тот розъездъ».\nТаким образом, ранее лета 1381 г. Дмитрий Иванович «купил», очевидно у местных князей, Мещеру или ее часть.\nЛетом 1392 г. Василий отправился в Орду к Тохтамышу (который после поражения, понесенного годом ранее от Тимура, нуждался в средствах) и получил от него «Новгородчкое княжение Нижнего Новагорода, Муромъ, Мещеру, Торусоу». Таким образом, под власть Москвы отходила Мещера, которой владел уже Дмитрий Донской, но как «куплей» (видимо, у местных князей), без ярлыка. Этот ярлык на Мещеру 1392 г. не предоставлял Василию I права наследственного владения, он требовал подтверждения при каждой смене великого князя.\n"},{precision:1,comment:null,fid:779,ruler:null,date_from:"01.01.1415",date_to:"01.01.1483",reason:"разгром татарами Елецкого княжества, зависимость территории от Рязанского великого княжества",description_short:"Разгром татарами Елецкого княжества привел к зависимости территории от Рязанской земли.",description_long:"В результате московско-рязанского договора 1483 г. Земли Елецкого княжества были переданы московскому великому князю Ивану Васильевичу III."},{precision:1,comment:null,fid:780,ruler:null,date_from:"01.01.1403",date_to:null,reason:"захват Литвой Вяземского княжества",description_short:"Захват Литвой Вяземского княжества",description_long:"Вяземское княжество возникло в 1239 г. и досталось Андрею Владимировичу Долгой Руке – сыну Великого князя киевского Владимира Рюриковича. Потомки Андрея Владимировича правили Вязьмой вплоть до 1403 г., когда город был присоединен к Великому княжеству Литовскому. В 1493 г. Вязьма была присоединена к Великому княжеству Московскому."},{precision:1,comment:"условно показано продвижение зоны славянской колонизации на восток",fid:781,ruler:null,date_from:"01.01.1383",date_to:"01.01.1392",reason:"зона славянской колонизации - где?? Объяснение дат?",description_short:"Зона славянской колонизации",description_long:null},{precision:1,comment:null,fid:782,ruler:null,date_from:"01.01.1300",date_to:"01.01.1403",reason:"образование Козельского княжества",description_short:"Образование Козельского княжества",description_long:"Козельское княжество выделилось из Карачевского княжества к XIV столетию. Около 1400 г. оно вошло в состав Московского великого княжества, затем на какое-то время захватывалось Литвой. Затем (не позже начала 1430-х гг.) вновь вернулось под московскую власть, в 1448 г. опять оказалось в составе Великого княжества Литовского. Вернулось к великим князьям московским в конце XV в."},{precision:1,comment:null,fid:783,ruler:null,date_from:"01.01.1448",date_to:null,reason:"переход земель Козельского княжества к ВКЛ",description_short:"Переход земель Козельского княжества к Великому княжеству Литовскому",description_long:"Козельское княжество выделилось из Карачевского княжества к XIV столетию. Около 1400 г. оно вошло в состав Московского великого княжества, затем на какое-то время захватывалось Литвой. Затем (не позже начала 1430-х гг.) вновь вернулось под московскую власть, в 1448 г. опять оказалось в составе Великого княжества Литовского. Вернулось к великим князьям московским в конце XV в."},{precision:1,comment:null,fid:784,ruler:null,date_from:"01.01.1386",date_to:null,reason:"Медынь перешла от Смоленского княжества к Московскому",description_short:"Медынь перешла от Смоленского княжества к Московскому",description_long:'<a href="http://rgada.info/kueh/index2.php?str=1209_77_19028&name=%D0%A7%D0%B5%D1%80%D1%82%D0%B5%D0%B6%20%D0%B7%D0%B5%D0%BC%D0%B5%D0%BB%D1%8C%20%20%D0%B2%20%D0%BE%D0%BA%D1%80%D0%B5%D1%81%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8F%D1%85%20%D0%9C%D0%B5%D0%B4%D1%8B%D0%BD%D1%81%D0%BA%D0%BE%D0%B3%D0%BE%20%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D0%B8%D1%89%D0%B0.%20%D0%9F%D0%BE%D0%B4%D0%BB%D0%B8%D0%BD%D0%BD%D0%B8%D0%BA." target="_blank">Чертеж земель в окрестностях Медынского городища. Подлинник.</a><br />\nРГАДА\nФ. 1209. Оп. 77. Ед. хр. 19028\nДатировка: XVII в. Аннотация: Документ зафиксировал исторический ландшафт и коммуникации в окрестностях Медынского городища, существовавшие в эпоху позднего Средневековья. Помимо упомянутого городища на чертеже особо отмечены: Благовещенский монастырь, пустоши Саларево, Ивачево, Цвиленево, Челюсткино, Коркодиново, Огашино и Черневка, речки Медынка, Гомышовка и Каменка, межевые грани земельных угодий. Историческая справка: выполненный в красках чертеж окрестностей Медынского городища был создан в Поместном приказе во второй половине XVII в. в ходе разбирательства одного из дел, которое к настоящему времени не сохранилось.'},{precision:1,comment:null,fid:785,ruler:null,date_from:"01.01.1246",date_to:"01.01.1392",reason:"Тарусское княжество",description_short:"В 1246 г. образовалось Тарусское княжество. В 1392 г. Тарусское княжество включено в состав Московского великого княжества.",description_long:"Тарусское княжество выделилось после гибели в 1246 г. Михаила Всеволодовича. В 1392 г., по договоренности с местными князьями, оно было включено в состав Московского великого княжества."},{precision:1,comment:null,fid:786,ruler:null,date_from:"01.01.1371",date_to:null,reason:"включение Алексина в Московское княжество",description_short:"Включение г. Алексина в Московское княжество",description_long:null},{precision:1,comment:"очень условно полузависимое от Москвы состояние Оболенского княжества приурочено к переходу к Москве соседней Тарусы",fid:787,ruler:null,date_from:"01.01.1392",date_to:"01.01.1494",reason:null,description_short:"Оболенское княжество с 1392 г. включено в состав Московского великого княжества. В начале XVI в. оказалось в составе Российского государства.",description_long:"Во второй половине XIII в. в северо-восточной части Черниговской земли происходит выделение нескольких княжеств, которые закрепляются за потомками Михаила Черниговского. Это Новосильское, Карачевское и Тарусско-Оболенское княжества.\nВ XIV в. внутри этих княжеств намечается дальнейшее дробление: в Карачевском выделяется Козельский удел, в Новосильском — Белевский, Тарусско-Оболенское делится на Тарусское и Оболенское.\nВ начале XVI в., после московско-литовских войн, практически вся территория, входившая некогда в Черниговскую землю, оказалась в составе Российского государства.\n"},{precision:1,comment:null,fid:788,ruler:null,date_from:"01.01.1368",date_to:null,reason:"калужские земли присоединены к Московскому княжеству",description_short:"В 1368 г. калужские земли присоединены к Московскому княжеству.",description_long:null},{precision:1,comment:null,fid:789,ruler:null,date_from:"01.01.1353",date_to:null,reason:"переход Вереи и Боровска в Московское княжество",description_short:"Переход г. Вереи и г. Боровска в Московское княжество",description_long:null},{precision:1,comment:null,fid:790,ruler:null,date_from:"01.01.1446",date_to:null,reason:"переход Конинского удельного княжества к Москве",description_short:"В 1446 г. переход Конинского удельного княжества к Московскому великому княжеству.",description_long:null},{precision:1,comment:null,fid:791,ruler:null,date_from:"01.01.1238",date_to:"01.01.1330",reason:"выделение Белозерского княжества из Ростовского",description_short:"В 1238 г. образовалось Белозерское княжество. В 1330-е территория Белозерского княжества вошла в состав Великого княжества Владимирского.",description_long:"Белозерское княжество выделилось после гибели ростовского князя Василька Константиновича. В 1238 г. началось княжение Глеба Васильковича (ранее Белоозеро входило во владения его отца ростовского князя Василька Константиновича). В 1330-е стало «куплей» Ивана Калиты."},{precision:1,comment:null,fid:792,ruler:null,date_from:"01.01.1280",date_to:"01.01.1363",reason:"Галичское княжество до включения его в великое княжество Владимирское",description_short:"Около 1280 г. Галицко-Дмитровское княжество было разделено на два княжества – Галицкое и Дмитровское. В 1363 г. территория Галицкого княжества вошла в состав Владимирского великого княжества.",description_long:"Галицко-Дмитровское княжество выделилось в 1247 г. по смерти великого князя Ярослава Всеволодовича. Около 1280 г. два сына Давыда Константиновича стали править разными частями его владений; их отдаленность друг от друга способствовала обособлению Галицкого и Дмитровского княжеств. Галицкое княжество в 1363 г.вошло в состав Владимирского великого княжества как «купля» Ивана Калиты."},{precision:1,comment:null,fid:793,ruler:null,date_from:"01.01.1280",date_to:"01.01.1336",reason:"Дмитровское княжество",description_short:"Около 1280 г. Галицко-Дмитровское княжество было разделено на два княжества – Галицкое и Дмитровское. В 1336 г. территория Дмитровского княжества вошла в состав Владимирского великого княжества.",description_long:"Галицко-Дмитровское княжество выделилось в 1247 г. по смерти великого князя Ярослава Всеволодовича. Около 1300 г. два сына Давыда Константиновича стали править разными частями его владений; их отдаленность друг от друга способствовала обособлению Галицкого и Дмитровского княжеств. Дмитровское княжество вошло в состав Владимирского великого княжества в 1336 г. – по ханскому ярлыку."},{precision:1,comment:null,fid:794,ruler:null,date_from:"01.01.1212",date_to:"01.01.1347",reason:"Юрьевское княжество",description_short:"В 1212 г. образовалось Юрьевское княжество. В 1347 г. Юрьевское княжество вошло в состав Великого княжества Владимирского.",description_long:"Юрьевское княжество было выделено в 1212 г. из Суздальской земли по завещанию Всеволода Юрьевича. В 1347 г. Юрьевское княжество включено во Владимирское великое княжество по смерти последнего князя из местной династии."},{precision:1,comment:null,fid:795,ruler:null,date_from:"01.01.1218",date_to:"01.01.1330",reason:"Угличское княжество",description_short:"В 1218 г. образовалось Угличское княжество. В 1330-е годы территория Углицкого княжества вошла в состав Великого княжества Владимирского. ",description_long:"В 1218 г. образовались Угличское, Ростовское и Ярославское княжества. По смерти Константина Всеволодовича там стали княжить три его сына: Василько (Ростов), Всеволод (Ярославль), Владимир (Углич). Углицкое княжество образовано после смерти Константина Всеволодовича. В 1330-е гг. оно стало «куплей» великого князя владимирского Ивана Даниловича Калиты."},{precision:1,comment:null,fid:796,ruler:null,date_from:"01.01.1218",date_to:"01.01.1363",reason:"Ростовское княжество",description_short:"В 1218 г. образовалось Ростовское княжество. В 1363 г. территория Ростовского княжества вошла в состав Великого княжества Владимирского. ",description_long:"В 1218 г. образовались Угличское, Ростовское и Ярославское княжества. По смерти Константина Всеволодовича там стали княжить три его сына: Василько (Ростов), Всеволод (Ярославль), Владимир (Углич). В 1328 г. половина княжества отошла к великому князю владимирскому. В 1363 г. перешла под его верховную власть по ханскому ярлыку вторая половина (по другому мнению, это случилось позже, но не позднее первой трети XV в.). В 1474 г. ростовские князья продали великому князю московскому остатки своих владельческих прав."},{precision:1,comment:null,fid:797,ruler:null,date_from:"01.01.1218",date_to:"01.01.1463",reason:"Ярославское княжество",description_short:"В 1218 г. образовалось Ярославское княжество. В 1463 г. территория Ярославского княжества вошла в состав Великого княжества Московского. ",description_long:"В 1218 г. образовались Угличское, Ростовское и Ярославское княжества. По смерти Константина Всеволодовича там стали княжить три его сына: Василько (Ростов), Всеволод (Ярославль), Владимир (Углич). В 1463 г. оно было присоединено к Московскому великому княжеству по соглашению с местными князьями."},{precision:1,comment:null,fid:798,ruler:null,date_from:"01.01.1257",date_to:"01.01.1341",reason:"Суздальское княжество",description_short:"В 1250-е гг. образовалось Суздальское княжество. \nВ 1341 г. объединено с Нижегородским княжеством в Нижегородско-Суздальское княжество.\n",description_long:"Суздальское княжество выделилось в 1250-е гг., когда его получил вернувшийся из изгнания Андрей Ярославич. В 1341 г. оно было объединено с восстановленным ханом Узбеком Нижегородским княжеством. В 1392 г. княжество отошло к московскому и великому владимирскому князю Василию Дмитриевичу по ярлыку хана Тохтамыша."},{precision:1,comment:null,fid:799,ruler:null,date_from:"01.01.1263",date_to:"01.01.1320",reason:"Городецкое княжество",description_short:"В 1263 г. образовалось Городецкое княжество. В 1320 г. территория Городецкого княжества вошла в состав Владимирского великого княжества.",description_long:"В 1263 г. Городецкое княжество было выделено по завещанию Александра Ярославича Невского. В начале XIV в. столицей стал Нижний Новгород. В 1310 г. оно отошло к московским князьям, в 1320 г. вошло во Владимирское великое княжество."},{precision:1,comment:null,fid:800,ruler:null,date_from:"01.01.1218",date_to:"01.01.1447",reason:"Ярославское княжество (Кубенско-Заозерский удел)",description_short:null,description_long:null},{precision:1,comment:null,fid:801,ruler:null,date_from:"01.01.1127",date_to:"01.01.1392",reason:"Муромское княжество",description_short:"Муромская земля обособилась от Черниговской земли в 1127 г. В 1392 г. Муромское княжество вошло в состав Московского великого княжества.",description_long:"Муромская земля обособилась от Черниговской земли в 1127 г. Ранее (со времен Любецкого съезда князей 1097 г.) она составляла с Черниговской землей одно целое в качестве владения потомков Святослава Ярославича. В 1127 г. Ярослав Святославич (внук Ярослава Мудрого), изгнанный племянником Всеволодом Ольговичем из Чернигова, вокняжился в Муроме. В третьей четверти XII в. его потомки делятся на рязанскую и муромскую ветви; это определило формирование Рязанской и Муромской земель. В Муроме стали княжить потомки Святослава Ярославича. В первой трети XIII в. Муромское княжество, по-видимому, находилось в некоторой зависимости от Владимиро-Суздальского, и муромские князья участвовали в походах суздальских князей. Сведений о Муромском княжестве за вторую половину XIII – XIV вв. крайне мало. В 1392 г. великий князь московский Василий I Дмитриевич получил в Орде ярлык на Муром и присоединил Муромскую землю к своим владениям."},{precision:1,comment:null,fid:802,ruler:null,date_from:"01.01.1385",date_to:"01.01.1386",reason:"Коломенские волости Рязанское княжесто захватило у Московского",description_short:"Присоединенная в 1300–1305 гг. к Московскому княжеству Коломна была захвачена в 1385 г. Рязанским княжеством. ",description_long:null},{precision:1,comment:null,fid:803,ruler:null,date_from:"01.01.1212",date_to:"01.01.1383",reason:"Владимирское княжество",description_short:"В 1212 г. образовалось Великое княжество Владимирское.\nВ 1383 г. территория Великого княжества Владимирского включена в состав Великого княжества Московского.\n",description_long:"1212 г. – деление Всеволодом Юрьевичем Суздальской земли между своими сыновьями. Выделенные княжества должны были подчиняться владимирскому великому князю.\nВ 1383 г. произошло закрепление Великого княжества Владимирского (которое ранее ханы могли давать князьям разных княжеств Северо-Восточной Руси) за московскими князьями. Дмитрий Донской боролся за это с 1362 г., но только в 1383 г. принадлежность великого княжения московскому дому признал хан Орды.\n"},{precision:1,comment:null,fid:805,ruler:null,date_from:"01.01.1303",date_to:"01.01.1303",reason:"переход Можайска к Москве",description_short:"В 1303 г. Можайское княжество было захвачено московским князем Юрием Даниловичем и присоединено к Московскому княжеству.",description_long:null},{precision:1,comment:null,fid:806,ruler:null,date_from:"01.01.1368",date_to:"01.01.1372",reason:"переход Ржевы к Москве",description_short:"Переход Ржевы к Москве",description_long:null},{precision:1,comment:null,fid:807,ruler:null,date_from:"01.01.1382",date_to:"01.01.1446",reason:"переход Ржевы к Москве",description_short:"Ржева закрепилась за Московским княжеством, став частью удела серпуховского князя Владимира Андреевича Храброго.",description_long:null},{precision:1,comment:null,fid:809,ruler:null,date_from:"01.01.1132",date_to:"01.01.1404",reason:"Смоленская земля",description_short:"В 1132 г., после смерти Мстислава Великого, Смоленская земля становится самостоятельной. В 1404 г. великий литовский князь Витовт взял Смоленск и присоединил его к Литве.",description_long:"В процессе разделения средневековой Руси на фактически самостоятельные земли Смоленская земля стала независимой от Киева при внуке Владимира Мономаха князе Ростиславе Мстиславиче (вокняжился в Смоленске в 20-х гг. XII в., умер в 1167 г.) и закрепилась за его потомками Ростиславичами. В домонгольскую эпоху она была одной из сильнейших среди русских земель. К середине XIII в. произошло ослабление Смоленской земли, а в XIV в. смоленские князья признавали политическое верховенство то великих князей владимирских, то великих князей литовских. В 1395 г. великий литовский князь Витовт взял Смоленск штурмом и посадил в нем своих наместников. В 1401 г. смоленским князьям удалось вернуть власть, но ненадолго. В 1514 г., после русско-литовской войны, Смоленск вошел в состав Российского государства."},{precision:1,comment:null,fid:810,ruler:null,date_from:"01.01.1300",date_to:null,reason:null,description_short:"«Лопастенские места» от Рязани перешли к Москве.",description_long:null},{precision:1,comment:null,fid:811,ruler:null,date_from:"01.01.1247",date_to:"01.01.1276",reason:"Костромское княжество",description_short:"В 1247 г. образовалось Костромское княжество. В 1276 г. территория Костромского княжества вошла в состав Владимирского великого княжества.",description_long:"В 1247 г. Костромское княжество выделилось из Суздальской земли по смерти великого князя Ярослава Всеволодовича. В 1276 г., после смерти великого князя Василия Ярославича (он же – князь костромской), вошло в состав Владимирского великого княжества."},{precision:1,comment:"зона русской колонизации",fid:812,ruler:null,date_from:"01.01.1280",date_to:"01.01.1363",reason:"зона русской колонизации",description_short:"Зона русской колонизации.",description_long:null},{precision:1,comment:null,fid:814,ruler:null,date_from:"01.01.1246",date_to:"01.01.1360",reason:"Карачевское княжество",description_short:"В 1246 г. образовалось Карачевское княжество. В 1360-е гг. было захвачено Литвой. ",description_long:"Карачевское княжество выделилось из Черниговской земли после гибели в 1246 г. Михаила Всеволодовича. В 1360-е гг. было захвачено Литвой. По итогам русско-литовской войны 1500–1503 гг. Карачев вошел в состав Московского государства."},{precision:1,comment:null,fid:815,ruler:null,date_from:"01.01.1218",date_to:"01.01.1363",reason:"Ростовское княжество",description_short:"В 1218 г. образовалось Ростовское княжество. В 1363 г. территория Ростовского княжества вошла в состав Великого княжества Владимирского. ",description_long:"Ростовское княжество выделилось из Суздальской земли в 1218 г. по смерти Константина Всеволодовича. В 1328 г. половина княжества отошла к великому князю владимирскому. В 1363 г. перешла под его верховную власть по ханскому ярлыку вторая половина (по другому мнению, это случилось позже, но не позднее первой трети XV в.). В 1474 г. ростовские князья продали великому князю московскому остатки своих владельческих прав."},{precision:1,comment:null,fid:816,ruler:null,date_from:"01.01.1341",date_to:"01.01.1363",reason:"присоединение к Москве земель Ростовского княжества",description_short:"С присоединением к Московскому княжеству ростовских земель его костромские и белозерские владения слились с основной территорией княжества.",description_long:null},{precision:1,comment:null,fid:817,ruler:null,date_from:"01.01.1330",date_to:"01.01.1383",reason:"Владимирское княжество",description_short:"Великое княжество Владимирское образовалось из Суздальского княжества в 1212 г. В 1383 г. территория Великого княжества Владимирского включена в состав Великого княжества Московского.",description_long:"В результате деления в 1212 г. Всеволодом Юрьевичем Суздальской земли между своими сыновьями образовалось Владимирское княжество. Выделенные княжества должны были подчиняться владимирскому великому князю. В 1383 г. произошло закрепление Великого княжества Владимирского (которое ранее ханы могли давать князьям разных княжеств Северо-Восточной Руси) за московскими князьями. Дмитрий Донской боролся за это с 1362 г., но только в 1383 г. принадлежность великого княжения московскому дому признал хан Орды."},{precision:1,comment:null,fid:818,ruler:null,date_from:"01.01.1277\n",date_to:"01.01.1320",reason:"Владимирское княжество",description_short:"В 1227 г. Костромское княжество вошло в состав Владимирского княжества.",description_long:"В результате деления в 1212 г. Всеволодом Юрьевичем Суздальской земли между своими сыновьями образовалось Владимирское княжество. Выделенные княжества должны были подчиняться владимирскому великому князю. В 1383 г. произошло закрепление Великого княжества Владимирского (которое ранее ханы могли давать князьям разных княжеств Северо-Восточной Руси) за московскими князьями. Дмитрий Донской боролся за это с 1362 г., но только в 1383 г. принадлежность великого княжения московскому дому признал хан Орды."},{precision:1,comment:null,fid:819,ruler:null,date_from:"01.01.1403",date_to:"01.01.1448",reason:"переход Козельска под юрисдикцию Москвы",description_short:"В 1448 г. Козельское княжество вновь вернулось в состав Московского великого княжества.",description_long:"Козельское княжество выделилось из Карачевского к XIV столетию. Около 1400 г. оно вошло в состав Московского великого княжества, затем на какое-то время захватывалось Литвой. Затем (не позже начала 1430-х гг.) вновь вернулось под московскую власть, в 1448 г. опять оказалось в составе Великого княжества Литовского. Вернулось к великим князьям московским в конце XV в."},{precision:1,comment:null,fid:820,ruler:null,date_from:"01.01.1246",date_to:"01.01.1353",reason:"переход земель от Черниговского княжества к Рязанскому",description_short:"В 1353 г. меньшая часть земель Черниговского княжества перешла к Рязанскому. ",description_long:"В 1360-е гг. большая часть Черниговской земли (кроме верхнеокских, т.н. верховских, княжеств) вошла в состав Великого княжества Литовского. "},{precision:1,comment:null,fid:821,ruler:null,date_from:"01.01.1302",date_to:"01.01.1303",reason:"переход Переяславского княжества к Москве",description_short:"Переход Переяславского княжества к Московскому княжеству",description_long:null},{precision:1,comment:null,fid:822,ruler:null,date_from:"01.01.1305",date_to:null,reason:"возврат земель Переяславского княжества в состав Владимирского княжества",description_short:"Возврат земель Переяславского княжества в состав Владимирского княжества",description_long:null},{precision:0,comment:null,fid:823,ruler:null,date_from:"25.06.1807",date_to:null,reason:"по Тильзитскому миру Белосток передан из состава Пруссии России",description_short:"По Тильзитскому миру Белосток передан Наполеоном Российской империи, в составе которой был главным городом Белостокской области. ",description_long:'<a href="https://www.runivers.ru/newenc/474766/" target="_blank">Тильзитский мирный договор (25 июня / 8 июля 1807 г.)</a><br />'},{precision:0,comment:null,fid:824,ruler:null,date_from:"16.05.1703",date_to:"30.08.1721",reason:"основание Санкт-Петербурга",description_short:"В 1703 г. был основан Санкт-Петербург. Юридически земли, на которых располагался город, отошли России по Ништадскому миру, заключенному в 1721 г.",description_long:'Ништадский мирный договор (30 августа (10 сентября) 1721)\nНиштадский мирный договор – договор между Россией и Швецией, завершивший Северную войну 1700–1721 гг. Был заключен в городе Ништадт (ныне Уусикаупунки, Финляндия) 30 августа (10 сентября 1721 г.). Со стороны России договор был подписан Я. В. Брюсом и А. И. Остерманом, со стороны Швеции – Ю. Лилльенстедтом и О. Стрёмфельдом.\nДо подписания этого договора граница между Россией и Швецией определялась Столбовским мирным договором 1617 г. Ништадским миром за Россией были закреплены обширные территории, ранее принадлежавшие Швеции: часть Карелии с Кексгольмом к северу от Ладожского озера, Ингерманладия (Ижорская земля), часть Эстляндии с Ревелем и Нарвой, часть Лифляндии с Ригой, острова Эзель и Даго. Россия за приобретенные земли должна была выплатить Швеции денежную компенсацию в размере около полутора млн рублей, а также вернуть бóльшую часть занятой русскими войсками Финляндии. Восстанавливались торговые отношения между двумя странами: Швеции получала право ежегодно вывозить из России на 50 000 руб. хлеба без уплаты пошлин. Договор предусматривал обмен пленными и амнистию преступникам и перебежчикам, кроме казаков И. Мазепы. Дворянство перешедших к России территорий сохраняло свои привилегии, самоуправление и вероисповедание.\nТаким образом, Россия закрепила выход в Балтийское море. В ознаменование заключения Ништадского мира 22 октября (2 ноября) 1721 г. Петр I по прошению Сената принял титул Отца Отечества, Императора Всероссийского, а также Петра Великого.\n\n<a href="http://www.runivers.ru/bookreader/book9814/#page/422/mode/1up" target="_blank">Текст Ништадского мирного договора</a><br />\n\n<a href="http://raritety.rusarchives.ru/dokumenty/relyaciya-o-zaklyuchenii-mira-so-shveciey-s-opisaniem-torzhestva-podneseniya-i-prinyatiya-gosudarem" target="_blank">Реляция о заключении мира со Швецией с описанием торжества поднесения и принятия государем титула «Отца Отечества, Императора Всероссийского Петра Великого»</a><br />\n\n<a href="http://www.runivers.ru/mp/maps-detail.php?ID=466744&SECTION_ID=" target="_blank">Территориальные изменения по Ништадскому мирному договору 30 августа 1721 г.</a><br />\n'},{precision:1,comment:null,fid:825,ruler:null,date_from:"01.01.1806",date_to:"12.10.1813",reason:"присоединение Кубинского ханства к РИ",description_short:"Кубинское ханство вошло в состав Российской империи. ",description_long:"В 1806 г. Кубинское ханство вошло в состав Российской империи. По Гюлистанскому мирному договору 1813 г. Персия признала переход Кубинского ханства под власть Российской империи."},{precision:1,comment:null,fid:826,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:1,comment:null,fid:827,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:828,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:829,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:830,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:831,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:832,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:833,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:834,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:835,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:836,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:837,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:838,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:839,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:840,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:841,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:842,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:843,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:844,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:845,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:846,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:847,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:848,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:849,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:850,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:851,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:852,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:853,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:854,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:855,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:856,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:857,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:858,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:859,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:860,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:1,comment:null,fid:861,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:862,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:863,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:864,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:865,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:866,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:867,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:868,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:869,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:870,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:871,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:872,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:873,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:874,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:875,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:876,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:877,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:878,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:879,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:880,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:881,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:882,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:883,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно соглашению «О создании Содружества Независимых Государств», подписанному Республикой Беларусь, Российской Федерацией и Украиной как государствами – учредителями Союза ССР, подписавшими договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'},{precision:0,comment:null,fid:1841,ruler:null,date_from:"12/8/1991",date_to:null,reason:"Беловежские соглашения",description_short:"Согласно «Соглашению о создании Содружества Независимых Государств», подписанного Республикой Беларусь, Российской Федерацией и Украиной как государствами, учредителями Союза ССР, подписавшими Договор об образовании СССР в 1922 г., констатировалось прекращение существования Союза ССР как «субъекта международного права и геополитической реальности» и заявлялось о создании Содружества Независимых Государств (СНГ).",description_long:'<a href="http://www.rusarchives.ru/projects/statehood/10-12-soglashenie-sng.shtml" target="_blank">Соглашение о создании СНГ</a><br />'}]},function(t,e,r){r(125),t.exports=r(303)},function(t,e,r){"use strict";(function(t){r(126),r(270),r(272),r(274),r(276),r(278),r(280),r(282),r(284),r(286),r(290),t._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),t._babelPolyfill=!0}).call(this,r(48))},function(t,e,r){r(127),r(129),r(130),r(131),r(132),r(133),r(134),r(135),r(136),r(137),r(138),r(139),r(140),r(141),r(142),r(143),r(145),r(146),r(147),r(148),r(149),r(150),r(151),r(152),r(153),r(154),r(155),r(156),r(157),r(158),r(159),r(160),r(161),r(162),r(163),r(164),r(165),r(166),r(167),r(168),r(169),r(170),r(171),r(173),r(174),r(175),r(176),r(177),r(178),r(179),r(180),r(181),r(182),r(183),r(184),r(185),r(186),r(187),r(188),r(189),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201),r(202),r(203),r(204),r(205),r(206),r(208),r(209),r(211),r(212),r(213),r(214),r(215),r(216),r(217),r(220),r(221),r(222),r(223),r(224),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(232),r(82),r(233),r(234),r(107),r(235),r(236),r(237),r(238),r(108),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(266),r(267),r(268),r(269),t.exports=r(8)},function(t,e,r){"use strict";var n=r(2),i=r(13),o=r(7),a=r(0),s=r(11),l=r(28).KEY,u=r(1),c=r(62),h=r(39),p=r(31),d=r(5),f=r(63),m=r(89),_=r(128),y=r(66),g=r(4),v=r(3),b=r(15),x=r(27),w=r(30),k=r(35),E=r(92),I=r(18),S=r(6),M=r(33),T=I.f,A=S.f,P=E.f,C=n.Symbol,D=n.JSON,z=D&&D.stringify,B=d("_hidden"),L=d("toPrimitive"),R={}.propertyIsEnumerable,O=c("symbol-registry"),F=c("symbols"),N=c("op-symbols"),V=Object.prototype,j="function"==typeof C,U=n.QObject,q=!U||!U.prototype||!U.prototype.findChild,G=o&&u(function(){return 7!=k(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=T(V,e);n&&delete V[e],A(t,e,r),n&&t!==V&&A(V,e,n)}:A,Z=function(t){var e=F[t]=k(C.prototype);return e._k=t,e},X=j&&"symbol"==typeof C.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof C},W=function(t,e,r){return t===V&&W(N,e,r),g(t),e=x(e,!0),g(r),i(F,e)?(r.enumerable?(i(t,B)&&t[B][e]&&(t[B][e]=!1),r=k(r,{enumerable:w(0,!1)})):(i(t,B)||A(t,B,w(1,{})),t[B][e]=!0),G(t,e,r)):A(t,e,r)},H=function(t,e){g(t);for(var r,n=_(e=b(e)),i=0,o=n.length;o>i;)W(t,r=n[i++],e[r]);return t},Y=function(t){var e=R.call(this,t=x(t,!0));return!(this===V&&i(F,t)&&!i(N,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,B)&&this[B][t])||e)},K=function(t,e){if(t=b(t),e=x(e,!0),t!==V||!i(F,e)||i(N,e)){var r=T(t,e);return!r||!i(F,e)||i(t,B)&&t[B][e]||(r.enumerable=!0),r}},J=function(t){for(var e,r=P(b(t)),n=[],o=0;r.length>o;)i(F,e=r[o++])||e==B||e==l||n.push(e);return n},Q=function(t){for(var e,r=t===V,n=P(r?N:b(t)),o=[],a=0;n.length>a;)!i(F,e=n[a++])||r&&!i(V,e)||o.push(F[e]);return o};j||(s((C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(r){this===V&&e.call(N,r),i(this,B)&&i(this[B],t)&&(this[B][t]=!1),G(this,t,w(1,r))};return o&&q&&G(V,t,{configurable:!0,set:e}),Z(t)}).prototype,"toString",function(){return this._k}),I.f=K,S.f=W,r(36).f=E.f=J,r(47).f=Y,r(50).f=Q,o&&!r(32)&&s(V,"propertyIsEnumerable",Y,!0),f.f=function(t){return Z(d(t))}),a(a.G+a.W+a.F*!j,{Symbol:C});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;$.length>tt;)d($[tt++]);for(var et=M(d.store),rt=0;et.length>rt;)m(et[rt++]);a(a.S+a.F*!j,"Symbol",{for:function(t){return i(O,t+="")?O[t]:O[t]=C(t)},keyFor:function(t){if(!X(t))throw TypeError(t+" is not a symbol!");for(var e in O)if(O[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),a(a.S+a.F*!j,"Object",{create:function(t,e){return void 0===e?k(t):H(k(t),e)},defineProperty:W,defineProperties:H,getOwnPropertyDescriptor:K,getOwnPropertyNames:J,getOwnPropertySymbols:Q}),D&&a(a.S+a.F*(!j||u(function(){var t=C();return"[null]"!=z([t])||"{}"!=z({a:t})||"{}"!=z(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(v(e)||void 0!==t)&&!X(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!X(e))return e}),n[1]=e,z.apply(D,n)}}),C.prototype[L]||r(14)(C.prototype,L,C.prototype.valueOf),h(C,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},function(t,e,r){var n=r(33),i=r(50),o=r(47);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var a,s=r(t),l=o.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e,r){var n=r(0);n(n.S,"Object",{create:r(35)})},function(t,e,r){var n=r(0);n(n.S+n.F*!r(7),"Object",{defineProperty:r(6).f})},function(t,e,r){var n=r(0);n(n.S+n.F*!r(7),"Object",{defineProperties:r(91)})},function(t,e,r){var n=r(15),i=r(18).f;r(19)("getOwnPropertyDescriptor",function(){return function(t,e){return i(n(t),e)}})},function(t,e,r){var n=r(16),i=r(37);r(19)("getPrototypeOf",function(){return function(t){return i(n(t))}})},function(t,e,r){var n=r(16),i=r(33);r(19)("keys",function(){return function(t){return i(n(t))}})},function(t,e,r){r(19)("getOwnPropertyNames",function(){return r(92).f})},function(t,e,r){var n=r(3),i=r(28).onFreeze;r(19)("freeze",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(3),i=r(28).onFreeze;r(19)("seal",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(3),i=r(28).onFreeze;r(19)("preventExtensions",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(3);r(19)("isFrozen",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,r){var n=r(3);r(19)("isSealed",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,r){var n=r(3);r(19)("isExtensible",function(t){return function(e){return!!n(e)&&(!t||t(e))}})},function(t,e,r){var n=r(0);n(n.S+n.F,"Object",{assign:r(93)})},function(t,e,r){var n=r(0);n(n.S,"Object",{is:r(144)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,r){var n=r(0);n(n.S,"Object",{setPrototypeOf:r(68).set})},function(t,e,r){"use strict";var n=r(51),i={};i[r(5)("toStringTag")]="z",i+""!="[object z]"&&r(11)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(t,e,r){var n=r(0);n(n.P,"Function",{bind:r(94)})},function(t,e,r){var n=r(6).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||r(7)&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,r){"use strict";var n=r(3),i=r(37),o=r(5)("hasInstance"),a=Function.prototype;o in a||r(6).f(a,o,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,r){var n=r(0),i=r(96);n(n.G+n.F*(parseInt!=i),{parseInt:i})},function(t,e,r){var n=r(0),i=r(97);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},function(t,e,r){"use strict";var n=r(2),i=r(13),o=r(23),a=r(70),s=r(27),l=r(1),u=r(36).f,c=r(18).f,h=r(6).f,p=r(52).trim,d=n.Number,f=d,m=d.prototype,_="Number"==o(r(35)(m)),y="trim"in String.prototype,g=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var r,n,i,o=(e=y?e.trim():p(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=e.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+e}for(var a,l=e.slice(2),u=0,c=l.length;u<c;u++)if((a=l.charCodeAt(u))<48||a>i)return NaN;return parseInt(l,n)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof d&&(_?l(function(){m.valueOf.call(r)}):"Number"!=o(r))?a(new f(g(e)),r,d):g(e)};for(var v,b=r(7)?u(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;b.length>x;x++)i(f,v=b[x])&&!i(d,v)&&h(d,v,c(f,v));d.prototype=m,m.constructor=d,r(11)(n,"Number",d)}},function(t,e,r){"use strict";var n=r(0),i=r(25),o=r(98),a=r(71),s=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h=function(t,e){for(var r=-1,n=e;++r<6;)n+=t*u[r],u[r]=n%1e7,n=l(n/1e7)},p=function(t){for(var e=6,r=0;--e>=0;)r+=u[e],u[e]=l(r/t),r=r%t*1e7},d=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==u[t]){var r=String(u[t]);e=""===e?r:e+a.call("0",7-r.length)+r}return e},f=function(t,e,r){return 0===e?r:e%2==1?f(t,e-1,r*t):f(t*t,e/2,r)};n(n.P+n.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(1)(function(){s.call({})})),"Number",{toFixed:function(t){var e,r,n,s,l=o(this,c),u=i(t),m="",_="0";if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(m="-",l=-l),l>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(l*f(2,69,1))-69)<0?l*f(2,-e,1):l/f(2,e,1),r*=4503599627370496,(e=52-e)>0){for(h(0,r),n=u;n>=7;)h(1e7,0),n-=7;for(h(f(10,n,1),0),n=e-1;n>=23;)p(1<<23),n-=23;p(1<<n),h(1,1),p(2),_=d()}else h(0,r),h(1<<-e,0),_=d()+a.call("0",u);return _=u>0?m+((s=_.length)<=u?"0."+a.call("0",u-s)+_:_.slice(0,s-u)+"."+_.slice(s-u)):m+_}})},function(t,e,r){"use strict";var n=r(0),i=r(1),o=r(98),a=1..toPrecision;n(n.P+n.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,r){var n=r(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,r){var n=r(0),i=r(2).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,r){var n=r(0);n(n.S,"Number",{isInteger:r(99)})},function(t,e,r){var n=r(0);n(n.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,r){var n=r(0),i=r(99),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,r){var n=r(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,r){var n=r(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,r){var n=r(0),i=r(97);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,r){var n=r(0),i=r(96);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,r){var n=r(0),i=r(100),o=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,r){var n=r(0),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,r){var n=r(0),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,r){var n=r(0),i=r(72);n(n.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,r){var n=r(0);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,r){var n=r(0),i=Math.exp;n(n.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,r){var n=r(0),i=r(73);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,r){var n=r(0);n(n.S,"Math",{fround:r(172)})},function(t,e,r){var n=r(72),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126);t.exports=Math.fround||function(t){var e,r,i=Math.abs(t),u=n(t);return i<l?u*function(t){return t+1/o-1/o}(i/l/a)*l*a:(r=(e=(1+a/o)*i)-(e-i))>s||r!=r?u*(1/0):u*r}},function(t,e,r){var n=r(0),i=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var r,n,o=0,a=0,s=arguments.length,l=0;a<s;)l<(r=i(arguments[a++]))?(o=o*(n=l/r)*n+1,l=r):o+=r>0?(n=r/l)*n:r;return l===1/0?1/0:l*Math.sqrt(o)}})},function(t,e,r){var n=r(0),i=Math.imul;n(n.S+n.F*r(1)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var r=+t,n=+e,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}})},function(t,e,r){var n=r(0);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,r){var n=r(0);n(n.S,"Math",{log1p:r(100)})},function(t,e,r){var n=r(0);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,r){var n=r(0);n(n.S,"Math",{sign:r(72)})},function(t,e,r){var n=r(0),i=r(73),o=Math.exp;n(n.S+n.F*r(1)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,r){var n=r(0),i=r(73),o=Math.exp;n(n.S,"Math",{tanh:function(t){var e=i(t=+t),r=i(-t);return e==1/0?1:r==1/0?-1:(e-r)/(o(t)+o(-t))}})},function(t,e,r){var n=r(0);n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,r){var n=r(0),i=r(34),o=String.fromCharCode,a=String.fromCodePoint;n(n.S+n.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,r=[],n=arguments.length,a=0;n>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");r.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return r.join("")}})},function(t,e,r){var n=r(0),i=r(15),o=r(9);n(n.S,"String",{raw:function(t){for(var e=i(t.raw),r=o(e.length),n=arguments.length,a=[],s=0;r>s;)a.push(String(e[s++])),s<n&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,r){"use strict";r(52)("trim",function(t){return function(){return t(this,3)}})},function(t,e,r){"use strict";var n=r(101)(!0);r(74)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){"use strict";var n=r(0),i=r(101)(!1);n(n.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,r){"use strict";var n=r(0),i=r(9),o=r(75),a="".endsWith;n(n.P+n.F*r(77)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=i(e.length),s=void 0===r?n:Math.min(i(r),n),l=String(t);return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,r){"use strict";var n=r(0),i=r(75);n(n.P+n.F*r(77)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,r){var n=r(0);n(n.P,"String",{repeat:r(71)})},function(t,e,r){"use strict";var n=r(0),i=r(9),o=r(75),a="".startsWith;n(n.P+n.F*r(77)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,r):e.slice(r,r+n.length)===n}})},function(t,e,r){"use strict";r(12)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,r){"use strict";r(12)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,r){"use strict";r(12)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,r){"use strict";r(12)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,r){"use strict";r(12)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,r){"use strict";r(12)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,r){"use strict";r(12)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,r){"use strict";r(12)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,r){"use strict";r(12)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,r){"use strict";r(12)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,r){"use strict";r(12)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,r){"use strict";r(12)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,r){"use strict";r(12)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,r){var n=r(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,r){"use strict";var n=r(0),i=r(16),o=r(27);n(n.P+n.F*r(1)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),r=o(e);return"number"!=typeof r||isFinite(r)?e.toISOString():null}})},function(t,e,r){var n=r(0),i=r(207);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,r){"use strict";var n=r(1),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!n(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),r=t.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(r>99?r:"0"+a(r))+"Z"}:o},function(t,e,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r(11)(n,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,r){var n=r(5)("toPrimitive"),i=Date.prototype;n in i||r(14)(i,n,r(210))},function(t,e,r){"use strict";var n=r(4),i=r(27);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(n(this),"number"!=t)}},function(t,e,r){var n=r(0);n(n.S,"Array",{isArray:r(66)})},function(t,e,r){"use strict";var n=r(21),i=r(0),o=r(16),a=r(103),s=r(78),l=r(9),u=r(79),c=r(80);i(i.S+i.F*!r(53)(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,i,h,p=o(t),d="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,_=void 0!==m,y=0,g=c(p);if(_&&(m=n(m,f>2?arguments[2]:void 0,2)),void 0==g||d==Array&&s(g))for(r=new d(e=l(p.length));e>y;y++)u(r,y,_?m(p[y],y):p[y]);else for(h=g.call(p),r=new d;!(i=h.next()).done;y++)u(r,y,_?a(h,m,[i.value,y],!0):i.value);return r.length=y,r}})},function(t,e,r){"use strict";var n=r(0),i=r(79);n(n.S+n.F*r(1)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,r=new("function"==typeof this?this:Array)(e);e>t;)i(r,t,arguments[t++]);return r.length=e,r}})},function(t,e,r){"use strict";var n=r(0),i=r(15),o=[].join;n(n.P+n.F*(r(46)!=Object||!r(17)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,r){"use strict";var n=r(0),i=r(67),o=r(23),a=r(34),s=r(9),l=[].slice;n(n.P+n.F*r(1)(function(){i&&l.call(i)}),"Array",{slice:function(t,e){var r=s(this.length),n=o(this);if(e=void 0===e?r:e,"Array"==n)return l.call(this,t,e);for(var i=a(t,r),u=a(e,r),c=s(u-i),h=new Array(c),p=0;p<c;p++)h[p]="String"==n?this.charAt(i+p):this[i+p];return h}})},function(t,e,r){"use strict";var n=r(0),i=r(22),o=r(16),a=r(1),s=[].sort,l=[1,2,3];n(n.P+n.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!r(17)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,r){"use strict";var n=r(0),i=r(20)(0),o=r(17)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,r){var n=r(219);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,r){var n=r(3),i=r(66),o=r(5)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){"use strict";var n=r(0),i=r(20)(1);n(n.P+n.F*!r(17)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(20)(2);n(n.P+n.F*!r(17)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(20)(3);n(n.P+n.F*!r(17)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(20)(4);n(n.P+n.F*!r(17)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(104);n(n.P+n.F*!r(17)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,r){"use strict";var n=r(0),i=r(104);n(n.P+n.F*!r(17)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,r){"use strict";var n=r(0),i=r(49)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(a||!r(17)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(15),o=r(25),a=r(9),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!r(17)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=i(this),r=a(e.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},function(t,e,r){var n=r(0);n(n.P,"Array",{copyWithin:r(105)}),r(41)("copyWithin")},function(t,e,r){var n=r(0);n(n.P,"Array",{fill:r(81)}),r(41)("fill")},function(t,e,r){"use strict";var n=r(0),i=r(20)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(41)("find")},function(t,e,r){"use strict";var n=r(0),i=r(20)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(41)(o)},function(t,e,r){r(42)("Array")},function(t,e,r){var n=r(2),i=r(70),o=r(6).f,a=r(36).f,s=r(76),l=r(83),u=n.RegExp,c=u,h=u.prototype,p=/a/g,d=/a/g,f=new u(p)!==p;if(r(7)&&(!f||r(1)(function(){return d[r(5)("match")]=!1,u(p)!=p||u(d)==d||"/a/i"!=u(p,"i")}))){u=function(t,e){var r=this instanceof u,n=s(t),o=void 0===e;return!r&&n&&t.constructor===u&&o?t:i(f?new c(n&&!o?t.source:t,e):c((n=t instanceof u)?t.source:t,n&&o?l.call(t):e),r?this:h,u)};for(var m=function(t){t in u||o(u,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},_=a(c),y=0;_.length>y;)m(_[y++]);h.constructor=u,u.prototype=h,r(11)(n,"RegExp",u)}r(42)("RegExp")},function(t,e,r){"use strict";r(107);var n=r(4),i=r(83),o=r(7),a=/./.toString,s=function(t){r(11)(RegExp.prototype,"toString",t,!0)};r(1)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,r){r(54)("match",1,function(t,e,r){return[function(r){"use strict";var n=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,n):new RegExp(r)[e](String(n))},r]})},function(t,e,r){r(54)("replace",2,function(t,e,r){return[function(n,i){"use strict";var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,r){r(54)("search",1,function(t,e,r){return[function(r){"use strict";var n=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,n):new RegExp(r)[e](String(n))},r]})},function(t,e,r){r(54)("split",2,function(t,e,n){"use strict";var i=r(76),o=n,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];n=function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(r,t,e);var n,l,u,c,h,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,m=void 0===e?4294967295:e>>>0,_=new RegExp(t.source,d+"g");for(s||(n=new RegExp("^"+_.source+"$(?!\\s)",d));(l=_.exec(r))&&!((u=l.index+l[0].length)>f&&(p.push(r.slice(f,l.index)),!s&&l.length>1&&l[0].replace(n,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(l[h]=void 0)}),l.length>1&&l.index<r.length&&a.apply(p,l.slice(1)),c=l[0].length,f=u,p.length>=m));)_.lastIndex===l.index&&_.lastIndex++;return f===r.length?!c&&_.test("")||p.push(""):p.push(r.slice(f)),p.length>m?p.slice(0,m):p}}else"0".split(void 0,0).length&&(n=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(r,i){var o=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,r){var n=r(2),i=r(84).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,l="process"==r(23)(a);t.exports=function(){var t,e,r,u=function(){var n,i;for(l&&(n=a.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(l)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);r=function(){c.then(u)}}else r=function(){i.call(n,u)};else{var h=!0,p=document.createTextNode("");new o(u).observe(p,{characterData:!0}),r=function(){p.data=h=!h}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){"use strict";var n=r(111),i=r(45);t.exports=r(58)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(i(this,"Map"),0===t?0:t,e)}},n,!0)},function(t,e,r){"use strict";var n=r(111),i=r(45);t.exports=r(58)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"Set"),t=0===t?0:t,t)}},n)},function(t,e,r){"use strict";var n,i=r(20)(0),o=r(11),a=r(28),s=r(93),l=r(112),u=r(3),c=r(1),h=r(45),p=a.getWeak,d=Object.isExtensible,f=l.ufstore,m={},_=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(t){if(u(t)){var e=p(t);return!0===e?f(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},g=t.exports=r(58)("WeakMap",_,y,l,!0,!0);c(function(){return 7!=(new g).set((Object.freeze||Object)(m),7).get(m)})&&(s((n=l.getConstructor(_,"WeakMap")).prototype,y),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=g.prototype,r=e[t];o(e,t,function(e,i){if(u(e)&&!d(e)){this._f||(this._f=new n);var o=this._f[t](e,i);return"set"==t?this:o}return r.call(this,e,i)})}))},function(t,e,r){"use strict";var n=r(112),i=r(45);r(58)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"WeakSet"),t,!0)}},n,!1,!0)},function(t,e,r){"use strict";var n=r(0),i=r(59),o=r(85),a=r(4),s=r(34),l=r(9),u=r(3),c=r(2).ArrayBuffer,h=r(56),p=o.ArrayBuffer,d=o.DataView,f=i.ABV&&c.isView,m=p.prototype.slice,_=i.VIEW;n(n.G+n.W+n.F*(c!==p),{ArrayBuffer:p}),n(n.S+n.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return f&&f(t)||u(t)&&_ in t}}),n(n.P+n.U+n.F*r(1)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(a(this),t);for(var r=a(this).byteLength,n=s(t,r),i=s(void 0===e?r:e,r),o=new(h(this,p))(l(i-n)),u=new d(this),c=new d(o),f=0;n<i;)c.setUint8(f++,u.getUint8(n++));return o}}),r(42)("ArrayBuffer")},function(t,e,r){var n=r(0);n(n.G+n.W+n.F*!r(59).ABV,{DataView:r(85).DataView})},function(t,e,r){r(26)("Int8",1,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint8",1,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint8",1,function(t){return function(e,r,n){return t(this,e,r,n)}},!0)},function(t,e,r){r(26)("Int16",2,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint16",2,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Int32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Float32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Float64",8,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){var n=r(0),i=r(22),o=r(4),a=(r(2).Reflect||{}).apply,s=Function.apply;n(n.S+n.F*!r(1)(function(){a(function(){})}),"Reflect",{apply:function(t,e,r){var n=i(t),l=o(r);return a?a(n,e,l):s.call(n,e,l)}})},function(t,e,r){var n=r(0),i=r(35),o=r(22),a=r(4),s=r(3),l=r(1),u=r(94),c=(r(2).Reflect||{}).construct,h=l(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),p=!l(function(){c(function(){})});n(n.S+n.F*(h||p),"Reflect",{construct:function(t,e){o(t),a(e);var r=arguments.length<3?t:o(arguments[2]);if(p&&!h)return c(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(u.apply(t,n))}var l=r.prototype,d=i(s(l)?l:Object.prototype),f=Function.apply.call(t,d,e);return s(f)?f:d}})},function(t,e,r){var n=r(6),i=r(0),o=r(4),a=r(27);i(i.S+i.F*r(1)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,r){o(t),e=a(e,!0),o(r);try{return n.f(t,e,r),!0}catch(t){return!1}}})},function(t,e,r){var n=r(0),i=r(18).f,o=r(4);n(n.S,"Reflect",{deleteProperty:function(t,e){var r=i(o(t),e);return!(r&&!r.configurable)&&delete t[e]}})},function(t,e,r){"use strict";var n=r(0),i=r(4),o=function(t){this._t=i(t),this._i=0;var e,r=this._k=[];for(e in t)r.push(e)};r(102)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),n(n.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,r){var n=r(18),i=r(37),o=r(13),a=r(0),s=r(3),l=r(4);a(a.S,"Reflect",{get:function t(e,r){var a,u,c=arguments.length<3?e:arguments[2];return l(e)===c?e[r]:(a=n.f(e,r))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=i(e))?t(u,r,c):void 0}})},function(t,e,r){var n=r(18),i=r(0),o=r(4);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(o(t),e)}})},function(t,e,r){var n=r(0),i=r(37),o=r(4);n(n.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,r){var n=r(0);n(n.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,r){var n=r(0),i=r(4),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,r){var n=r(0);n(n.S,"Reflect",{ownKeys:r(114)})},function(t,e,r){var n=r(0),i=r(4),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,r){var n=r(6),i=r(18),o=r(37),a=r(13),s=r(0),l=r(30),u=r(4),c=r(3);s(s.S,"Reflect",{set:function t(e,r,s){var h,p,d=arguments.length<4?e:arguments[3],f=i.f(u(e),r);if(!f){if(c(p=o(e)))return t(p,r,s,d);f=l(0)}if(a(f,"value")){if(!1===f.writable||!c(d))return!1;if(h=i.f(d,r)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,n.f(d,r,h)}else n.f(d,r,l(0,s));return!0}return void 0!==f.set&&(f.set.call(d,s),!0)}})},function(t,e,r){var n=r(0),i=r(68);i&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,r){r(271),t.exports=r(8).Array.includes},function(t,e,r){"use strict";var n=r(0),i=r(49)(!0);n(n.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(41)("includes")},function(t,e,r){r(273),t.exports=r(8).String.padStart},function(t,e,r){"use strict";var n=r(0),i=r(115),o=r(57);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,r){r(275),t.exports=r(8).String.padEnd},function(t,e,r){"use strict";var n=r(0),i=r(115),o=r(57);n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,r){r(277),t.exports=r(63).f("asyncIterator")},function(t,e,r){r(89)("asyncIterator")},function(t,e,r){r(279),t.exports=r(8).Object.getOwnPropertyDescriptors},function(t,e,r){var n=r(0),i=r(114),o=r(15),a=r(18),s=r(79);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,r,n=o(t),l=a.f,u=i(n),c={},h=0;u.length>h;)void 0!==(r=l(n,e=u[h++]))&&s(c,e,r);return c}})},function(t,e,r){r(281),t.exports=r(8).Object.values},function(t,e,r){var n=r(0),i=r(116)(!1);n(n.S,"Object",{values:function(t){return i(t)}})},function(t,e,r){r(283),t.exports=r(8).Object.entries},function(t,e,r){var n=r(0),i=r(116)(!0);n(n.S,"Object",{entries:function(t){return i(t)}})},function(t,e,r){"use strict";r(108),r(285),t.exports=r(8).Promise.finally},function(t,e,r){"use strict";var n=r(0),i=r(8),o=r(2),a=r(56),s=r(110);n(n.P+n.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),r="function"==typeof t;return this.then(r?function(r){return s(e,t()).then(function(){return r})}:t,r?function(r){return s(e,t()).then(function(){throw r})}:t)}})},function(t,e,r){r(287),r(288),r(289),t.exports=r(8)},function(t,e,r){var n=r(2),i=r(0),o=r(57),a=[].slice,s=/MSIE .\./.test(o),l=function(t){return function(e,r){var n=arguments.length>2,i=!!n&&a.call(arguments,2);return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,r)}};i(i.G+i.B+i.F*s,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},function(t,e,r){var n=r(0),i=r(84);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,r){for(var n=r(82),i=r(33),o=r(11),a=r(2),s=r(14),l=r(40),u=r(5),c=u("iterator"),h=u("toStringTag"),p=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=i(d),m=0;m<f.length;m++){var _,y=f[m],g=d[y],v=a[y],b=v&&v.prototype;if(b&&(b[c]||s(b,c,p),b[h]||s(b,h,y),l[y]=p,g))for(_ in n)b[_]||o(b,_,n[_],!0)}},function(t,e){!function(e){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u="object"==typeof t,c=e.regeneratorRuntime;if(c)u&&(t.exports=c);else{(c=e.regeneratorRuntime=u?t.exports:{}).wrap=b;var h="suspendedStart",p="suspendedYield",d="executing",f="completed",m={},_={};_[a]=function(){return this};var y=Object.getPrototypeOf,g=y&&y(y(C([])));g&&g!==n&&i.call(g,a)&&(_=g);var v=E.prototype=w.prototype=Object.create(_);k.prototype=v.constructor=E,E.constructor=k,E[l]=k.displayName="GeneratorFunction",c.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},c.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(v),t},c.awrap=function(t){return{__await:t}},I(S.prototype),S.prototype[s]=function(){return this},c.AsyncIterator=S,c.async=function(t,e,r,n){var i=new S(b(t,e,r,n));return c.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},I(v),v[l]="Generator",v[a]=function(){return this},v.toString=function(){return"[object Generator]"},c.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),m}}}function b(t,e,r,n){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),a=new P(n||[]);return o._invoke=function(t,e,r){var n=h;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw o;return D()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=M(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var l=x(t,e,r);if("normal"===l.type){if(n=r.done?f:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=f,r.method="throw",r.arg=l.arg)}}}(t,r,a),o}function x(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function w(){}function k(){}function E(){}function I(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function S(t){var e;this._invoke=function(r,n){function o(){return new Promise(function(e,o){!function e(r,n,o,a){var s=x(t[r],t,n);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(u).then(function(t){l.value=t,o(l)},a)}a(s.arg)}(r,n,e,o)})}return e=e?e.then(o,o):o()}}function M(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,M(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=x(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,m):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function C(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return o.next=o}}return{next:D}}function D(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,r){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},r(296),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,r(48))},function(t,e,r){(function(t,e){!function(t,r){"use strict";if(!t.setImmediate){var n,i=1,o={},a=!1,s=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick(function(){c(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?function(){var e="setImmediate$"+Math.random()+"$",r=function(r){r.source===t&&"string"==typeof r.data&&0===r.data.indexOf(e)&&c(+r.data.slice(e.length))};t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),n=function(r){t.postMessage(e+r,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){c(t.data)},n=function(e){t.port2.postMessage(e)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var t=s.documentElement;n=function(e){var r=s.createElement("script");r.onreadystatechange=function(){c(e),r.onreadystatechange=null,t.removeChild(r),r=null},t.appendChild(r)}}():n=function(t){setTimeout(c,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var a={callback:t,args:e};return o[i]=a,n(i),i++},l.clearImmediate=u}function u(t){delete o[t]}function c(t){if(a)setTimeout(c,0,t);else{var e=o[t];if(e){a=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(r,n)}}(e)}finally{u(t),a=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,r(48),r(297))},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,u=[],c=!1,h=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&d())}function d(){if(!c){var t=s(p);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new f(t,e)),1!==u.length||c||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,r){"use strict";r.r(e);r(291),r(292);var n=r(10),i=(r(293),r(118)),o=r.n(i),a=r(119),s=r.n(a),l=(r(294),{type:"range",min:0,max:100,step:1,animationStep:1,value:50,animationDelay:100}),u=function(){function t(t){this.emitter=new n.EventEmitter,this.options=Object.assign({},l,t),this.options.animationStep=this.options.animationStep||this.options.step}return t.prototype.onAdd=function(t){return this.map=t,this._container=this._createContainer(),this._container},t.prototype.onRemove=function(){},t.prototype._createContainer=function(){var t=document.createElement("div");return t.className="mapboxgl-ctrl slider-control",t.appendChild(this._createPlayerContainer()),t.appendChild(this._createSliderContainer()),t.appendChild(this._createNavigationContainer()),t},t.prototype._createValueInput=function(){var t=this,e=this._createLabeledInput({type:"number",value:this.options.value}),r=e.input;return r.onchange=function(){t._onChange(t._getAllowedValue(r.value))},this._input=r,e.label},t.prototype._createAnimationStepInput=function(){var t=this._createLabeledInput({type:"number",label:"animation step",value:this.options.animationStep}),e=t.input,r=this.options;return e.onchange=function(){var t=Number(e.value);t=t<=0?r.animationStep:t>r.max?r.max:t,e.value=String(t),r.animationStep=t},this._animationStepInput=e,t.label},t.prototype._createAnimationDelayInput=function(){var t=this,e=this._createLabeledInput({type:"number",label:"amimation delay",value:this.options.animationDelay}),r=e.input;return r.onchange=function(){var e=Number(r.value);e=e<=0?1:e,t.options.animationDelay=e},e.label},t.prototype._createSliderContainer=function(){var t=this,e=document.createElement("span");e.className="slider-control-range";var r=document.createElement("div");e.appendChild(r);var n=this.options,i=n.min,a=n.max,l=n.step,u=o.a.create(r,{range:{min:i,max:a},step:l,tooltips:[s()({decimals:0})],start:[this.options.value],pips:{mode:"count",values:5}});return u.on("change",function(e,r){t._onChange(parseInt(e[0],10))}),this._sliderContainer=e,this._slider=u,e},t.prototype._createPlayerContainer=function(){var t=this,e=document.createElement("div");e.className="slider-control-block slider-control-player";var r=document.createElement("button");return r.className="player-button",r.onclick=function(){t._toggleAnimation()},e.appendChild(r),this._playerControl=r,e},t.prototype._createNavigationContainer=function(){var t=this,e=document.createElement("div");e.className="slider-control-block slider-control-steps";var r=function(r){var n=document.createElement("button");return n.className="slider-control-steps-btn "+(r?"previous":"next"),e.appendChild(n),n.onclick=function(){t._stepReady(function(e){"boolean"!=typeof e&&t._nextStep(e)},r)},n};return r(!0),r(),e},t.prototype._createLabeledInput=function(t){t=t||{};var e=document.createElement("input");e.className="slider-control-input",t.type&&e.setAttribute("type",t.type),t.value&&(e.value=t.value);var r=document.createElement(t.label?"label":"div");return r.className="slider-control-block",t.label&&(r.innerHTML=t.label+":"),r.appendChild(e),{label:r,input:e}},t.prototype.stopAnimation=function(){this._toggleAnimation(!1)},t.prototype._onChange=function(t){this._slider.set(t),this._input&&(this._input.value=t),this.emitter.emit("change",t)},t.prototype._toggleAnimation=function(t){t=void 0!==t?t:!this._animationStatus,this._animationStatus=t,this._playerControl.classList[this._animationStatus?"add":"remove"]("paused"),t?this._startAnimation():this._stopAnimation()},t.prototype._startAnimation=function(){var t=this;this._animationStatus?this._stepReady(function(e){"boolean"!=typeof e&&e<t.options.max&&e>t.options.min?setTimeout(function(){t._nextStep(e),t._startAnimation()},t.options.animationDelay):t.stopAnimation()}):this.stopAnimation()},t.prototype._nextStep=function(t){this._slider.set(t),this._onChange(t)},t.prototype._stepReady=function(t,e){var r=this._getNextValue(e),n=this.options.value<=this.options.max&&this.options.value>=this.options.min;r&&n?(this.options.value=r,this.options.stepReady?this.options.stepReady(r,t,e):t(r)):t(!1)},t.prototype._getAllowedValue=function(t){return t<=this.options.min?this.options.min:t>this.options.max?this.options.max:t},t.prototype._getNextValue=function(t){var e=parseInt(this._slider.get(),10),r=t?e-this.options.animationStep:e+this.options.animationStep;return this._getAllowedValue(r)},t.prototype._stopAnimation=function(){},t}(),c=r(60),h=r(38),p=r(86);var d=r(120),f=h.baseUrl,m=new d.NgwConnector({baseUrl:f});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var _=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function y(t,e){function r(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var g=function(){return(g=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function v(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,s)}l((n=n.apply(t,e||[])).next())})}function b(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function x(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=x(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,i){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,i,(e=t[r](e)).done,e.value)})}}}Object.prototype.toString;function k(t,e,r,n){var i;if(void 0===e&&(e=function(t){return t}),void 0===n&&(n=[]),Array.isArray(t))i=t;else{e(t)&&n.push(t);var o=r(t);o&&(i=[].concat(o))}if(i)for(var a=0;a<i.length;a++)i[a]&&k(i[a],e,r,n);return n}var E=function(){function t(t){this._children=[],this.entry=t}return t.prototype.setParent=function(t){this._parent=t},t.prototype.addChildren=function(t){this._children.push(t)},t.prototype.getParent=function(){return this._parent},t.prototype.getParents=function(t){return this.getParent()?k(this._parent,t,function(t){return t.tree.getParent()}):[]},t.prototype.getDescendants=function(t){return k(this._children,t,function(t){return t.tree.getChildren()})},t.prototype.getChildren=function(){return this._children},t}(),I=function(t){function e(r,n,i){var o=t.call(this,r,n,Object.assign({},e.options,i))||this;return o.set(o.value()),o}return y(e,t),e.prototype.update=function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var r=this.getParent(),n=r&&r.properties.get(this.name);n&&n.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)},e.prototype.getHierarchyValue=function(){var t=this;return this.value()&&this.getParents().every(function(e){var r=e.properties[t.name];return r&&r.get()})},e.prototype._prepareValue=function(t){return!!t},e.prototype._turnOff=function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChilds(t)},e.prototype._turnOn=function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChilds(t)},e.prototype.block=function(t){this._blocked=!0,this._block(t)},e.prototype._block=function(t){this._turnOff(t)},e.prototype.unBlock=function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)},e.prototype._unBlock=function(t){this._turnOn(t)},e.prototype.blockChilds=function(t){this.entry.tree.getDescendants().forEach(this._blockChild.bind(this,t))},e.prototype.unblockChilds=function(t){this.entry.tree.getChildren().forEach(this._unBlockChild.bind(this,t))},e.prototype._blockChild=function(t,e){var r=e.properties.get(this.name);r.block&&r.block(t)},e.prototype._unBlockChild=function(t,e){var r=e.properties.get(this.name);r.unBlock&&r.unBlock(t)},e.prototype._propagation=function(t,e){if(this.isGroup())for(var r=this.entry.tree.getChildren(),n=0;n<r.length;n++){var i=r[n].properties.get(this.name);i&&i.set(t,g({},e,{propagation:!0,bubble:!1}))}},e.options={hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"},e}(function(){function t(t,e,r){this.emitter=new n.EventEmitter,this.entry=e,this.options=Object.assign({},r),this.name=t,this._value=this.getProperty()}return t.prototype.getProperty=function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this):this.options.value},t.prototype.getParents=function(){return this.entry.tree.getParents()||[]},t.prototype.getParent=function(){return this.entry.tree.getParent()},t.prototype.isGroup=function(){return this.entry.tree.getDescendants().length},t.prototype.isBlocked=function(){var t=this;if(void 0===this._blocked){var e=this.entry.tree.getParents();if(e){var r=e.find(function(e){var r=e.properties.get(t.name);if(r)return!r.value()});this._blocked=!!r}else this._blocked=!1}return this._blocked},t.prototype.set=function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)},t.prototype.value=function(){return this.getValue()},t.prototype.update=function(t,e){this._callOnSet(t,e)},t.prototype.getContainer=function(){return this._container},t.prototype.destroy=function(){this._container&&this._container.parentNode.removeChild(this._container),this._removeEventsListener&&this._removeEventsListener()},t.prototype.getValue=function(){return void 0!==this._value?this._value:this.getProperty()},t.prototype._prepareValue=function(t){return t},t.prototype._callOnSet=function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e)},t.prototype._fireChangeEvent=function(t,e){var r=this;t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.entry.tree.getParents().forEach(function(n){var i=n.properties.get(r.name);i&&i.emitter.emit("change-tree",{value:t,options:e,entry:r.entry})})},t}()),S=function(){function t(t,e){this.options={},this.entry=t,this._properties={},this._propertiesList=[],e&&e.forEach(this._setPropertyHandler.bind(this))}return t.prototype.add=function(t){this._setPropertyHandler(t)},t.prototype._setPropertyHandler=function(e){var r=t.handlers,n=e.handler;if(!n&&e.type)switch(e.type){case"boolean":n=r.CheckProperty;break;case"string":n=r.BaseProperty;break;default:n=r.BaseProperty}if(n){var i=g({},e||{});this._properties[e.name]=new n(e.name,this.entry,i),this._propertiesList.push(e.name)}},t.prototype.update=function(){this.list().forEach(function(t){t.update()})},t.prototype.value=function(t){var e=this.get(t);if(e)return e.value},t.prototype.set=function(t,e,r){var n=this.get(t);if(n)return n.set(e,r)},t.prototype.get=function(t){return this._properties[t]},t.prototype.list=function(){var t=this;return this._propertiesList.map(function(e){return t._properties[e]})},t.prototype.destroy=function(){for(var t in this._properties)if(this._properties.hasOwnProperty(t)){var e=this.get(t);e&&e.destroy&&e.destroy()}this._properties=null,this._propertiesList=[]},t.handlers={CheckProperty:I},t}(),M=0,T=function(t){function e(r,n,i,o){var a=t.call(this,Object.assign({},e.options,i))||this;return a.map=r,a.item=n,o&&a.tree.setParent(o),a.initProperties(),a.initItem(n),a}return y(e,t),e.prototype.initItem=function(t){var r=this,n=t._layer;if("group"===t.item_type||"root"===t.item_type)t.children&&t.children.length&&t.children.forEach(function(t){var n=new e(r.map,t,r.options,r);r.tree.addChildren(n)});else if("layer"===t.item_type){var i=t.layer_adapter.toUpperCase();n=this.map.addLayer(i,Object.assign({id:this.id},t))}n&&(t._layer=n,"layer"===t.item_type&&t.layer_enabled&&this.properties.get("visibility").set(!0))},e.prototype.fit=function(){"layer"===this.item.item_type&&console.log(this.item)},e.options={properties:[{type:"boolean",name:"visibility",getProperty:function(){var t=this.entry;return"group"===t.item.item_type||("layer"===t.item.item_type?t.item.layer_enabled:"root"===t.item.item_type)},onSet:function(t){var e=this.entry;"layer"===e.item.item_type&&(t?e.map.showLayer(e.id):e.map.hideLayer(e.id),e.item.layer_enabled=t)}}]},e}(function(){function t(t){this.emitter=new n.EventEmitter,this.options=Object.assign({},this.options,t),this.id=String(M++),this.tree=new E(this)}return t.prototype.initProperties=function(){this.properties=new S(this,this.options.properties)},t}()),A=function(){return function(){this.backspace=8,this.tab=9,this.enter=13,this.shift=16,this.ctrl=17,this.alt=18,this["pause/break"]=19,this.caps_lock=20,this.escape=27,this.page_up=33,this.page_down=34,this.end=35,this.home=36,this.left_arrow=37,this.up_arrow=38,this.right_arrow=39,this.down_arrow=40,this.insert=45,this.delete=46,this.left_window_key=91,this.right_window_key=92,this.select_key=93,this.numpad_0=96,this.numpad_1=97,this.numpad_2=98,this.numpad_3=99,this.numpad_4=100,this.numpad_5=101,this.numpad_6=102,this.numpad_7=103,this.numpad_8=104,this.numpad_9=105,this.multiply=106,this.add=107,this.subtract=109,this.decimal_point=110,this.divide=111,this.f1=112,this.f2=113,this.f3=114,this.f4=115,this.f5=116,this.f6=117,this.f7=118,this.f8=119,this.f9=120,this.f10=121,this.f11=122,this.f12=123,this.num_lock=144,this.scroll_lock=145,this["semi-colon"]=186,this.equal_sign=187,this[","]=188,this["-"]=189,this["."]=190,this["/"]=191,this["`"]=192,this["["]=219,this["\\"]=220,this["]"]=221,this["'"]=222}}(),P=function(){function t(){this.keyCodeAlias=new A,this.keys={},this._windowOnFocus=this.windowOnFocus.bind(this),this._keysPressed=this.keysPressed.bind(this),this._keysReleased=this.keysReleased.bind(this),this.addKeyboardEventsListener()}return t.prototype.pressed=function(t){var e=this.keyCodeAlias[t];if(e)return this.keys[e]},t.prototype.addKeyboardEventsListener=function(){window.addEventListener("focus",this._windowOnFocus,!1),window.addEventListener("keydown",this._keysPressed,!1),window.addEventListener("keyup",this._keysReleased,!1)},t.prototype.removeKeyboardEventsListener=function(){window.removeEventListener("focus",this._windowOnFocus,!1),window.removeEventListener("keydown",this._keysPressed,!1),window.removeEventListener("keyup",this._keysReleased,!1)},t.prototype.keysPressed=function(t){t.stopPropagation(),this.keys[t.keyCode]||(this.keys[t.keyCode]=!0)},t.prototype.keysReleased=function(t){t.stopPropagation(),this.keys[t.keyCode]=!1},t.prototype.windowOnFocus=function(){this.keys={}},t}(),C=function(){function t(t){this.displayProjection="EPSG:3857",this.lonlatProjection="EPSG:4326",this.emitter=new n.EventEmitter,this.keys=new P,this.settingsIsLoading=!1,this._baseLayers=[],this.map=t.mapAdapter,this._starterKits=t.starterKits||[],this._addEventsListeners()}return t.prototype.create=function(t){return v(this,void 0,Promise,function(){return b(this,function(e){switch(e.label){case 0:return this.options=function t(e,r,n){void 0===n&&(n=!1);var i=Array.isArray(r),o=i&&[]||{};return i?n?(e=e||[],o=o.concat(e),r.forEach(function(r,i){void 0===o[i]?o[i]=r:"object"==typeof r?o[i]=t(e[i],r,n):-1===e.indexOf(r)&&o.push(r)})):o=r:(e&&"object"==typeof e&&Object.keys(e).forEach(function(t){o[t]=e[t]}),Object.keys(r).forEach(function(i){"object"==typeof r[i]&&r[i]&&e[i]?o[i]=t(e[i],r[i],n):o[i]=r[i]})),o}(this.options||{},t),this.settings||!this._starterKits.length?[3,2]:[4,this.getSettings()];case 1:e.sent(),e.label=2;case 2:return[4,this._setupMap()];case 3:return e.sent(),[2,this]}})})},t.prototype.getSettings=function(){return v(this,void 0,Promise,function(){var t,e,r,n,i,o,a=this;return b(this,function(s){switch(s.label){case 0:return this.settings?[2,Promise.resolve(this.settings)]:this.settingsIsLoading?[2,new Promise(function(t){var e=function(r){t(r),a.emitter.removeListener("load-settings",e)};a.emitter.on("load-settings",e)})]:[3,1];case 1:this.settingsIsLoading=!0,t=void 0,s.label=2;case 2:s.trys.push([2,7,,8]),t={},e=0,r=this._starterKits.filter(function(t){return t.getSettings}),s.label=3;case 3:return e<r.length?[4,(n=r[e]).getSettings.call(n)]:[3,6];case 4:(i=s.sent())&&Object.assign(t,i),s.label=5;case 5:return e++,[3,3];case 6:return[3,8];case 7:throw o=s.sent(),this.settingsIsLoading=!1,new Error(o);case 8:if(t)return this.settings=t,this.settingsIsLoading=!1,this.emitter.emit("load-settings",t),[2,t];s.label=9;case 9:return[2]}})})},t.prototype.addBaseLayer=function(t,e,r){var n=this;return this.map.addLayer(e,g({},r,{id:t}),!0).then(function(t){return t&&n._baseLayers.push(t.name),t})},t.prototype.isBaseLayer=function(t){return-1!==this._baseLayers.indexOf(t)},t.prototype._setupMap=function(){return v(this,void 0,void 0,function(){var t,e,r,n,i,o;return b(this,function(a){switch(a.label){case 0:return this.settings&&(t=this.settings,e=t.extent_bottom,r=t.extent_left,n=t.extent_top,i=t.extent_right,e&&r&&n&&i&&(this._extent=[r,e,i,n],(o=this._extent)[3]>82&&(o[3]=82),o[1]<-82&&(o[1]=-82))),this.map.displayProjection=this.displayProjection,this.map.lonlatProjection=this.lonlatProjection,this.map.create(this.options),this._addTreeLayers(),[4,this._addLayerProviders()];case 1:return a.sent(),this._zoomToInitialExtent(),this.emitter.emit("build-map",this.map),[2,this]}})})},t.prototype._addTreeLayers=function(){return v(this,void 0,void 0,function(){var t,e;return b(this,function(r){switch(r.label){case 0:return[4,this.getSettings()];case 1:return(t=r.sent())&&(e=t.root_item)&&(this.layers=new T(this.map,e),this.emitter.emit("add-layers",this.layers)),[2]}})})},t.prototype._zoomToInitialExtent=function(){if(this._extent)this.map.fit(this._extent);else{var t=this.options,e=t.center,r=t.zoom;e&&this.map.setCenter(e),r&&this.map.setZoom(r)}},t.prototype._addLayerProviders=function(){return v(this,void 0,void 0,function(){var t,e,r,n,i,o,a,s,l,u,c,h,p,d,f;return b(this,function(m){switch(m.label){case 0:m.trys.push([0,26,,27]),m.label=1;case 1:m.trys.push([1,19,20,25]),i=w(this._starterKits.filter(function(t){return t.getLayerAdapters})),m.label=2;case 2:return[4,i.next()];case 3:return(o=m.sent()).done?[3,18]:[4,(a=o.value).getLayerAdapters.call(a)];case 4:if(!(s=m.sent()))return[3,17];m.label=5;case 5:m.trys.push([5,11,12,17]),l=w(s),m.label=6;case 6:return[4,l.next()];case 7:return(u=m.sent()).done?[3,10]:[4,(c=u.value).createAdapter(this.map)];case 8:(h=m.sent())&&(this.map.layerAdapters[c.name]=h),m.label=9;case 9:return[3,6];case 10:return[3,17];case 11:return p=m.sent(),r={error:p},[3,17];case 12:return m.trys.push([12,,15,16]),u&&!u.done&&(n=l.return)?[4,n.call(l)]:[3,14];case 13:m.sent(),m.label=14;case 14:return[3,16];case 15:if(r)throw r.error;return[7];case 16:return[7];case 17:return[3,2];case 18:return[3,25];case 19:return d=m.sent(),t={error:d},[3,25];case 20:return m.trys.push([20,,23,24]),o&&!o.done&&(e=i.return)?[4,e.call(i)]:[3,22];case 21:m.sent(),m.label=22;case 22:return[3,24];case 23:if(t)throw t.error;return[7];case 24:return[7];case 25:return[3,27];case 26:throw f=m.sent(),new Error(f);case 27:return[2]}})})},t.prototype._addEventsListeners=function(){var t=this;this.map.emitter.on("click",function(e){return t._onMapClick(e)})},t.prototype._onMapClick=function(t){var e=this;this.emitter.emit("click",t),this._starterKits.forEach(function(r){r.onMapClick&&r.onMapClick(t,e)})},t}(),D=1,z=function(){function t(t,e){this.map=t,this.name=e.id||String(D++),this.options=Object.assign({},this.options,e)}return t.prototype.addLayer=function(t){return""},t}(),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.addLayer=function(t){t=Object.assign({},this.options,t||{});var e=String(this.name),r={id:e,type:t.type||"fill","source-layer":t["source-layer"]||e,source:{type:"vector",tiles:[t.url]},layout:{visibility:"none"}};return t.paint&&(r.paint=t.paint),this.map.addLayer(r,t.before),this.name},e}(z),L=r(29),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.addLayer=function(t){var e,r=Object.assign({},this.options,t||{});return e=r&&r.subdomains?r.subdomains.split("").map(function(t){return r.url.replace("{s}",t)}):[r.url],this.map.addLayer({id:String(this.name),type:"raster",layout:{visibility:"none"},source:{type:"raster",tiles:e,tileSize:r&&r.tileSize||256}},t.before),this.name},e}(z),O={url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright" target="_blank">OpenStreetMap</a> contributors',subdomains:"abc"},F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.addLayer=function(e){return t.prototype.addLayer.call(this,Object.assign({},O,e))},e}(R),N=function(t){function e(e){void 0===e&&(e={});return e=Object.assign({},e,{showCompass:!1}),t.call(this,e)||this}return y(e,t),e}(L.NavigationControl),V=function(t){function e(e){void 0===e&&(e={});return e=Object.assign({},e,{showZoom:!1}),t.call(this,e)||this}return y(e,t),e}(L.NavigationControl),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e}(L.AttributionControl),U=function(){function t(){this.displayProjection="EPSG:3857",this.lonlatProjection="EPSG:4326",this.emitter=new n.EventEmitter,this.layerAdapters=t.layerAdapters,this._layers={},this._baseLayers=[],this.DPI=1e3/39.37/.28,this.IPM=39.37,this.isLoaded=!1,this.orders=[],this._sourcedataloading={}}return t.prototype.create=function(t){this.map||(this.options=t,this.map=new L.Map({container:t.target,center:[96,63],zoom:2,style:{version:8,name:"Empty style",sources:{},layers:[]}}),this._addEventsListeners())},t.prototype.getContainer=function(){return this.map.getContainer()},t.prototype.setCenter=function(t){},t.prototype.setZoom=function(t){},t.prototype.fit=function(t){},t.prototype.setRotation=function(t){},t.prototype.showLayer=function(t){var e=this;this.onMapLoad(function(){return e.toggleLayer(t,!0)})},t.prototype.hideLayer=function(t){var e=this;this.onMapLoad(function(){return e.toggleLayer(t,!1)})},t.prototype.addLayer=function(t,e,r){var n=this;return this.onMapLoad(function(){var i;if("string"==typeof t&&(i=n.getLayerAdapter(t)),i){var o=new i(n.map,e);r&&n.orders.length&&(e.before=n.orders[0]);var a=o.addLayer(e),s=function(){var t=o.name;return n._layers[t]=!1,n.orders.push(t),n._baseLayers.push(t),r?n.map.moveLayer(t,n.orders[0]):n.map.moveLayer(t),o};return a.then?a.then(function(t){return s()}):Promise.resolve(s())}})},t.prototype.removeLayer=function(t){this._layers[t]&&(this.map.removeLayer(t),this.map.removeSource(t),delete this._layers[t])},t.prototype.getLayer=function(t){return void 0!==this._layers[t]},t.prototype.isLayerOnTheMap=function(t){return this._layers[t]},t.prototype.getLayers=function(){return Object.keys(this._layers)},t.prototype.setLayerOpacity=function(t,e){var r=this;this.onMapLoad().then(function(){var n=r.map.getLayer(t);n&&r.map.setPaintProperty(t,n.type+"-opacity",e)})},t.prototype.getScaleForResolution=function(t,e){return parseFloat(t)*(e*this.IPM*this.DPI)},t.prototype.getResolutionForScale=function(t,e){return parseFloat(t)/(e*this.IPM*this.DPI)},t.prototype.onMapLoad=function(t){var e=this;return new Promise(function(r){e.isLoaded?r(t&&t()):e.map.once("load",function(){e.isLoaded=!0,r(t&&t())})})},t.prototype.toggleLayer=function(t,e){var r=this;this.onMapLoad().then(function(){var n=r._layers[t];void 0!==n&&n!==e&&(r.map.setLayoutProperty(t,"visibility",e?"visible":"none"),r._layers[t]=e)})},t.prototype.addControl=function(e,r,n){var i;if("string"==typeof e){var o=t.controlAdapters[e];o&&(i=new o(n))}else i=e;i&&this.map.addControl(i,r)},t.prototype.onMapClick=function(t){var e=t.lngLat,r=t.point,n=r.x,i=r.y;this.emitter.emit("click",{latLng:e,pixel:{top:i,left:n}})},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype._addEventsListeners=function(){var t=this;this.map.on("sourcedataloading",function(e){t._sourcedataloading[e.sourceId]=t._sourcedataloading[e.sourceId]||[],e.tile&&t._sourcedataloading[e.sourceId].push(e.tile)}),this.map.on("sourcedata",function(e){if("source"===e.dataType){var r=function(e){t._layers[e]&&t.emitter.emit("data-loaded",{target:e})};if(e.isSourceLoaded)Object.keys(t._sourcedataloading).forEach(function(t){r(t)}),t._sourcedataloading={};else{var n=t._sourcedataloading[e.sourceId];if(n&&e.tile){var i=n.indexOf(e.tile);-1!==i&&t._sourcedataloading[e.sourceId].splice(i,1),n.length||(r(e.sourceId),delete t._sourcedataloading[e.sourceId])}}}}),this.map.on("click",function(e){t.onMapClick(e)})},t.layerAdapters={TILE:R,MVT:B,OSM:F},t.controlAdapters={ZOOM:N,COMPASS:V,ATTRIBUTION:j},t}(),q=function(){function t(t){this.options={url:"https://qms.nextgis.com"},this.options=g({},this.options,t),this.url=this.options.url}return t.prototype.getLayerAdapters=function(){var t=this;return Promise.resolve([{name:"QMS",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}])},t.prototype.getQmsServices=function(){return v(this,void 0,void 0,function(){return b(this,function(t){return[2,G(this.url+"/api/v1/geoservices/")]})})},t.prototype._createAdapter=function(t){var e=this.url;this.map=t;var r={tms:"TILE"},n=function(t,e){this.map=t,this.name=e.id};return n.prototype.addLayer=function(n){var i=this;return G(e+"/api/v1/geoservices/"+n.qmsid).then(function(e){if(e){var o=r[e.type],a=t.layerAdapters[o];if(a&&"TILE"===o)return n.url=e.url,a.prototype.addLayer.call(i,n)}})},n},t}();function G(t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status&&n.responseText)try{e(JSON.parse(n.responseText))}catch(t){r(t)}},n.open("GET",function(t){return t.replace(/([^:]\/)\/+/g,"$1")}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */(t),!0),n.send(null)})}var Z=function(t,e){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function X(t,e){function r(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}r(298);var W=r(121),H=function(){function t(t){this.emitter=new n.EventEmitter,this._blocked=!1,this.options=Object.assign({},this.options,t),this._container=null,this._header=null,this._body=null,this._container=this._createContainer()}return t.prototype.onAdd=function(t){return this.map=t,this._container},t.prototype.onRemove=function(){},t.prototype.updateBody=function(t){this._cleanBody(),"string"==typeof t?this._body.innerHTML=t:t instanceof HTMLElement&&this._body.appendChild(t)},t.prototype.hide=function(){this._container.classList.add("panel-hide"),this.emitter.emit("toggle",!1)},t.prototype.show=function(){this._blocked||(this._container.classList.remove("panel-hide"),this.emitter.emit("toggle",!0))},t.prototype.createControlButton=function(t,e){void 0===e&&(e="Подробнее");var r=document.createElement("button");return r.className="btn panel-button",r.innerHTML=e,r.onclick=t,r},t.prototype.createRefButton=function(t,e){return this.createControlButton(function(){return window.open(t,"_blank")},e)},t.prototype.openDialog=function(t){this._dialog||(this._dialog=new W.Dialog(t)),t&&t.template&&this._dialog.options.template===t.template||this._dialog.updateContent(t.template),this._dialog.show()},t.prototype.closeDialog=function(){this._dialog&&this._dialog.close()},t.prototype._cleanBody=function(){this._body.innerHTML=""},t.prototype._createContainer=function(){var t=document.createElement("div");return t.className="mapboxgl-ctrl panel",this.options.addClass&&t.classList.add("bottom-links"),this.options.headerText&&t.appendChild(this._createHeader()),t.appendChild(this._createBody()),t},t.prototype._createHeader=function(){var t=document.createElement("div");return t.className="panel-header",t.innerHTML=this.options.headerText,this._header=t,t},t.prototype._createBody=function(){var t=document.createElement("div");return t.className="panel-body",this._body=t,t},t}(),Y=(r(299),{headerText:"Правители"}),K=function(t){function e(e){var r=t.call(this,Object.assign({},Y,e))||this;return r.period=null,r}return X(e,t),e.prototype.updatePeriod=function(t){var e=this.period;this.closeDialog(),t?e!==t&&(this.updateBody(this._createPeriodBody(t)),this.period=t):(this.updateBody('<div class="panel-body__period empty">Данные не предоставленны</div>'),this.period=null)},e.prototype._createPeriodBody=function(t){var e=document.createElement("div");e.className="panel-body__period";var r,n=document.createElement("div");t.img_link&&(r='<div class="panel-body__period--image"><img src="'+t.img_link+'"></div>'),n.innerHTML="\n      "+(r||"")+'\n      <div class="panel-body__period--name">'+t.name+'</div>\n      <div class="panel-body__period--description">'+t.description+'</div>\n      <div class="panel-body__period--period">'+t.years_from+" – "+t.years_to+" г.</div>\n    ",e.appendChild(n);var i=t.detail_link&&this.createRefButton(t.detail_link);return i&&e.appendChild(i),e},e}(H),J=(r(300),{headerText:"Изменения в территориальной целостности"}),Q=function(t){function e(e){return t.call(this,Object.assign({},J,e))||this}return X(e,t),e.prototype.updateYearStats=function(t){this.yearStats=t,this.updateYearStat(this.yearStats[0])},e.prototype.updateYearStat=function(t){var e=this.yearStat;t?e!==t&&(this.show(),this.yearStat=t,this.updateBody(this._createPeriodBody(t))):(this.hide(),this.updateBody('<div class="panel-body__period empty">Данные не предоставленны</div>'),this.yearStat=null)},e.prototype._createPeriodBody=function(t){var e=this,r=document.createElement("div");r.className="panel-body__yearstat",this.yearStats.length>1&&r.appendChild(this._createStateSwitcher());var n=this._createDescriptionBlock(t);n&&r.appendChild(n);var i=t.description_long;if(i){var o=document.createElement("div");o.innerHTML='<div class="panel-body__period--description">'+i+"</div>",r.appendChild(this.createControlButton(function(){return e.openDialog({template:o})}))}return r},e.prototype._createStateSwitcher=function(){var t=this,e=document.createElement("div");e.className="state-switcher";var r=this.yearStats.indexOf(this.yearStat),n=0===r,i=this.yearStats.length,o=r===i-1,a=function(e,n){var i=document.createElement("div");return i.className="state-switcher__flow state-switcher__flow--"+(e?"back":"forward")+(n?"":" hiden"),i.innerHTML=e?"<<":">>",n&&(i.onclick=function(n){n.preventDefault();var i=t.yearStats[e?r-1:r+1];t.updateYearStat(i)}),i};e.appendChild(a(!0,!n));var s=document.createElement("div");return s.className="state-switcher__flow state-switcher__flow--counter",s.innerHTML="<b>"+(r+1)+"</b> <small>/ "+i+"</small>",e.appendChild(s),e.appendChild(a(!1,!o)),e},e.prototype._createDescriptionBlock=function(t){if(t.description_short){var e=document.createElement("div");return e.className="panel-body__yearstat--description",e.innerHTML=t.description_short,e}},e}(H),$=1,tt=2,et=4,rt=5,nt=484813681109536e-20,it=Math.PI/2,ot=.16666666666666666,at=.04722222222222222,st=.022156084656084655,lt=1e-10,ut=.017453292519943295,ct=57.29577951308232,ht=Math.PI/4,pt=2*Math.PI,dt=3.14159265359,ft={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},mt={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},_t=/[\s_\-\/\(\)]/g;function yt(t,e){if(t[e])return t[e];for(var r,n=Object.keys(t),i=e.toLowerCase().replace(_t,""),o=-1;++o<n.length;)if((r=n[o]).toLowerCase().replace(_t,"")===i)return t[r]}var gt=function(t){var e,r,n,i={},o=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var r=e.split("=");return r.push(!0),t[r[0].toLowerCase()]=r[1],t},{}),a={proj:"projName",datum:"datumCode",rf:function(t){i.rf=parseFloat(t)},lat_0:function(t){i.lat0=t*ut},lat_1:function(t){i.lat1=t*ut},lat_2:function(t){i.lat2=t*ut},lat_ts:function(t){i.lat_ts=t*ut},lon_0:function(t){i.long0=t*ut},lon_1:function(t){i.long1=t*ut},lon_2:function(t){i.long2=t*ut},alpha:function(t){i.alpha=parseFloat(t)*ut},lonc:function(t){i.longc=t*ut},x_0:function(t){i.x0=parseFloat(t)},y_0:function(t){i.y0=parseFloat(t)},k_0:function(t){i.k0=parseFloat(t)},k:function(t){i.k0=parseFloat(t)},a:function(t){i.a=parseFloat(t)},b:function(t){i.b=parseFloat(t)},r_a:function(){i.R_A=!0},zone:function(t){i.zone=parseInt(t,10)},south:function(){i.utmSouth=!0},towgs84:function(t){i.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){i.to_meter=parseFloat(t)},units:function(t){i.units=t;var e=yt(mt,t);e&&(i.to_meter=e.to_meter)},from_greenwich:function(t){i.from_greenwich=t*ut},pm:function(t){var e=yt(ft,t);i.from_greenwich=(e||parseFloat(t))*ut},nadgrids:function(t){"@null"===t?i.datumCode="none":i.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(i.axis=t)}};for(e in o)r=o[e],e in a?"function"==typeof(n=a[e])?n(r):i[n]=r:i[e]=r;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},vt=function(t){return new St(t).output()},bt=1,xt=/\s/,wt=/[A-Za-z]/,kt=/[A-Za-z84]/,Et=/[,\]]/,It=/[\d\.E\-\+]/;function St(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=bt}function Mt(t,e,r){Array.isArray(e)&&(r.unshift(e),e=null);var n=e?{}:t,i=r.reduce(function(t,e){return Tt(e,t),t},n);e&&(t[e]=i)}function Tt(t,e){if(Array.isArray(t)){var r,n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void Tt(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n)switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Tt(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Tt(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Mt(e,n,t);default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Tt(t,e[n]);return Mt(e,n,t)}else e[n]=t;else e[n]=!0}else e[t]=!0}St.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;xt.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case bt:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},St.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Et.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},St.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=bt)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=bt,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},St.prototype.number=function(t){if(!It.test(t)){if(Et.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},St.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},St.prototype.keyword=function(t){if(kt.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=bt)}if(!Et.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},St.prototype.neutral=function(t){if(wt.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(It.test(t))return this.word=t,void(this.state=3);if(!Et.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},St.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var At=.017453292519943295;function Pt(t){return t*At}var Ct=function(t){var e=vt(t),r=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",r]);var i={};return Tt(e,i),function(t){"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var e=t.GEOGCS;function r(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(e=t),e&&(e.DATUM?t.datumCode=e.DATUM.name.toLowerCase():t.datumCode=e.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),e.DATUM&&e.DATUM.SPHEROID&&(t.ellps=e.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=e.DATUM.SPHEROID.a,t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)),e.DATUM&&e.DATUM.TOWGS84&&(t.datum_params=e.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Pt],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Pt],["x0","false_easting",r],["y0","false_northing",r],["long0","central_meridian",Pt],["lat0","latitude_of_origin",Pt],["lat0","standard_parallel_1",Pt],["lat1","standard_parallel_1",Pt],["lat2","standard_parallel_2",Pt],["azimuth","Azimuth"],["alpha","azimuth",Pt],["srsCode","name"]].forEach(function(e){return function(t,e){var r=e[0],n=e[1];!(r in t)&&n in t&&(t[r]=t[n],3===e.length&&(t[r]=e[2](t[r])))}(t,e)}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=Pt(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(i),i};function Dt(t){var e=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?Dt[t]=gt(arguments[1]):Dt[t]=Ct(arguments[1]):Dt[t]=r}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?Dt.apply(e,t):Dt(t)});if("string"==typeof t){if(t in Dt)return Dt[t]}else"EPSG"in t?Dt["EPSG:"+t.EPSG]=t:"ESRI"in t?Dt["ESRI:"+t.ESRI]=t:"IAU2000"in t?Dt["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Dt);var zt=Dt;var Bt=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var Lt=["3857","900913","3785","102113"];var Rt=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in zt}(t))return zt[t];if(function(t){return Bt.some(function(e){return t.indexOf(e)>-1})}(t)){var e=Ct(t);if(function(t){var e=yt(t,"authority");if(e){var r=yt(e,"epsg");return r&&Lt.indexOf(r)>-1}}(e))return zt["EPSG:3857"];var r=function(t){var e=yt(t,"extension");if(e)return yt(e,"proj4")}(e);return r?gt(r):e}return function(t){return"+"===t[0]}(t)?gt(t):void 0},Ot=function(t,e){var r,n;if(t=t||{},!e)return t;for(n in e)void 0!==(r=e[n])&&(t[n]=r);return t},Ft=function(t,e,r){var n=t*e;return r/Math.sqrt(1-n*n)},Nt=function(t){return t<0?-1:1},Vt=function(t){return Math.abs(t)<=dt?t:t-Nt(t)*pt},jt=function(t,e,r){var n=t*r,i=.5*t;return n=Math.pow((1-n)/(1+n),i),Math.tan(.5*(it-e))/n},Ut=function(t,e){for(var r,n,i=.5*t,o=it-2*Math.atan(e),a=0;a<=15;a++)if(r=t*Math.sin(o),o+=n=it-2*Math.atan(e*Math.pow((1-r)/(1+r),i))-o,Math.abs(n)<=1e-10)return o;return-9999};function qt(t){return t}var Gt=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ft(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,r,n=t.x,i=t.y;if(i*ct>90&&i*ct<-90&&n*ct>180&&n*ct<-180)return null;if(Math.abs(Math.abs(i)-it)<=lt)return null;if(this.sphere)e=this.x0+this.a*this.k0*Vt(n-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(ht+.5*i));else{var o=Math.sin(i),a=jt(this.e,i,o);e=this.x0+this.a*this.k0*Vt(n-this.long0),r=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=r,t},inverse:function(t){var e,r,n=t.x-this.x0,i=t.y-this.y0;if(this.sphere)r=it-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(r=Ut(this.e,o)))return null}return e=Vt(this.long0+n/(this.a*this.k0)),t.x=e,t.y=r,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:qt,inverse:qt,names:["longlat","identity"]}],Zt={},Xt=[];function Wt(t,e){var r=Xt.length;return t.names?(Xt[r]=t,t.names.forEach(function(t){Zt[t.toLowerCase()]=r}),this):(console.log(e),!0)}var Ht={start:function(){Gt.forEach(Wt)},add:Wt,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Zt[e]&&Xt[Zt[e]]?Xt[Zt[e]]:void 0}},Yt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Kt=Yt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Yt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Jt={};Jt.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Jt.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Jt.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Jt.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Jt.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Jt.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Jt.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Jt.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},Jt.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Jt.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Jt.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Jt.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Jt.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Jt.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Jt.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Jt.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Jt.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var Qt=function(t,e,r,n,i,o){var a={};return a.datum_type=void 0===t||"none"===t?rt:et,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=$),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=tt,a.datum_params[3]*=nt,a.datum_params[4]*=nt,a.datum_params[5]*=nt,a.datum_params[6]=a.datum_params[6]/1e6+1))),a.a=r,a.b=n,a.es=i,a.ep2=o,a};function $t(t,e){if(!(this instanceof $t))return new $t(t);e=e||function(t){if(t)throw t};var r=Rt(t);if("object"==typeof r){var n=$t.projections.get(r.projName);if(n){if(r.datumCode&&"none"!==r.datumCode){var i=yt(Jt,r.datumCode);i&&(r.datum_params=i.towgs84?i.towgs84.split(","):null,r.ellps=i.ellipse,r.datumName=i.datumName?i.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84";var o=function(t,e,r,n,i){if(!t){var o=yt(Yt,n);o||(o=Kt),t=o.a,e=o.b,r=o.rf}return r&&!e&&(e=(1-1/r)*t),(0===r||Math.abs(t-e)<lt)&&(i=!0,e=t),{a:t,b:e,rf:r,sphere:i}}(r.a,r.b,r.rf,r.ellps,r.sphere),a=function(t,e,r,n){var i=t*t,o=e*e,a=(i-o)/i,s=0;return n?(i=(t*=1-a*(ot+a*(at+a*st)))*t,a=0):s=Math.sqrt(a),{es:a,e:s,ep2:(i-o)/o}}(o.a,o.b,o.rf,r.R_A),s=r.datum||Qt(r.datumCode,r.datum_params,o.a,o.b,a.es,a.ep2);Ot(this,r),Ot(this,n),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=s,this.init(),e(null,this)}else e(t)}else e(t)}$t.projections=Ht,$t.projections.start();var te=$t;function ee(t){return t===$||t===tt}var re=function(t,e,r){return function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===$?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==tt||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e)?r:t.datum_type===rt||e.datum_type===rt?r:t.es!==e.es||t.a!==e.a||ee(t.datum_type)||ee(e.datum_type)?(r=function(t,e,r){var n,i,o,a,s=t.x,l=t.y,u=t.z?t.z:0;if(l<-it&&l>-1.001*it)l=-it;else if(l>it&&l<1.001*it)l=it;else{if(l<-it)return{x:-1/0,y:-1/0,z:t.z};if(l>it)return{x:1/0,y:1/0,z:t.z}}return s>Math.PI&&(s-=2*Math.PI),i=Math.sin(l),a=Math.cos(l),o=i*i,{x:((n=r/Math.sqrt(1-e*o))+u)*a*Math.cos(s),y:(n+u)*a*Math.sin(s),z:(n*(1-e)+u)*i}}(r,t.es,t.a),ee(t.datum_type)&&(r=function(t,e,r){if(e===$)return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]};if(e===tt){var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6];return{x:u*(t.x-l*t.y+s*t.z)+n,y:u*(l*t.x+t.y-a*t.z)+i,z:u*(-s*t.x+a*t.y+t.z)+o}}}(r,t.datum_type,t.datum_params)),ee(e.datum_type)&&(r=function(t,e,r){if(e===$)return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]};if(e===tt){var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6],c=(t.x-n)/u,h=(t.y-i)/u,p=(t.z-o)/u;return{x:c+l*h-s*p,y:-l*c+h+a*p,z:s*c-a*h+p}}}(r,e.datum_type,e.datum_params)),function(t,e,r,n){var i,o,a,s,l,u,c,h,p,d,f,m,_,y,g,v=t.x,b=t.y,x=t.z?t.z:0;if(i=Math.sqrt(v*v+b*b),o=Math.sqrt(v*v+b*b+x*x),i/r<1e-12){if(y=0,o/r<1e-12)return g=-n,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(b,v);a=x/o,h=(s=i/o)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*s*s)),p=a*l,_=0;do{_++,u=e*(c=r/Math.sqrt(1-e*p*p))/(c+(g=i*h+x*p-c*(1-e*p*p))),m=(f=a*(l=1/Math.sqrt(1-u*(2-u)*s*s)))*h-(d=s*(1-u)*l)*p,h=d,p=f}while(m*m>1e-24&&_<30);return{x:y,y:Math.atan(f/Math.abs(d)),z:g}}(r,e.es,e.a,e.b)):r},ne=function(t,e,r){var n,i,o,a=r.x,s=r.y,l=r.z||0,u={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==r.z)switch(0===o?(n=a,i="x"):1===o?(n=s,i="y"):(n=l,i="z"),t.axis[o]){case"e":u[i]=n;break;case"w":u[i]=-n;break;case"n":u[i]=n;break;case"s":u[i]=-n;break;case"u":void 0!==r[i]&&(u.z=n);break;case"d":void 0!==r[i]&&(u.z=-n);break;default:return null}return u},ie=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e},oe=function(t){ae(t.x),ae(t.y)};function ae(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function se(t,e,r){var n;return Array.isArray(r)&&(r=ie(r)),oe(r),t.datum&&e.datum&&function(t,e){return(t.datum.datum_type===$||t.datum.datum_type===tt)&&"WGS84"!==e.datumCode||(e.datum.datum_type===$||e.datum.datum_type===tt)&&"WGS84"!==t.datumCode}(t,e)&&(r=se(t,n=new te("WGS84"),r),t=n),"enu"!==t.axis&&(r=ne(t,!1,r)),"longlat"===t.projName?r={x:r.x*ut,y:r.y*ut}:(t.to_meter&&(r={x:r.x*t.to_meter,y:r.y*t.to_meter}),r=t.inverse(r)),t.from_greenwich&&(r.x+=t.from_greenwich),r=re(t.datum,e.datum,r),e.from_greenwich&&(r={x:r.x-e.from_greenwich,y:r.y}),"longlat"===e.projName?r={x:r.x*ct,y:r.y*ct}:(r=e.forward(r),e.to_meter&&(r={x:r.x/e.to_meter,y:r.y/e.to_meter})),"enu"!==e.axis?ne(e,!0,r):r}var le=te("WGS84");function ue(t,e,r){var n,i,o;return Array.isArray(r)?(n=se(t,e,r),3===r.length?[n.x,n.y,n.z]:[n.x,n.y]):(i=se(t,e,r),2===(o=Object.keys(r)).length?i:(o.forEach(function(t){"x"!==t&&"y"!==t&&(i[t]=r[t])}),i))}function ce(t){return t instanceof te?t:t.oProj?t.oProj:te(t)}var he=function(t,e,r){t=ce(t);var n,i=!1;return void 0===e?(e=t,t=le,i=!0):(void 0!==e.x||Array.isArray(e))&&(r=e,e=t,t=le,i=!0),e=ce(e),r?ue(t,e,r):(n={forward:function(r){return ue(t,e,r)},inverse:function(r){return ue(e,t,r)}},i&&(n.oProj=e),n)},pe=6,de="AJSAJS",fe="AFAFAF",me=65,_e=73,ye=79,ge=86,ve=90,be={forward:xe,inverse:function(t){var e=Ie(Me(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:we};function xe(t,e){return e=e||5,function(t,e){var r="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function(t,e,r){var n=Se(r),i=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return function(t,e,r){var n=r-1,i=de.charCodeAt(n),o=fe.charCodeAt(n),a=i+t-1,s=o+e,l=!1;a>ve&&(a=a-ve+me-1,l=!0);(a===_e||i<_e&&a>_e||(a>_e||i<_e)&&l)&&a++;(a===ye||i<ye&&a>ye||(a>ye||i<ye)&&l)&&++a===_e&&a++;a>ve&&(a=a-ve+me-1);s>ge?(s=s-ge+me-1,l=!0):l=!1;(s===_e||o<_e&&s>_e||(s>_e||o<_e)&&l)&&s++;(s===ye||o<ye&&s>ye||(s>ye||o<ye)&&l)&&++s===_e&&s++;s>ge&&(s=s-ge+me-1);return String.fromCharCode(a)+String.fromCharCode(s)}(i,o,n)}(t.easting,t.northing,t.zoneNumber)+r.substr(r.length-5,e)+n.substr(n.length-5,e)}(function(t){var e,r,n,i,o,a,s,l=t.lat,u=t.lon,c=6378137,h=ke(l),p=ke(u);s=Math.floor((u+180)/6)+1,180===u&&(s=60);l>=56&&l<64&&u>=3&&u<12&&(s=32);l>=72&&l<84&&(u>=0&&u<9?s=31:u>=9&&u<21?s=33:u>=21&&u<33?s=35:u>=33&&u<42&&(s=37));a=ke(6*(s-1)-180+3),.006739496752268451,e=c/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h)),r=Math.tan(h)*Math.tan(h),n=.006739496752268451*Math.cos(h)*Math.cos(h),i=Math.cos(h)*(p-a),o=c*(.9983242984503243*h-.002514607064228144*Math.sin(2*h)+2639046602129982e-21*Math.sin(4*h)-3.418046101696858e-9*Math.sin(6*h));var d=.9996*e*(i+(1-r+n)*i*i*i/6+(5-18*r+r*r+72*n-.39089081163157013)*i*i*i*i*i/120)+5e5,f=.9996*(o+e*Math.tan(h)*(i*i/2+(5-r+9*n+4*n*n)*i*i*i*i/24+(61-58*r+r*r+600*n-2.2240339282485886)*i*i*i*i*i*i/720));l<0&&(f+=1e7);return{northing:Math.round(f),easting:Math.round(d),zoneNumber:s,zoneLetter:function(t){var e="Z";84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C");return e}(l)}}({lat:t[1],lon:t[0]}),e)}function we(t){var e=Ie(Me(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function ke(t){return t*(Math.PI/180)}function Ee(t){return t/Math.PI*180}function Ie(t){var e=t.northing,r=t.easting,n=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var o,a,s,l,u,c,h,p,d=6378137,f=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=r-5e5,_=e;n<"N"&&(_-=1e7),c=6*(i-1)-180+3,p=(h=_/.9996/6367449.145945056)+(3*f/2-27*f*f*f/32)*Math.sin(2*h)+(21*f*f/16-55*f*f*f*f/32)*Math.sin(4*h)+151*f*f*f/96*Math.sin(6*h),o=d/Math.sqrt(1-.00669438*Math.sin(p)*Math.sin(p)),a=Math.tan(p)*Math.tan(p),s=.006739496752268451*Math.cos(p)*Math.cos(p),l=.99330562*d/Math.pow(1-.00669438*Math.sin(p)*Math.sin(p),1.5),u=m/(.9996*o);var y=p-o*Math.tan(p)/l*(u*u/2-(5+3*a+10*s-4*s*s-.06065547077041606)*u*u*u*u/24+(61+90*a+298*s+45*a*a-1.6983531815716497-3*s*s)*u*u*u*u*u*u/720);y=Ee(y);var g,v=(u-(1+2*a+s)*u*u*u/6+(5-2*s+28*a-3*s*s+.05391597401814761+24*a*a)*u*u*u*u*u/120)/Math.cos(p);if(v=c+Ee(v),t.accuracy){var b=Ie({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});g={top:b.lat,right:b.lon,bottom:y,left:v}}else g={lat:y,lon:v};return g}function Se(t){var e=t%pe;return 0===e&&(e=pe),e}function Me(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,r=t.length,n=null,i="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;i+=e,o++}var a=parseInt(i,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;n=t.substring(o,o+=2);for(var l=Se(a),u=function(t,e){var r=de.charCodeAt(e-1),n=1e5,i=!1;for(;r!==t.charCodeAt(0);){if(++r===_e&&r++,r===ye&&r++,r>ve){if(i)throw"Bad character: "+t;r=me,i=!0}n+=1e5}return n}(n.charAt(0),l),c=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var r=fe.charCodeAt(e-1),n=0,i=!1;for(;r!==t.charCodeAt(0);){if(++r===_e&&r++,r===ye&&r++,r>ge){if(i)throw"Bad character: "+t;r=me,i=!0}n+=1e5}return n}(n.charAt(1),l);c<Te(s);)c+=2e6;var h=r-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,d,f,m=h/2,_=0,y=0;return m>0&&(p=1e5/Math.pow(10,m),d=t.substring(o,o+m),_=parseFloat(d)*p,f=t.substring(o+m),y=parseFloat(f)*p),{easting:_+u,northing:y+c,zoneLetter:s,zoneNumber:a,accuracy:p}}function Te(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Ae(t,e,r){if(!(this instanceof Ae))return new Ae(t,e,r);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ae.fromMGRS=function(t){return new Ae(we(t))},Ae.prototype.toMGRS=function(t){return xe([this.x,this.y],t)};var Pe=Ae,Ce=r(117),De=.01068115234375,ze=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*De))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*De)));var r=t*t;return e[2]=r*(.46875-t*(.013020833333333334+.007120768229166667*t)),r*=t,e[3]=r*(.3645833333333333-.005696614583333333*t),e[4]=r*t*.3076171875,e},Be=function(t,e,r,n){return r*=e,e*=e,n[0]*t-r*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))},Le=function(t,e,r){for(var n=1/(1-e),i=t,o=20;o;--o){var a=Math.sin(i),s=1-e*a*a;if(i-=s=(Be(i,a,Math.cos(i),r)-t)*(s*Math.sqrt(s))*n,Math.abs(s)<lt)return i}return i};var Re={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ze(this.es),this.ml0=Be(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,r,n,i=t.x,o=t.y,a=Vt(i-this.long0),s=Math.sin(o),l=Math.cos(o);if(this.es){var u=l*a,c=Math.pow(u,2),h=this.ep2*Math.pow(l,2),p=Math.pow(h,2),d=Math.abs(l)>lt?Math.tan(o):0,f=Math.pow(d,2),m=Math.pow(f,2);e=1-this.es*Math.pow(s,2),u/=Math.sqrt(e);var _=Be(o,s,l,this.en);r=this.a*(this.k0*u*(1+c/6*(1-f+h+c/20*(5-18*f+m+14*h-58*f*h+c/42*(61+179*m-m*f-479*f)))))+this.x0,n=this.a*(this.k0*(_-this.ml0+s*a*u/2*(1+c/12*(5-f+9*h+4*p+c/30*(61+m-58*f+270*h-330*f*h+c/56*(1385+543*m-m*f-3111*f))))))+this.y0}else{var y=l*Math.sin(a);if(Math.abs(Math.abs(y)-1)<lt)return 93;if(r=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,n=l*Math.cos(a)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(n))>=1){if(y-1>lt)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=r,t.y=n,t},inverse:function(t){var e,r,n,i,o=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,r=Le(e,this.es,this.en),Math.abs(r)<it){var s=Math.sin(r),l=Math.cos(r),u=Math.abs(l)>lt?Math.tan(r):0,c=this.ep2*Math.pow(l,2),h=Math.pow(c,2),p=Math.pow(u,2),d=Math.pow(p,2);e=1-this.es*Math.pow(s,2);var f=o*Math.sqrt(e)/this.k0,m=Math.pow(f,2);n=r-(e*=u)*m/(1-this.es)*.5*(1-m/12*(5+3*p-9*c*p+c-4*h-m/30*(61+90*p-252*c*p+45*d+46*c-m/56*(1385+3633*p+4095*d+1574*d*p)))),i=Vt(this.long0+f*(1-m/6*(1+2*p+c-m/20*(5+28*p+24*d+8*c*p+6*c-m/42*(61+662*p+1320*d+720*d*p))))/l)}else n=it*Nt(a),i=0;else{var _=Math.exp(o/this.k0),y=.5*(_-1/_),g=this.lat0+a/this.k0,v=Math.cos(g);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(y,2))),n=Math.asin(e),a<0&&(n=-n),i=0===y&&0===v?0:Vt(Math.atan2(y,v)+this.long0)}return t.x=i,t.y=n,t},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Oe=function(t){var e=Math.exp(t);return e=(e-1/e)/2},Fe=function(t,e){t=Math.abs(t),e=Math.abs(e);var r=Math.max(t,e),n=Math.min(t,e)/(r||1);return r*Math.sqrt(1+Math.pow(n,2))},Ne=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,r=e-1;return 0===r?t:t*Math.log(e)/r}(e*(1+e/(Fe(1,e)+1))),t<0?-e:e},Ve=function(t,e){for(var r,n=2*Math.cos(2*e),i=t.length-1,o=t[i],a=0;--i>=0;)r=n*o-a+t[i],a=o,o=r;return e+r*Math.sin(2*e)},je=function(t,e){for(var r,n=2*Math.cos(e),i=t.length-1,o=t[i],a=0;--i>=0;)r=n*o-a+t[i],a=o,o=r;return Math.sin(e)*r},Ue=function(t,e,r){for(var n,i,o=Math.sin(e),a=Math.cos(e),s=Oe(r),l=function(t){var e=Math.exp(t);return e=(e+1/e)/2}(r),u=2*a*l,c=-2*o*s,h=t.length-1,p=t[h],d=0,f=0,m=0;--h>=0;)n=f,i=d,p=u*(f=p)-n-c*(d=m)+t[h],m=c*f-i+u*d;return[(u=o*l)*p-(c=a*s)*m,u*m+c*p]};var qe={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),r=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),r*=e,this.cgb[1]=r*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=r*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),r*=e,this.cgb[2]=r*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=r*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),r*=e,this.cgb[3]=r*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=r*(1237/630+e*(e*(-24832/14175)-2.4)),r*=e,this.cgb[4]=r*(4174/315+e*(-144838/6237)),this.cbg[4]=r*(-734/315+e*(109598/31185)),r*=e,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+r*(.25+r*(1/64+r/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=r*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=r*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),r*=e,this.utg[2]=r*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=r*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),r*=e,this.utg[3]=r*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=r*(49561/161280+e*(-179/168+e*(6601661/7257600))),r*=e,this.utg[4]=r*(-4583/161280+e*(108847/3991680)),this.gtu[4]=r*(34729/80640+e*(-3418889/1995840)),r*=e,this.utg[5]=-.03233083094085698*r,this.gtu[5]=.6650675310896665*r;var n=Ve(this.cbg,this.lat0);this.Zb=-this.Qn*(n+je(this.gtu,2*n))},forward:function(t){var e=Vt(t.x-this.long0),r=t.y;r=Ve(this.cbg,r);var n=Math.sin(r),i=Math.cos(r),o=Math.sin(e),a=Math.cos(e);r=Math.atan2(n,a*i),e=Math.atan2(o*i,Fe(n,i*a)),e=Ne(Math.tan(e));var s,l,u=Ue(this.gtu,2*r,2*e);return r+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(s=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*r+this.Zb)+this.y0):(s=1/0,l=1/0),t.x=s,t.y=l,t},inverse:function(t){var e,r,n=(t.x-this.x0)*(1/this.a),i=(t.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var o=Ue(this.utg,2*i,2*n);i+=o[0],n+=o[1],n=Math.atan(Oe(n));var a=Math.sin(i),s=Math.cos(i),l=Math.sin(n),u=Math.cos(n);i=Math.atan2(a*u,Fe(l,u*s)),n=Math.atan2(l,u*s),e=Vt(n+this.long0),r=Ve(this.cgb,i)}else e=1/0,r=1/0;return t.x=e,t.y=r,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},Ge=function(t,e){if(void 0===t){if((t=Math.floor(30*(Vt(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t};var Ze={init:function(){var t=Ge(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*ut,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,qe.init.apply(this),this.forward=qe.forward,this.inverse=qe.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Xe=function(t,e){return Math.pow((1-t)/(1+t),e)},We=20;var He={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ht)/(Math.pow(Math.tan(.5*this.lat0+ht),this.C)*Xe(this.e*t,this.ratexp))},forward:function(t){var e=t.x,r=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+ht),this.C)*Xe(this.e*Math.sin(r),this.ratexp))-it,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,r=t.y,n=Math.pow(Math.tan(.5*r+ht)/this.K,1/this.C),i=We;i>0&&(r=2*Math.atan(n*Xe(this.e*Math.sin(t.y),-.5*this.e))-it,!(Math.abs(r-t.y)<1e-14));--i)t.y=r;return i?(t.x=e,t.y=r,t):null},names:["gauss"]};var Ye={init:function(){He.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,r,n,i;return t.x=Vt(t.x-this.long0),He.forward.apply(this,[t]),e=Math.sin(t.y),r=Math.cos(t.y),n=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*n),t.x=i*r*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*r*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,r,n,i,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),r=Math.cos(a),i=Math.asin(r*this.sinc0+t.y*e*this.cosc0/o),n=Math.atan2(t.x*e,o*this.cosc0*r-t.y*this.sinc0*e)}else i=this.phic0,n=0;return t.x=n,t.y=i,He.inverse.apply(this,[t]),t.x=Vt(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var Ke={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&(this.k0=.5*(1+Nt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=lt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=lt&&(this.k0=.5*this.cons*Ft(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/jt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ft(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-it,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,r,n,i,o,a,s=t.x,l=t.y,u=Math.sin(l),c=Math.cos(l),h=Vt(s-this.long0);return Math.abs(Math.abs(s-this.long0)-Math.PI)<=lt&&Math.abs(l+this.lat0)<=lt?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(h)),t.x=this.a*e*c*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(h))+this.y0,t):(r=2*Math.atan(this.ssfn_(l,u,this.e))-it,i=Math.cos(r),n=Math.sin(r),Math.abs(this.coslat0)<=lt?(o=jt(this.e,l*this.con,this.con*u),a=2*this.a*this.k0*o/this.cons,t.x=this.x0+a*Math.sin(s-this.long0),t.y=this.y0-this.con*a*Math.cos(s-this.long0),t):(Math.abs(this.sinlat0)<lt?(e=2*this.a*this.k0/(1+i*Math.cos(h)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*i*Math.cos(h))),t.y=e*(this.cosX0*n-this.sinX0*i*Math.cos(h))+this.y0),t.x=e*i*Math.sin(h)+this.x0,t))},inverse:function(t){var e,r,n,i,o;t.x-=this.x0,t.y-=this.y0;var a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,r=this.lat0,a<=lt?(t.x=e,t.y=r,t):(r=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/a),e=Math.abs(this.coslat0)<lt?this.lat0>0?Vt(this.long0+Math.atan2(t.x,-1*t.y)):Vt(this.long0+Math.atan2(t.x,t.y)):Vt(this.long0+Math.atan2(t.x*Math.sin(s),a*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=r,t)}if(Math.abs(this.coslat0)<=lt){if(a<=lt)return r=this.lat0,e=this.long0,t.x=e,t.y=r,t;t.x*=this.con,t.y*=this.con,n=a*this.cons/(2*this.a*this.k0),r=this.con*Ut(this.e,n),e=this.con*Vt(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=lt?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/a),e=Vt(this.long0+Math.atan2(t.x*Math.sin(i),a*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),r=-1*Ut(this.e,Math.tan(.5*(it+o)));return t.x=e,t.y=r,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,r){return e*=r,Math.tan(.5*(it+t))*Math.pow((1-e)/(1+e),.5*r)}};var Je={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),r=this.a,n=1/this.rf,i=2*n-Math.pow(n,2),o=this.e=Math.sqrt(i);this.R=this.k0*r*Math.sqrt(1-i)/(1-i*Math.pow(e,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*s+this.alpha*o/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+r)+this.K,i=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,r=t.y-this.y0,n=e/this.R,i=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n)),a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+a/this.alpha,l=0,u=o,c=-1e3,h=0;Math.abs(u-c)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=s,t.y=u,t},names:["somerc"]};var Qe={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),r=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-r*r);var n,i,o=jt(this.e,this.lat0,t),a=this.bl/e*Math.sqrt((1-this.es)/(1-r*r));if(a*a<1&&(a=1),isNaN(this.longc)){var s=jt(this.e,this.lat1,Math.sin(this.lat1)),l=jt(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(a+Math.sqrt(a*a-1))*Math.pow(o,this.bl):this.el=(a-Math.sqrt(a*a-1))*Math.pow(o,this.bl);var u=Math.pow(s,this.bl),c=Math.pow(l,this.bl);i=.5*((n=this.el/u)-1/n);var h=(this.el*this.el-c*u)/(this.el*this.el+c*u),p=(c-u)/(c+u),d=Vt(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*d)/p)/this.bl,this.long0=Vt(this.long0);var f=Vt(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/i),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else n=this.lat0>=0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=n*Math.pow(o,this.bl),i=.5*(n-1/n),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},forward:function(t){var e,r,n,i=t.x,o=t.y,a=Vt(i-this.long0);if(Math.abs(Math.abs(o)-it)<=lt)n=o>0?-1:1,r=this.al/this.bl*Math.log(Math.tan(ht+n*this.gamma0*.5)),e=-1*n*it*this.al/this.bl;else{var s=jt(this.e,o,Math.sin(o)),l=this.el/Math.pow(s,this.bl),u=.5*(l-1/l),c=.5*(l+1/l),h=Math.sin(this.bl*a),p=(u*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/c;r=Math.abs(Math.abs(p)-1)<=lt?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,e=Math.abs(Math.cos(this.bl*a))<=lt?this.al*this.bl*a:this.al*Math.atan2(u*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*a))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+r):(e-=this.uc,t.x=this.x0+r*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-r*Math.sin(this.alpha)),t},inverse:function(t){var e,r;this.no_rot?(r=t.y-this.y0,e=t.x-this.x0):(r=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var n=Math.exp(-1*this.bl*r/this.al),i=.5*(n-1/n),o=.5*(n+1/n),a=Math.sin(this.bl*e/this.al),s=(a*Math.cos(this.gamma0)+i*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+s)/(1-s)),1/this.bl);return Math.abs(s-1)<lt?(t.x=this.long0,t.y=it):Math.abs(s+1)<lt?(t.x=this.long0,t.y=-1*it):(t.y=Ut(this.e,l),t.x=Vt(this.long0-Math.atan2(i*Math.cos(this.gamma0)-a*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};var $e={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<lt)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),r=Math.cos(this.lat1),n=Ft(this.e,e,r),i=jt(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),s=Ft(this.e,o,a),l=jt(this.e,this.lat2,o),u=jt(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>lt?this.ns=Math.log(n/s)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,r=t.y;Math.abs(2*Math.abs(r)-Math.PI)<=lt&&(r=Nt(r)*(it-2*lt));var n,i,o=Math.abs(Math.abs(r)-it);if(o>lt)n=jt(this.e,r,Math.sin(r)),i=this.a*this.f0*Math.pow(n,this.ns);else{if((o=r*this.ns)<=0)return null;i=0}var a=this.ns*Vt(e-this.long0);return t.x=this.k0*(i*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-i*Math.cos(a))+this.y0,t},inverse:function(t){var e,r,n,i,o,a=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+s*s),r=1):(e=-Math.sqrt(a*a+s*s),r=-1);var l=0;if(0!==e&&(l=Math.atan2(r*a,r*s)),0!==e||this.ns>0){if(r=1/this.ns,n=Math.pow(e/(this.a*this.f0),r),-9999===(i=Ut(this.e,n)))return null}else i=-it;return o=Vt(l/this.ns+this.long0),t.x=o,t.y=i,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};var tr={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,r,n,i,o,a,s,l=t.x,u=t.y,c=Vt(l-this.long0);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),n=-c*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),o=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(i)),a=this.n*o,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=s*Math.cos(a)/1,t.x=s*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,r,n,i,o,a,s,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),r=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(e)),t.x=this.long0-r/this.alfa,a=e,s=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(s=1),a=t.y,u+=1}while(0===s&&u<15);return u>=15?null:t},names:["Krovak","krovak"]},er=function(t,e,r,n,i){return t*i-e*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)},rr=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},nr=function(t){return.375*t*(1+.25*t*(1+.46875*t))},ir=function(t){return.05859375*t*t*(1+.75*t)},or=function(t){return t*t*t*(35/3072)},ar=function(t,e,r){var n=e*r;return t/Math.sqrt(1-n*n)},sr=function(t){return Math.abs(t)<it?t:t-Nt(t)*Math.PI},lr=function(t,e,r,n,i){var o,a;o=t/e;for(var s=0;s<15;s++)if(o+=a=(t-(e*o-r*Math.sin(2*o)+n*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*n*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(a)<=1e-10)return o;return NaN};var ur={init:function(){this.sphere||(this.e0=rr(this.es),this.e1=nr(this.es),this.e2=ir(this.es),this.e3=or(this.es),this.ml0=this.a*er(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,r,n=t.x,i=t.y;if(n=Vt(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(n)),r=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0);else{var o=Math.sin(i),a=Math.cos(i),s=ar(this.a,this.e,o),l=Math.tan(i)*Math.tan(i),u=n*Math.cos(i),c=u*u,h=this.es*a*a/(1-this.es);e=s*u*(1-c*l*(1/6-(8-l+8*h)*c/120)),r=this.a*er(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*o/a*c*(.5+(5-l+6*h)*c/24)}return t.x=e+this.x0,t.y=r+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,r,n=t.x/this.a,i=t.y/this.a;if(this.sphere){var o=i+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(n)),r=Math.atan2(Math.tan(n),Math.cos(o))}else{var a=this.ml0/this.a+i,s=lr(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-it)<=lt)return t.x=this.long0,t.y=it,i<0&&(t.y*=-1),t;var l=ar(this.a,this.e,Math.sin(s)),u=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(s),2),h=n*this.a/l,p=h*h;e=s-l*Math.tan(s)/u*h*h*(.5-(1+3*c)*h*h/24),r=h*(1-p*(c/3+(1+3*c)*c*p/15))/Math.cos(s)}return t.x=Vt(r+this.long0),t.y=sr(e),t},names:["Cassini","Cassini_Soldner","cass"]},cr=function(t,e){var r;return t>1e-7?(1-t*t)*(e/(1-(r=t*e)*r)-.5/t*Math.log((1-r)/(1+r))):2*e};var hr=.3333333333333333,pr=.17222222222222222,dr=.10257936507936508,fr=.06388888888888888,mr=.0664021164021164,_r=.016415012942191543;var yr={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-it)<lt?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<lt?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=cr(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,r=[];return r[0]=t*hr,e=t*t,r[0]+=e*pr,r[1]=e*fr,e*=t,r[0]+=e*dr,r[1]+=e*mr,r[2]=e*_r,r}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=cr(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,r,n,i,o,a,s,l,u,c,h=t.x,p=t.y;if(h=Vt(h-this.long0),this.sphere){if(o=Math.sin(p),c=Math.cos(p),n=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+c*n:1+this.sinph0*o+this.cosph0*c*n)<=lt)return null;e=(r=Math.sqrt(2/r))*c*Math.sin(h),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(p+this.phi0)<lt)return null;r=ht-.5*p,e=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(h),r*=n}}else{switch(s=0,l=0,u=0,n=Math.cos(h),i=Math.sin(h),o=Math.sin(p),a=cr(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(s=a/this.qp,l=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:u=1+this.sinb1*s+this.cosb1*l*n;break;case this.EQUIT:u=1+l*n;break;case this.N_POLE:u=it+p,a=this.qp-a;break;case this.S_POLE:u=p-it,a=this.qp+a}if(Math.abs(u)<lt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),r=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*s-this.sinb1*l*n):(u=Math.sqrt(2/(1+l*n)))*s*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*i,r=n*(this.mode===this.S_POLE?u:-u)):e=r=0}}return t.x=this.a*e+this.x0,t.y=this.a*r+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,r,n,i,o,a,s,l=t.x/this.a,u=t.y/this.a;if(this.sphere){var c,h=0,p=0;if((r=.5*(c=Math.sqrt(l*l+u*u)))>1)return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(r),h=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(c)<=lt?0:Math.asin(u*p/c),l*=p,u=h*c;break;case this.OBLIQ:r=Math.abs(c)<=lt?this.phi0:Math.asin(h*this.sinph0+u*p*this.cosph0/c),l*=p*this.cosph0,u=(h-Math.sin(r)*this.sinph0)*c;break;case this.N_POLE:u=-u,r=it-r;break;case this.S_POLE:r-=it}e=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,u):0}else{if(s=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,u*=this.dd,(a=Math.sqrt(l*l+u*u))<lt)return t.x=0,t.y=this.phi0,t;i=2*Math.asin(.5*a/this.rq),n=Math.cos(i),l*=i=Math.sin(i),this.mode===this.OBLIQ?(s=n*this.sinb1+u*i*this.cosb1/a,o=this.qp*s,u=a*this.cosb1*n-u*this.sinb1*i):(s=u*i/a,o=this.qp*s,u=a*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),!(o=l*l+u*u))return t.x=0,t.y=this.phi0,t;s=1-o/this.qp,this.mode===this.S_POLE&&(s=-s)}e=Math.atan2(l,u),r=function(t,e){var r=t+t;return t+e[0]*Math.sin(r)+e[1]*Math.sin(r+r)+e[2]*Math.sin(r+r+r)}(Math.asin(s),this.apa)}return t.x=Vt(this.long0+e),t.y=r,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},gr=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)};var vr={init:function(){Math.abs(this.lat1+this.lat2)<lt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ft(this.e3,this.sin_po,this.cos_po),this.qs1=cr(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ft(this.e3,this.sin_po,this.cos_po),this.qs2=cr(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=cr(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>lt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,r=t.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var n=cr(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*Vt(e-this.long0),a=i*Math.sin(o)+this.x0,s=this.rh-i*Math.cos(o)+this.y0;return t.x=a,t.y=s,t},inverse:function(t){var e,r,n,i,o,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),i=0,0!==e&&(i=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-n*n)/(2*this.ns0)):(r=(this.c-n*n)/this.ns0,a=this.phi1z(this.e3,r)),o=Vt(i/this.ns0+this.long0),t.x=o,t.y=a,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var r,n,i,o,a,s=gr(.5*e);if(t<lt)return s;for(var l=t*t,u=1;u<=25;u++)if(r=Math.sin(s),n=Math.cos(s),s+=a=.5*(o=1-(i=t*r)*i)*o/n*(e/(1-l)-r/o+.5/t*Math.log((1-i)/(1+i))),Math.abs(a)<=1e-7)return s;return null}};var br={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,r,n,i,o,a,s,l=t.x,u=t.y;return n=Vt(l-this.long0),e=Math.sin(u),r=Math.cos(u),i=Math.cos(n),(o=this.sin_p14*e+this.cos_p14*r*i)>0||Math.abs(o)<=lt?(a=this.x0+1*this.a*r*Math.sin(n)/o,s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*r*i)/o):(a=this.x0+this.infinity_dist*r*Math.sin(n),s=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*i)),t.x=a,t.y=s,t},inverse:function(t){var e,r,n,i,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),r=Math.sin(i),n=Math.cos(i),a=gr(n*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.atan2(t.x*r,e*this.cos_p14*n-t.y*this.sin_p14*r),o=Vt(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t},names:["gnom"]},xr=function(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6)return e<0?-1*it:it;for(var n,i,o,a,s=Math.asin(.5*e),l=0;l<30;l++)if(i=Math.sin(s),o=Math.cos(s),a=t*i,s+=n=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-i/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),Math.abs(n)<=1e-10)return s;return NaN};var wr={init:function(){this.sphere||(this.k0=Ft(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,r,n=t.x,i=t.y,o=Vt(n-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var a=cr(this.e,Math.sin(i));e=this.x0+this.a*this.k0*o,r=this.y0+this.a*a*.5/this.k0}return t.x=e,t.y=r,t},inverse:function(t){var e,r;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Vt(this.long0+t.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(r=xr(this.e,2*t.y*this.k0/this.a),e=Vt(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=r,t},names:["cea"]};var kr={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,r=t.y,n=Vt(e-this.long0),i=sr(r-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*i,t},inverse:function(t){var e=t.x,r=t.y;return t.x=Vt(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=sr(this.lat0+(r-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Er=20;var Ir={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=rr(this.es),this.e1=nr(this.es),this.e2=ir(this.es),this.e3=or(this.es),this.ml0=this.a*er(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,r,n,i=t.x,o=t.y,a=Vt(i-this.long0);if(n=a*Math.sin(o),this.sphere)Math.abs(o)<=lt?(e=this.a*a,r=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(o),r=this.a*(sr(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=lt)e=this.a*a,r=-1*this.ml0;else{var s=ar(this.a,this.e,Math.sin(o))/Math.tan(o);e=s*Math.sin(n),r=this.a*er(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(n))}return t.x=e+this.x0,t.y=r+this.y0,t},inverse:function(t){var e,r,n,i,o,a,s,l,u;if(n=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=lt)e=Vt(n/this.a+this.long0),r=0;else{var c;for(a=this.lat0+i/this.a,s=n*n/this.a/this.a+a*a,l=a,o=Er;o;--o)if(l+=u=-1*(a*(l*(c=Math.tan(l))+1)-l-.5*(l*l+s)*c)/((l-a)/c-1),Math.abs(u)<=lt){r=l;break}e=Vt(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(r))}else if(Math.abs(i+this.ml0)<=lt)r=0,e=Vt(this.long0+n/this.a);else{var h,p,d,f,m;for(a=(this.ml0+i)/this.a,s=n*n/this.a/this.a+a*a,l=a,o=Er;o;--o)if(m=this.e*Math.sin(l),h=Math.sqrt(1-m*m)*Math.tan(l),p=this.a*er(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=u=(a*(h*(f=p/this.a)+1)-f-.5*h*(f*f+s))/(this.es*Math.sin(2*l)*(f*f+s-2*a*f)/(4*h)+(a-f)*(h*d-2/Math.sin(2*l))-d),Math.abs(u)<=lt){r=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),e=Vt(this.long0+Math.asin(n*h/this.a)/Math.sin(r))}return t.x=e,t.y=r,t},names:["Polyconic","poly"]};var Sr={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,r=t.x,n=t.y-this.lat0,i=r-this.long0,o=n/nt*1e-5,a=i,s=1,l=0;for(e=1;e<=10;e++)s*=o,l+=this.A[e]*s;var u,c=l,h=a,p=1,d=0,f=0,m=0;for(e=1;e<=6;e++)u=d*c+p*h,p=p*c-d*h,d=u,f=f+this.B_re[e]*p-this.B_im[e]*d,m=m+this.B_im[e]*p+this.B_re[e]*d;return t.x=m*this.a+this.x0,t.y=f*this.a+this.y0,t},inverse:function(t){var e,r,n=t.x,i=t.y,o=n-this.x0,a=(i-this.y0)/this.a,s=o/this.a,l=1,u=0,c=0,h=0;for(e=1;e<=6;e++)r=u*a+l*s,l=l*a-u*s,u=r,c=c+this.C_re[e]*l-this.C_im[e]*u,h=h+this.C_im[e]*l+this.C_re[e]*u;for(var p=0;p<this.iterations;p++){var d,f=c,m=h,_=a,y=s;for(e=2;e<=6;e++)d=m*c+f*h,f=f*c-m*h,m=d,_+=(e-1)*(this.B_re[e]*f-this.B_im[e]*m),y+=(e-1)*(this.B_im[e]*f+this.B_re[e]*m);f=1,m=0;var g=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)d=m*c+f*h,f=f*c-m*h,m=d,g+=e*(this.B_re[e]*f-this.B_im[e]*m),v+=e*(this.B_im[e]*f+this.B_re[e]*m);var b=g*g+v*v;c=(_*g+y*v)/b,h=(y*g-_*v)/b}var x=c,w=h,k=1,E=0;for(e=1;e<=9;e++)k*=x,E+=this.D[e]*k;var I=this.lat0+E*nt*1e5,S=this.long0+w;return t.x=S,t.y=I,t},names:["New_Zealand_Map_Grid","nzmg"]};var Mr={init:function(){},forward:function(t){var e=t.x,r=t.y,n=Vt(e-this.long0),i=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return t.x=i,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Vt(this.long0+t.x/this.a),r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=r,t},names:["Miller_Cylindrical","mill"]},Tr=20;var Ar={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ze(this.es)},forward:function(t){var e,r,n=t.x,i=t.y;if(n=Vt(n-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),a=Tr;a;--a){var s=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<lt)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;e=this.a*this.C_x*n*(this.m+Math.cos(i)),r=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);r=this.a*Be(i,l,u,this.en),e=this.a*n*u/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=r,t},inverse:function(t){var e,r,n,i;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=gr((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=gr(Math.sin(e)/this.n)),n=Vt(n+this.long0),e=sr(e)):(e=Le(t.y/this.a,this.es,this.en),(i=Math.abs(e))<it?(i=Math.sin(e),r=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),n=Vt(r)):i-lt<it&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]};var Pr={init:function(){},forward:function(t){for(var e=t.x,r=t.y,n=Vt(e-this.long0),i=r,o=Math.PI*Math.sin(r);;){var a=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=a,Math.abs(a)<lt)break}i/=2,Math.PI/2-Math.abs(r)<lt&&(n=0);var s=.900316316158*this.a*n*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=s,t.y=l,t},inverse:function(t){var e,r;t.x-=this.x0,t.y-=this.y0,r=t.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),e=Math.asin(r);var n=Vt(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),r=(2*e+Math.sin(2*e))/Math.PI,Math.abs(r)>1&&(r=1);var i=Math.asin(r);return t.x=n,t.y=i,t},names:["Mollweide","moll"]};var Cr={init:function(){Math.abs(this.lat1+this.lat2)<lt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=rr(this.es),this.e1=nr(this.es),this.e2=ir(this.es),this.e3=or(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Ft(this.e,this.sinphi,this.cosphi),this.ml1=er(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<lt?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Ft(this.e,this.sinphi,this.cosphi),this.ml2=er(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=er(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,r=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var i=er(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-i)}var o=this.ns*Vt(r-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t},inverse:function(t){var e,r,n,i;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(r=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(r=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==r&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=Vt(this.long0+o/this.ns),n=sr(this.g-r/this.a),t.x=i,t.y=n,t;var a=this.g-r/this.a;return n=lr(a,this.e0,this.e1,this.e2,this.e3),i=Vt(this.long0+o/this.ns),t.x=i,t.y=n,t},names:["Equidistant_Conic","eqdc"]};var Dr={init:function(){this.R=this.a},forward:function(t){var e,r,n=t.x,i=t.y,o=Vt(n-this.long0);Math.abs(i)<=lt&&(e=this.x0+this.R*o,r=this.y0);var a=gr(2*Math.abs(i/Math.PI));(Math.abs(o)<=lt||Math.abs(Math.abs(i)-it)<=lt)&&(e=this.x0,r=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var s=.5*Math.abs(Math.PI/o-o/Math.PI),l=s*s,u=Math.sin(a),c=Math.cos(a),h=c/(u+c-1),p=h*h,d=h*(2/u-1),f=d*d,m=Math.PI*this.R*(s*(h-f)+Math.sqrt(l*(h-f)*(h-f)-(f+l)*(p-f)))/(f+l);o<0&&(m=-m),e=this.x0+m;var _=l+h;return m=Math.PI*this.R*(d*_-s*Math.sqrt((f+l)*(l+1)-_*_))/(f+l),r=i>=0?this.y0+m:this.y0-m,t.x=e,t.y=r,t},inverse:function(t){var e,r,n,i,o,a,s,l,u,c,h,p;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,o=(n=t.x/h)*n+(i=t.y/h)*i,h=3*(i*i/(l=-2*(a=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(s=a-2*i*i+n*n)*s*s/l/l/l-9*a*s/l/l)/27)/(u=(a-s*s/3/l)/l)/(c=2*Math.sqrt(-u/3)),Math.abs(h)>1&&(h=h>=0?1:-1),p=Math.acos(h)/3,r=t.y>=0?(-c*Math.cos(p+Math.PI/3)-s/3/l)*Math.PI:-(-c*Math.cos(p+Math.PI/3)-s/3/l)*Math.PI,e=Math.abs(n)<lt?this.long0:Vt(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-i*i)+o*o))/2/n),t.x=e,t.y=r,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var zr={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,r,n,i,o,a,s,l,u,c,h,p,d,f,m,_,y,g,v,b,x,w,k=t.x,E=t.y,I=Math.sin(t.y),S=Math.cos(t.y),M=Vt(k-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=lt?(t.x=this.x0+this.a*(it-E)*Math.sin(M),t.y=this.y0-this.a*(it-E)*Math.cos(M),t):Math.abs(this.sin_p12+1)<=lt?(t.x=this.x0+this.a*(it+E)*Math.sin(M),t.y=this.y0+this.a*(it+E)*Math.cos(M),t):(g=this.sin_p12*I+this.cos_p12*S*Math.cos(M),y=(_=Math.acos(g))/Math.sin(_),t.x=this.x0+this.a*y*S*Math.sin(M),t.y=this.y0+this.a*y*(this.cos_p12*I-this.sin_p12*S*Math.cos(M)),t):(e=rr(this.es),r=nr(this.es),n=ir(this.es),i=or(this.es),Math.abs(this.sin_p12-1)<=lt?(o=this.a*er(e,r,n,i,it),a=this.a*er(e,r,n,i,E),t.x=this.x0+(o-a)*Math.sin(M),t.y=this.y0-(o-a)*Math.cos(M),t):Math.abs(this.sin_p12+1)<=lt?(o=this.a*er(e,r,n,i,it),a=this.a*er(e,r,n,i,E),t.x=this.x0+(o+a)*Math.sin(M),t.y=this.y0+(o+a)*Math.cos(M),t):(s=I/S,l=ar(this.a,this.e,this.sin_p12),u=ar(this.a,this.e,I),c=Math.atan((1-this.es)*s+this.es*l*this.sin_p12/(u*S)),v=0===(h=Math.atan2(Math.sin(M),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(M)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(h)-Math.PI)<=lt?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(M)*Math.cos(c)/Math.sin(h)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),_=l*v*(1-(b=v*v)*(m=(d=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*d)*(1-m)/6+(x=b*v)/8*(f=p*d)*(1-2*m)+(w=x*v)/120*(m*(4-7*m)-3*p*p*(1-7*m))-w*v/48*f),t.x=this.x0+_*Math.sin(h),t.y=this.y0+_*Math.cos(h),t))},inverse:function(t){var e,r,n,i,o,a,s,l,u,c,h,p,d,f,m,_,y,g,v,b,x,w;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*it*this.a)return;return r=e/this.a,n=Math.sin(r),i=Math.cos(r),o=this.long0,Math.abs(e)<=lt?a=this.lat0:(a=gr(i*this.sin_p12+t.y*n*this.cos_p12/e),s=Math.abs(this.lat0)-it,o=Math.abs(s)<=lt?this.lat0>=0?Vt(this.long0+Math.atan2(t.x,-t.y)):Vt(this.long0-Math.atan2(-t.x,t.y)):Vt(this.long0+Math.atan2(t.x*n,e*this.cos_p12*i-t.y*this.sin_p12*n))),t.x=o,t.y=a,t}return l=rr(this.es),u=nr(this.es),c=ir(this.es),h=or(this.es),Math.abs(this.sin_p12-1)<=lt?(p=this.a*er(l,u,c,h,it),e=Math.sqrt(t.x*t.x+t.y*t.y),a=lr((p-e)/this.a,l,u,c,h),o=Vt(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=lt?(p=this.a*er(l,u,c,h,it),e=Math.sqrt(t.x*t.x+t.y*t.y),a=lr((e-p)/this.a,l,u,c,h),o=Vt(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),d=ar(this.a,this.e,this.sin_p12),_=Math.cos(m),g=-(y=this.e*this.cos_p12*_)*y/(1-this.es),v=3*this.es*(1-g)*this.sin_p12*this.cos_p12*_/(1-this.es),w=1-g*(x=(b=e/d)-g*(1+g)*Math.pow(b,3)/6-v*(1+3*g)*Math.pow(b,4)/24)*x/2-b*x*x*x/6,f=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*_),o=Vt(this.long0+Math.asin(Math.sin(m)*Math.sin(x)/Math.cos(f))),a=Math.atan((1-this.es*w*this.sin_p12/Math.sin(f))*Math.tan(f)/(1-this.es)),t.x=o,t.y=a,t)},names:["Azimuthal_Equidistant","aeqd"]};var Br={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,r,n,i,o,a,s,l=t.x,u=t.y;return n=Vt(l-this.long0),e=Math.sin(u),r=Math.cos(u),i=Math.cos(n),((o=this.sin_p14*e+this.cos_p14*r*i)>0||Math.abs(o)<=lt)&&(a=1*this.a*r*Math.sin(n),s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*r*i)),t.x=a,t.y=s,t},inverse:function(t){var e,r,n,i,o,a,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),r=gr(e/this.a),n=Math.sin(r),i=Math.cos(r),a=this.long0,Math.abs(e)<=lt?(s=this.lat0,t.x=a,t.y=s,t):(s=gr(i*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.abs(this.lat0)-it,Math.abs(o)<=lt?(a=this.lat0>=0?Vt(this.long0+Math.atan2(t.x,-t.y)):Vt(this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=s,t):(a=Vt(this.long0+Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n)),t.x=a,t.y=s,t))},names:["ortho"]},Lr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Rr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Or(t,e,r,n){var i;return t<lt?(n.value=Rr.AREA_0,i=0):(i=Math.atan2(e,r),Math.abs(i)<=ht?n.value=Rr.AREA_0:i>ht&&i<=it+ht?(n.value=Rr.AREA_1,i-=it):i>it+ht||i<=-(it+ht)?(n.value=Rr.AREA_2,i=i>=0?i-dt:i+dt):(n.value=Rr.AREA_3,i+=it)),i}function Fr(t,e){var r=t+e;return r<-dt?r+=pt:r>+dt&&(r-=pt),r}var Nr={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=it-ht/2?this.face=Lr.TOP:this.lat0<=-(it-ht/2)?this.face=Lr.BOTTOM:Math.abs(this.long0)<=ht?this.face=Lr.FRONT:Math.abs(this.long0)<=it+ht?this.face=this.long0>0?Lr.RIGHT:Lr.LEFT:this.face=Lr.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,r,n,i,o,a,s={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,r=t.x,this.face===Lr.TOP)i=it-e,r>=ht&&r<=it+ht?(l.value=Rr.AREA_0,n=r-it):r>it+ht||r<=-(it+ht)?(l.value=Rr.AREA_1,n=r>0?r-dt:r+dt):r>-(it+ht)&&r<=-ht?(l.value=Rr.AREA_2,n=r+it):(l.value=Rr.AREA_3,n=r);else if(this.face===Lr.BOTTOM)i=it+e,r>=ht&&r<=it+ht?(l.value=Rr.AREA_0,n=-r+it):r<ht&&r>=-ht?(l.value=Rr.AREA_1,n=-r):r<-ht&&r>=-(it+ht)?(l.value=Rr.AREA_2,n=-r-it):(l.value=Rr.AREA_3,n=r>0?-r+dt:-r-dt);else{var u,c,h,p,d,f;this.face===Lr.RIGHT?r=Fr(r,+it):this.face===Lr.BACK?r=Fr(r,+dt):this.face===Lr.LEFT&&(r=Fr(r,-it)),p=Math.sin(e),d=Math.cos(e),f=Math.sin(r),u=d*Math.cos(r),c=d*f,h=p,this.face===Lr.FRONT?n=Or(i=Math.acos(u),h,c,l):this.face===Lr.RIGHT?n=Or(i=Math.acos(c),h,-u,l):this.face===Lr.BACK?n=Or(i=Math.acos(-u),h,-c,l):this.face===Lr.LEFT?n=Or(i=Math.acos(-c),h,u,l):(i=n=0,l.value=Rr.AREA_0)}return a=Math.atan(12/dt*(n+Math.acos(Math.sin(n)*Math.cos(ht))-it)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(n))))),l.value===Rr.AREA_1?a+=it:l.value===Rr.AREA_2?a+=dt:l.value===Rr.AREA_3&&(a+=1.5*dt),s.x=o*Math.cos(a),s.y=o*Math.sin(a),s.x=s.x*this.a+this.x0,s.y=s.y*this.a+this.y0,t.x=s.x,t.y=s.y,t},inverse:function(t){var e,r,n,i,o,a,s,l,u,c,h,p,d={lam:0,phi:0},f={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?f.value=Rr.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(f.value=Rr.AREA_1,e-=it):t.x<0&&-t.x>=Math.abs(t.y)?(f.value=Rr.AREA_2,e=e<0?e+dt:e-dt):(f.value=Rr.AREA_3,e+=it),u=dt/12*Math.tan(e),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),(s=1-(n=Math.cos(e))*n*(i=Math.tan(r))*i*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?s=-1:s>1&&(s=1),this.face===Lr.TOP)l=Math.acos(s),d.phi=it-l,f.value===Rr.AREA_0?d.lam=a+it:f.value===Rr.AREA_1?d.lam=a<0?a+dt:a-dt:f.value===Rr.AREA_2?d.lam=a-it:d.lam=a;else if(this.face===Lr.BOTTOM)l=Math.acos(s),d.phi=l-it,f.value===Rr.AREA_0?d.lam=-a+it:f.value===Rr.AREA_1?d.lam=-a:f.value===Rr.AREA_2?d.lam=-a-it:d.lam=a<0?-a-dt:-a+dt;else{var m,_,y;u=(m=s)*m,_=(u+=(y=u>=1?0:Math.sqrt(1-u)*Math.sin(a))*y)>=1?0:Math.sqrt(1-u),f.value===Rr.AREA_1?(u=_,_=-y,y=u):f.value===Rr.AREA_2?(_=-_,y=-y):f.value===Rr.AREA_3&&(u=_,_=y,y=-u),this.face===Lr.RIGHT?(u=m,m=-_,_=u):this.face===Lr.BACK?(m=-m,_=-_):this.face===Lr.LEFT&&(u=m,m=_,_=-u),d.phi=Math.acos(-y)-it,d.lam=Math.atan2(_,m),this.face===Lr.RIGHT?d.lam=Fr(d.lam,-it):this.face===Lr.BACK?d.lam=Fr(d.lam,-dt):this.face===Lr.LEFT&&(d.lam=Fr(d.lam,+it))}return 0!==this.es&&(c=d.phi<0?1:0,h=Math.tan(d.phi),p=this.b/Math.sqrt(h*h+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),c&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Vr=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],jr=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ur=.8487,qr=1.3523,Gr=ct/5,Zr=1/Gr,Xr=18,Wr=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},Hr=function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])};var Yr={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Vt(t.x-this.long0),r=Math.abs(t.y),n=Math.floor(r*Gr);n<0?n=0:n>=Xr&&(n=Xr-1),r=ct*(r-Zr*n);var i={x:Wr(Vr[n],r)*e,y:Wr(jr[n],r)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*Ur+this.x0,i.y=i.y*this.a*qr+this.y0,i},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*Ur),y:Math.abs(t.y-this.y0)/(this.a*qr)};if(e.y>=1)e.x/=Vr[Xr][0],e.y=t.y<0?-it:it;else{var r=Math.floor(e.y*Xr);for(r<0?r=0:r>=Xr&&(r=Xr-1);;)if(jr[r][0]>e.y)--r;else{if(!(jr[r+1][0]<=e.y))break;++r}var n=jr[r],i=5*(e.y-n[0])/(jr[r+1][0]-n[0]);i=function(t,e,r,n){for(var i=e;n;--n){var o=t(i);if(i-=o,Math.abs(o)<r)break}return i}(function(t){return(Wr(n,t)-e.y)/Hr(n,t)},i,lt,100),e.x/=Wr(Vr[r],i),e.y=(5*r+i)*ut,t.y<0&&(e.y=-e.y)}return e.x=Vt(e.x+this.long0),e},names:["Robinson","robin"]};he.defaultDatum="WGS84",he.Proj=te,he.WGS84=new he.Proj("WGS84"),he.Point=Pe,he.toPoint=ie,he.defs=zt,he.transform=se,he.mgrs=be,he.version=Ce.a,function(t){t.Proj.projections.add(Re),t.Proj.projections.add(qe),t.Proj.projections.add(Ze),t.Proj.projections.add(Ye),t.Proj.projections.add(Ke),t.Proj.projections.add(Je),t.Proj.projections.add(Qe),t.Proj.projections.add($e),t.Proj.projections.add(tr),t.Proj.projections.add(ur),t.Proj.projections.add(yr),t.Proj.projections.add(vr),t.Proj.projections.add(br),t.Proj.projections.add(wr),t.Proj.projections.add(kr),t.Proj.projections.add(Ir),t.Proj.projections.add(Sr),t.Proj.projections.add(Mr),t.Proj.projections.add(Ar),t.Proj.projections.add(Pr),t.Proj.projections.add(Cr),t.Proj.projections.add(Dr),t.Proj.projections.add(zr),t.Proj.projections.add(Br),t.Proj.projections.add(Nr),t.Proj.projections.add(Yr)}(he);var Kr=he,Jr=(r(301),function(){function t(t){this.options=t,this._status=!0,this._status=void 0!==this.options.status?this.options.status:this._status,this._container=this._createContainer(),this._updateContainer()}return t.prototype.getContainer=function(){return this._container},t.prototype.toggle=function(t){void 0===t&&(t=!this._status),this._status=t,this._updateContainer()},t.prototype._createContainer=function(){var t=this,e=document.createElement("div");return e.className="panel__toggler",this.options.className&&this.options.className.split(" ").forEach(function(t){return e.classList.add(t)}),this.options.toggleAction&&e.addEventListener("click",function(){t.toggle(),t.options.toggleAction(t._status)}),e},t.prototype._updateContainer=function(){this._container.title=this._status?this.options.title:this.options.titleOff,this._status?this._container.classList.add("active"):this._container.classList.remove("active")},t}());var Qr=function(){function t(t){this.periodsPanelControl=new K,this.yearsStatPanelControl=new Q,this.emitter=new n.EventEmitter,this._layersConfig=[],this._onDataLoadEvents=[],this._layersLoaded={},this._pointsConfig=[],this._markers=[],this.options=Object.assign({},this.options,t);var e=this.options,r=e.fromYear,i=e.currentYear;r&&i&&i<r&&(this.options.currentYear=r),this.currentYear=this.options.currentYear,this.createWebMap(),this._buildApp()}return t.prototype.createWebMap=function(){var t=this,e=Object.assign({},this.options),r=new C({mapAdapter:new U,starterKits:[new q]});return r.create(e).then(function(){r.addBaseLayer("sputnik","QMS",{qmsid:487}).then(function(t){r.map.showLayer(t.name)}),r.map.addControl("ZOOM","top-left"),r.map.addControl("ATTRIBUTION","bottom-left",{customAttribution:['<a href="http://nextgis.ru" target="_blank">©NextGIS</a>']}),r.map.emitter.on("data-loaded",function(e){return t._onData(e)})}),this.webMap=r,r},t.prototype.updateByYear=function(t,e){var r=this._getLayerIdByYear(t,e);this.updateLayer(r),this.updateDataByYear(t)},t.prototype.updateDataByYear=function(t){var e=this._getPointIdByYear(t);this.updatePoint(e),this._updatePeriodBlockByYear(t),this._updateYearStatBlockByYear(t)},t.prototype.updateLayer=function(t){var e=this.currentLayerId;this.currentLayerId=t,this._switchLayer(e,t)},t.prototype.updatePoint=function(t){t!==this.currentPointId&&(this.currentPointId&&this._markers.forEach(function(t){t.remove()}),this.currentPointId=t,t&&this._addPoint(t))},t.prototype._buildApp=function(){var t=this;!function(t){p&&setTimeout(function(){t(p)})}(function(e){t._layersConfig=t._processLayersMeta(e),t._layersConfig.sort(function(t,e){return t.from<e.from?-1:1}),t.slider=t._createSlider(),t._bottomLink=function(){var t=document.createElement("div");t.innerHTML='\n    <div class="transneft__logo"></div>\n\n    <span class="socialLinks" style="height: 20px;">\n      <a href="http://twitter.com/#!/runivers" class="social__logo twitter"></a>\n      <a href="http://www.facebook.com/Runiverse.ru" class="social__logo facebook"></a>\n      <a href="http://vk.com/public35690973" class="social__logo vkontakte"></a>\n      <a href="http://runivers.livejournal.com/" class="social__logo livejournal"></a>\n    </span>\n  ';var e=new H({addClass:"bottom-links"});return e.updateBody(t),e}(),t._topLink=function(t){var e=document.createElement("div"),r=new Jr({className:"period__toggler",title:"Скрыть панель правителей",titleOff:"Показать панель правителей",toggleAction:function(e){e?t.periodsPanelControl.show():t.periodsPanelControl.hide()}});e.appendChild(r.getContainer()),t.periodsPanelControl.emitter.on("toggle",function(t){r.toggle(t)});var n=new Jr({className:"years__toggler",title:"Скрыть панель изменения в территориальной целостности",titleOff:"Показать панель изменения в территориальной целостности",toggleAction:function(e){e?(t.yearsStatPanelControl.show(),t.yearsStatPanelControl._blocked=!1):(t.yearsStatPanelControl.hide(),t.yearsStatPanelControl._blocked=!0)}});t.yearsStatPanelControl.emitter.on("toggle",function(t){n.toggle(t)}),e.appendChild(n.getContainer());var i=new H({addClass:"bottom-links"});return i.updateBody(e),i}(t),t.webMap.map.addControl(t._topLink,"top-right"),t.webMap.map.addControl(t.periodsPanelControl,"top-right"),t.webMap.map.addControl(t.yearsStatPanelControl,"top-right"),t.webMap.map.addControl(t._bottomLink,"bottom-right"),t._headerElement=t._createHeader(),t.webMap.map.onMapLoad(function(){t.updateByYear(t.currentYear)}),t.emitter.emit("build")}),m.makeQuery("/api/resource/?parent={id}",{id:h.pointsGroupId}).then(function(e){t._pointsConfig=t._processPointsMeta(e);var r=t._getPointIdByYear(t.currentYear);t.updatePoint(r)})},t.prototype._createSlider=function(){var t=this,e=new u({min:this._minYear,max:this._maxYear,step:1,animationStep:this.options.animationStep,value:this.currentYear,animationDelay:this.options.animationDelay,stepReady:function(e,r,n){return t._stepReady(e,r,n)}});return e.emitter.on("change",function(e){e!==t.currentYear&&(t.currentYear=e,t.updateByYear(e))}),this.webMap.map.getContainer().appendChild(e.onAdd(this.webMap)),e},t.prototype._createHeader=function(){var t=document.createElement("div");return t.className="font-effect-outline app-header",t.innerHTML="Границы России "+this._minYear+"-"+this._maxYear+" гг.",this.webMap.map.getContainer().appendChild(t),t},t.prototype._updatePeriodBlockByYear=function(t){var e=this._findPeriodByYear(t);this.periodsPanelControl.updatePeriod(e)},t.prototype._findPeriodByYear=function(t){return t=parseInt(t,10),(this.options.periods||[]).find(function(e){return t>=e.years_from&&t<=e.years_to})},t.prototype._updateYearStatBlockByYear=function(t){var e=this._findYearStatsByYear(t);this.yearsStatPanelControl.updateYearStats(e)},t.prototype._findYearInDateStr=function(t){var e=/(\d{4})/.exec(t);return Number(e[0])},t.prototype._findYearStatsByYear=function(t){var e=this;return t=Number(t),(this.options.yearsStat||[]).filter(function(r){var n=e._findYearInDateStr(r.date_from);return t===n})},t.prototype._switchLayer=function(t,e){this._removePopup(),e&&t!==e&&(this._showLayer(e),this._addLayerListeners(e),t&&(this._removeLayerListeners(t),this._setLayerOpacity(e,0)))},t.prototype._stepReady=function(t,e,r){var n=this,i=this._getLayerByYear(t,r);if(i||(i=this._getNextLayer(t,r)),i){var o=t,a=function(){n.currentYear=o,e(o)};this.currentLayerId!==String(i.id)?(this._onDataLoadEvents.push(a),this.updateLayer(String(i.id))):a(),this.updateDataByYear(o)}else e(r?this._minYear:this._maxYear)},t.prototype._isHistoryLayer=function(t){return!this.webMap.isBaseLayer(t)},t.prototype._onData=function(t){var e=t.target,r=this._layersLoaded[e],n=t.target===this.currentLayerId||t.target===this.currentLayerId+"-bound";!r&&this._isHistoryLayer(t.target)&&n&&(this._layersLoaded[e]=!0,this._onSourceIsLoaded())},t.prototype._onSourceIsLoaded=function(){if(this._layersLoaded[this.currentLayerId]&&this._layersLoaded[this.currentLayerId+"-bound"]){this._hideNotCurrentLayers(),this._setLayerOpacity(this.currentLayerId,.8);for(var t=0;t<this._onDataLoadEvents.length;t++){(0,this._onDataLoadEvents[t])()}this._onDataLoadEvents=[]}},t.prototype._hideNotCurrentLayers=function(){var t=this;this.webMap.map.getLayers().forEach(function(e){t.webMap.isBaseLayer(e)||!(e===t.currentLayerId||e===t.currentLayerId+"-bound")&&t.webMap.map.isLayerOnTheMap(e)&&t._hideLayer(e)})},t.prototype._hideLayer=function(t){this._toggleLayer(t,!1)},t.prototype._showLayer=function(t){var e=this,r=function(){e.webMap.map.toggleLayer(t,!0),e.webMap.map.toggleLayer(t+"-bound",!0)};if(this.webMap.map.getLayer(t))r();else{var n=this.options.baseUrl+"/api/resource/"+t+"/{z}/{x}/{y}.mvt";this._addLayer(n,t).then(function(){r()})}},t.prototype._setLayerOpacity=function(t,e){this.webMap.map.setLayerOpacity(t,e),this.webMap.map.setLayerOpacity(t+"-bound",e)},t.prototype._addPoint=function(t){var e=this;(function(t){return m.makeQuery("/api/resource/{id}/geojson",{id:t})})(t).then(function(t){var r=t.features.length>1;t.features.forEach(function(t,n){var i=t&&t.geometry&&t.geometry.type;"MultiPoint"===i?t.geometry.coordinates.forEach(function(i){e._addMarkerToMap(i,t.properties,r&&n)}):"Point"===i&&e._addMarkerToMap(t.geometry.coordinates,t.properties,r&&n)})})},t.prototype._addMarkerToMap=function(t,e,r){var n=this,i=this.webMap.map.map,o=document.createElement("div");o.className="map-marker",o.innerHTML="boolean"!=typeof r?'<div class="map-marker__label">'+(r+1)+"</div>":"";var a=Kr("EPSG:3857").inverse(t),s=new c.Marker(o);this._markers.push(s),s.setLngLat(a),o.addEventListener("click",function(t){t.stopPropagation(),n._removePopup(),n._popup=(new c.Popup).setLngLat(a).setHTML((e.eventstart||e.linecomnt)+e.lwdate).addTo(i)}),s.addTo(i)},t.prototype._addLayer=function(t,e){return Promise.all([this.webMap.map.addLayer("MVT",{url:t,id:e,paint:{"fill-opacity":.8,"fill-opacity-transition":{duration:0},"fill-color":["match",["get","status"],1,"#cd403a",2,"#d66460",3,"#e19c4b",4,"#e1774b",5,"#e14b90",6,"#a62f2b",7,"#008000","#ccc"]}}),this.webMap.map.addLayer("MVT",{url:t,id:e+"-bound",paint:{"line-opacity":.8,"line-opacity-transition":{duration:0},"line-width":1,"line-color":["match",["get","status"],1,"#7d2420",2,"#cd403a",3,"#d68324",4,"#d65a24",5,"#d62477",6,"#7d2420",7,"#004d00","#ccc"]},type:"line","source-layer":e})])},t.prototype._toggleLayer=function(t,e){this._layersLoaded[t]=!1,this._layersLoaded[t+"-bound"]=!1,e?(this._showLayer(t),this._showLayer(t+"-bound")):(this.webMap.map.removeLayer(t),this.webMap.map.removeLayer(t+"-bound"))},t.prototype._getLayerByYear=function(t,e){var r=this._layersConfig.filter(function(e){return t>=e.from&&t<=e.to});return r[r.length-1]},t.prototype._getLayerIdByYear=function(t,e){var r=this._getLayerByYear(t,e);return r&&String(r.id)},t.prototype._getPointByYear=function(t){return this._pointsConfig.find(function(e){return e.year===t})},t.prototype._getPointIdByYear=function(t){var e=this._getPointByYear(t);return e&&e.id},t.prototype._getNextLayer=function(t,e){var r=this._getLayerByYear(t);if(!r)return e?this._layersConfig.slice().reverse().find(function(e){return e.to<=t}):this._layersConfig.find(function(e){return e.from>=t});if(String(r.id)!==this.currentLayerId)return r;var n=this._layersConfig.indexOf(r);return-1!==n&&this._layersConfig[e?n-1:n+1]},t.prototype._processLayersMeta=function(t){var e=this,r=[];return t.forEach(function(t){var n=t.resource,i=n.display_name,o=i.match("from_(\\d{4})_to_(\\d{4}).*$").slice(1).map(function(t){return Number(t)}),a=o[0],s=o[1];!(e.options.fromYear&&a<e.options.fromYear)&&(e._minYear=(e._minYear>a?a:e._minYear)||a,e._maxYear=(e._maxYear<s?s:e._maxYear)||s,r.push({name:i,from:a,to:s,id:n.id}))}),r},t.prototype._processPointsMeta=function(t){return t.map(function(t){var e=t.resource,r=e.display_name,n=r.match("(\\d{4})-(\\d{2})-(\\d{2})*$").slice(1).map(function(t){return Number(t)});return{name:r,year:n[0],month:n[1],day:n[2],id:e.id}})},t.prototype._createPopupContent=function(t){return this._createPropBlock([{name:"Fid",field:"fid"},{name:"Наименование территории",field:"name"}],t)},t.prototype._createPropBlock=function(t,e){var r=document.createElement("div");return t.forEach(function(t){var n=e[t.field];if(n){var i=document.createElement("div");i.className="popup__propertyblock",i.innerHTML='\n        <div class="popup__property-name">'+t.name+'</div>\n        <div class="popup__property-value">'+n+"</div>\n        ",r.appendChild(i)}}),r},t.prototype._addLayerListeners=function(t){var e=this,r=this.webMap.map.map;r.on("click",t,function(n){var i=n.point,o=r.queryRenderedFeatures([[i.x-2.5,i.y-2.5],[i.x+2.5,i.y+2.5]],{layers:[t]})[0];if(o.properties.status&&o.properties.status<6){var a=e._createPopupContent(o.properties).innerHTML;a&&(e._popup=(new c.Popup).setLngLat(n.lngLat).setHTML(a).addTo(r))}}),r.on("mouseenter",t,function(t){r.getCanvas().style.cursor="pointer"}),r.on("mouseleave",t,function(){r.getCanvas().style.cursor=""})},t.prototype._removePopup=function(){this._popup&&(this._popup.remove(),this._popup=null)},t.prototype._removeLayerListeners=function(t){var e=this.webMap.map.map;e.off("mouseenter",t),e.off("mouseleave",t),e.getCanvas().style.cursor="",this._removePopup()},t}(),$r=r(87),tn=r(122),en=r.n(tn),rn=r(123),nn=r.n(rn);r(302);const on=new Qr({baseUrl:h.baseUrl,target:"map",fromYear:1462,currentYear:1300,animationDelay:100,animationStep:1,periods:en.a,yearsStat:nn.a,version:$r.a});on.emitter.on("build",function(){const t=document.getElementsByClassName("noUi-marker-large");if(t.length){[t[0],t[t.length-1]].forEach(function(t){t.style.display="none"})}}),window.app=on,window.version=$r.a}]);